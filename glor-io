! function(t) {
    function e(s) {
        if (i[s]) return i[s].exports;
        var n = i[s] = {
            i: s,
            l: !1,
            exports: {}
        };
        return t[s].call(n.exports, n, n.exports, e), n.l = !0, n.exports
    }
    var i = {};
    e.m = t, e.c = i, e.i = function(t) {
        return t
    }, e.d = function(t, i, s) {
        e.o(t, i) || Object.defineProperty(t, i, {
            configurable: !1,
            enumerable: !0,
            get: s
        })
    }, e.n = function(t) {
        var i = t && t.__esModule ? function() {
            return t.default
        } : function() {
            return t
        };
        return e.d(i, "a", i), i
    }, e.o = function(t, e) {
        return Object.prototype.hasOwnProperty.call(t, e)
    }, e.p = "", e(e.s = 137)
}([function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(8),
        o = function(t) {
            function e() {
                return t.call(this) || this
            }
            return s(e, t), e.prototype.start = function() {}, e.prototype.update = function(t) {}, e.prototype.destroy = function() {}, e
        }(n.EventEmitter);
    e.Component = o;
    var r = function(t) {
        function e(e, i, s) {
            var n = t.call(this) || this;
            return n._components = [], n.components = {}, n.world = e, n.id = i, n.parentId = s, n
        }
        return s(e, t), e.prototype.addComponent = function(t) {
            if (this._components.push(t), t.id)
                if (this.components[t.id]) {
                    for (var e = 1; this.components.hasOwnProperty(t.id + "_" + e.toString());) e++;
                    this.components[t.id + "_" + e.toString()] = t
                } else this.components[t.id] = t;
            return t.entity = this, t.world = this.world, t.start(), t
        }, e.prototype.update = function(t) {
            for (var e = 0, i = this._components; e < i.length; e++) i[e].update(t)
        }, e.prototype.destroy = function() {
            for (; this._components.length > 0;) this._components.pop().destroy();
            this.components = {}
        }, e.prototype.isLocalPlayer = function() {
            return this.id === this.world.id
        }, e
    }(n.EventEmitter);
    e.Entity = r
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e(e) {
            var i = t.call(this) || this;
            return i.world = e, i
        }
        return s(e, t), e.prototype.update = function(t) {}, e.prototype.cleanup = function() {}, e.prototype.destroy = function() {}, e
    }(i(8).EventEmitter);
    e.Service = n;
    var o = function() {
        function t() {
            this.services = []
        }
        return t.prototype.registerService = function(t) {
            this.services.push(t)
        }, t.prototype.getService = function(t) {
            for (var e = 0, i = this.services; e < i.length; e++) {
                var s = i[e];
                if (s instanceof t) return s
            }
            return null
        }, t.prototype.update = function(t) {
            for (var e = 0, i = this.services; e < i.length; e++) i[e].update(t)
        }, t.prototype.cleanup = function() {
            for (var t = 0, e = this.services; t < e.length; t++) e[t].cleanup()
        }, t.prototype.destroy = function() {
            for (var t = 0, e = this.services; t < e.length; t++) e[t].destroy();
            this.services = []
        }, t
    }();
    e.ServiceManager = o
}, function(t, e, i) {
    "use strict";
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var s = i(20);
    i(130),
        function(t) {
            var e, n, o, r;
            t.ProtobufRoot = s.Root.fromJSON(i(39)),
                function(t) {
                    t[t.Spectator = 0] = "Spectator", t[t.Player = 1] = "Player", t[t.WoodGenerator = 2] = "WoodGenerator", t[t.StoneGenerator = 3] = "StoneGenerator", t[t.Pig = 4] = "Pig", t[t.Wolf = 5] = "Wolf", t[t.Chicken = 6] = "Chicken", t[t.Bear = 7] = "Bear", t[t.RideablePig = 8] = "RideablePig", t[t.RideableWolf = 9] = "RideableWolf", t[t.WoodBlock = 10] = "WoodBlock", t[t.StoneBlock = 11] = "StoneBlock", t[t.Door = 12] = "Door", t[t.FoodCrate = 13] = "FoodCrate", t[t.WoodCrate = 14] = "WoodCrate", t[t.StoneCrate = 15] = "StoneCrate", t[t.Tower = 16] = "Tower", t[t.Mannequin = 17] = "Mannequin", t[t.Heartstone = 18] = "Heartstone", t[t.Garden = 19] = "Garden", t[t.PigSpawner = 20] = "PigSpawner", t[t.ChickenSpawner = 21] = "ChickenSpawner", t[t.WolfSpawner = 22] = "WolfSpawner", t[t.BearSpawner = 23] = "BearSpawner", t[t.EggPickup = 24] = "EggPickup", t[t.PigMeatPickup = 25] = "PigMeatPickup", t[t.BearMeatPickup = 26] = "BearMeatPickup", t[t.CarrotPickup = 27] = "CarrotPickup", t[t.BoxPickup = 28] = "BoxPickup", t[t.FollowerBot = 29] = "FollowerBot", t[t.GuardBot = 30] = "GuardBot", t[t.FarmerBot = 31] = "FarmerBot", t[t.GardenBot = 32] = "GardenBot", t[t.WhiteBear = 33] = "WhiteBear", t[t.WinterWoodGenerator = 34] = "WinterWoodGenerator", t[t.WinterStoneGenerator = 35] = "WinterStoneGenerator", t[t.WhiteBearSpawner = 36] = "WhiteBearSpawner", t[t.SoccerBall = 37] = "SoccerBall", t[t.FireballBullet = 38] = "FireballBullet", t[t.NightmareBoss = 39] = "NightmareBoss", t[t.WhiteWalker = 40] = "WhiteWalker", t[t.WhiteWalkerSpawner = 41] = "WhiteWalkerSpawner", t[t.WinterWall = 42] = "WinterWall", t[t.WinterFloor = 43] = "WinterFloor", t[t.WinterTower = 44] = "WinterTower", t[t.WhiteBearHat = 45] = "WhiteBearHat", t[t.BrownBearHat = 46] = "BrownBearHat", t[t.ChessHat = 47] = "ChessHat", t[t.CowboyHat = 48] = "CowboyHat", t[t.HiddenHat = 49] = "HiddenHat", t[t.CatHat = 50] = "CatHat", t[t.CoinPickup = 51] = "CoinPickup", t[t.ChickenHat = 52] = "ChickenHat", t[t.WoodSpikes = 53] = "WoodSpikes", t[t.Portal = 54] = "Portal", t[t.BuilderHat = 55] = "BuilderHat", t[t.FoxHat = 56] = "FoxHat", t[t.VikingHat = 57] = "VikingHat", t[t.HockeyHat = 58] = "HockeyHat", t[t.SoulPickup = 59] = "SoulPickup", t[t.SoulCrate = 60] = "SoulCrate", t[t.DarkStoneBlock = 61] = "DarkStoneBlock", t[t.DarkDoor = 62] = "DarkDoor", t[t.RideableBear = 63] = "RideableBear", t[t.DarkGuardBot = 64] = "DarkGuardBot", t[t.TankHat = 65] = "TankHat", t[t.DruidHat = 66] = "DruidHat", t[t.IceHat = 67] = "IceHat", t[t.Spawn = 68] = "Spawn", t[t.HealWard = 69] = "HealWard", t[t.GoldIceHat = 70] = "GoldIceHat", t[t.WoodFloor = 71] = "WoodFloor", t[t.StoneFloor = 72] = "StoneFloor", t[t.TreasureChest = 73] = "TreasureChest", t[t.MarbleFloor = 74] = "MarbleFloor", t[t.Spider = 75] = "Spider", t[t.RideableDragon = 76] = "RideableDragon", t[t.IronSpikes = 77] = "IronSpikes", t[t.CrystalWall = 78] = "CrystalWall", t[t.CrystalDoor = 79] = "CrystalDoor", t[t.Troll = 80] = "Troll", t[t.TrollSpawner = 81] = "TrollSpawner"
                }(e = t.EntityType || (t.EntityType = {})),
                function(t) {
                    t[t.WhiteBearHat = 0] = "WhiteBearHat", t[t.BrownBearHat = 1] = "BrownBearHat", t[t.ChessHat = 2] = "ChessHat", t[t.CowboyHat = 3] = "CowboyHat", t[t.HiddenHat = 4] = "HiddenHat", t[t.CatHat = 5] = "CatHat", t[t.ChickenHat = 6] = "ChickenHat", t[t.BuilderHat = 7] = "BuilderHat", t[t.FoxHat = 8] = "FoxHat", t[t.HockeyHat = 9] = "HockeyHat", t[t.VikingHat = 10] = "VikingHat", t[t.TankHat = 11] = "TankHat", t[t.DruidHat = 12] = "DruidHat", t[t.IceHat = 13] = "IceHat", t[t.GoldIceHat = 14] = "GoldIceHat"
                }(t.HatType || (t.HatType = {})),
                function(t) {
                    t[t.WoodBlock = 0] = "WoodBlock", t[t.StoneBlock = 1] = "StoneBlock", t[t.Door = 2] = "Door", t[t.FarmerBot = 3] = "FarmerBot", t[t.GuardBot = 4] = "GuardBot", t[t.FollowerBot = 5] = "FollowerBot", t[t.Garden = 6] = "Garden", t[t.Heartstone = 7] = "Heartstone", t[t.Tower = 8] = "Tower", t[t.FoodCrate = 9] = "FoodCrate", t[t.WoodCrate = 10] = "WoodCrate", t[t.StoneCrate = 11] = "StoneCrate", t[t.Mannequin = 12] = "Mannequin", t[t.RideableWolf = 13] = "RideableWolf", t[t.GardenBot = 14] = "GardenBot", t[t.SoccerBall = 15] = "SoccerBall", t[t.WoodSpikes = 16] = "WoodSpikes", t[t.Portal = 17] = "Portal", t[t.SoulCrate = 18] = "SoulCrate", t[t.DarkStoneBlock = 19] = "DarkStoneBlock", t[t.DarkDoor = 20] = "DarkDoor", t[t.RideableBear = 21] = "RideableBear", t[t.DarkGuardBot = 22] = "DarkGuardBot", t[t.HealWard = 23] = "HealWard", t[t.FireballBullet = 38] = "FireballBullet", t[t.WoodFloor = 71] = "WoodFloor", t[t.StoneFloor = 72] = "StoneFloor", t[t.TreasureChest = 73] = "TreasureChest", t[t.RideableDragon = 76] = "RideableDragon", t[t.IronSpikes = 77] = "IronSpikes", t[t.CrystalWall = 78] = "CrystalWall", t[t.CrystalDoor = 79] = "CrystalDoor"
                }(n = t.BuildingType || (t.BuildingType = {})), t.BuildingTypeToEntityType = function(t) {
                    return e[n[t]]
                }, t.EntityTypeToBuildingType = function(t) {
                    return n[e[t]]
                },
                function(t) {
                    t[t.Food = 0] = "Food", t[t.Wood = 1] = "Wood", t[t.Stone = 2] = "Stone", t[t.Gold = 3] = "Gold", t[t.Soul = 4] = "Soul"
                }(o = t.ResourceType || (t.ResourceType = {})),
                function(t) {
                    t[t.Sword = 0] = "Sword", t[t.Axe = 1] = "Axe"
                }(t.ItemType || (t.ItemType = {})), t.ParseResourceType = function(t) {
                    var e = t.toLowerCase();
                    return "food" === e ? o.Food : "wood" === e ? o.Wood : "stone" === e ? o.Stone : "gold" === e ? o.Gold : "soul" === e ? o.Soul : o.Food
                },
                function(t) {
                    t[t.SyncObject = 0] = "SyncObject", t[t.SyncObjectDelete = 1] = "SyncObjectDelete", t[t.PlayerSpawnRequest = 2] = "PlayerSpawnRequest", t[t.PlayerInput = 3] = "PlayerInput", t[t.PlayerAction = 4] = "PlayerAction", t[t.PlayerBuildRequest = 5] = "PlayerBuildRequest", t[t.PlayerBuildResponse = 6] = "PlayerBuildResponse", t[t.PlayerChatRequest = 7] = "PlayerChatRequest", t[t.ObjectSendDamage = 8] = "ObjectSendDamage", t[t.ObjectReceiveDamage = 9] = "ObjectReceiveDamage", t[t.SyncBackpack = 10] = "SyncBackpack", t[t.Ping = 11] = "Ping", t[t.RequestServerInfo = 12] = "RequestServerInfo", t[t.ResponseServerInfo = 13] = "ResponseServerInfo", t[t.Assign = 14] = "Assign", t[t.FloatResources = 15] = "FloatResources", t[t.SyncChild = 16] = "SyncChild", t[t.SyncChildDelete = 17] = "SyncChildDelete", t[t.MapMessage = 18] = "MapMessage", t[t.LeaderboardMessage = 19] = "LeaderboardMessage", t[t.ChatMessage = 20] = "ChatMessage", t[t.PlayerUnmountRequest = 21] = "PlayerUnmountRequest", t[t.PlayerCheat = 22] = "PlayerCheat", t[t.ForceDisconnect = 23] = "ForceDisconnect", t[t.PlayerSetViewportSize = 24] = "PlayerSetViewportSize", t[t.PackedMessage = 25] = "PackedMessage", t[t.LeaderboardMessagePlayer = 26] = "LeaderboardMessagePlayer", t[t.PlayerCreateTeam = 27] = "PlayerCreateTeam", t[t.PlayerJoinTeam = 28] = "PlayerJoinTeam", t[t.PlayerApproveRequest = 29] = "PlayerApproveRequest", t[t.PlayerDeclineRequest = 30] = "PlayerDeclineRequest", t[t.PlayerLeaveTeam = 31] = "PlayerLeaveTeam", t[t.PlayerKickRequest = 32] = "PlayerKickRequest", t[t.PlayerTeamMembersRequest = 33] = "PlayerTeamMembersRequest", t[t.PlayerTeamMembersResponse = 34] = "PlayerTeamMembersResponse", t[t.PlayerTeamListRequest = 35] = "PlayerTeamListRequest", t[t.PlayerTeamListResponse = 36] = "PlayerTeamListResponse", t[t.NotifyTeamCreated = 37] = "NotifyTeamCreated", t[t.NotifyTeamRemoved = 38] = "NotifyTeamRemoved", t[t.NotifyJoinRequestCreated = 39] = "NotifyJoinRequestCreated", t[t.NotifyJoinRequestRemoved = 40] = "NotifyJoinRequestRemoved", t[t.NotifyMemberJoin = 41] = "NotifyMemberJoin", t[t.NotifyMemberLeave = 42] = "NotifyMemberLeave", t[t.DayTimeMessage = 43] = "DayTimeMessage", t[t.PlayerTeamPingRequest = 44] = "PlayerTeamPingRequest", t[t.PlayerTeamPingResponse = 45] = "PlayerTeamPingResponse", t[t.PlayerRequestDaytime = 46] = "PlayerRequestDaytime", t[t.SyncHats = 47] = "SyncHats", t[t.PlayerSelectHat = 48] = "PlayerSelectHat", t[t.ServerVersion = 49] = "ServerVersion", t[t.ConsoleMessage = 50] = "ConsoleMessage", t[t.CodeMessage = 51] = "CodeMessage", t[t.PlayerConfigRequest = 52] = "PlayerConfigRequest", t[t.PlayerConfigLoad = 53] = "PlayerConfigLoad", t[t.PlayerLoginToken = 54] = "PlayerLoginToken", t[t.ServerChatMessage = 55] = "ServerChatMessage", t[t.PlayerSetEquipment = 56] = "PlayerSetEquipment", t[t.PlayerUIEvent = 57] = "PlayerUIEvent", t[t.PlayerAPIRequest = 58] = "PlayerAPIRequest", t[t.PlayerAPIResponse = 59] = "PlayerAPIResponse"
                }(r = t.MessageType || (t.MessageType = {}));
            var a = function() {
                function t(t, e) {
                    this.type = t, this.content = e
                }
                return t.prototype.typeString = function() {
                    return r[this.type].toString()
                }, t
            }();
            t.Message = a;
            var h = {};
            t.decode = function(e) {
                if (e.length > 0) {
                    var i = e[0];
                    try {
                        var s = r[i];
                        if (null != s) {
                            var n = e.slice(1, e.length),
                                o = void 0;
                            if (h.hasOwnProperty(s) ? o = h[s] : (o = t.ProtobufRoot.lookupType(s), h[s] = o), null != o) return new a(i, o.decode(n))
                        }
                    } catch (t) {}
                }
                return null
            }, t.encode = function(e, i) {
                var s = r[e],
                    n = t.ProtobufRoot.lookupType(s).encode(i).finish(),
                    o = new Uint8Array(n.length + 1);
                return o[0] = e, o.set(n, 1), o
            }
        }(e.Protocol || (e.Protocol = {}))
}, function(t, e, i) {
    "use strict";
    Object.defineProperty(e, "__esModule", {
            value: !0
        }),
        function(t) {
            var e = function() {
                function t() {}
                return t.getName = function() {
                    return "atlases_knight-flamesword"
                }, t.getPNG = function() {
                    return i(47)
                }, t
            }();
            t.AtlasesKnightFlamesword = e;
            var s = function() {
                function t() {}
                return t.getName = function() {
                    return "frontend_btn_google_signin_dark_normal_web"
                }, t.getPNG = function() {
                    return i(53)
                }, t
            }();
            t.FrontendBtnGoogleSigninDarkNormalWeb = s;
            var n = function() {
                function t() {}
                return t.getName = function() {
                    return "frontend_crash"
                }, t.getPNG = function() {
                    return i(54)
                }, t
            }();
            t.FrontendCrash = n;
            var o = function() {
                function t() {}
                return t.getName = function() {
                    return "frontend_discord-logo"
                }, t.getSVG = function() {
                    return i(55)
                }, t
            }();
            t.FrontendDiscordLogo = o;
            var r = function() {
                function t() {}
                return t.getName = function() {
                    return "frontend_favicon"
                }, t.getICO = function() {
                    return i(56)
                }, t
            }();
            t.FrontendFavicon = r;
            var a = function() {
                function t() {}
                return t.getName = function() {
                    return "frontend_load"
                }, t.getGIF = function() {
                    return i(57)
                }, t.getPNG = function() {
                    return i(58)
                }, t
            }();
            t.FrontendLoad = a;
            var h = function() {
                function t() {}
                return t.getName = function() {
                    return "frontend_reddit-logo"
                }, t.getSVG = function() {
                    return i(59)
                }, t
            }();
            t.FrontendRedditLogo = h;
            var l = function() {
                function t() {}
                return t.getName = function() {
                    return "images_axe"
                }, t.getPNG = function() {
                    return i(60)
                }, t
            }();
            t.ImagesAxe = l;
            var c = function() {
                function t() {}
                return t.getName = function() {
                    return "images_background_template"
                }, t.getPNG = function() {
                    return i(61)
                }, t
            }();
            t.ImagesBackgroundTemplate = c;
            var u = function() {
                function t() {}
                return t.getName = function() {
                    return "images_bannertopleft"
                }, t.getPNG = function() {
                    return i(62)
                }, t
            }();
            t.ImagesBannertopleft = u;
            var d = function() {
                function t() {}
                return t.getName = function() {
                    return "images_body"
                }, t.getPNG = function() {
                    return i(63)
                }, t
            }();
            t.ImagesBody = d;
            var p = function() {
                function t() {}
                return t.getName = function() {
                    return "images_build"
                }, t.getPNG = function() {
                    return i(64)
                }, t
            }();
            t.ImagesBuild = p;
            var f = function() {
                function t() {}
                return t.getName = function() {
                    return "images_chesshatrot"
                }, t.getPNG = function() {
                    return i(65)
                }, t
            }();
            t.ImagesChesshatrot = f;
            var m = function() {
                function t() {}
                return t.getName = function() {
                    return "images_cowboyhaticon"
                }, t.getPNG = function() {
                    return i(66)
                }, t
            }();
            t.ImagesCowboyhaticon = m;
            var g = function() {
                function t() {}
                return t.getName = function() {
                    return "images_crown"
                }, t.getPNG = function() {
                    return i(67)
                }, t
            }();
            t.ImagesCrown = g;
            var y = function() {
                function t() {}
                return t.getName = function() {
                    return "images_crownserver"
                }, t.getPNG = function() {
                    return i(68)
                }, t
            }();
            t.ImagesCrownserver = y;
            var v = function() {
                function t() {}
                return t.getName = function() {
                    return "images_dynastiobanner"
                }, t.getPNG = function() {
                    return i(69)
                }, t
            }();
            t.ImagesDynastiobanner = v;
            var b = function() {
                function t() {}
                return t.getName = function() {
                    return "images_glasswall"
                }, t.getPNG = function() {
                    return i(70)
                }, t
            }();
            t.ImagesGlasswall = b;
            var _ = function() {
                function t() {}
                return t.getName = function() {
                    return "images_greyportal"
                }, t.getPNG = function() {
                    return i(71)
                }, t
            }();
            t.ImagesGreyportal = _;
            var w = function() {
                function t() {}
                return t.getName = function() {
                    return "images_hands"
                }, t.getPNG = function() {
                    return i(72)
                }, t
            }();
            t.ImagesHands = w;
            var x = function() {
                function t() {}
                return t.getName = function() {
                    return "images_head"
                }, t.getPNG = function() {
                    return i(73)
                }, t
            }();
            t.ImagesHead = x;
            var P = function() {
                function t() {}
                return t.getName = function() {
                    return "images_knight"
                }, t.getPNG = function() {
                    return i(74)
                }, t
            }();
            t.ImagesKnight = P;
            var T = function() {
                function t() {}
                return t.getName = function() {
                    return "images_minimapwalker"
                }, t.getPNG = function() {
                    return i(75)
                }, t
            }();
            t.ImagesMinimapwalker = T;
            var C = function() {
                function t() {}
                return t.getName = function() {
                    return "images_minimapwinner"
                }, t.getPNG = function() {
                    return i(76)
                }, t
            }();
            t.ImagesMinimapwinner = C;
            var S = function() {
                function t() {}
                return t.getName = function() {
                    return "images_rain"
                }, t.getPNG = function() {
                    return i(77)
                }, t
            }();
            t.ImagesRain = S;
            var A = function() {
                function t() {}
                return t.getName = function() {
                    return "images_rideabledragon"
                }, t.getPNG = function() {
                    return i(78)
                }, t
            }();
            t.ImagesRideabledragon = A;
            var E = function() {
                function t() {}
                return t.getName = function() {
                    return "images_sociallogo"
                }, t.getPNG = function() {
                    return i(79)
                }, t
            }();
            t.ImagesSociallogo = E;
            var k = function() {
                function t() {}
                return t.getName = function() {
                    return "images_sword"
                }, t.getPNG = function() {
                    return i(80)
                }, t
            }();
            t.ImagesSword = k;
            var M = function() {
                function t() {}
                return t.getName = function() {
                    return "images_team"
                }, t.getPNG = function() {
                    return i(81)
                }, t
            }();
            t.ImagesTeam = M;
            var O = function() {
                function t() {}
                return t.getName = function() {
                    return "images_unknown"
                }, t.getPNG = function() {
                    return i(82)
                }, t
            }();
            t.ImagesUnknown = O;
            var R = function() {
                function t() {}
                return t.getName = function() {
                    return "images_unmount"
                }, t.getPNG = function() {
                    return i(83)
                }, t
            }();
            t.ImagesUnmount = R
        }(e.Images || (e.Images = {})),
        function(t) {
            var e;
            ! function(t) {
                t[t.Walk1 = "walk1.png"] = "Walk1", t[t.Walk2 = "walk2.png"] = "Walk2", t[t.Walk3 = "walk3.png"] = "Walk3", t[t.Walk4 = "walk4.png"] = "Walk4", t[t.Walk5 = "walk5.png"] = "Walk5", t[t.Walk6 = "walk6.png"] = "Walk6", t[t.Walk7 = "walk7.png"] = "Walk7", t[t.Walk8 = "walk8.png"] = "Walk8"
            }(e || (e = {}));
            var s, n = function() {
                function t() {}
                return t.getName = function() {
                    return "atlases_carpig"
                }, t.getJSONHash = function() {
                    return i(41)
                }, t.getPNG = function() {
                    return i(42)
                }, t
            }();
            n.Frames = e, t.AtlasesCarpig = n, s || (s = {});
            var o, r = function() {
                function t() {}
                return t.getName = function() {
                    return "atlases_feet"
                }, t.getJSONHash = function() {
                    return i(43)
                }, t.getPNG = function() {
                    return i(44)
                }, t
            }();
            r.Frames = s, t.AtlasesFeet = r,
                function(t) {
                    t[t.Hit1 = "hit1.png"] = "Hit1", t[t.Hit2 = "hit2.png"] = "Hit2", t[t.Hit3 = "hit3.png"] = "Hit3", t[t.Hit4 = "hit4.png"] = "Hit4", t[t.Hit5 = "hit5.png"] = "Hit5", t[t.Hit6 = "hit6.png"] = "Hit6"
                }(o || (o = {}));
            var a, h = function() {
                function t() {}
                return t.getName = function() {
                    return "atlases_hit"
                }, t.getJSONHash = function() {
                    return i(45)
                }, t.getPNG = function() {
                    return i(46)
                }, t
            }();
            h.Frames = o, t.AtlasesHit = h,
                function(t) {
                    t[t.Hit1 = "hit1.png"] = "Hit1", t[t.Hit2 = "hit2.png"] = "Hit2", t[t.Hit3 = "hit3.png"] = "Hit3", t[t.Hit4 = "hit4.png"] = "Hit4", t[t.Hit5 = "hit5.png"] = "Hit5", t[t.Hit6 = "hit6.png"] = "Hit6", t[t.Hit7 = "hit7.png"] = "Hit7", t[t.Hit8 = "hit8.png"] = "Hit8", t[t.Hit9 = "hit9.png"] = "Hit9", t[t.Hit10 = "hit10.png"] = "Hit10", t[t.Onpig = "onpig.png"] = "Onpig", t[t.Pighit1 = "pighit1.png"] = "Pighit1", t[t.Pighit2 = "pighit2.png"] = "Pighit2", t[t.Pighit3 = "pighit3.png"] = "Pighit3", t[t.Pighit4 = "pighit4.png"] = "Pighit4", t[t.Pighit5 = "pighit5.png"] = "Pighit5", t[t.Pighit6 = "pighit6.png"] = "Pighit6", t[t.Pighit7 = "pighit7.png"] = "Pighit7", t[t.Pighit8 = "pighit8.png"] = "Pighit8", t[t.Walk1 = "walk1.png"] = "Walk1", t[t.Walk2 = "walk2.png"] = "Walk2", t[t.Walk3 = "walk3.png"] = "Walk3", t[t.Walk4 = "walk4.png"] = "Walk4", t[t.Walk5 = "walk5.png"] = "Walk5", t[t.Walk6 = "walk6.png"] = "Walk6", t[t.Walk7 = "walk7.png"] = "Walk7", t[t.Walk8 = "walk8.png"] = "Walk8", t[t.Walk9 = "walk9.png"] = "Walk9", t[t.Walk10 = "walk10.png"] = "Walk10", t[t.Walk11 = "walk11.png"] = "Walk11", t[t.Walk12 = "walk12.png"] = "Walk12", t[t.Walk13 = "walk13.png"] = "Walk13", t[t.Walk14 = "walk14.png"] = "Walk14", t[t.Walk15 = "walk15.png"] = "Walk15", t[t.Walk16 = "walk16.png"] = "Walk16"
                }(a || (a = {}));
            var l, c = function() {
                function t() {}
                return t.getName = function() {
                    return "atlases_knight"
                }, t.getJSONHash = function() {
                    return i(48)
                }, t.getPNG = function() {
                    return i(49)
                }, t
            }();
            c.Frames = a, t.AtlasesKnight = c,
                function(t) {
                    t[t.Hit1 = "hit1.png"] = "Hit1", t[t.Hit2 = "hit2.png"] = "Hit2", t[t.Hit3 = "hit3.png"] = "Hit3", t[t.Hit4 = "hit4.png"] = "Hit4", t[t.Hit5 = "hit5.png"] = "Hit5", t[t.Hit6 = "hit6.png"] = "Hit6", t[t.Hit7 = "hit7.png"] = "Hit7", t[t.Hit8 = "hit8.png"] = "Hit8", t[t.Walk1 = "walk1.png"] = "Walk1", t[t.Walk2 = "walk2.png"] = "Walk2", t[t.Walk3 = "walk3.png"] = "Walk3", t[t.Walk4 = "walk4.png"] = "Walk4", t[t.Walk5 = "walk5.png"] = "Walk5", t[t.Walk6 = "walk6.png"] = "Walk6", t[t.Walk7 = "walk7.png"] = "Walk7", t[t.Walk8 = "walk8.png"] = "Walk8"
                }(l || (l = {}));
            var u, d = function() {
                function t() {}
                return t.getName = function() {
                    return "atlases_troll"
                }, t.getJSONHash = function() {
                    return i(50)
                }, t.getPNG = function() {
                    return i(51)
                }, t
            }();
            d.Frames = l, t.AtlasesTroll = d, u || (u = {});
            var p = function() {
                function t() {}
                return t.getName = function() {
                    return "map_map"
                }, t.getJSONHash = function() {
                    return i(86)
                }, t.getPNG = function() {
                    return i(87)
                }, t
            }();
            p.Frames = u, t.MapMap = p
        }(e.Atlases || (e.Atlases = {})),
        function(t) {
            var e = function() {
                function t() {}
                return t.getName = function() {
                    return "whoosh_1"
                }, t.getWAV = function() {
                    return i(88)
                }, t
            }();
            t.SfxWhoosh1 = e
        }(e.Audio || (e.Audio = {})), e.Audiosprites || (e.Audiosprites = {}), (e.GoogleWebFonts || (e.GoogleWebFonts = {})).RobotoMono = "Roboto Mono", e.CustomWebFonts || (e.CustomWebFonts = {}), e.BitmapFonts || (e.BitmapFonts = {}), e.JSON || (e.JSON = {}), e.XML || (e.XML = {}), e.Text || (e.Text = {}),
        function(t) {
            var e = function() {
                function t() {}
                return t.getName = function() {
                    return "frontend-util"
                }, t.getJS = function() {
                    return i(84)
                }, t
            }();
            t.JsFrontendUtil = e;
            var s = function() {
                function t() {}
                return t.getName = function() {
                    return "joy"
                }, t.getJS = function() {
                    return i(85)
                }, t
            }();
            t.JsJoy = s
        }(e.Scripts || (e.Scripts = {})),
        function(t) {
            var e = function() {
                function t() {}
                return t.getName = function() {
                    return "blue-dots"
                }, t.getFRAG = function() {
                    return i(89)
                }, t
            }();
            t.ShadersBlueDots = e
        }(e.Shaders || (e.Shaders = {})),
        function(t) {
            var e = function() {
                function t() {}
                return t.getName = function() {
                    return "style"
                }, t.getCSS = function() {
                    return i(52)
                }, t
            }();
            t.CssStyle = e
        }(e.Misc || (e.Misc = {}))
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(35),
        r = function() {
            function t() {
                this.serverRotation = 0, this.clientRotation = 0, this.updateTime = 0, this.interpolationTime = .1
            }
            return t.prototype.updateFrame = function(t, e, i) {
                this.serverRotation = e, this.clientRotation = t, this.updateTime = i
            }, t.interpolateAngle = function(t, e, i, s) {
                void 0 === s && (s = !0);
                var n = s ? Math.PI : 180;
                Math.abs(e - t) > n && (e > t ? t += 2 * n : e += 2 * n);
                var o = t + (e - t) * i;
                return o >= 0 && o <= 2 * n ? o : o % (2 * n)
            }, t.prototype.interpolate = function(e, i) {
                var s = (e - this.updateTime) / (this.interpolationTime + i / 2);
                return s = Phaser.Math.clamp(s, 0, 1), t.interpolateAngle(this.clientRotation, this.serverRotation, s)
            }, t
        }();
    e.RotationInterpolator = r;
    var a = function() {
        function t() {
            this.serverPosition = new Phaser.Point, this.clientPosition = new Phaser.Point, this.updateTime = 0, this.forceTeleportDistance = 500, this.interpolationTime = .1
        }
        return t.prototype.updateFrame = function(t, e, i) {
            this.serverPosition.copyFrom(e), this.clientPosition.copyFrom(t), this.updateTime = i
        }, t.prototype.interpolate = function(t, e, i) {
            if (this.clientPosition.distance(this.serverPosition) < this.forceTeleportDistance) {
                var s = (e - this.updateTime) / (this.interpolationTime + i / 2);
                s = Phaser.Math.clamp(s, 0, 1), Phaser.Point.interpolate(this.clientPosition, this.serverPosition, s, t)
            } else t.set(this.serverPosition.x, this.serverPosition.y)
        }, t
    }();
    e.PositionInterpolator = a;
    var h = function(t) {
        function e(e, i) {
            void 0 === e && (e = !0), void 0 === i && (i = !0);
            var s = t.call(this) || this;
            return s.id = "networktransform", s.rotationInterpolator = new r, s.positionInterpolator = new a, s.tmpNetworkPoint = new Phaser.Point, s.interpolateRotation = !0, s.interpolatePosition = !0, s.interpolateRotation = i, s.interpolatePosition = e, s
        }
        return s(e, t), e.prototype.start = function() {
            t.prototype.start.call(this), this.cachedTransform = this.entity.components.transform, this.cachedPingService = this.world.services.getService(o.default), this.entity.on("networksync", this.onNetworkSync.bind(this))
        }, e.prototype.onNetworkSync = function(t) {
            t.hasOwnProperty("x") && this.interpolatePosition && (this.tmpNetworkPoint.set(t.x, t.y), this.positionInterpolator.updateFrame(this.cachedTransform.position, this.tmpNetworkPoint, this.world.game.time.totalElapsedSeconds())), t.hasOwnProperty("rotation") && this.interpolateRotation && this.rotationInterpolator.updateFrame(this.cachedTransform.rotation, t.rotation, this.world.game.time.totalElapsedSeconds())
        }, e.prototype.update = function(t) {
            this.interpolatePosition && this.positionInterpolator.interpolate(this.cachedTransform.position, this.world.game.time.totalElapsedSeconds(), this.cachedPingService.getAveragePing()), this.interpolateRotation && (this.cachedTransform.rotation = this.rotationInterpolator.interpolate(this.world.game.time.totalElapsedSeconds(), this.cachedPingService.getAveragePing()))
        }, e
    }(n.Component);
    e.default = h
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e(e, i) {
            var s = t.call(this) || this;
            return s.position = new Phaser.Point, s.rotation = 0, s.id = "transform", s.previousPosition = new Phaser.Point, s.stayTime = 0, e && s.position.copyFrom(e), i && (s.rotation = i), s
        }
        return s(e, t), e.prototype.angle = function() {
            return this.position.equals(this.previousPosition) ? 0 : this.position.angle(this.previousPosition)
        }, e.prototype.update = function(t) {
            this.position.equals(this.previousPosition) ? this.stayTime += t : this.stayTime = 0, this.previousPosition.copyFrom(this.position)
        }, e.prototype.isMoving = function() {
            return this.stayTime < .2
        }, e
    }(i(0).Component);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            var e = t.call(this) || this;
            return e.id = "animator", e
        }
        return s(e, t), e.prototype.start = function() {
            this.cachedSpriteComponent = this.entity.components.sprite, this.cachedTransform = this.entity.components.transform
        }, e.prototype.addAnimation = function(t, e, i, s) {
            return void 0 === s && (s = !1), this.cachedSpriteComponent.sprite.animations.add(t, e, i, s)
        }, e.prototype.play = function(t) {
            this.cachedSpriteComponent.sprite.animations.play(t)
        }, e.prototype.getCurrentName = function() {
            return this.cachedSpriteComponent.sprite.animations.name
        }, e
    }(i(0).Component);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(3),
        r = function(t) {
            function e(e, i, s) {
                var n = t.call(this) || this;
                return n.sync = !0, n.id = "sprite", n.color = 16777215, n.parents = {}, n.sways = {}, n.equipment = 0, n.sprite = e.create(0, 0, i), n.sprite.anchor.copyFrom(s), n.sprite.smoothed = !0, n
            }
            return s(e, t), e.prototype.addSpriteParent = function(t, e, i, s) {
                var n = e.create(0, 0, i);
                (n.anchor.copyFrom(s), n.smoothed = !0, this.parents[t] = n, this.sprite.addChild(n), "body" == t || "hands" == t) && ((o = this.world.game.add.tween(n)).to({
                    rotation: .3
                }, 250, Phaser.Easing.Linear.None, !0, 0, -1, !0), this.sways[t] = o);
                if ("weapon" == t) {
                    var o = this.world.game.add.tween(n);
                    n.rotation = -.5, o.to({
                        rotation: -.2
                    }, 250, Phaser.Easing.Linear.None, !0, 0, -1, !0), this.sways[t] = o
                }
                return n
            }, e.prototype.stop = function() {
                for (var t in this.sways) this.sways[t].pause()
            }, e.prototype.walk = function() {
                for (var t in this.sways) this.sways[t].resume()
            }, e.prototype.attack = function() {
                for (var t in this.sways) this.sways[t].pause();
                try {
                    this.parents.hit.animations.play("hit")
                } catch (t) {}
                var e = this.world.game.add.tween(this.parents.weapon);
                e.to({
                    x: 20,
                    rotation: 1.4
                }, 50).to({
                    x: -10,
                    y: -40,
                    scaley: 3,
                    rotation: .3
                }, 35).to({
                    x: -10,
                    y: -30,
                    scaley: 3,
                    rotation: -2.5
                }, 35).to({
                    x: 0,
                    y: 0,
                    scaley: 1,
                    rotation: -.5
                }, 120), e.start();
                var i = this.world.game.add.tween(this.parents.body);
                i.to({
                    rotation: .8
                }, 50).to({
                    y: -5,
                    rotation: -1
                }, 45).to({
                    y: -5,
                    rotation: -1.5
                }, 55).to({
                    rotation: 0,
                    y: 0
                }, 100), i.start();
                var s = this.world.game.add.tween(this.parents.hands);
                s.to({
                    rotation: .8
                }, 50).to({
                    x: -0,
                    y: -20,
                    rotation: -1
                }, 35).to({
                    x: -0,
                    y: -20,
                    rotation: -1.5
                }, 35).to({
                    rotation: 0,
                    x: 0,
                    y: 0
                }, 100), s.start()
            }, e.prototype.start = function() {
                this.cachedTransform = this.entity.components.transform, this.entity.on("networksync", this.onNetworkSync.bind(this)), this.entity.on("alpha", function(t) {
                    this.sprite.alpha = t.alpha
                }.bind(this))
            }, e.prototype.onNetworkSync = function(t) {
                t.hasOwnProperty("equipment") && this.setEquipment(t.equipment)
            }, e.prototype.setEquipment = function(t) {
                this.equipment = t, this.parents.weapon && (t % 2 ? this.parents.weapon.loadTexture(o.Images.ImagesAxe.getName()) : this.parents.weapon.loadTexture(o.Images.ImagesSword.getName()))
            }, e.prototype.update = function(t) {
                this.sync && (this.sprite.position.copyFrom(this.cachedTransform.position), this.sprite.rotation = this.cachedTransform.rotation)
            }, e.prototype.destroy = function() {
                for (var t in this.sprite.destroy(), this.sways) this.sways[t].stop();
                this.sways = {}
            }, e.prototype.jump = function(t) {
                this.sync = !1, this.sprite.position.y -= t;
                var e = this.world.game.add.tween(this.sprite);
                e.to({
                    y: this.sprite.position.y + 10
                }, 250), e.onComplete.add(this.onJumpTweenComplete, this), e.start()
            }, e.prototype.scale = function(t, e) {
                this.sprite.scale.set(t, e)
            }, e.prototype.setColor = function(t) {
                for (var e in this.color = t, this.sprite.tint = this.color, this.parents) this.parents[e].tint = this.color
            }, e.prototype.flashRed = function() {
                if (this.sprite) {
                    for (var t in this.sprite.tint = 16751001, this.parents) this.parents[t].tint = 16751001;
                    this.world.game.time.events.add(.2 * Phaser.Timer.SECOND, function() {
                        if (this.sprite) {
                            var t = this.color;
                            for (var e in this.sprite.tint = t, this.parents) this.parents[e].tint = t
                        }
                    }, this)
                }
            }, e.prototype.onJumpTweenComplete = function() {
                this.sync = !0
            }, e
        }(n.Component);
    e.default = r
}, function(t, e, i) {
    "use strict";

    function s() {
        s.init.call(this)
    }

    function n(t) {
        if ("function" != typeof t) throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof t)
    }

    function o(t) {
        return void 0 === t._maxListeners ? s.defaultMaxListeners : t._maxListeners
    }

    function r(t, e, i, s) {
        var r, a, h;
        if (n(i), void 0 === (a = t._events) ? (a = t._events = Object.create(null), t._eventsCount = 0) : (void 0 !== a.newListener && (t.emit("newListener", e, i.listener ? i.listener : i), a = t._events), h = a[e]), void 0 === h) h = a[e] = i, ++t._eventsCount;
        else if ("function" == typeof h ? h = a[e] = s ? [i, h] : [h, i] : s ? h.unshift(i) : h.push(i), (r = o(t)) > 0 && h.length > r && !h.warned) {
            h.warned = !0;
            var l = new Error("Possible EventEmitter memory leak detected. " + h.length + " " + String(e) + " listeners added. Use emitter.setMaxListeners() to increase limit");
            l.name = "MaxListenersExceededWarning", l.emitter = t, l.type = e, l.count = h.length,
                function(t) {
                    console && console.warn && console.warn(t)
                }(l)
        }
        return t
    }

    function a(t, e, i) {
        var s = {
                fired: !1,
                wrapFn: void 0,
                target: t,
                type: e,
                listener: i
            },
            n = function() {
                if (!this.fired) return this.target.removeListener(this.type, this.wrapFn), this.fired = !0, 0 === arguments.length ? this.listener.call(this.target) : this.listener.apply(this.target, arguments)
            }.bind(s);
        return n.listener = i, s.wrapFn = n, n
    }

    function h(t, e, i) {
        var s = t._events;
        if (void 0 === s) return [];
        var n = s[e];
        return void 0 === n ? [] : "function" == typeof n ? i ? [n.listener || n] : [n] : i ? function(t) {
            for (var e = new Array(t.length), i = 0; i < e.length; ++i) e[i] = t[i].listener || t[i];
            return e
        }(n) : c(n, n.length)
    }

    function l(t) {
        var e = this._events;
        if (void 0 !== e) {
            var i = e[t];
            if ("function" == typeof i) return 1;
            if (void 0 !== i) return i.length
        }
        return 0
    }

    function c(t, e) {
        for (var i = new Array(e), s = 0; s < e; ++s) i[s] = t[s];
        return i
    }
    var u, d = "object" == typeof Reflect ? Reflect : null,
        p = d && "function" == typeof d.apply ? d.apply : function(t, e, i) {
            return Function.prototype.apply.call(t, e, i)
        };
    u = d && "function" == typeof d.ownKeys ? d.ownKeys : Object.getOwnPropertySymbols ? function(t) {
        return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))
    } : function(t) {
        return Object.getOwnPropertyNames(t)
    };
    var f = Number.isNaN || function(t) {
        return t != t
    };
    t.exports = s, s.EventEmitter = s, s.prototype._events = void 0, s.prototype._eventsCount = 0, s.prototype._maxListeners = void 0;
    var m = 10;
    Object.defineProperty(s, "defaultMaxListeners", {
        enumerable: !0,
        get: function() {
            return m
        },
        set: function(t) {
            if ("number" != typeof t || t < 0 || f(t)) throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ' + t + ".");
            m = t
        }
    }), s.init = function() {
        void 0 !== this._events && this._events !== Object.getPrototypeOf(this)._events || (this._events = Object.create(null), this._eventsCount = 0), this._maxListeners = this._maxListeners || void 0
    }, s.prototype.setMaxListeners = function(t) {
        if ("number" != typeof t || t < 0 || f(t)) throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received ' + t + ".");
        return this._maxListeners = t, this
    }, s.prototype.getMaxListeners = function() {
        return o(this)
    }, s.prototype.emit = function(t) {
        for (var e = [], i = 1; i < arguments.length; i++) e.push(arguments[i]);
        var s = "error" === t,
            n = this._events;
        if (void 0 !== n) s = s && void 0 === n.error;
        else if (!s) return !1;
        if (s) {
            var o;
            if (e.length > 0 && (o = e[0]), o instanceof Error) throw o;
            var r = new Error("Unhandled error." + (o ? " (" + o.message + ")" : ""));
            throw r.context = o, r
        }
        var a = n[t];
        if (void 0 === a) return !1;
        if ("function" == typeof a) p(a, this, e);
        else {
            var h = a.length,
                l = c(a, h);
            for (i = 0; i < h; ++i) p(l[i], this, e)
        }
        return !0
    }, s.prototype.addListener = function(t, e) {
        return r(this, t, e, !1)
    }, s.prototype.on = s.prototype.addListener, s.prototype.prependListener = function(t, e) {
        return r(this, t, e, !0)
    }, s.prototype.once = function(t, e) {
        return n(e), this.on(t, a(this, t, e)), this
    }, s.prototype.prependOnceListener = function(t, e) {
        return n(e), this.prependListener(t, a(this, t, e)), this
    }, s.prototype.removeListener = function(t, e) {
        var i, s, o, r, a;
        if (n(e), void 0 === (s = this._events)) return this;
        if (void 0 === (i = s[t])) return this;
        if (i === e || i.listener === e) 0 == --this._eventsCount ? this._events = Object.create(null) : (delete s[t], s.removeListener && this.emit("removeListener", t, i.listener || e));
        else if ("function" != typeof i) {
            for (o = -1, r = i.length - 1; r >= 0; r--)
                if (i[r] === e || i[r].listener === e) {
                    a = i[r].listener, o = r;
                    break
                } if (o < 0) return this;
            0 === o ? i.shift() : function(t, e) {
                for (; e + 1 < t.length; e++) t[e] = t[e + 1];
                t.pop()
            }(i, o), 1 === i.length && (s[t] = i[0]), void 0 !== s.removeListener && this.emit("removeListener", t, a || e)
        }
        return this
    }, s.prototype.off = s.prototype.removeListener, s.prototype.removeAllListeners = function(t) {
        var e, i, s;
        if (void 0 === (i = this._events)) return this;
        if (void 0 === i.removeListener) return 0 === arguments.length ? (this._events = Object.create(null), this._eventsCount = 0) : void 0 !== i[t] && (0 == --this._eventsCount ? this._events = Object.create(null) : delete i[t]), this;
        if (0 === arguments.length) {
            var n, o = Object.keys(i);
            for (s = 0; s < o.length; ++s) "removeListener" !== (n = o[s]) && this.removeAllListeners(n);
            return this.removeAllListeners("removeListener"), this._events = Object.create(null), this._eventsCount = 0, this
        }
        if ("function" == typeof(e = i[t])) this.removeListener(t, e);
        else if (void 0 !== e)
            for (s = e.length - 1; s >= 0; s--) this.removeListener(t, e[s]);
        return this
    }, s.prototype.listeners = function(t) {
        return h(this, t, !0)
    }, s.prototype.rawListeners = function(t) {
        return h(this, t, !1)
    }, s.listenerCount = function(t, e) {
        return "function" == typeof t.listenerCount ? t.listenerCount(e) : l.call(t, e)
    }, s.prototype.listenerCount = l, s.prototype.eventNames = function() {
        return this._eventsCount > 0 ? u(this._events) : []
    }
}, function(t, e, i) {
    "use strict";
    Object.defineProperty(e, "__esModule", {
            value: !0
        }),
        function(t) {
            t.getUrlParameterByName = function(t) {
                var e = window.location.href,
                    i = t.replace(/[\[\]]/g, "\\$&"),
                    s = new RegExp("[?&]" + i + "(=([^&#]*)|&|#|$)").exec(e);
                return s ? s[2] ? decodeURIComponent(s[2].replace(/\+/g, " ")) : "" : null
            }, t.getGameToken = function(t) {
                return btoa(JSON.stringify(t)).replace(/=/g, "")
            }, t.getGameOpts = function(e) {
                var i = t.getUrlParameterByName(e);
                if (i) try {
                    var s = JSON.parse(atob(i));
                    if (s.hasOwnProperty("ssl") && s.hasOwnProperty("ip") && s.hasOwnProperty("port")) return s
                } catch (t) {
                    return null
                }
                return null
            }
        }(e.UrlParse || (e.UrlParse = {}))
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(2).Protocol.EntityTypeToBuildingType,
        r = i(11),
        a = function() {
            return function(t, e, i) {
                this.id = t, this.objectType = e, this.position = i
            }
        }(),
        h = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                return i.childs = [], i.typeCounts = {}, i
            }
            return s(e, t), e.prototype.onCreateChild = function(t) {
                var e = t.content.objectType;
                this.childs.push(new a(t.content.id, e, new Phaser.Point(t.content.x, t.content.y))), this.typeCounts.hasOwnProperty(e) ? this.typeCounts[e]++ : this.typeCounts[e] = 1, this.world.services.getService(r.CraftMenuService).updateLimit(o(e), this.typeCounts[e])
            }, e.prototype.onRemoveChild = function(t) {
                for (var e = t.content.id, i = t.content.objectType, s = 0; s < this.childs.length; s++)
                    if (this.childs[s].id === e) {
                        this.typeCounts[i]--, this.childs.splice(s, 1);
                        break
                    } this.world.services.getService(r.CraftMenuService).updateLimit(o(i), this.typeCounts[i])
            }, e.prototype.getCountsForType = function(t) {
                return this.typeCounts.hasOwnProperty(t.toString()) ? this.typeCounts[t] : 0
            }, e.prototype.cleanup = function() {
                this.childs = [], this.typeCounts = {}, this.world.services.getService(r.CraftMenuService).updateAllLimit()
            }, e
        }(n.Service);
    e.default = h
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(17),
        r = i(2),
        a = r.Protocol.BuildingType,
        h = i(10),
        l = r.Protocol.BuildingTypeToEntityType,
        c = function() {
            function t(t, e) {
                this.name = t, this.element = document.createElement("div"), this.element.className = "item", this.element.onclick = this.onClick.bind(this), this.element.id = t, e && (Phaser.GAMES[0].input.keyboard.removeKey(Phaser.Keyboard[e]), this.key = Phaser.GAMES[0].input.keyboard.addKey(Phaser.Keyboard[e]), this.key.onDown.add(this.onClick, this))
            }
            return t.prototype.action = function() {}, t.prototype.onClick = function() {
                this.action()
            }, t.prototype.destroy = function() {
                this.key && (this.key.onDown.remove(this.onClick, this), this.key = null), this.element = null
            }, t.prototype.updateAvailability = function(t) {
                this.element && (this.element.classList.remove("available"), this.element.classList.remove("unavailable"), this.element.classList.add(t ? "available" : "unavailable"))
            }, t
        }();
    e.MenuItem = c;
    var u = function() {
        function t() {
            this.items = []
        }
        return t.prototype.appendChild = function(t) {
            this.element.appendChild(t.element), this.items.push(t)
        }, t.prototype.destroy = function() {
            for (var t = 0, e = this.items; t < e.length; t++) e[t].destroy();
            this.items = []
        }, t
    }();
    e.MenuContainer = u;
    var d = function(t) {
            function e(e) {
                var i = t.call(this) || this;
                return i.element = document.getElementById("bottom-panel"), i.element.innerHTML = "", i
            }
            return s(e, t), e.prototype.appendMany = function(t, e, i) {
                for (var s = [], n = 0, o = i; n < o.length; n++) {
                    var r = o[n];
                    r.tooltip = t.getTooltipFor(r.name), r.maxLimit = t.getMaxLimit(r.name);
                    var a = y.getUrlFromItem(r),
                        h = new m(e, a, r.name, r.hotKey, r.hotKeyDisplay, r.tooltip, r.maxLimit);
                    this.appendChild(h), s.push(h)
                }
                return s
            }, e
        }(u),
        p = function(t) {
            function e(e, i) {
                var s = t.call(this) || this;
                return s.world = i, s.element = document.getElementById("left-panel"), s.element.innerHTML = "", s
            }
            return s(e, t), e.prototype.appendMany = function(t, e, i) {
                for (var s = [], n = 0, o = i; n < o.length; n++) {
                    var r = o[n];
                    r.tooltip = t.getTooltipFor(r.name), r.maxLimit = t.getMaxLimit(r.name);
                    var a = y.getUrlFromItem(r),
                        h = new f(e, a, r.name, r.hotKey, r.hotKeyDisplay, r.tooltip, r.maxLimit);
                    this.appendChild(h), s.push(h)
                }
                return s
            }, e.prototype.pushRecently = function(t) {
                for (var e = this.world.services.getService(h.default), i = 0; i < this.items.length; i++)
                    if (this.items[i].name === t.name) return;
                for (i = 0; i < this.items.length; i++) {
                    var s = void 0;
                    s = i === this.items.length - 1 ? t : this.items[i + 1], this.items[i].reInit(s.getImage(), s.name, this.items[i].getHotKey(), Phaser.GAMES[0].state.getCurrentState().services.getService(v).getTooltipFor(s.name), Phaser.GAMES[0].state.getCurrentState().services.getService(v).getMaxLimit(s.name)), this.items[i].updateLimit(e.getCountsForType(l(s.name)))
                }
            }, e
        }(u),
        f = function(t) {
            function e(e, i, s, n, o, r, a) {
                var h = t.call(this, s, n) || this;
                return h.img = i, h.hotKey = n, h.world = e, h.maxLimit = a, h.element.className = "gui-tooltip item", h.element.innerHTML = '\n            <div class="gui-tooltip-content gui-tooltip-right">\n                ' + r + '\n            </div>\n            <img src="' + i + '" />\n            <div class="hotkey" id="' + s + ':hotkey">' + o + "</div>\n        ", h.limit = document.createElement("div"), h.limit.className = "limit", h.limit.innerHTML = "0/" + a, h.element.appendChild(h.limit), h
            }
            return s(e, t), e.prototype.getImage = function() {
                return this.img
            }, e.prototype.getHotKey = function() {
                return this.hotKey
            }, e.prototype.reInit = function(t, e, i, s, n) {
                this.name = e, this.img = t, this.maxLimit = n, this.element.className = "gui-tooltip item", this.element.innerHTML = '\n            <div class="gui-tooltip-content gui-tooltip-right">\n                ' + s + '\n            </div>\n            <img src="' + t + '" />\n            <div class="hotkey" id="' + e + ':hotkey">' + i + "</div>\n        ", this.limit = document.createElement("div"), this.limit.className = "limit", this.limit.innerHTML = "0/" + n, this.element.appendChild(this.limit)
            }, e.prototype.updateLimit = function(t) {
                this.limit.innerText = t + "/" + this.maxLimit
            }, e.prototype.onClick = function() {
                t.prototype.onClick.call(this)
            }, e.prototype.action = function() {
                this.world.services.getService(o.default).requestWork(this.name)
            }, e
        }(c),
        m = function(t) {
            function e(e, i, s, n, o, r, a) {
                var h = t.call(this, s, n) || this;
                return h.world = e, h.maxLimit = a, h.element.className = "gui-tooltip item", h.element.innerHTML = '\n            <div class="gui-tooltip-content gui-tooltip-up">\n                ' + r + '\n            </div>\n            <img src="' + i + '" />\n            <div class="hotkey" id="' + s + ':hotkey">' + o + "</div>\n        ", h.limit = document.createElement("div"), h.limit.className = "limit", h.limit.innerHTML = "0/" + a, h.element.appendChild(h.limit), h
            }
            return s(e, t), e.prototype.updateLimit = function(t) {
                this.limit.innerText = t + "/" + this.maxLimit
            }, e.prototype.onClick = function() {
                t.prototype.onClick.call(this)
            }, e.prototype.action = function() {
                this.world.services.getService(o.default).requestWork(this.name)
            }, e
        }(c),
        g = function(t) {
            function e(e, i, s, n, o, r, a, h, l) {
                var c = t.call(this, s, n) || this;
                return c.img = i, c.world = e, c.maxLimit = r, c.element.className = "shop-item", c.element.innerHTML = '\n            <div class="price">' + l + '</div>\n            <div class="icon">\n            <img width="48px" height="48px" src="' + i + '"/>\n            </div>\n            <div class="content">\n            <div class="content-name">' + a + ' <span id="n' + s + '_building_price">0/' + r + '</span></div>\n            <div class="content-description">' + h + "</div>\n            </div>\n        ", c
            }
            return s(e, t), e.prototype.getImage = function() {
                return this.img
            }, e.prototype.updateLimit = function(t) {
                this.limit || (this.limit = document.getElementById("n" + this.name + "_building_price")), this.limit.innerText = t + "/" + this.maxLimit
            }, e.prototype.onClick = function() {
                t.prototype.onClick.call(this)
            }, e.prototype.action = function() {
                this.world.services.getService(o.default).requestWork(this.name), this.world.services.getService(v).recentlyUsed(this)
            }, e
        }(c),
        y = function(t) {
            function e(e) {
                var i = t.call(this) || this;
                return i.parentElement = document.getElementById("shop"), i.element = document.getElementById("shop-list"), i.element.innerHTML = "", i.key = Phaser.GAMES[0].input.keyboard.addKey(Phaser.KeyCode.ESC), i.key.onDown.add(i.hide, i), document.addEventListener("click", function(t) {
                    "block" === this.parentElement.style.display && (t.target === this.element || "shop-show" === t.target.id || t.target.parentElement && "shop-show" === t.target.parentElement.id || this.hide())
                }.bind(i)), i.hide(), i
            }
            return s(e, t), e.getUrlFromItem = function(t) {
                var e = Phaser.GAMES[0].load.cache;
                return t.img && e.checkImageKey(t.img) ? e.getImage(t.img).src : e.checkImageKey("entity_icon_" + a[t.name]) ? e.getImage("entity_icon_" + a[t.name]).src : e.getImage("entity_" + a[t.name]).src
            }, e.prototype.appendMany = function(t, i) {
                for (var s = [], n = 0, o = i; n < o.length; n++) {
                    var r = o[n];
                    try {
                        var h = Config.buildings[a[r.name].toLowerCase()].name;
                        if (!h || h.toString().length < 1) continue
                    } catch (t) {
                        continue
                    }
                    r.tooltip = t.getTooltipFor(r.name), r.maxLimit = t.getMaxLimit(r.name);
                    var l = e.getUrlFromItem(r),
                        c = new g(t.world, l, r.name, r.hotKey, r.hotKeyDisplay, t.getMaxLimit(r.name), t.getDisplayNameFor(r.name), t.getDisplayDescription(r.name), t.getDisplayPriceFor(r.name));
                    this.appendChild(c), s.push(c)
                }
                return $("shop-list").scrollTop(0), s
            }, e.prototype.toggle = function() {
                "block" === this.parentElement.style.display ? this.hide() : this.show()
            }, e.prototype.show = function() {
                this.parentElement.style.display = "block"
            }, e.prototype.hide = function() {
                this.parentElement.style.display = "none"
            }, e.prototype.destroy = function() {
                t.prototype.destroy.call(this), this.key.onDown.remove(this.hide, this), this.key = null
            }, e
        }(u),
        v = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                return i.menuItems = [], i
            }
            return s(e, t), e.prototype.getTooltipFor = function(t) {
                for (var e = "", i = Config.buildings[a[t].toLowerCase()], s = 0, n = Object.keys(i.price); s < n.length; s++) {
                    var o = n[s];
                    e += '<div class="gui-tooltip-costs"><span>' + (o.charAt(0).toUpperCase() + o.slice(1)) + ": </span><span>" + i.price[o] + "</span></div>"
                }
                return '\n            <div class="gui-tooltip-header">' + i.name + "</div>\n            <span>" + i.description + "</span>\n            " + e + "\n        "
            }, e.prototype.getDisplayPriceFor = function(t) {
                for (var e = "", i = Config.buildings[a[t].toLowerCase()], s = 0, n = Object.keys(i.price); s < n.length; s++) {
                    var o = n[s];
                    e += "<div>" + (o.charAt(0).toUpperCase() + o.slice(1)) + ": " + i.price[o] + "</div>"
                }
                return e
            }, e.prototype.getMaxLimit = function(t) {
                try {
                    return Config.buildings[a[t].toLowerCase()].limit
                } catch (t) {
                    return 0
                }
            }, e.prototype.getDisplayNameFor = function(t) {
                return Config.buildings[a[t].toLowerCase()].name
            }, e.prototype.getDisplayDescription = function(t) {
                return Config.buildings[a[t].toLowerCase()].description
            }, e.prototype.recentlyUsed = function(t) {
                this.shopMenu.hide(), this.recentlyMenu.pushRecently(t)
            }, e.prototype.initializeFromConfig = function() {
                this.bottomMenu = new d("bottom-panel"), this.menuItems = this.bottomMenu.appendMany(this, this.world, [{
                    name: a.WoodBlock,
                    hotKey: "ONE",
                    hotKeyDisplay: "1"
                }, {
                    name: a.StoneBlock,
                    hotKey: "TWO",
                    hotKeyDisplay: "2"
                }, {
                    name: a.Door,
                    hotKey: "THREE",
                    hotKeyDisplay: "3"
                }, {
                    name: a.FarmerBot,
                    hotKey: "FOUR",
                    hotKeyDisplay: "4"
                }, {
                    name: a.Garden,
                    hotKey: "FIVE",
                    hotKeyDisplay: "5"
                }, {
                    name: a.GuardBot,
                    hotKey: "SIX",
                    hotKeyDisplay: "6"
                }, {
                    name: a.FollowerBot,
                    hotKey: "SEVEN",
                    hotKeyDisplay: "7"
                }, {
                    name: a.Heartstone,
                    hotKey: "EIGHT",
                    hotKeyDisplay: "8"
                }, {
                    name: a.Tower,
                    hotKey: "NINE",
                    hotKeyDisplay: "9"
                }]), this.recentlyMenu = new p("left-panel", this.world);
                var t = this.recentlyMenu.appendMany(this, this.world, [{
                    name: a.FoodCrate,
                    hotKey: "Z",
                    hotKeyDisplay: "Z"
                }, {
                    name: a.WoodCrate,
                    hotKey: "X",
                    hotKeyDisplay: "X"
                }, {
                    name: a.StoneCrate,
                    hotKey: "C",
                    hotKeyDisplay: "C"
                }]);
                this.shopMenu = new y("shop");
                var e = this.shopMenu.appendMany(this, [{
                    
                }, {
                    
                }, {
                    
                }, {
                    
                }, {
                    
                }, {
                    name: a.SoulCrate
                }, {
                    name: a.WoodSpikes
                }, {
                    name: a.IronSpikes
                }, {
                    name: a.Portal
                }, {
                    name: a.RideableWolf
                }, {
                    name: a.GardenBot
                }, {
                    name: a.Mannequin
                }, {
                    name: a.RideableDragon
                }, {
                    name: a.RideableBear
                }, {
                    name: a.DarkGuardBot
                }, {
                    name: a.DarkStoneBlock
                }, {
                    name: a.DarkDoor
                }, {
                    name: a.CrystalWall
                }, {
                    name: a.CrystalDoor
                }, {
                    name: a.SoccerBall
                }, {
                    name: a.HealWard
                }]);
                this.menuItems = this.menuItems.concat(t), this.menuItems = this.menuItems.concat(e), this.updateAvailability(), this.updateAllLimit()
            }, e.prototype.updateAvailability = function() {
                for (var t = this.world.services.getService(o.default), e = 0, i = this.menuItems; e < i.length; e++) {
                    var s = i[e];
                    s.updateAvailability(t.canBuild(s.name))
                }
            }, e.prototype.updateLimit = function(t, e) {
                for (var i = this.world.services.getService(o.default), s = 0, n = this.menuItems; s < n.length; s++) {
                    var r = n[s];
                    r.name === t && (r.updateLimit(e), r.updateAvailability(i.canBuild(r.name)))
                }
            }, e.prototype.updateAllLimit = function() {
                for (var t = this.world.services.getService(h.default), e = 0, i = this.menuItems; e < i.length; e++) {
                    var s = i[e];
                    s.updateLimit(t.getCountsForType(l(s.name)))
                }
            }, e.prototype.cleanup = function() {
                this.updateAvailability()
            }, e
        }(n.Service);
    e.CraftMenuService = v
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(5),
        r = i(4),
        a = i(7),
        h = i(23),
        l = function(t) {
            function e(e, i, s, n, l) {
                void 0 === n && (n = null);
                var c = t.call(this, e, i, s) || this;
                n || (n = e.LAYER_FOREGROUND_0);
                var u = new Phaser.Point(.5, .5);
                return c.addComponent(new o.default), c.addComponent(new r.default), c.addComponent(new a.default(n, l, u)), c.addComponent(new h.default), c
            }
            return s(e, t), e
        }(n.Entity);
    e.BasicEntity = l
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = function() {
            function t(t, e, i, s) {
                this.width = 120, this.height = 10, this.borderwidth = 1, this.borderheight = 1, this.bgcolor = "#ffffff", this.fgcolor = "#aa0000", this.offset = 10, this.alpha = .5, this.game = t, this.group = e;
                var n = this.game.add.bitmapData(this.width, this.height);
                n.ctx.beginPath(), n.ctx.rect(0, 0, this.width, this.height), n.ctx.fillStyle = this.bgcolor, n.ctx.fill(), this.bitmap1 = n, this.total = e.create(i, s, n), this.total.alpha = this.alpha, this.total.anchor.set(.5, .5), (n = this.game.add.bitmapData(this.width - 2 * this.borderwidth, this.height - 2 * this.borderheight)).ctx.beginPath(), n.ctx.rect(0, 0, this.width - 2 * this.borderwidth, this.height - 2 * this.borderheight), n.ctx.fillStyle = this.fgcolor, n.ctx.fill(), this.bitmap2 = n, this.current = e.create(i, s, n), this.current.alpha = this.alpha, this.current.anchor.set(0, .5), this.croprect = new Phaser.Rectangle(0, 0, n.width, n.height), this.totalcrop = n.width, this.current.cropRect = this.croprect
            }
            return t.prototype.setposition = function(t, e) {
                this.current.position.x = t - this.totalcrop / 2, this.current.position.y = e + this.height / 2 + this.offset, this.total.position.x = t, this.total.position.y = e + this.height / 2 + this.offset
            }, t.prototype.fill = function(t) {
                this.croprect.width = t * this.totalcrop, this.current.updateCrop()
            }, t.prototype.destroy = function() {
                this.current.destroy(), this.total.destroy(), this.bitmap1.destroy(), this.bitmap2.destroy()
            }, t
        }();
    e.Healthbar = o;
    var r = function(t) {
        function e(e) {
            void 0 === e && (e = 0);
            var i = t.call(this) || this;
            return i.health = 1, i.maxHealth = 1, i.offset = e, i
        }
        return s(e, t), e.prototype.start = function() {
            this.cachedTransform = this.entity.components.transform, this.cachedSprite = this.entity.components.sprite, this.bar = new o(this.world.game, this.world.LAYER_UI, this.cachedTransform.position.x, this.cachedTransform.position.y), this.bar.fill(1), this.entity.on("networksync", this.onNetworkSync.bind(this)), this.entity.on("alpha", function(t) {
                t.alpha < 1 ? (this.bar.total.alpha = 0, this.bar.current.alpha = 0) : (this.bar.total.alpha = this.bar.alpha, this.bar.current.alpha = this.bar.alpha)
            }.bind(this))
        }, e.prototype.onNetworkSync = function(t) {
            t.hasOwnProperty("health") && (this.health = t.health), t.hasOwnProperty("maxHealth") && (this.maxHealth = t.maxHealth), this.bar.fill(this.health / this.maxHealth)
        }, e.prototype.update = function(t) {
            var e = this.cachedTransform.position.x,
                i = this.cachedTransform.position.y - this.offset + this.cachedSprite.sprite.height / 2;
            this.bar.setposition(e, i)
        }, e.prototype.destroy = function() {
            this.bar.destroy()
        }, e
    }(n.Component);
    e.default = r
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            return t.call(this) || this
        }
        return s(e, t), e.prototype.start = function() {
            this.cachedSpriteComponent = this.entity.components.sprite, this.entity.on("receivedamage", this.onReceiveDamage.bind(this))
        }, e.prototype.onReceiveDamage = function(t) {
            this.cachedSpriteComponent.flashRed()
        }, e
    }(i(0).Component);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(5),
        r = i(4),
        a = i(107),
        h = i(7),
        l = i(108),
        c = i(24),
        u = i(3),
        d = i(13),
        p = i(22),
        f = i(100),
        m = i(26),
        g = i(14),
        y = i(27),
        v = i(106),
        b = i(109),
        _ = i(105),
        w = function(t) {
            function e(e, i, s) {
                var n = t.call(this, e, i, s) || this;
                n.addComponent(new o.default), n.addComponent(new r.default(!0, !0));
                var w = new h.default(e.LAYER_MIDDLE_1, u.Atlases.AtlasesFeet.getName(), new Phaser.Point(.5, .5));
                n.addComponent(w);
                var x = w.addSpriteParent("hit", e.LAYER_MIDDLE_1, u.Atlases.AtlasesHit.getName(), new Phaser.Point(.5, .8));
                x.alpha = 0;
                var P = x.animations.add("hit", Phaser.Animation.generateFrameNames("hit", 1, 6, ".png", 0), 30, !1);
                return P.onStart.add(function() {
                    x.alpha = 1
                }), P.onComplete.add(function() {
                    x.alpha = 0
                }), w.addSpriteParent("hands", e.LAYER_MIDDLE_1, u.Images.ImagesHands.getName(), new Phaser.Point(.5, .6)), w.addSpriteParent("weapon", e.LAYER_MIDDLE_1, u.Images.ImagesSword.getName(), new Phaser.Point(0, .95)), w.addSpriteParent("body", e.LAYER_MIDDLE_1, u.Images.ImagesBody.getName(), new Phaser.Point(.5, .6)), w.addSpriteParent("head", e.LAYER_MIDDLE_1, u.Images.ImagesHead.getName(), new Phaser.Point(.5, .6)), n.addComponent(new l.default), n.addComponent(new c.default), n.addComponent(new d.default(50)), n.addComponent(new p.default(50)), n.addComponent(new m.default(50)), n.addComponent(new b.default(25)), n.addComponent(new g.default), n.isLocalPlayer() && (n.components.networktransform.interpolateRotation = !1, n.addComponent(new v.default), n.addComponent(new a.default), n.addComponent(new f.default(50))), n.addComponent(new _.default(e.LAYER_FOREGROUND_0)), n.addComponent(new y.default), n
            }
            return s(e, t), e
        }(n.Entity);
    e.default = w
}, function(t, e, i) {
    "use strict";
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var s = i(9),
        n = function() {
            function t() {}
            return t.getGameToken = function() {
                return s.UrlParse.getGameToken(t.gameOpts)
            }, t.init = function(e) {
                s.UrlParse.getGameOpts("game") ? e() : t.getNearestServer().then(function(i) {
                    var s = !1,
                        n = i.port;
                    i.ssl_port && "https:" === location.protocol && (s = !0, n = i.ssl_port), t.gameOpts = {
                        ip: i.host,
                        port: n,
                        ssl: s,
                        id: i.id
                    }, e()
                }).catch(function() {
                    console.log("Unable to get server"), e()
                })
            }, t.getHostAddress = function() {
                var e = s.UrlParse.getGameOpts("game");
                e || (e = t.gameOpts);
                try {
                    window.dataLayer = window.dataLayer || [], window.dataLayer.push({
                        server: e.ip + ":" + e.port
                    })
                } catch (t) {}
                return e.ssl ? "wss://" + e.ip + ":" + e.port : "ws://" + e.ip + ":" + e.port
            }, t.getNearestServer = function() {
                return new Promise(function(e, i) {
                    $.ajax("https://status.glar.io").done(function(s) {
                        for (var n = {}, o = 0, r = s; o < r.length; o++) {
                            var a = r[o];
                            if (a.status && !a.test) {
                                if (u = (u = a.name.split("-")[0]).charAt(0).toUpperCase() + u.slice(1), n.hasOwnProperty(u) || (n[u] = []), "https:" === location.protocol && !a.ssl_port) continue;
                                n[u].push({
                                    host: a.host,
                                    port: a.port,
                                    ssl_port: a.ssl_port,
                                    id: a.id
                                })
                            }
                        }
                        "dev.glar.io" != document.location.hostname && "localhost.glar.io" != document.location.hostname || ("localhost.glar.io" == document.location.hostname && (n.localdev = [{
                            host: "127.0.0.1",
                            port: 7002,
                            ssl_port: 8002,
                            id: 9999
                        }]), n.testserver = [{
                            host: "phoenix.glar.io",
                            port: 7003,
                            ssl_port: 8003,
                            id: 9998
                        }]);
                        for (var h = [], l = 0, c = Object.keys(n); l < c.length; l++) {
                            var u = c[l];
                            if (n[u].length > 0) {
                                var d = t.ping("https://" + n[u][0].host + "/derp", u, .3);
                                n[u].ssl_port, h.push(d)
                            }
                        }
                        t.successRace(h).then(function(t) {
                            console.log("Nearest server in " + t.city + " with ping " + t.delta + "ms");
                            var i = n[t.city],
                                s = i[Math.floor(Math.random() * i.length)];
                            e(s)
                        }).catch(function(t) {
                            i("All promises unresolved")
                        })
                    }).fail(function() {
                        i("Can't connect to status.glar.io")
                    })
                })
            }, t.successRace = function(t) {
                return Promise.all(t.map(function(t) {
                    return t.then(function(t) {
                        return Promise.reject(t)
                    }, function(t) {
                        return Promise.resolve(t)
                    })
                })).then(function(t) {
                    return Promise.reject(t)
                }, function(t) {
                    return Promise.resolve(t)
                })
            }, t.request_image = function(t) {
                return new Promise(function(e, i) {
                    var s = new Image;
                    s.onload = function() {
                        e(s)
                    }, s.onerror = function() {
                        i(t)
                    }, s.src = t + "?random-no-cache=" + Math.floor(65536 * (1 + Math.random())).toString(16)
                })
            }, t.ping = function(e, i, s) {
                return new Promise(function(n, o) {
                    var r = (new Date).getTime(),
                        a = function() {
                            var t = (new Date).getTime() - r;
                            t *= s || 1, console.log(i + " ping " + t), n({
                                city: i,
                                delta: t
                            })
                        };
                    t.request_image(e).then(a).catch(a), setTimeout(function() {
                        o(Error("Timeout"))
                    }, 3e3)
                })
            }, t
        }();
    n.gameOpts = {
        ip: "127.0.0.1",
        port: "5000",
        ssl: !1
    }, e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(36),
        r = i(10),
        a = i(2),
        h = a.Protocol.BuildingType,
        l = a.Protocol.BuildingTypeToEntityType,
        c = i(33),
        u = a.Protocol.MessageType;
    e.BuildingDefinitions = {
        WoodFloor: {
            scale: 1
        },
        StoneFloor: {
            scale: 1
        },
        WoodBlock: {
            scale: 1
        },
        StoneBlock: {
            scale: 1
        },
        DarkStoneBlock: {
            scale: 1
        },
        Garden: {
            scale: 1
        },
        Tower: {
            scale: 1
        },
        Heartstone: {
            scale: 1
        },
        HealWard: {
            scale: 1
        },
        GuardBot: {
            scale: .7
        },
        DarkGuardBot: {
            scale: .7
        },
        FollowerBot: {
            scale: .7
        },
        FarmerBot: {
            scale: .7
        },
        GardenBot: {
            scale: .7
        },
        Door: {
            scale: 1
        },
        DarkDoor: {
            scale: 1
        },
        FoodCrate: {
            scale: 1
        },
        WoodCrate: {
            scale: 1
        },
        StoneCrate: {
            scale: 1
        },
        SoulCrate: {
            scale: 1
        },
        RideableWolf: {
            scale: 1
        },
        RideableBear: {
            scale: 1
        },
        RideableDragon: {
            scale: 1
        },
        Mannequin: {
            scale: 1
        },
        SoccerBall: {
            scale: 1
        },
        WoodSpikes: {
            scale: 1
        },
        IronSpikes: {
            scale: 1
        },
        CrystalDoor: {
            scale: 1
        },
        CrystalWall: {
            scale: 1
        },
        Portal: {
            scale: 1
        }
    };
    var d = function(t) {
        function i(e) {
            var i = t.call(this, e) || this;
            return i.currentBuildingId = null, i.currentBuildingSprite = null, i.currentBuildingPosition = new Phaser.Point(0, 0), i.world.game.input.onDown.add(i.onMouseDown, i), i.escapeKey = i.world.game.input.keyboard.addKey(Phaser.Keyboard.ESC), i
        }
        return s(i, t), i.prototype.inProgress = function() {
            return null != this.currentBuildingSprite
        }, i.prototype.onMouseDown = function(t) {
            if (this.inProgress()) {
                var e = this.world.game.input.activePointer.leftButton.isDown,
                    i = this.world.game.input.activePointer.rightButton.isDown;
                e ? this.completeBuild() : i && this.cancelBuild()
            }
        }, i.prototype.requestWork = function(t) {
            this.inProgress() ? this.cancelBuild() : this.canBuild(t) && this.startBuild(t)
        }, i.prototype.startBuild = function(t) {
            this.currentBuildingId = t;
            var i, s = "";
            e.BuildingDefinitions[h[t]] && (s = e.BuildingDefinitions[h[t]].spriteName), "" != s && null != s || (s = "entity_" + h[t]), this.currentBuildingSprite = this.world.LAYER_FOREGROUND_0.create(this.world.game.input.activePointer.worldX, this.world.game.input.activePointer.worldY, s), i = e.BuildingDefinitions[h[t]].scale ? e.BuildingDefinitions[h[t]].scale : 1, this.currentBuildingSprite.scale.set(i, i), this.currentBuildingSprite.tint = 16751001, this.currentBuildingSprite.anchor.set(.5, .5)
        }, i.prototype.canBuild = function(t) {
            var e = h[t].toLowerCase(),
                i = Config.buildings[e].price,
                s = Config.buildings[e].limit,
                n = this.world.services.getService(o.default),
                a = this.world.services.getService(r.default);
            return n.hasResources(i) && a.getCountsForType(l(t)) < s
        }, i.prototype.update = function(t) {
            if (this.inProgress()) {
                var e = this.world.assignedObject.components.transform.position;
                this.currentBuildingPosition.x = this.world.game.input.activePointer.worldX, this.currentBuildingPosition.y = this.world.game.input.activePointer.worldY, this.currentBuildingPosition.x = this.currentBuildingPosition.x - e.x, this.currentBuildingPosition.y = this.currentBuildingPosition.y - e.y;
                var i = this.currentBuildingPosition.getMagnitude();
                i > Config.client.build_radius && (i = Config.client.build_radius), this.currentBuildingPosition.normalize(), this.currentBuildingPosition.multiply(i, i), this.currentBuildingPosition.add(e.x, e.y);
                var s = this.world.services.getService(c.default).tileWidth,
                    n = this.world.services.getService(c.default).tileHeight,
                    o = s / 2,
                    r = n / 2;
                Config.buildings[h[this.currentBuildingId].toLowerCase()].radius || Config.buildings[h[this.currentBuildingId].toLowerCase()].subtile ? (this.currentBuildingPosition.x = Math.floor(this.currentBuildingPosition.x / o) * o, this.currentBuildingPosition.y = Math.floor(this.currentBuildingPosition.y / r) * r) : (this.currentBuildingPosition.x = Math.floor(this.currentBuildingPosition.x / s) * s + o, this.currentBuildingPosition.y = Math.floor(this.currentBuildingPosition.y / n) * n + r), this.currentBuildingSprite.position.copyFrom(this.currentBuildingPosition), this.escapeKey.isDown && this.cancelBuild()
            }
        }, i.prototype.completeBuild = function() {
            this.world.socket.sendMessage(u.PlayerBuildRequest, {
                buildingType: this.currentBuildingId,
                x: this.currentBuildingPosition.x,
                y: this.currentBuildingPosition.y
            }), this.world.assignedObject && this.world.assignedObject.components.networkinput && this.world.assignedObject.components.networkinput.lockPunchUntilMouseUp()
        }, i.prototype.cancelBuild = function() {
            this.currentBuildingSprite && (this.currentBuildingSprite.destroy(), this.currentBuildingSprite = null)
        }, i.prototype.onBuildResponse = function(t) {
            t.success && this.cancelBuild()
        }, i.prototype.destroy = function() {
            this.cancelBuild(), this.world.game.input.onDown.remove(this.onMouseDown, this)
        }, i
    }(n.Service);
    e.default = d
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(2),
        r = o.Protocol.MessageType,
        a = i(8),
        h = o.Protocol.HatType,
        l = i(3),
        c = i(19),
        u = function(t) {
            function e(i, s) {
                var n = t.call(this) || this;
                return n.hatType = i, n.element = document.createElement("div"), n.element.className = s ? "ui-hat-list-item is-active" : "ui-hat-list-item is-aviable", n.element.innerHTML = '\n            <div class="ui-hat-image">\n                <img src="' + e.getHatSprite(i) + '" />\n            </div>\n        ', s || (n.element.onclick = function() {
                    this.emit("wear")
                }.bind(n)), n
            }
            return s(e, t), e.getHatSprite = function(t) {
                var e = "entity_" + h[t];
                return Phaser.GAMES[0].load.cache.checkImageKey(e) ? Phaser.GAMES[0].load.cache.getImage(e).src : l.Images.ImagesKnight.getPNG()
            }, e
        }(a.EventEmitter),
        d = function() {
            function t(t, e) {
                this.listContainer = e, this.world = t
            }
            return t.prototype.cleanup = function() {
                this.elements = [], this.listContainer.innerHTML = ""
            }, t.prototype.updateHats = function(t, e) {
                this.cleanup();
                for (var i = function(i) {
                        var n = t[i],
                            o = new u(n, n === e);
                        o.on("wear", function() {
                            this.world.socket.sendMessage(r.PlayerSelectHat, {
                                hatType: n
                            }), this.world.services.getService(p).toggle()
                        }.bind(s)), s.listContainer.appendChild(o.element)
                    }, s = this, n = 0; n < t.length; n++) i(n);
                var o = new u(-1, -1 === e);
                o.on("wear", function() {
                    this.world.socket.sendMessage(r.PlayerSelectHat, {
                        hatType: -1
                    }), this.world.services.getService(p).toggle()
                }.bind(this)), this.listContainer.appendChild(o.element)
            }, t
        }(),
        p = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                return i.isEnabled = !1, i.world.socket.onMessage(r.SyncHats, i.onSyncHats.bind(i)), i.container = document.getElementById("ui-hat-list-container"), document.getElementById("ui-hat-list-close").onclick = function() {
                    this.toggle()
                }.bind(i), document.getElementById("ui-hat-close-button").onclick = function() {
                    this.toggle()
                }.bind(i), i.hatList = new d(e, document.getElementById("ui-hat-list-content")), i
            }
            return s(e, t), e.prototype.onSyncHats = function(t) {
                var e = t.content.hatTypes,
                    i = t.content.currentHat;
                this.hatList.updateHats(e, i)
            }, e.prototype.hide = function() {
                this.isEnabled && this.toggle()
            }, e.prototype.toggle = function() {
                this.isEnabled = !this.isEnabled, this.isEnabled && this.world.services.getService(c.default).hide(), this.container.style.display = this.isEnabled ? "block" : "none"
            }, e.prototype.destroy = function() {
                this.isEnabled && this.toggle()
            }, e
        }(n.Service);
    e.default = p
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(2).Protocol.MessageType,
        r = i(8),
        a = i(18),
        h = function() {
            return function(t, e) {
                this.teamId = t, this.teamName = e
            }
        }(),
        l = function() {
            return function(t, e, i) {
                this.id = t, this.teamId = e, this.memberName = i
            }
        }(),
        c = function() {
            return function(t, e, i) {
                this.id = t, this.teamId = e, this.memberName = i
            }
        }(),
        u = function(t) {
            function e(e, i) {
                var s = t.call(this) || this;
                return s.requestId = e, s.element = document.createElement("div"), s.element.className = "join-request-content", s.element.innerHTML = "\n        " + i + '<br /> ask for join\n            <div class="join-request-buttons">\n                <span class="approve">\n                    <i class="fa-solid fa-thumbs-up fa-2x" aria-hidden="true"></i>\n                </span>\n                <span class="decline">\n                    <i class="fa-solid fa-thumbs-down fa-2x" aria-hidden="true"></i>\n                </span>\n            </div>\n        ', $(".approve", s.element).on("click", function() {
                    this.emit("approve", e)
                }.bind(s)), $(".decline", s.element).on("click", function() {
                    this.emit("decline", e)
                }.bind(s)), s
            }
            return s(e, t), e
        }(r.EventEmitter),
        d = function() {
            function t(t, e) {
                this.requests = {}, this.world = t, this.container = e
            }
            return t.prototype.clear = function() {
                for (var t = 0, e = Object.keys(this.requests); t < e.length; t++) {
                    var i = e[t];
                    this.removeJoinRequest(parseInt(i))
                }
            }, t.prototype.addJoinRequest = function(t) {
                this.requests[t.id] = t, this.currentElement || this.show(t.id)
            }, t.prototype.removeJoinRequest = function(t) {
                delete this.requests[t], this.currentElement && this.currentElement.requestId === t && (this.hide(), Object.keys(this.requests).length > 0 && this.show(Object.keys(this.requests)[0]))
            }, t.prototype.show = function(t) {
                this.requests[t] && (this.currentElement = new u(t, this.requests[t].memberName), this.currentElement.on("approve", function(t) {
                    this.world.services.getService(y).requestApprove(t), this.removeJoinRequest(t)
                }.bind(this)), this.currentElement.on("decline", function(t) {
                    this.world.services.getService(y).requestDecline(t), this.removeJoinRequest(t)
                }.bind(this)), this.container.appendChild(this.currentElement.element), this.container.style.visibility = "visible")
            }, t.prototype.hide = function() {
                this.currentElement && (this.container.removeChild(this.currentElement.element), this.currentElement = null, this.container.style.visibility = "hidden")
            }, t
        }(),
        p = function(t) {
            function e(e, i) {
                var s = t.call(this) || this;
                return s.element = document.createElement("div"), s.element.className = "ui-team-list-item", s.element.innerHTML = '\n            <div class="ui-join-button">\n                JOIN\n            </div>\n            <div class="ui-team-name">\n                ' + i + "\n            </div>\n        ", s.joinButton = $(".ui-join-button", s.element).get(0), s.joinButton.onclick = function() {
                    this.emit("join-request", e)
                }.bind(s), s
            }
            return s(e, t), e.prototype.setJoinStatus = function(t) {
                t ? (this.joinButton.classList.add("loading"), this.joinButton.innerHTML = '<i class="fa-solid fa-spin fa-spinner" aria-hidden="true"></i> REQUESTED') : (this.joinButton.classList.remove("loading"), this.joinButton.innerHTML = "JOIN")
            }, e
        }(r.EventEmitter),
        f = function() {
            function t(t, e, i) {
                this.elements = {}, this.listContainer = i, this.container = e, this.world = t
            }
            return t.prototype.addTeam = function(t) {
                var e = new p(t.teamId, t.teamName);
                this.listContainer.appendChild(e.element), this.elements[t.teamId] = e, e.on("join-request", function(t) {
                    this.world.services.getService(y).requestJoin(t)
                }.bind(this))
            }, t.prototype.removeTeam = function(t) {
                this.elements[t] && (this.elements[t].element.parentNode.removeChild(this.elements[t].element), delete this.elements[t])
            }, t.prototype.setJoinStatus = function(t, e) {
                this.elements[t] && this.elements[t].setJoinStatus(e)
            }, t.prototype.toggle = function(t) {
                this.container.style.visibility = t ? "visible" : "hidden"
            }, t
        }(),
        m = function(t) {
            function e(e, i, s) {
                var n = t.call(this) || this;
                return n.element = document.createElement("div"), n.element.className = "ui-member-list-item", n.element.innerHTML = "\n            " + (e.isAdmin && i !== e.networkId ? '<div class="ui-kick-button">KICK</div>' : "") + '\n            <div class="ui-team-name">\n                ' + s + "\n            </div>\n        ", e.isAdmin && i !== e.networkId && (n.element.childNodes[1].onclick = function() {
                    this.emit("kick-request", i)
                }.bind(n)), n
            }
            return s(e, t), e.prototype.setJoinStatus = function(t) {
                t ? this.element.childNodes[1].classList.add("loading") : this.element.childNodes[1].classList.remove("loading")
            }, e
        }(r.EventEmitter),
        g = function() {
            function t(t, e, i) {
                this.elements = {}, this.container = e, this.content = i, this.world = t
            }
            return t.prototype.addMember = function(t) {
                var e = new m(this.world, t.id, t.memberName);
                this.content.appendChild(e.element), this.elements[t.id] = e, e.on("kick-request", function(t) {
                    this.world.services.getService(y).requestKick(t)
                }.bind(this))
            }, t.prototype.removeMember = function(t) {
                this.elements[t] && (this.elements[t].element.parentNode.removeChild(this.elements[t].element), delete this.elements[t])
            }, t.prototype.toggle = function(t) {
                this.container.style.visibility = t ? "visible" : "hidden"
            }, t
        }(),
        y = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                i.teams = {}, i.joins = {}, i.members = {}, i.enabled = !1, i.teamList = new f(e, document.getElementById("ui-team-list-container"), document.getElementById("ui-team-list-content")), i.memberList = new g(e, document.getElementById("ui-member-list-container"), document.getElementById("ui-member-list-content")), i.joinRequestList = new d(e, document.getElementById("ui-join-request-list")), i.world.socket.onMessage(o.PlayerTeamListResponse, i.onTeamListResponse.bind(i)), i.world.socket.onMessage(o.PlayerTeamMembersResponse, i.onMemberListResponse.bind(i)), i.world.socket.onMessage(o.NotifyTeamCreated, i.onTeamCreated.bind(i)), i.world.socket.onMessage(o.NotifyTeamRemoved, i.onTeamRemoved.bind(i)), i.world.socket.onMessage(o.NotifyJoinRequestCreated, i.onJoinRequestCreated.bind(i)), i.world.socket.onMessage(o.NotifyJoinRequestRemoved, i.onJoinRequestRemoved.bind(i)), i.world.socket.onMessage(o.NotifyMemberJoin, i.onMemberJoin.bind(i)), i.world.socket.onMessage(o.NotifyMemberLeave, i.onMemberLeave.bind(i)), i.requestTeamList(), window.addEventListener("keydown", i.onKeyDown.bind(i), !1), document.getElementById("ui-create-team-button").onclick = function() {
                    this.requestCreateTeam(document.getElementById("ui-input-team-name").value)
                }.bind(i), document.getElementById("ui-leave-team-button").onclick = function() {
                    this.requestLeave()
                }.bind(i);
                for (var s = document.getElementsByClassName("ui-team-list-close"), n = 0; n < s.length; n++) s.item(n).onclick = function() {
                    this.toggle()
                }.bind(i);
                return i
            }
            return s(e, t), e.prototype.onKeyDown = function(t) {
                this.enabled && 27 === t.keyCode && this.toggle()
            }, e.prototype.onJoinRequestCreated = function(t) {
                var e = new l(t.content.id, t.content.teamId, t.content.fromName);
                this.joins[e.id] = e, this.teamList.setJoinStatus(e.teamId, !0), this.world.isAdmin && e.teamId === this.world.teamId && this.joinRequestList.addJoinRequest(e)
            }, e.prototype.onJoinRequestRemoved = function(t) {
                var e = t.content.id;
                this.joins[e] && (this.teamList.setJoinStatus(this.joins[e].teamId, !1), delete this.joins[e]), this.joinRequestList.removeJoinRequest(e)
            }, e.prototype.onTeamListResponse = function(t) {
                for (var e = t.content.teamId, i = t.content.teamName, s = t.content.memberCount, n = 0; n < e.length; n++) this.addTeam(e[n], i[n], s[n])
            }, e.prototype.onMemberListResponse = function(t) {
                for (var e = t.content.teamId, i = t.content.networkId, s = t.content.name, n = 0; n < i.length; n++) this.addMember(e, i[n], s[n])
            }, e.prototype.onTeamCreated = function(t) {
                this.addTeam(t.content.teamId, t.content.teamName, 0)
            }, e.prototype.onTeamRemoved = function(t) {
                this.removeTeam(t.content.teamId)
            }, e.prototype.onMemberJoin = function(t) {
                var e = t.content.teamId,
                    i = t.content.memberId,
                    s = t.content.memberName;
                this.addMember(e, i, s)
            }, e.prototype.onMemberLeave = function(t) {
                var e = (t.content.teamId, t.content.memberId);
                this.removeMember(e)
            }, e.prototype.onTeamSwitch = function(t) {
                if (this.cleanupMembers(), this.world.isAdmin)
                    for (var e in this.joins) this.joins[e].teamId === this.world.teamId && this.joinRequestList.addJoinRequest(this.joins[e]);
                else this.joinRequestList.clear();
                for (var i in this.teams) this.teamList.setJoinStatus(i, !1);
                t > -1 && this.requestMemberList(t), this.requestTeamList(), this.teamList.toggle(this.enabled && this.world.teamId < 0), this.memberList.toggle(this.enabled && this.world.teamId > -1)
            }, e.prototype.removeTeam = function(t) {
                this.teams[t] && (delete this.teams[t], this.teamList.removeTeam(t))
            }, e.prototype.addTeam = function(t, e, i) {
                this.teams[t] || (this.teams[t] = new h(t, e), this.teamList.addTeam(this.teams[t]))
            }, e.prototype.cleanupMembers = function() {
                for (var t = 0, e = Object.keys(this.members); t < e.length; t++) {
                    var i = e[t];
                    this.removeMember(i)
                }
            }, e.prototype.addMember = function(t, e, i) {
                this.members[e] || (this.members[e] = new c(e, t, i), this.memberList.addMember(this.members[e]))
            }, e.prototype.removeMember = function(t) {
                this.members[t] && (this.memberList.removeMember(t), delete this.members[t])
            }, e.prototype.requestJoin = function(t) {
                this.world.socket.sendMessage(o.PlayerJoinTeam, {
                    teamId: t
                })
            }, e.prototype.requestKick = function(t) {
                this.world.socket.sendMessage(o.PlayerKickRequest, {
                    networkId: t
                })
            }, e.prototype.requestCreateTeam = function(t) {
                this.world.socket.sendMessage(o.PlayerCreateTeam, {
                    name: t
                })
            }, e.prototype.requestLeave = function() {
                this.world.socket.sendMessage(o.PlayerLeaveTeam, {})
            }, e.prototype.requestApprove = function(t) {
                this.world.socket.sendMessage(o.PlayerApproveRequest, {
                    requestId: t
                })
            }, e.prototype.requestDecline = function(t) {
                this.world.socket.sendMessage(o.PlayerDeclineRequest, {
                    requestId: t
                })
            }, e.prototype.requestTeamList = function() {
                this.world.socket.sendMessage(o.PlayerTeamListRequest, {})
            }, e.prototype.requestMemberList = function(t) {
                this.world.socket.sendMessage(o.PlayerTeamMembersRequest, {
                    teamId: t
                })
            }, e.prototype.hide = function() {
                this.enabled && this.toggle()
            }, e.prototype.toggle = function() {
                this.enabled = !this.enabled, this.enabled && this.world.services.getService(a.default).hide(), this.teamList.toggle(this.enabled && this.world.teamId < 0), this.memberList.toggle(this.enabled && this.world.teamId > -1), this.world.game.input.keyboard.enabled = !this.enabled, this.world.game.input.keyboard.reset(!1)
            }, e
        }(n.Service);
    e.default = y
}, function(module, exports, __webpack_require__) {
    (function(module) {
        var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;
        ! function(e, t) {
            "use strict";
            ! function(t, i, s) {
                var n = e.protobuf = function e(s) {
                    var n = i[s];
                    return n || t[s][0].call(n = i[s] = {
                        exports: {}
                    }, e, n, n.exports), n.exports
                }(19);
                __webpack_require__(132) && (__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(90)], void 0 !== (__WEBPACK_AMD_DEFINE_RESULT__ = function(t) {
                    return n.util.Long = t, n.configure(), n
                }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)), "object" == typeof module && module && module.exports && (module.exports = n)
            }({
                1: [function(t, e) {
                    e.exports = function(t, e) {
                        for (var i = [], s = 2; s < arguments.length;) i.push(arguments[s++]);
                        var n = !0;
                        return new Promise(function(s, o) {
                            i.push(function(t) {
                                if (n)
                                    if (n = !1, t) o(t);
                                    else {
                                        for (var e = [], i = 1; i < arguments.length;) e.push(arguments[i++]);
                                        s.apply(null, e)
                                    }
                            });
                            try {
                                t.apply(e || this, i)
                            } catch (t) {
                                n && (n = !1, o(t))
                            }
                        })
                    }
                }, {}],
                2: [function(e, i, s) {
                    var n = s;
                    n.length = function(t) {
                        var e = t.length;
                        if (!e) return 0;
                        for (var i = 0; --e % 4 > 1 && "=" === t.charAt(e);) ++i;
                        return Math.ceil(3 * t.length) / 4 - i
                    };
                    for (var o = Array(64), r = Array(123), a = 0; a < 64;) r[o[a] = a < 26 ? a + 65 : a < 52 ? a + 71 : a < 62 ? a - 4 : a - 59 | 43] = a++;
                    n.encode = function(t, e, i) {
                        for (var s, n = [], r = 0, a = 0; e < i;) {
                            var h = t[e++];
                            switch (a) {
                                case 0:
                                    n[r++] = o[h >> 2], s = (3 & h) << 4, a = 1;
                                    break;
                                case 1:
                                    n[r++] = o[s | h >> 4], s = (15 & h) << 2, a = 2;
                                    break;
                                case 2:
                                    n[r++] = o[s | h >> 6], n[r++] = o[63 & h], a = 0
                            }
                        }
                        return a && (n[r++] = o[s], n[r] = 61, 1 === a && (n[r + 1] = 61)), String.fromCharCode.apply(String, n)
                    };
                    var h = "invalid encoding";
                    n.decode = function(e, i, s) {
                        for (var n, o = s, a = 0, l = 0; l < e.length;) {
                            var c = e.charCodeAt(l++);
                            if (61 === c && a > 1) break;
                            if ((c = r[c]) === t) throw Error(h);
                            switch (a) {
                                case 0:
                                    n = c, a = 1;
                                    break;
                                case 1:
                                    i[s++] = n << 2 | (48 & c) >> 4, n = c, a = 2;
                                    break;
                                case 2:
                                    i[s++] = (15 & n) << 4 | (60 & c) >> 2, n = c, a = 3;
                                    break;
                                case 3:
                                    i[s++] = (3 & n) << 6 | c, a = 0
                            }
                        }
                        if (1 === a) throw Error(h);
                        return s - o
                    }, n.test = function(t) {
                        return /^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(t)
                    }
                }, {}],
                3: [function(e, i) {
                    function s() {
                        function e() {
                            for (var t = [], i = 0; i < arguments.length;) t.push(arguments[i++]);
                            var s = n.apply(null, t),
                                p = u;
                            if (c.length) {
                                var f = c[c.length - 1];
                                o.test(f) ? p = ++u : h.test(f) && ++p, a.test(f) && !a.test(s) ? (p = ++u, d = !0) : d && l.test(f) && (p = --u, d = !1), r.test(s) && (p = --u)
                            }
                            for (i = 0; i < p; ++i) s = "\t" + s;
                            return c.push(s), e
                        }
                        for (var i = [], c = [], u = 1, d = !1, p = 0; p < arguments.length;) i.push(arguments[p++]);
                        return e.str = function(t) {
                            return "function" + (t ? " " + t.replace(/[^\w_$]/g, "_") : "") + "(" + i.join(",") + ") {\n" + c.join("\n") + "\n}"
                        }, e.eof = function(i, n) {
                            "object" == typeof i && (n = i, i = t);
                            var o = e.str(i);
                            s.verbose && console.log("--- codegen ---\n" + o.replace(/^/gm, "> ").replace(/\t/g, "  "));
                            var r = Object.keys(n || (n = {}));
                            return Function.apply(null, r.concat("return " + o)).apply(null, r.map(function(t) {
                                return n[t]
                            }))
                        }, e
                    }

                    function n(t) {
                        for (var e = [], i = 1; i < arguments.length;) e.push(arguments[i++]);
                        if (i = 0, t = t.replace(/%([dfjs])/g, function(t, s) {
                                switch (s) {
                                    case "d":
                                        return Math.floor(e[i++]);
                                    case "f":
                                        return +e[i++];
                                    case "j":
                                        return JSON.stringify(e[i++]);
                                    default:
                                        return e[i++]
                                }
                            }), i !== e.length) throw Error("argument count mismatch");
                        return t
                    }
                    i.exports = s;
                    var o = /[{[]$/,
                        r = /^[}\]]/,
                        a = /:$/,
                        h = /^\s*(?:if|}?else if|while|for)\b|\b(?:else)\s*$/,
                        l = /\b(?:break|continue)(?: \w+)?;?$|^\s*return\b/;
                    s.sprintf = n, s.supported = !1;
                    try {
                        s.supported = 1 === s("a", "b")("return a-b").eof()(2, 1)
                    } catch (e) {}
                    s.verbose = !1
                }, {}],
                4: [function(e, i) {
                    function s() {
                        this.a = {}
                    }
                    i.exports = s, s.prototype.on = function(t, e, i) {
                        return (this.a[t] || (this.a[t] = [])).push({
                            fn: e,
                            ctx: i || this
                        }), this
                    }, s.prototype.off = function(e, i) {
                        if (e === t) this.a = {};
                        else if (i === t) this.a[e] = [];
                        else
                            for (var s = this.a[e], n = 0; n < s.length;) s[n].fn === i ? s.splice(n, 1) : ++n;
                        return this
                    }, s.prototype.emit = function(t) {
                        var e = this.a[t];
                        if (e) {
                            for (var i = [], s = 1; s < arguments.length;) i.push(arguments[s++]);
                            for (s = 0; s < e.length;) e[s].fn.apply(e[s++].ctx, i)
                        }
                        return this
                    }
                }, {}],
                5: [function(e, i) {
                    function s(t, e, i) {
                        return "function" == typeof e ? (i = e, e = {}) : e || (e = {}), i ? !e.xhr && o && o.readFile ? o.readFile(t, function(n, o) {
                            return n && "undefined" != typeof XMLHttpRequest ? s.xhr(t, e, i) : n ? i(n) : i(null, e.binary ? o : o.toString("utf8"))
                        }) : s.xhr(t, e, i) : n(s, this, t, e)
                    }
                    i.exports = s;
                    var n = e(1),
                        o = e(6)("fs");
                    s.xhr = function(e, i, s) {
                        var n = new XMLHttpRequest;
                        n.onreadystatechange = function() {
                            if (4 !== n.readyState) return t;
                            if (0 !== n.status && 200 !== n.status) return s(Error("status " + n.status));
                            if (i.binary) {
                                var e = n.response;
                                if (!e) {
                                    e = [];
                                    for (var o = 0; o < n.responseText.length; ++o) e.push(255 & n.responseText.charCodeAt(o))
                                }
                                return s(null, "undefined" != typeof Uint8Array ? new Uint8Array(e) : e)
                            }
                            return s(null, n.responseText)
                        }, i.binary && ("overrideMimeType" in n && n.overrideMimeType("text/plain; charset=x-user-defined"), n.responseType = "arraybuffer"), n.open("GET", e), n.send()
                    }
                }, {
                    1: 1,
                    6: 6
                }],
                6: [function(e, t, r) {
                    function n(e) {
                        try {
                            var t = eval("quire".replace(/^/, "re"))(e);
                            if (t && (t.length || Object.keys(t).length)) return t
                        } catch (e) {}
                        return null
                    }
                    t.exports = n
                }, {}],
                7: [function(t, e, i) {
                    var s = i,
                        n = s.isAbsolute = function(t) {
                            return /^(?:\/|\w+:)/.test(t)
                        },
                        o = s.normalize = function(t) {
                            var e = (t = t.replace(/\\/g, "/").replace(/\/{2,}/g, "/")).split("/"),
                                i = n(t),
                                s = "";
                            i && (s = e.shift() + "/");
                            for (var o = 0; o < e.length;) ".." === e[o] ? o > 0 && ".." !== e[o - 1] ? e.splice(--o, 2) : i ? e.splice(o, 1) : ++o : "." === e[o] ? e.splice(o, 1) : ++o;
                            return s + e.join("/")
                        };
                    s.resolve = function(t, e, i) {
                        return i || (e = o(e)), n(e) ? e : (i || (t = o(t)), (t = t.replace(/(?:\/|^)[^\/]+$/, "")).length ? o(t + "/" + e) : e)
                    }
                }, {}],
                8: [function(t, e) {
                    e.exports = function(t, e, i) {
                        var s = i || 8192,
                            n = s >>> 1,
                            o = null,
                            r = s;
                        return function(i) {
                            if (i < 1 || i > n) return t(i);
                            r + i > s && (o = t(s), r = 0);
                            var a = e.call(o, r, r += i);
                            return 7 & r && (r = 1 + (7 | r)), a
                        }
                    }
                }, {}],
                9: [function(t, e, i) {
                    var s = i;
                    s.length = function(t) {
                        for (var e = 0, i = 0, s = 0; s < t.length; ++s)(i = t.charCodeAt(s)) < 128 ? e += 1 : i < 2048 ? e += 2 : 55296 == (64512 & i) && 56320 == (64512 & t.charCodeAt(s + 1)) ? (++s, e += 4) : e += 3;
                        return e
                    }, s.read = function(t, e, i) {
                        if (i - e < 1) return "";
                        for (var s, n = null, o = [], r = 0; e < i;)(s = t[e++]) < 128 ? o[r++] = s : s > 191 && s < 224 ? o[r++] = (31 & s) << 6 | 63 & t[e++] : s > 239 && s < 365 ? (s = ((7 & s) << 18 | (63 & t[e++]) << 12 | (63 & t[e++]) << 6 | 63 & t[e++]) - 65536, o[r++] = 55296 + (s >> 10), o[r++] = 56320 + (1023 & s)) : o[r++] = (15 & s) << 12 | (63 & t[e++]) << 6 | 63 & t[e++], r > 8191 && ((n || (n = [])).push(String.fromCharCode.apply(String, o)), r = 0);
                        return n ? (r && n.push(String.fromCharCode.apply(String, o.slice(0, r))), n.join("")) : String.fromCharCode.apply(String, o.slice(0, r))
                    }, s.write = function(t, e, i) {
                        for (var s, n, o = i, r = 0; r < t.length; ++r)(s = t.charCodeAt(r)) < 128 ? e[i++] = s : s < 2048 ? (e[i++] = s >> 6 | 192, e[i++] = 63 & s | 128) : 55296 == (64512 & s) && 56320 == (64512 & (n = t.charCodeAt(r + 1))) ? (s = 65536 + ((1023 & s) << 10) + (1023 & n), ++r, e[i++] = s >> 18 | 240, e[i++] = s >> 12 & 63 | 128, e[i++] = s >> 6 & 63 | 128, e[i++] = 63 & s | 128) : (e[i++] = s >> 12 | 224, e[i++] = s >> 6 & 63 | 128, e[i++] = 63 & s | 128);
                        return i - o
                    }
                }, {}],
                10: [function(t, e) {
                    function i(e, r) {
                        if (s || (s = t(34)), !(e instanceof s)) throw TypeError("type must be a Type");
                        if (r) {
                            if ("function" != typeof r) throw TypeError("ctor must be a function")
                        } else r = o.codegen("p")("return c.call(this,p)").eof(e.name, {
                            c: n
                        });
                        r.constructor = i, (r.prototype = new n).constructor = r, o.merge(r, n, !0), r.$type = e, r.prototype.$type = e;
                        for (var a = 0; a < e.fieldsArray.length; ++a) r.prototype[e.b[a].name] = Array.isArray(e.b[a].resolve().defaultValue) ? o.emptyArray : o.isObject(e.b[a].defaultValue) && !e.b[a].long ? o.emptyObject : e.b[a].defaultValue;
                        var h = {};
                        for (a = 0; a < e.oneofsArray.length; ++a) h[e.d[a].resolve().name] = {
                            get: o.oneOfGetter(e.d[a].oneof),
                            set: o.oneOfSetter(e.d[a].oneof)
                        };
                        return a && Object.defineProperties(r.prototype, h), e.ctor = r, r.prototype
                    }
                    e.exports = i;
                    var s, n = t(21),
                        o = t(36);
                    i.create = i, i.prototype = n
                }, {
                    21: 21,
                    34: 34,
                    36: 36
                }],
                11: [function(t, e) {
                    function i(t, e) {
                        /\/|\./.test(t) || (t = "google/protobuf/" + t + ".proto", e = {
                            nested: {
                                google: {
                                    nested: {
                                        protobuf: {
                                            nested: e
                                        }
                                    }
                                }
                            }
                        }), i[t] = e
                    }
                    var s;
                    e.exports = i, i("any", {
                        Any: {
                            fields: {
                                type_url: {
                                    type: "string",
                                    id: 1
                                },
                                value: {
                                    type: "bytes",
                                    id: 2
                                }
                            }
                        }
                    }), i("duration", {
                        Duration: s = {
                            fields: {
                                seconds: {
                                    type: "int64",
                                    id: 1
                                },
                                nanos: {
                                    type: "int32",
                                    id: 2
                                }
                            }
                        }
                    }), i("timestamp", {
                        Timestamp: s
                    }), i("empty", {
                        Empty: {
                            fields: {}
                        }
                    }), i("struct", {
                        Struct: {
                            fields: {
                                fields: {
                                    keyType: "string",
                                    type: "Value",
                                    id: 1
                                }
                            }
                        },
                        Value: {
                            oneofs: {
                                kind: {
                                    oneof: ["nullValue", "numberValue", "stringValue", "boolValue", "structValue", "listValue"]
                                }
                            },
                            fields: {
                                nullValue: {
                                    type: "NullValue",
                                    id: 1
                                },
                                numberValue: {
                                    type: "double",
                                    id: 2
                                },
                                stringValue: {
                                    type: "string",
                                    id: 3
                                },
                                boolValue: {
                                    type: "bool",
                                    id: 4
                                },
                                structValue: {
                                    type: "Struct",
                                    id: 5
                                },
                                listValue: {
                                    type: "ListValue",
                                    id: 6
                                }
                            }
                        },
                        NullValue: {
                            values: {
                                NULL_VALUE: 0
                            }
                        },
                        ListValue: {
                            fields: {
                                values: {
                                    rule: "repeated",
                                    type: "Value",
                                    id: 1
                                }
                            }
                        }
                    }), i("wrappers", {
                        DoubleValue: {
                            fields: {
                                value: {
                                    type: "double",
                                    id: 1
                                }
                            }
                        },
                        FloatValue: {
                            fields: {
                                value: {
                                    type: "float",
                                    id: 1
                                }
                            }
                        },
                        Int64Value: {
                            fields: {
                                value: {
                                    type: "int64",
                                    id: 1
                                }
                            }
                        },
                        UInt64Value: {
                            fields: {
                                value: {
                                    type: "uint64",
                                    id: 1
                                }
                            }
                        },
                        Int32Value: {
                            fields: {
                                value: {
                                    type: "int32",
                                    id: 1
                                }
                            }
                        },
                        UInt32Value: {
                            fields: {
                                value: {
                                    type: "uint32",
                                    id: 1
                                }
                            }
                        },
                        BoolValue: {
                            fields: {
                                value: {
                                    type: "bool",
                                    id: 1
                                }
                            }
                        },
                        StringValue: {
                            fields: {
                                value: {
                                    type: "string",
                                    id: 1
                                }
                            }
                        },
                        BytesValue: {
                            fields: {
                                value: {
                                    type: "bytes",
                                    id: 1
                                }
                            }
                        }
                    })
                }, {}],
                12: [function(t, e, i) {
                    function s(t, e, i, s) {
                        if (e.resolvedType)
                            if (e.resolvedType instanceof r) {
                                t("switch(d%s){", s);
                                for (var n = e.resolvedType.values, o = Object.keys(n), a = 0; a < o.length; ++a) e.repeated && n[o[a]] === e.typeDefault && t("default:"), t("case%j:", o[a])("case %j:", n[o[a]])("m%s=%j", s, n[o[a]])("break");
                                t("}")
                            } else t('if(typeof d%s!=="object")', s)("throw TypeError(%j)", e.fullName + ": object expected")("m%s=types[%d].fromObject(d%s)", s, i, s);
                        else {
                            var h = !1;
                            switch (e.type) {
                                case "double":
                                case "float":
                                    t("m%s=Number(d%s)", s, s);
                                    break;
                                case "uint32":
                                case "fixed32":
                                    t("m%s=d%s>>>0", s, s);
                                    break;
                                case "int32":
                                case "sint32":
                                case "sfixed32":
                                    t("m%s=d%s|0", s, s);
                                    break;
                                case "uint64":
                                    h = !0;
                                case "int64":
                                case "sint64":
                                case "fixed64":
                                case "sfixed64":
                                    t("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j", s, s, h)('else if(typeof d%s==="string")', s)("m%s=parseInt(d%s,10)", s, s)('else if(typeof d%s==="number")', s)("m%s=d%s", s, s)('else if(typeof d%s==="object")', s)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)", s, s, s, h ? "true" : "");
                                    break;
                                case "bytes":
                                    t('if(typeof d%s==="string")', s)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)", s, s, s)("else if(d%s.length)", s)("m%s=d%s", s, s);
                                    break;
                                case "string":
                                    t("m%s=String(d%s)", s, s);
                                    break;
                                case "bool":
                                    t("m%s=Boolean(d%s)", s, s)
                            }
                        }
                        return t
                    }

                    function n(t, e, i, s) {
                        if (e.resolvedType) e.resolvedType instanceof r ? t("d%s=o.enums===String?types[%d].values[m%s]:m%s", s, i, s, s) : t("d%s=types[%d].toObject(m%s,o)", s, i, s);
                        else {
                            var n = !1;
                            switch (e.type) {
                                case "uint64":
                                    n = !0;
                                case "int64":
                                case "sint64":
                                case "fixed64":
                                case "sfixed64":
                                    t('if(typeof m%s==="number")', s)("d%s=o.longs===String?String(m%s):m%s", s, s, s)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s", s, s, s, s, n ? "true" : "", s);
                                    break;
                                case "bytes":
                                    t("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s", s, s, s, s, s);
                                    break;
                                default:
                                    t("d%s=m%s", s, s)
                            }
                        }
                        return t
                    }
                    var o = i,
                        r = t(15),
                        a = t(36);
                    o.fromObject = function(t) {
                        var e = t.fieldsArray,
                            i = a.codegen("d")("if(d instanceof this.ctor)")("return d");
                        if (!e.length) return i("return new this.ctor");
                        i("var m=new this.ctor");
                        for (var n = 0; n < e.length; ++n) {
                            var o = e[n].resolve(),
                                h = a.safeProp(o.name);
                            o.map ? (i("if(d%s){", h)('if(typeof d%s!=="object")', h)("throw TypeError(%j)", o.fullName + ": object expected")("m%s={}", h)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){", h), s(i, o, n, h + "[ks[i]]")("}")("}")) : o.repeated ? (i("if(d%s){", h)("if(!Array.isArray(d%s))", h)("throw TypeError(%j)", o.fullName + ": array expected")("m%s=[]", h)("for(var i=0;i<d%s.length;++i){", h), s(i, o, n, h + "[i]")("}")("}")) : (o.resolvedType instanceof r || i("if(d%s!==undefined&&d%s!==null){", h, h), s(i, o, n, h), o.resolvedType instanceof r || i("}"))
                        }
                        return i("return m")
                    }, o.toObject = function(t) {
                        var e = t.fieldsArray;
                        if (!e.length) return a.codegen()("return {}");
                        for (var i = a.codegen("m", "o")("if(!o)")("o={}")("var d={}"), s = [], o = [], h = [], l = 0; l < e.length; ++l) e[l].resolve().repeated ? s.push(e[l]) : e[l].map ? o.push(e[l]) : h.push(e[l]);
                        if (s.length) {
                            for (i("if(o.arrays||o.defaults){"), l = 0; l < s.length; ++l) i("d%s=[]", a.safeProp(s[l].name));
                            i("}")
                        }
                        if (o.length) {
                            for (i("if(o.objects||o.defaults){"), l = 0; l < o.length; ++l) i("d%s={}", a.safeProp(o[l].name));
                            i("}")
                        }
                        if (h.length) {
                            for (i("if(o.defaults){"), l = 0; l < h.length; ++l) {
                                var c = h[l],
                                    u = a.safeProp(c.name);
                                c.resolvedType instanceof r ? i("d%s=o.enums===String?%j:%j", u, c.resolvedType.valuesById[c.typeDefault], c.typeDefault) : c.long ? i("if(util.Long){")("var n=new util.Long(%d,%d,%j)", c.typeDefault.low, c.typeDefault.high, c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n", u)("}else")("d%s=o.longs===String?%j:%d", u, "" + c.typeDefault, c.typeDefault.toNumber()) : c.bytes ? i("d%s=o.bytes===String?%j:%s", u, String.fromCharCode.apply(String, c.typeDefault), "[" + Array.prototype.slice.call(c.typeDefault).join(",") + "]") : i("d%s=%j", u, c.typeDefault)
                            }
                            i("}")
                        }
                        for (l = 0; l < e.length; ++l) {
                            c = e[l];
                            i("if(m%s!==undefined&&m%s!==null&&m.hasOwnProperty(%j)){", u = a.safeProp(c.name), u, c.name), c.map ? (i("d%s={}", u)("for(var ks2=Object.keys(m%s),j=0;j<ks2.length;++j){", u), n(i, c, l, u + "[ks2[j]]")("}")) : c.repeated ? (i("d%s=[]", u)("for(var j=0;j<m%s.length;++j){", u), n(i, c, l, u + "[j]")("}")) : n(i, c, l, u), i("}")
                        }
                        return i("return d")
                    }
                }, {
                    15: 15,
                    36: 36
                }],
                13: [function(e, i) {
                    function s(e) {
                        var i = r.codegen("r", "l")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor")("while(r.pos<c){")("var t=r.uint32()");
                        e.group && i("if((t&7)===4)")("break"), i("switch(t>>>3){");
                        for (var a = 0; a < e.fieldsArray.length; ++a) {
                            var h = e.b[a].resolve(),
                                l = h.resolvedType instanceof n ? "uint32" : h.type,
                                c = "m" + r.safeProp(h.name);
                            i("case %d:", h.id), h.map ? (i("r.skip().pos++")("if(%s===util.emptyObject)", c)("%s={}", c)("var k=r.%s()", h.keyType)("r.pos++"), o.basic[l] === t ? i('%s[typeof k==="object"?util.longToHash(k):k]=types[%d].decode(r,r.uint32())', c, a) : i('%s[typeof k==="object"?util.longToHash(k):k]=r.%s()', c, l)) : h.repeated ? (i("if(!(%s&&%s.length))", c, c)("%s=[]", c), (s.compat || h.packed) && o.packed[l] !== t && i("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())", c, l)("}else"), o.basic[l] === t ? i(h.resolvedType.group ? "%s.push(types[%d].decode(r))" : "%s.push(types[%d].decode(r,r.uint32()))", c, a) : i("%s.push(r.%s())", c, l)) : o.basic[l] === t ? i(h.resolvedType.group ? "%s=types[%d].decode(r)" : "%s=types[%d].decode(r,r.uint32())", c, a) : i("%s=r.%s()", c, l), i("break")
                        }
                        return i("default:")("r.skipType(t&7)")("break")("}")("}")("return m")
                    }
                    i.exports = s, s.compat = !0;
                    var n = e(15),
                        o = e(35),
                        r = e(36)
                }, {
                    15: 15,
                    35: 35,
                    36: 36
                }],
                14: [function(e, i) {
                    function s(t, e, i, s) {
                        return e.resolvedType.group ? t("types[%d].encode(%s,w.uint32(%d)).uint32(%d)", i, s, (e.id << 3 | 3) >>> 0, (e.id << 3 | 4) >>> 0) : t("types[%d].encode(%s,w.uint32(%d).fork()).ldelim()", i, s, (e.id << 3 | 2) >>> 0)
                    }
                    i.exports = function(e) {
                        for (var i, a = r.codegen("m", "w")("if(!w)")("w=Writer.create()"), h = 0; h < e.fieldsArray.length; ++h)
                            if (!(p = e.b[h].resolve()).partOf) {
                                var l = p.resolvedType instanceof n ? "uint32" : p.type,
                                    c = o.basic[l];
                                i = "m" + r.safeProp(p.name), p.map ? (a("if(%s&&m.hasOwnProperty(%j)){", i, p.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){", i)("w.uint32(%d).fork().uint32(%d).%s(ks[i])", (p.id << 3 | 2) >>> 0, 8 | o.mapKey[p.keyType], p.keyType), c === t ? a("types[%d].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()", h, i) : a(".uint32(%d).%s(%s[ks[i]]).ldelim()", 16 | c, l, i), a("}")("}")) : p.repeated ? p.packed && o.packed[l] !== t ? a("if(%s&&%s.length&&m.hasOwnProperty(%j)){", i, i, p.name)("w.uint32(%d).fork()", (p.id << 3 | 2) >>> 0)("for(var i=0;i<%s.length;++i)", i)("w.%s(%s[i])", l, i)("w.ldelim()")("}") : (a("if(%s!==undefined&&m.hasOwnProperty(%j)){", i, p.name)("for(var i=0;i<%s.length;++i)", i), c === t ? s(a, p, h, i + "[i]") : a("w.uint32(%d).%s(%s[i])", (p.id << 3 | c) >>> 0, l, i), a("}")) : (p.required || (p.long ? a("if(%s!==undefined&&%s!==null&&m.hasOwnProperty(%j))", i, i, p.name) : p.bytes || p.resolvedType && !(p.resolvedType instanceof n) ? a("if(%s&&m.hasOwnProperty(%j))", i, p.name) : a("if(%s!==undefined&&m.hasOwnProperty(%j))", i, p.name)), c === t ? s(a, p, h, i) : a("w.uint32(%d).%s(%s)", (p.id << 3 | c) >>> 0, l, i))
                            } for (h = 0; h < e.oneofsArray.length; ++h) {
                            var u = e.d[h];
                            a("switch(%s){", "m" + r.safeProp(u.name));
                            for (var d = 0; d < u.fieldsArray.length; ++d) {
                                var p;
                                l = (p = u.fieldsArray[d]).resolvedType instanceof n ? "uint32" : p.type, c = o.basic[l], i = "m" + r.safeProp(p.name), a("case%j:", p.name), c === t ? s(a, p, e.b.indexOf(p), i) : a("w.uint32(%d).%s(%s)", (p.id << 3 | c) >>> 0, l, i), a("break")
                            }
                            a("}")
                        }
                        return a("return w")
                    };
                    var n = e(15),
                        o = e(35),
                        r = e(36)
                }, {
                    15: 15,
                    35: 35,
                    36: 36
                }],
                15: [function(e, i) {
                    function s(t, e, i) {
                        if (n.call(this, t, i), e && "object" != typeof e) throw TypeError("values must be an object");
                        if (this.valuesById = {}, this.values = Object.create(this.valuesById), this.comments = {}, e)
                            for (var s = Object.keys(e), o = 0; o < s.length; ++o) this.valuesById[this.values[s[o]] = e[s[o]]] = s[o]
                    }
                    i.exports = s;
                    var n = e(24);
                    ((s.prototype = Object.create(n.prototype)).constructor = s).className = "Enum";
                    var o = e(36);
                    s.fromJSON = function(t, e) {
                        return new s(t, e.values, e.options)
                    }, s.prototype.toJSON = function() {
                        return {
                            options: this.options,
                            values: this.values
                        }
                    }, s.prototype.add = function(e, i, s) {
                        if (!o.isString(e)) throw TypeError("name must be a string");
                        if (!o.isInteger(i)) throw TypeError("id must be an integer");
                        if (this.values[e] !== t) throw Error("duplicate name");
                        if (this.valuesById[i] !== t) {
                            if (!this.options || !this.options.allow_alias) throw Error("duplicate id");
                            this.values[e] = i
                        } else this.valuesById[this.values[e] = i] = e;
                        return this.comments[e] = s || null, this
                    }, s.prototype.remove = function(e) {
                        if (!o.isString(e)) throw TypeError("name must be a string");
                        var i = this.values[e];
                        if (i === t) throw Error("name does not exist");
                        return delete this.valuesById[i], delete this.values[e], delete this.comments[e], this
                    }
                }, {
                    24: 24,
                    36: 36
                }],
                16: [function(e, i) {
                    function s(e, i, s, o, r, l) {
                        if (h.isObject(o) ? (l = o, o = r = t) : h.isObject(r) && (l = r, r = t), n.call(this, e, l), !h.isInteger(i) || i < 0) throw TypeError("id must be a non-negative integer");
                        if (!h.isString(s)) throw TypeError("type must be a string");
                        if (o !== t && !/^required|optional|repeated$/.test(o = ("" + o).toLowerCase())) throw TypeError("rule must be a string rule");
                        if (r !== t && !h.isString(r)) throw TypeError("extend must be a string");
                        this.rule = o && "optional" !== o ? o : t, this.type = s, this.id = i, this.extend = r || t, this.required = "required" === o, this.optional = !this.required, this.repeated = "repeated" === o, this.map = !1, this.message = null, this.partOf = null, this.typeDefault = null, this.defaultValue = null, this.long = !!h.Long && a.long[s] !== t, this.bytes = "bytes" === s, this.resolvedType = null, this.extensionField = null, this.declaringField = null, this.e = null
                    }
                    i.exports = s;
                    var n = e(24);
                    ((s.prototype = Object.create(n.prototype)).constructor = s).className = "Field";
                    var o, r = e(15),
                        a = e(35),
                        h = e(36);
                    Object.defineProperty(s.prototype, "packed", {
                        get: function() {
                            return null === this.e && (this.e = !1 !== this.getOption("packed")), this.e
                        }
                    }), s.prototype.setOption = function(t, e, i) {
                        return "packed" === t && (this.e = null), n.prototype.setOption.call(this, t, e, i)
                    }, s.fromJSON = function(t, e) {
                        return new s(t, e.id, e.type, e.rule, e.extend, e.options)
                    }, s.prototype.toJSON = function() {
                        return {
                            rule: "optional" !== this.rule && this.rule || t,
                            type: this.type,
                            id: this.id,
                            extend: this.extend,
                            options: this.options
                        }
                    }, s.prototype.resolve = function() {
                        if (this.resolved) return this;
                        if ((this.typeDefault = a.defaults[this.type]) === t) {
                            o || (o = e(34));
                            var i = this.declaringField ? this.declaringField.parent : this.parent;
                            if (this.resolvedType = i.lookup(this.type, o)) this.typeDefault = null;
                            else {
                                if (!(this.resolvedType = i.lookup(this.type, r))) throw Error("unresolvable field type: " + this.type + " in " + i);
                                this.typeDefault = this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]
                            }
                        }
                        if (this.options && this.options.default !== t && (this.typeDefault = this.options.default, this.resolvedType instanceof r && "string" == typeof this.typeDefault && (this.typeDefault = this.resolvedType.values[this.typeDefault])), !this.options || this.options.packed === t || !this.resolvedType || this.resolvedType instanceof r || delete this.options.packed, this.long) this.typeDefault = h.Long.fromNumber(this.typeDefault, "u" === this.type.charAt(0)), Object.freeze && Object.freeze(this.typeDefault);
                        else if (this.bytes && "string" == typeof this.typeDefault) {
                            var s;
                            h.base64.test(this.typeDefault) ? h.base64.decode(this.typeDefault, s = h.newBuffer(h.base64.length(this.typeDefault)), 0) : h.utf8.write(this.typeDefault, s = h.newBuffer(h.utf8.length(this.typeDefault)), 0), this.typeDefault = s
                        }
                        return this.map ? this.defaultValue = h.emptyObject : this.repeated ? this.defaultValue = h.emptyArray : this.defaultValue = this.typeDefault, n.prototype.resolve.call(this)
                    }
                }, {
                    15: 15,
                    24: 24,
                    34: 34,
                    35: 35,
                    36: 36
                }],
                17: [function(t, e) {
                    var i = e.exports = t(18);
                    i.build = "light", i.load = function(t, e, s) {
                        return "function" == typeof e ? (s = e, e = new i.Root) : e || (e = new i.Root), e.load(t, s)
                    }, i.loadSync = function(t, e) {
                        return e || (e = new i.Root), e.loadSync(t)
                    }, i.encoder = t(14), i.decoder = t(13), i.verifier = t(39), i.converter = t(12), i.ReflectionObject = t(24), i.Namespace = t(23), i.Root = t(29), i.Enum = t(15), i.Type = t(34), i.Field = t(16), i.OneOf = t(25), i.MapField = t(20), i.Service = t(32), i.Method = t(22), i.Class = t(10), i.Message = t(21), i.types = t(35), i.util = t(36), i.ReflectionObject.f(i.Root), i.Namespace.f(i.Type, i.Service), i.Root.f(i.Type)
                }, {
                    10: 10,
                    12: 12,
                    13: 13,
                    14: 14,
                    15: 15,
                    16: 16,
                    18: 18,
                    20: 20,
                    21: 21,
                    22: 22,
                    23: 23,
                    24: 24,
                    25: 25,
                    29: 29,
                    32: 32,
                    34: 34,
                    35: 35,
                    36: 36,
                    39: 39
                }],
                18: [function(t, e, i) {
                    function s() {
                        n.Reader.f(n.BufferReader), n.util.f()
                    }
                    var n = i;
                    n.build = "minimal", n.roots = {}, n.Writer = t(40), n.BufferWriter = t(41), n.Reader = t(27), n.BufferReader = t(28), n.util = t(38), n.rpc = t(30), n.configure = s, n.Writer.f(n.BufferWriter), s()
                }, {
                    27: 27,
                    28: 28,
                    30: 30,
                    38: 38,
                    40: 40,
                    41: 41
                }],
                19: [function(t, e) {
                    var i = e.exports = t(17);
                    i.build = "full", i.tokenize = t(33), i.parse = t(26), i.common = t(11), i.Root.f(i.Type, i.parse, i.common)
                }, {
                    11: 11,
                    17: 17,
                    26: 26,
                    33: 33
                }],
                20: [function(e, i) {
                    function s(t, e, i, s, o) {
                        if (n.call(this, t, e, s, o), !r.isString(i)) throw TypeError("keyType must be a string");
                        this.keyType = i, this.resolvedKeyType = null, this.map = !0
                    }
                    i.exports = s;
                    var n = e(16);
                    ((s.prototype = Object.create(n.prototype)).constructor = s).className = "MapField";
                    var o = e(35),
                        r = e(36);
                    s.fromJSON = function(t, e) {
                        return new s(t, e.id, e.keyType, e.type, e.options)
                    }, s.prototype.toJSON = function() {
                        return {
                            keyType: this.keyType,
                            type: this.type,
                            id: this.id,
                            extend: this.extend,
                            options: this.options
                        }
                    }, s.prototype.resolve = function() {
                        if (this.resolved) return this;
                        if (o.mapKey[this.keyType] === t) throw Error("invalid key type: " + this.keyType);
                        return n.prototype.resolve.call(this)
                    }
                }, {
                    16: 16,
                    35: 35,
                    36: 36
                }],
                21: [function(t, e) {
                    function i(t) {
                        if (t)
                            for (var e = Object.keys(t), i = 0; i < e.length; ++i) this[e[i]] = t[e[i]]
                    }
                    e.exports = i;
                    var s = t(36);
                    i.encode = function(t, e) {
                        return this.$type.encode(t, e)
                    }, i.encodeDelimited = function(t, e) {
                        return this.$type.encodeDelimited(t, e)
                    }, i.decode = function(t) {
                        return this.$type.decode(t)
                    }, i.decodeDelimited = function(t) {
                        return this.$type.decodeDelimited(t)
                    }, i.verify = function(t) {
                        return this.$type.verify(t)
                    }, i.fromObject = function(t) {
                        return this.$type.fromObject(t)
                    }, i.from = i.fromObject, i.toObject = function(t, e) {
                        return this.$type.toObject(t, e)
                    }, i.prototype.toObject = function(t) {
                        return this.$type.toObject(this, t)
                    }, i.prototype.toJSON = function() {
                        return this.$type.toObject(this, s.toJSONOptions)
                    }
                }, {
                    36: 36
                }],
                22: [function(e, i) {
                    function s(e, i, s, r, a, h, l) {
                        if (o.isObject(a) ? (l = a, a = h = t) : o.isObject(h) && (l = h, h = t), i !== t && !o.isString(i)) throw TypeError("type must be a string");
                        if (!o.isString(s)) throw TypeError("requestType must be a string");
                        if (!o.isString(r)) throw TypeError("responseType must be a string");
                        n.call(this, e, l), this.type = i || "rpc", this.requestType = s, this.requestStream = !!a || t, this.responseType = r, this.responseStream = !!h || t, this.resolvedRequestType = null, this.resolvedResponseType = null
                    }
                    i.exports = s;
                    var n = e(24);
                    ((s.prototype = Object.create(n.prototype)).constructor = s).className = "Method";
                    var o = e(36);
                    s.fromJSON = function(t, e) {
                        return new s(t, e.type, e.requestType, e.responseType, e.requestStream, e.responseStream, e.options)
                    }, s.prototype.toJSON = function() {
                        return {
                            type: "rpc" !== this.type && this.type || t,
                            requestType: this.requestType,
                            requestStream: this.requestStream,
                            responseType: this.responseType,
                            responseStream: this.responseStream,
                            options: this.options
                        }
                    }, s.prototype.resolve = function() {
                        return this.resolved ? this : (this.resolvedRequestType = this.parent.lookupType(this.requestType), this.resolvedResponseType = this.parent.lookupType(this.responseType), n.prototype.resolve.call(this))
                    }
                }, {
                    24: 24,
                    36: 36
                }],
                23: [function(e, i) {
                    function s(e) {
                        if (!e || !e.length) return t;
                        for (var i = {}, s = 0; s < e.length; ++s) i[e[s].name] = e[s].toJSON();
                        return i
                    }

                    function n(e, i) {
                        r.call(this, e, i), this.nested = t, this.g = null
                    }

                    function o(t) {
                        return t.g = null, t
                    }
                    i.exports = n;
                    var r = e(24);
                    ((n.prototype = Object.create(r.prototype)).constructor = n).className = "Namespace";
                    var a, h, l = e(15),
                        c = e(16),
                        u = e(36);
                    n.fromJSON = function(t, e) {
                        return new n(t, e.options).addJSON(e.nested)
                    }, n.arrayToJSON = s, Object.defineProperty(n.prototype, "nestedArray", {
                        get: function() {
                            return this.g || (this.g = u.toArray(this.nested))
                        }
                    }), n.prototype.toJSON = function() {
                        return {
                            options: this.options,
                            nested: s(this.nestedArray)
                        }
                    }, n.prototype.addJSON = function(e) {
                        if (e)
                            for (var i, s = Object.keys(e), o = 0; o < s.length; ++o) i = e[s[o]], this.add((i.fields !== t ? a.fromJSON : i.values !== t ? l.fromJSON : i.methods !== t ? h.fromJSON : i.id !== t ? c.fromJSON : n.fromJSON)(s[o], i));
                        return this
                    }, n.prototype.get = function(t) {
                        return this.nested && this.nested[t] || null
                    }, n.prototype.getEnum = function(t) {
                        if (this.nested && this.nested[t] instanceof l) return this.nested[t].values;
                        throw Error("no such enum")
                    }, n.prototype.add = function(e) {
                        if (!(e instanceof c && e.extend !== t || e instanceof a || e instanceof l || e instanceof h || e instanceof n)) throw TypeError("object must be a valid nested object");
                        if (this.nested) {
                            var i = this.get(e.name);
                            if (i) {
                                if (!(i instanceof n && e instanceof n) || i instanceof a || i instanceof h) throw Error("duplicate name '" + e.name + "' in " + this);
                                for (var s = i.nestedArray, r = 0; r < s.length; ++r) e.add(s[r]);
                                this.remove(i), this.nested || (this.nested = {}), e.setOptions(i.options, !0)
                            }
                        } else this.nested = {};
                        return this.nested[e.name] = e, e.onAdd(this), o(this)
                    }, n.prototype.remove = function(e) {
                        if (!(e instanceof r)) throw TypeError("object must be a ReflectionObject");
                        if (e.parent !== this) throw Error(e + " is not a member of " + this);
                        return delete this.nested[e.name], Object.keys(this.nested).length || (this.nested = t), e.onRemove(this), o(this)
                    }, n.prototype.define = function(t, e) {
                        if (u.isString(t)) t = t.split(".");
                        else if (!Array.isArray(t)) throw TypeError("illegal path");
                        if (t && t.length && "" === t[0]) throw Error("path must be relative");
                        for (var i = this; t.length > 0;) {
                            var s = t.shift();
                            if (i.nested && i.nested[s]) {
                                if (!((i = i.nested[s]) instanceof n)) throw Error("path conflicts with non-namespace objects")
                            } else i.add(i = new n(s))
                        }
                        return e && i.addJSON(e), i
                    }, n.prototype.resolveAll = function() {
                        for (var t = this.nestedArray, e = 0; e < t.length;) t[e] instanceof n ? t[e++].resolveAll() : t[e++].resolve();
                        return this.resolve()
                    }, n.prototype.lookup = function(e, i, s) {
                        if ("boolean" == typeof i && (s = i, i = t), u.isString(e) && e.length) {
                            if ("." === e) return this.root;
                            e = e.split(".")
                        } else if (!e.length) return this;
                        if ("" === e[0]) return this.root.lookup(e.slice(1), i);
                        var o = this.get(e[0]);
                        if (o)
                            if (1 === e.length) {
                                if (!i || o instanceof i) return o
                            } else if (o instanceof n && (o = o.lookup(e.slice(1), i, !0))) return o;
                        return null === this.parent || s ? null : this.parent.lookup(e, i)
                    }, n.prototype.lookupType = function(t) {
                        var e = this.lookup(t, a);
                        if (!e) throw Error("no such type");
                        return e
                    }, n.prototype.lookupService = function(t) {
                        var e = this.lookup(t, h);
                        if (!e) throw Error("no such service");
                        return e
                    }, n.prototype.lookupEnum = function(t) {
                        var e = this.lookup(t, l);
                        if (!e) throw Error("no such enum");
                        return e.values
                    }, n.f = function(t, e) {
                        a = t, h = e
                    }
                }, {
                    15: 15,
                    16: 16,
                    24: 24,
                    36: 36
                }],
                24: [function(e, i) {
                    function s(t, e) {
                        if (!o.isString(t)) throw TypeError("name must be a string");
                        if (e && !o.isObject(e)) throw TypeError("options must be an object");
                        this.options = e, this.name = t, this.parent = null, this.resolved = !1, this.comment = null, this.filename = null
                    }
                    i.exports = s, s.className = "ReflectionObject";
                    var n, o = e(36);
                    Object.defineProperties(s.prototype, {
                        root: {
                            get: function() {
                                for (var t = this; null !== t.parent;) t = t.parent;
                                return t
                            }
                        },
                        fullName: {
                            get: function() {
                                for (var t = [this.name], e = this.parent; e;) t.unshift(e.name), e = e.parent;
                                return t.join(".")
                            }
                        }
                    }), s.prototype.toJSON = function() {
                        throw Error()
                    }, s.prototype.onAdd = function(t) {
                        this.parent && this.parent !== t && this.parent.remove(this), this.parent = t, this.resolved = !1;
                        var e = t.root;
                        e instanceof n && e.h(this)
                    }, s.prototype.onRemove = function(t) {
                        var e = t.root;
                        e instanceof n && e.i(this), this.parent = null, this.resolved = !1
                    }, s.prototype.resolve = function() {
                        return this.resolved ? this : (this.root instanceof n && (this.resolved = !0), this)
                    }, s.prototype.getOption = function(e) {
                        return this.options ? this.options[e] : t
                    }, s.prototype.setOption = function(e, i, s) {
                        return s && this.options && this.options[e] !== t || ((this.options || (this.options = {}))[e] = i), this
                    }, s.prototype.setOptions = function(t, e) {
                        if (t)
                            for (var i = Object.keys(t), s = 0; s < i.length; ++s) this.setOption(i[s], t[i[s]], e);
                        return this
                    }, s.prototype.toString = function() {
                        var t = this.constructor.className,
                            e = this.fullName;
                        return e.length ? t + " " + e : t
                    }, s.f = function(t) {
                        n = t
                    }
                }, {
                    36: 36
                }],
                25: [function(e, i) {
                    function s(e, i, s) {
                        if (Array.isArray(i) || (s = i, i = t), o.call(this, e, s), i !== t && !Array.isArray(i)) throw TypeError("fieldNames must be an Array");
                        this.oneof = i || [], this.fieldsArray = []
                    }

                    function n(t) {
                        if (t.parent)
                            for (var e = 0; e < t.fieldsArray.length; ++e) t.fieldsArray[e].parent || t.parent.add(t.fieldsArray[e])
                    }
                    i.exports = s;
                    var o = e(24);
                    ((s.prototype = Object.create(o.prototype)).constructor = s).className = "OneOf";
                    var r = e(16);
                    s.fromJSON = function(t, e) {
                        return new s(t, e.oneof, e.options)
                    }, s.prototype.toJSON = function() {
                        return {
                            oneof: this.oneof,
                            options: this.options
                        }
                    }, s.prototype.add = function(t) {
                        if (!(t instanceof r)) throw TypeError("field must be a Field");
                        return t.parent && t.parent !== this.parent && t.parent.remove(t), this.oneof.push(t.name), this.fieldsArray.push(t), t.partOf = this, n(this), this
                    }, s.prototype.remove = function(t) {
                        if (!(t instanceof r)) throw TypeError("field must be a Field");
                        var e = this.fieldsArray.indexOf(t);
                        if (e < 0) throw Error(t + " is not a member of " + this);
                        return this.fieldsArray.splice(e, 1), (e = this.oneof.indexOf(t.name)) > -1 && this.oneof.splice(e, 1), t.partOf = null, this
                    }, s.prototype.onAdd = function(t) {
                        o.prototype.onAdd.call(this, t);
                        for (var e = 0; e < this.oneof.length; ++e) {
                            var i = t.get(this.oneof[e]);
                            i && !i.partOf && (i.partOf = this, this.fieldsArray.push(i))
                        }
                        n(this)
                    }, s.prototype.onRemove = function(t) {
                        for (var e, i = 0; i < this.fieldsArray.length; ++i)(e = this.fieldsArray[i]).parent && e.parent.remove(e);
                        o.prototype.onRemove.call(this, t)
                    }
                }, {
                    16: 16,
                    24: 24
                }],
                26: [function(e, i) {
                    function s(t) {
                        return /^[a-zA-Z_][a-zA-Z_0-9]*$/.test(t)
                    }

                    function n(t) {
                        return /^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/.test(t)
                    }

                    function o(t) {
                        return null === t ? null : t.toLowerCase()
                    }

                    function r(t) {
                        return t.substring(0, 1) + t.substring(1).replace(/_([a-z])(?=[a-z]|$)/g, function(t, e) {
                            return e.toUpperCase()
                        })
                    }

                    function a(e, i, b) {
                        function _(t, e, i) {
                            var s = a.filename;
                            return i || (a.filename = null), Error("illegal " + (e || "token") + " '" + t + "' (" + (s ? s + ", " : "") + "line " + H.line() + ")")
                        }

                        function w() {
                            var t, e = [];
                            do {
                                if ('"' !== (t = X()) && "'" !== t) throw _(t);
                                e.push(X()), z(t), t = Y()
                            } while ('"' === t || "'" === t);
                            return e.join("")
                        }

                        function x(t) {
                            var e = X();
                            switch (o(e)) {
                                case "'":
                                case '"':
                                    return V(e), w();
                                case "true":
                                    return !0;
                                case "false":
                                    return !1
                            }
                            try {
                                return function(t, e) {
                                    var i = 1;
                                    "-" === t.charAt(0) && (i = -1, t = t.substring(1));
                                    var s = o(t);
                                    switch (s) {
                                        case "inf":
                                            return i * (1 / 0);
                                        case "nan":
                                            return NaN;
                                        case "0":
                                            return 0
                                    }
                                    if (/^[1-9][0-9]*$/.test(t)) return i * parseInt(t, 10);
                                    if (/^0[x][0-9a-f]+$/.test(s)) return i * parseInt(t, 16);
                                    if (/^0[0-7]+$/.test(t)) return i * parseInt(t, 8);
                                    if (/^(?!e)[0-9]*(?:\.[0-9]*)?(?:[e][+-]?[0-9]+)?$/.test(s)) return i * parseFloat(t);
                                    throw _(t, "number", e)
                                }(e, !0)
                            } catch (i) {
                                if (t && n(e)) return e;
                                throw _(e, "value")
                            }
                        }

                        function P(t, e) {
                            var i, s;
                            do {
                                !e || '"' !== (i = Y()) && "'" !== i ? t.push([s = T(X()), z("to", !0) ? T(X()) : s]) : t.push(w())
                            } while (z(",", !0));
                            z(";")
                        }

                        function T(t, e) {
                            var i = o(t);
                            switch (i) {
                                case "max":
                                    return 536870911;
                                case "0":
                                    return 0
                            }
                            if ("-" === t.charAt(0) && !e) throw _(t, "id");
                            if (/^-?[1-9][0-9]*$/.test(t)) return parseInt(t, 10);
                            if (/^-?0[x][0-9a-f]+$/.test(i)) return parseInt(t, 16);
                            if (/^-?0[0-7]+$/.test(t)) return parseInt(t, 8);
                            throw _(t, "id")
                        }

                        function C() {
                            if (N !== t) throw _("package");
                            if (!n(N = X())) throw _(N, "name");
                            Z = Z.define(N), z(";")
                        }

                        function S() {
                            var t, e = Y();
                            switch (e) {
                                case "weak":
                                    t = j || (j = []), X();
                                    break;
                                case "public":
                                    X();
                                default:
                                    t = G || (G = [])
                            }
                            e = w(), z(";"), t.push(e)
                        }

                        function A() {
                            if (z("="), W = o(w()), !(Q = "proto3" === W) && "proto2" !== W) throw _(W, "syntax");
                            z(";")
                        }

                        function E(t, e) {
                            switch (e) {
                                case "option":
                                    return I(t, e), z(";"), !0;
                                case "message":
                                    return function(t, e) {
                                        var i = X();
                                        if (!s(i)) throw _(i, "type name");
                                        var r = new c(i);
                                        if (r.comment = K(), r.filename = a.filename, z("{", !0)) {
                                            for (;
                                                "}" !== (e = X());) {
                                                var h = o(e);
                                                if (!E(r, e)) switch (h) {
                                                    case "map":
                                                        O(r);
                                                        break;
                                                    case "required":
                                                    case "optional":
                                                    case "repeated":
                                                        k(r, h);
                                                        break;
                                                    case "oneof":
                                                        R(r, h);
                                                        break;
                                                    case "extensions":
                                                        P(r.extensions || (r.extensions = []));
                                                        break;
                                                    case "reserved":
                                                        P(r.reserved || (r.reserved = []), !0);
                                                        break;
                                                    default:
                                                        if (!Q || !n(e)) throw _(e);
                                                        V(e), k(r, "optional")
                                                }
                                            }
                                            z(";", !0)
                                        } else z(";");
                                        t.add(r)
                                    }(t, e), !0;
                                case "enum":
                                    return function(t, e) {
                                        var i = X();
                                        if (!s(i)) throw _(i, "name");
                                        var n = new f(i);
                                        if (n.comment = K(), n.filename = a.filename, z("{", !0)) {
                                            for (;
                                                "}" !== (e = X());) "option" === o(e) ? (I(n, e), z(";")) : B(n, e);
                                            z(";", !0)
                                        } else z(";");
                                        t.add(n)
                                    }(t, e), !0;
                                case "service":
                                    return function(t, e) {
                                        if (!s(e = X())) throw _(e, "service name");
                                        var i = new m(e);
                                        if (i.comment = K(), i.filename = a.filename, z("{", !0)) {
                                            for (;
                                                "}" !== (e = X());) {
                                                var n = o(e);
                                                switch (n) {
                                                    case "option":
                                                        I(i, n), z(";");
                                                        break;
                                                    case "rpc":
                                                        U(i, n);
                                                        break;
                                                    default:
                                                        throw _(e)
                                                }
                                            }
                                            z(";", !0)
                                        } else z(";");
                                        t.add(i)
                                    }(t, e), !0;
                                case "extend":
                                    return function(t, e) {
                                        var i = X();
                                        if (!n(i)) throw _(i, "reference");
                                        if (z("{", !0)) {
                                            for (;
                                                "}" !== (e = X());) {
                                                var s = o(e);
                                                switch (s) {
                                                    case "required":
                                                    case "repeated":
                                                    case "optional":
                                                        k(t, s, i);
                                                        break;
                                                    default:
                                                        if (!Q || !n(e)) throw _(e);
                                                        V(e), k(t, "optional", i)
                                                }
                                            }
                                            z(";", !0)
                                        } else z(";")
                                    }(t, e), !0
                            }
                            return !1
                        }

                        function k(e, i, o) {
                            var r = X();
                            if ("group" === r) return M(e, i), t;
                            if (!n(r)) throw _(r, "type");
                            var h = X();
                            if (!s(h)) throw _(h, "name");
                            h = $(h), z("=");
                            var l = new u(h, T(X()), r, i, o),
                                c = H.line();
                            l.comment = K(), l.filename = a.filename, F(l), l.comment || (l.comment = K(c)), !Q && l.repeated && l.setOption("packed", !1, !0), e.add(l)
                        }

                        function M(t, e) {
                            var i = X();
                            if (!s(i)) throw _(i, "name");
                            var n = v.lcFirst(i);
                            i === n && (i = v.ucFirst(i)), z("=");
                            var r = T(X()),
                                h = new c(i);
                            h.group = !0, h.comment = K();
                            var l = new u(n, r, i, e);
                            for (h.filename = l.filename = a.filename, z("{");
                                "}" !== (q = X());) switch (q = o(q)) {
                                case "option":
                                    I(h, q), z(";");
                                    break;
                                case "required":
                                case "optional":
                                case "repeated":
                                    k(h, q);
                                    break;
                                default:
                                    throw _(q)
                            }
                            z(";", !0), t.add(h).add(l)
                        }

                        function O(e) {
                            z("<");
                            var i = X();
                            if (y.mapKey[i] === t) throw _(i, "type");
                            z(",");
                            var o = X();
                            if (!n(o)) throw _(o, "type");
                            z(">");
                            var r = X();
                            if (!s(r)) throw _(r, "name");
                            r = $(r), z("=");
                            var h = new d(r, T(X()), i, o),
                                l = H.line();
                            h.comment = K(), h.filename = a.filename, F(h), h.comment || (h.comment = K(l)), e.add(h)
                        }

                        function R(t, e) {
                            var i = X();
                            if (!s(i)) throw _(i, "name");
                            i = $(i);
                            var n = new p(i),
                                o = H.line();
                            if (n.comment = K(), n.filename = a.filename, z("{", !0)) {
                                for (;
                                    "}" !== (e = X());) "option" === e ? (I(n, e), z(";")) : (V(e), k(n, "optional"));
                                z(";", !0)
                            } else z(";"), n.comment || (n.comment = K(o));
                            t.add(n)
                        }

                        function B(t, e) {
                            if (!s(e)) throw _(e, "name");
                            var i = e;
                            z("=");
                            var n = T(X(), !0),
                                o = H.line();
                            t.add(i, n, K()), F({}), t.comments[i] || (t.comments[i] = K(o))
                        }

                        function I(t, e) {
                            var i = z("(", !0),
                                s = X();
                            if (!n(s)) throw _(s, "name");
                            i && (z(")"), s = "(" + s + ")", function(t) {
                                return /^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/.test(t)
                            }(e = Y()) && (s += e, X())), z("="), L(t, s)
                        }

                        function L(t, e) {
                            if (z("{", !0))
                                do {
                                    if (!s(q = X())) throw _(q, "name");
                                    "{" === Y() ? L(t, e + "." + q) : (z(":"), D(t, e + "." + q, x(!0)))
                                } while (!z("}", !0));
                            else D(t, e, x(!0))
                        }

                        function D(t, e, i) {
                            t.setOption && t.setOption(e, i)
                        }

                        function F(t) {
                            if (z("[", !0)) {
                                do {
                                    I(t, "option")
                                } while (z(",", !0));
                                z("]")
                            }
                            return z(";"), t
                        }

                        function U(t, e) {
                            var i, r, h, l, c = e,
                                u = X();
                            if (!s(u)) throw _(u, "name");
                            if (z("("), z("stream", !0) && (r = !0), !n(e = X())) throw _(e);
                            if (i = e, z(")"), z("returns"), z("("), z("stream", !0) && (l = !0), !n(e = X())) throw _(e);
                            h = e, z(")");
                            var d = new g(u, c, i, h, r, l),
                                p = H.line();
                            if (d.comment = K(), d.filename = a.filename, z("{", !0)) {
                                for (;
                                    "}" !== (e = X());) {
                                    var f = o(e);
                                    switch (f) {
                                        case "option":
                                            I(d, f), z(";");
                                            break;
                                        default:
                                            throw _(e)
                                    }
                                }
                                z(";", !0)
                            } else z(";"), d.comment || (d.comment = K(p));
                            t.add(d)
                        }
                        i instanceof l || (b = i, i = new l), b || (b = a.defaults);
                        for (var N, G, j, W, q, H = h(e), X = H.next, V = H.push, Y = H.peek, z = H.skip, K = H.cmnt, J = !0, Q = !1, Z = i, $ = b.keepCase ? function(t) {
                                return t
                            } : r; null !== (q = X());) switch (o(q)) {
                            case "package":
                                if (!J) throw _(q);
                                C();
                                break;
                            case "import":
                                if (!J) throw _(q);
                                S();
                                break;
                            case "syntax":
                                if (!J) throw _(q);
                                A();
                                break;
                            case "option":
                                if (!J) throw _(q);
                                I(Z, q), z(";");
                                break;
                            default:
                                if (E(Z, q)) {
                                    J = !1;
                                    continue
                                }
                                throw _(q)
                        }
                        return a.filename = null, {
                            package: N,
                            imports: G,
                            weakImports: j,
                            syntax: W,
                            root: i
                        }
                    }
                    i.exports = a, a.filename = null, a.defaults = {
                        keepCase: !1
                    };
                    var h = e(33),
                        l = e(29),
                        c = e(34),
                        u = e(16),
                        d = e(20),
                        p = e(25),
                        f = e(15),
                        m = e(32),
                        g = e(22),
                        y = e(35),
                        v = e(36)
                }, {
                    15: 15,
                    16: 16,
                    20: 20,
                    22: 22,
                    25: 25,
                    29: 29,
                    32: 32,
                    33: 33,
                    34: 34,
                    35: 35,
                    36: 36
                }],
                27: [function(t, e) {
                    function i(t, e) {
                        return RangeError("index out of range: " + t.pos + " + " + (e || 1) + " > " + t.len)
                    }

                    function s(t) {
                        this.buf = t, this.pos = 0, this.len = t.length
                    }

                    function n() {
                        var t = new b(0, 0),
                            e = 0;
                        if (!(this.len - this.pos > 4)) {
                            for (; e < 3; ++e) {
                                if (this.pos >= this.len) throw i(this);
                                if (t.lo = (t.lo | (127 & this.buf[this.pos]) << 7 * e) >>> 0, this.buf[this.pos++] < 128) return t
                            }
                            return t.lo = (t.lo | (127 & this.buf[this.pos++]) << 7 * e) >>> 0, t
                        }
                        for (; e < 4; ++e)
                            if (t.lo = (t.lo | (127 & this.buf[this.pos]) << 7 * e) >>> 0, this.buf[this.pos++] < 128) return t;
                        if (t.lo = (t.lo | (127 & this.buf[this.pos]) << 28) >>> 0, t.hi = (t.hi | (127 & this.buf[this.pos]) >> 4) >>> 0, this.buf[this.pos++] < 128) return t;
                        if (e = 0, this.len - this.pos > 4) {
                            for (; e < 5; ++e)
                                if (t.hi = (t.hi | (127 & this.buf[this.pos]) << 7 * e + 3) >>> 0, this.buf[this.pos++] < 128) return t
                        } else
                            for (; e < 5; ++e) {
                                if (this.pos >= this.len) throw i(this);
                                if (t.hi = (t.hi | (127 & this.buf[this.pos]) << 7 * e + 3) >>> 0, this.buf[this.pos++] < 128) return t
                            }
                        throw Error("invalid varint encoding")
                    }

                    function o() {
                        return n.call(this).toLong()
                    }

                    function r() {
                        return n.call(this).toNumber()
                    }

                    function a() {
                        return n.call(this).toLong(!0)
                    }

                    function h() {
                        return n.call(this).toNumber(!0)
                    }

                    function l() {
                        return n.call(this).zzDecode().toLong()
                    }

                    function c() {
                        return n.call(this).zzDecode().toNumber()
                    }

                    function u(t, e) {
                        return (t[e - 4] | t[e - 3] << 8 | t[e - 2] << 16 | t[e - 1] << 24) >>> 0
                    }

                    function d() {
                        if (this.pos + 8 > this.len) throw i(this, 8);
                        return new b(u(this.buf, this.pos += 4), u(this.buf, this.pos += 4))
                    }

                    function p() {
                        return d.call(this).toLong(!0)
                    }

                    function f() {
                        return d.call(this).toNumber(!0)
                    }

                    function m() {
                        return d.call(this).toLong(!1)
                    }

                    function g() {
                        return d.call(this).toNumber(!1)
                    }
                    e.exports = s;
                    var y, v = t(38),
                        b = v.LongBits,
                        _ = v.utf8;
                    s.create = v.Buffer ? function(t) {
                        return (s.create = function(t) {
                            return v.Buffer.isBuffer(t) ? new y(t) : new s(t)
                        })(t)
                    } : function(t) {
                        return new s(t)
                    }, s.prototype.j = v.Array.prototype.subarray || v.Array.prototype.slice, s.prototype.uint32 = function() {
                        var t = 4294967295;
                        return function() {
                            if (t = (127 & this.buf[this.pos]) >>> 0, this.buf[this.pos++] < 128) return t;
                            if (t = (t | (127 & this.buf[this.pos]) << 7) >>> 0, this.buf[this.pos++] < 128) return t;
                            if (t = (t | (127 & this.buf[this.pos]) << 14) >>> 0, this.buf[this.pos++] < 128) return t;
                            if (t = (t | (127 & this.buf[this.pos]) << 21) >>> 0, this.buf[this.pos++] < 128) return t;
                            if (t = (t | (15 & this.buf[this.pos]) << 28) >>> 0, this.buf[this.pos++] < 128) return t;
                            if ((this.pos += 5) > this.len) throw this.pos = this.len, i(this, 10);
                            return t
                        }
                    }(), s.prototype.int32 = function() {
                        return 0 | this.uint32()
                    }, s.prototype.sint32 = function() {
                        var t = this.uint32();
                        return t >>> 1 ^ -(1 & t) | 0
                    }, s.prototype.bool = function() {
                        return 0 !== this.uint32()
                    }, s.prototype.fixed32 = function() {
                        if (this.pos + 4 > this.len) throw i(this, 4);
                        return u(this.buf, this.pos += 4)
                    }, s.prototype.sfixed32 = function() {
                        if (this.pos + 4 > this.len) throw i(this, 4);
                        return 0 | u(this.buf, this.pos += 4)
                    };
                    var w = "undefined" != typeof Float32Array ? function() {
                        var t = new Float32Array(1),
                            e = new Uint8Array(t.buffer);
                        return t[0] = -0, e[3] ? function(i, s) {
                            return e[0] = i[s], e[1] = i[s + 1], e[2] = i[s + 2], e[3] = i[s + 3], t[0]
                        } : function(i, s) {
                            return e[3] = i[s], e[2] = i[s + 1], e[1] = i[s + 2], e[0] = i[s + 3], t[0]
                        }
                    }() : function(t, e) {
                        var i = u(t, e + 4),
                            s = 2 * (i >> 31) + 1,
                            n = i >>> 23 & 255,
                            o = 8388607 & i;
                        return 255 === n ? o ? NaN : s * (1 / 0) : 0 === n ? 1.401298464324817e-45 * s * o : s * Math.pow(2, n - 150) * (o + 8388608)
                    };
                    s.prototype.float = function() {
                        if (this.pos + 4 > this.len) throw i(this, 4);
                        var t = w(this.buf, this.pos);
                        return this.pos += 4, t
                    };
                    var x = "undefined" != typeof Float64Array ? function() {
                        var t = new Float64Array(1),
                            e = new Uint8Array(t.buffer);
                        return t[0] = -0, e[7] ? function(i, s) {
                            return e[0] = i[s], e[1] = i[s + 1], e[2] = i[s + 2], e[3] = i[s + 3], e[4] = i[s + 4], e[5] = i[s + 5], e[6] = i[s + 6], e[7] = i[s + 7], t[0]
                        } : function(i, s) {
                            return e[7] = i[s], e[6] = i[s + 1], e[5] = i[s + 2], e[4] = i[s + 3], e[3] = i[s + 4], e[2] = i[s + 5], e[1] = i[s + 6], e[0] = i[s + 7], t[0]
                        }
                    }() : function(t, e) {
                        var i = u(t, e + 4),
                            s = u(t, e + 8),
                            n = 2 * (s >> 31) + 1,
                            o = s >>> 20 & 2047,
                            r = 4294967296 * (1048575 & s) + i;
                        return 2047 === o ? r ? NaN : n * (1 / 0) : 0 === o ? 5e-324 * n * r : n * Math.pow(2, o - 1075) * (r + 4503599627370496)
                    };
                    s.prototype.double = function() {
                        if (this.pos + 8 > this.len) throw i(this, 4);
                        var t = x(this.buf, this.pos);
                        return this.pos += 8, t
                    }, s.prototype.bytes = function() {
                        var t = this.uint32(),
                            e = this.pos,
                            s = this.pos + t;
                        if (s > this.len) throw i(this, t);
                        return this.pos += t, e === s ? new this.buf.constructor(0) : this.j.call(this.buf, e, s)
                    }, s.prototype.string = function() {
                        var t = this.bytes();
                        return _.read(t, 0, t.length)
                    }, s.prototype.skip = function(t) {
                        if ("number" == typeof t) {
                            if (this.pos + t > this.len) throw i(this, t);
                            this.pos += t
                        } else
                            do {
                                if (this.pos >= this.len) throw i(this)
                            } while (128 & this.buf[this.pos++]);
                        return this
                    }, s.prototype.skipType = function(t) {
                        switch (t) {
                            case 0:
                                this.skip();
                                break;
                            case 1:
                                this.skip(8);
                                break;
                            case 2:
                                this.skip(this.uint32());
                                break;
                            case 3:
                                for (; 4 != (t = 7 & this.uint32());) this.skipType(t);
                                break;
                            case 5:
                                this.skip(4);
                                break;
                            default:
                                throw Error("invalid wire type " + t + " at offset " + this.pos)
                        }
                        return this
                    }, s.f = function(t) {
                        y = t, v.Long ? (s.prototype.int64 = o, s.prototype.uint64 = a, s.prototype.sint64 = l, s.prototype.fixed64 = p, s.prototype.sfixed64 = m) : (s.prototype.int64 = r, s.prototype.uint64 = h, s.prototype.sint64 = c, s.prototype.fixed64 = f, s.prototype.sfixed64 = g)
                    }
                }, {
                    38: 38
                }],
                28: [function(t, e) {
                    function i(t) {
                        s.call(this, t)
                    }
                    e.exports = i;
                    var s = t(27);
                    (i.prototype = Object.create(s.prototype)).constructor = i;
                    var n = t(38);
                    n.Buffer && (i.prototype.j = n.Buffer.prototype.slice), i.prototype.string = function() {
                        var t = this.uint32();
                        return this.buf.utf8Slice(this.pos, this.pos = Math.min(this.pos + t, this.len))
                    }
                }, {
                    27: 27,
                    38: 38
                }],
                29: [function(e, i) {
                    function s(t) {
                        r.call(this, "", t), this.deferred = [], this.files = []
                    }

                    function n() {}

                    function o(e, i) {
                        var s = i.parent.lookup(i.extend);
                        if (s) {
                            var n = new c(i.fullName, i.id, i.type, i.rule, t, i.options);
                            return n.declaringField = i, i.extensionField = n, s.add(n), !0
                        }
                        return !1
                    }
                    i.exports = s;
                    var r = e(23);
                    ((s.prototype = Object.create(r.prototype)).constructor = s).className = "Root";
                    var a, h, l, c = e(16),
                        u = e(15),
                        d = e(36);
                    s.fromJSON = function(t, e) {
                        return e || (e = new s), t.options && e.setOptions(t.options), e.addJSON(t.nested)
                    }, s.prototype.resolvePath = d.path.resolve, s.prototype.load = function e(i, s, o) {
                        function r(t, e) {
                            if (o) {
                                var i = o;
                                if (o = null, p) throw t;
                                i(t, e)
                            }
                        }

                        function a(t, e) {
                            try {
                                if (d.isString(e) && "{" === e.charAt(0) && (e = JSON.parse(e)), d.isString(e)) {
                                    h.filename = t;
                                    var i, n = h(e, u, s),
                                        o = 0;
                                    if (n.imports)
                                        for (; o < n.imports.length; ++o)(i = u.resolvePath(t, n.imports[o])) && c(i);
                                    if (n.weakImports)
                                        for (o = 0; o < n.weakImports.length; ++o)(i = u.resolvePath(t, n.weakImports[o])) && c(i, !0)
                                } else u.setOptions(e.options).addJSON(e.nested)
                            } catch (t) {
                                r(t)
                            }
                            p || f || r(null, u)
                        }

                        function c(e, i) {
                            var s = e.lastIndexOf("google/protobuf/");
                            if (s > -1) {
                                var n = e.substring(s);
                                n in l && (e = n)
                            }
                            if (!(u.files.indexOf(e) > -1)) {
                                if (u.files.push(e), e in l) return p ? a(e, l[e]) : (++f, setTimeout(function() {
                                    --f, a(e, l[e])
                                })), t;
                                if (p) {
                                    var h;
                                    try {
                                        h = d.fs.readFileSync(e).toString("utf8")
                                    } catch (e) {
                                        return i || r(e), t
                                    }
                                    a(e, h)
                                } else ++f, d.fetch(e, function(s, n) {
                                    if (--f, o) return s ? (i ? f || r(null, u) : r(s), t) : (a(e, n), t)
                                })
                            }
                        }
                        "function" == typeof s && (o = s, s = t);
                        var u = this;
                        if (!o) return d.asPromise(e, u, i);
                        var p = o === n,
                            f = 0;
                        d.isString(i) && (i = [i]);
                        for (var m, g = 0; g < i.length; ++g)(m = u.resolvePath("", i[g])) && c(m);
                        return p ? u : (f || r(null, u), t)
                    }, s.prototype.loadSync = function(t, e) {
                        if (!d.isNode) throw Error("not supported");
                        return this.load(t, e, n)
                    }, s.prototype.resolveAll = function() {
                        if (this.deferred.length) throw Error("unresolvable extensions: " + this.deferred.map(function(t) {
                            return "'extend " + t.extend + "' in " + t.parent.fullName
                        }).join(", "));
                        return r.prototype.resolveAll.call(this)
                    };
                    var p = /^[A-Z]/;
                    s.prototype.h = function(e) {
                        if (e instanceof c) e.extend === t || e.extensionField || o(0, e) || this.deferred.push(e);
                        else if (e instanceof u) p.test(e.name) && (e.parent[e.name] = e.values);
                        else {
                            if (e instanceof a)
                                for (var i = 0; i < this.deferred.length;) o(0, this.deferred[i]) ? this.deferred.splice(i, 1) : ++i;
                            for (var s = 0; s < e.nestedArray.length; ++s) this.h(e.g[s]);
                            p.test(e.name) && (e.parent[e.name] = e)
                        }
                    }, s.prototype.i = function(e) {
                        if (e instanceof c) {
                            if (e.extend !== t)
                                if (e.extensionField) e.extensionField.parent.remove(e.extensionField), e.extensionField = null;
                                else {
                                    var i = this.deferred.indexOf(e);
                                    i > -1 && this.deferred.splice(i, 1)
                                }
                        } else if (e instanceof u) p.test(e.name) && delete e.parent[e.name];
                        else if (e instanceof r) {
                            for (var s = 0; s < e.nestedArray.length; ++s) this.i(e.g[s]);
                            p.test(e.name) && delete e.parent[e.name]
                        }
                    }, s.f = function(t, e, i) {
                        a = t, h = e, l = i
                    }
                }, {
                    15: 15,
                    16: 16,
                    23: 23,
                    36: 36
                }],
                30: [function(t, e, i) {
                    i.Service = t(31)
                }, {
                    31: 31
                }],
                31: [function(e, i) {
                    function s(t, e, i) {
                        if ("function" != typeof t) throw TypeError("rpcImpl must be a function");
                        n.EventEmitter.call(this), this.rpcImpl = t, this.requestDelimited = !!e, this.responseDelimited = !!i
                    }
                    i.exports = s;
                    var n = e(38);
                    (s.prototype = Object.create(n.EventEmitter.prototype)).constructor = s, s.prototype.rpcCall = function e(i, s, o, r, a) {
                        if (!r) throw TypeError("request must be specified");
                        var h = this;
                        if (!a) return n.asPromise(e, h, i, s, o, r);
                        if (!h.rpcImpl) return setTimeout(function() {
                            a(Error("already ended"))
                        }, 0), t;
                        try {
                            return h.rpcImpl(i, s[h.requestDelimited ? "encodeDelimited" : "encode"](r).finish(), function(e, s) {
                                if (e) return h.emit("error", e, i), a(e);
                                if (null === s) return h.end(!0), t;
                                if (!(s instanceof o)) try {
                                    s = o[h.responseDelimited ? "decodeDelimited" : "decode"](s)
                                } catch (e) {
                                    return h.emit("error", e, i), a(e)
                                }
                                return h.emit("data", s, i), a(null, s)
                            })
                        } catch (e) {
                            return h.emit("error", e, i), setTimeout(function() {
                                a(e)
                            }, 0), t
                        }
                    }, s.prototype.end = function(t) {
                        return this.rpcImpl && (t || this.rpcImpl(null, null, null), this.rpcImpl = null, this.emit("end").off()), this
                    }
                }, {
                    38: 38
                }],
                32: [function(e, i) {
                    function s(t, e) {
                        o.call(this, t, e), this.methods = {}, this.k = null
                    }

                    function n(t) {
                        return t.k = null, t
                    }
                    i.exports = s;
                    var o = e(23);
                    ((s.prototype = Object.create(o.prototype)).constructor = s).className = "Service";
                    var r = e(22),
                        a = e(36),
                        h = e(30);
                    s.fromJSON = function(t, e) {
                        var i = new s(t, e.options);
                        if (e.methods)
                            for (var n = Object.keys(e.methods), o = 0; o < n.length; ++o) i.add(r.fromJSON(n[o], e.methods[n[o]]));
                        return i
                    }, Object.defineProperty(s.prototype, "methodsArray", {
                        get: function() {
                            return this.k || (this.k = a.toArray(this.methods))
                        }
                    }), s.prototype.toJSON = function() {
                        var e = o.prototype.toJSON.call(this);
                        return {
                            options: e && e.options || t,
                            methods: o.arrayToJSON(this.methodsArray) || {},
                            nested: e && e.nested || t
                        }
                    }, s.prototype.get = function(t) {
                        return this.methods[t] || o.prototype.get.call(this, t)
                    }, s.prototype.resolveAll = function() {
                        for (var t = this.methodsArray, e = 0; e < t.length; ++e) t[e].resolve();
                        return o.prototype.resolve.call(this)
                    }, s.prototype.add = function(t) {
                        if (this.get(t.name)) throw Error("duplicate name '" + t.name + "' in " + this);
                        return t instanceof r ? (this.methods[t.name] = t, t.parent = this, n(this)) : o.prototype.add.call(this, t)
                    }, s.prototype.remove = function(t) {
                        if (t instanceof r) {
                            if (this.methods[t.name] !== t) throw Error(t + " is not a member of " + this);
                            return delete this.methods[t.name], t.parent = null, n(this)
                        }
                        return o.prototype.remove.call(this, t)
                    }, s.prototype.create = function(t, e, i) {
                        for (var s = new h.Service(t, e, i), n = 0; n < this.methodsArray.length; ++n) s[a.lcFirst(this.k[n].resolve().name)] = a.codegen("r", "c")("return this.rpcCall(m,q,s,r,c)").eof(a.lcFirst(this.k[n].name), {
                            m: this.k[n],
                            q: this.k[n].resolvedRequestType.ctor,
                            s: this.k[n].resolvedResponseType.ctor
                        });
                        return s
                    }
                }, {
                    22: 22,
                    23: 23,
                    30: 30,
                    36: 36
                }],
                33: [function(e, i) {
                    function s(t) {
                        return t.replace(/\\(.?)/g, function(t, e) {
                            switch (e) {
                                case "\\":
                                case "":
                                    return e;
                                default:
                                    return s.map[e] || ""
                            }
                        })
                    }

                    function n(e) {
                        function i(t) {
                            return Error("illegal " + t + " (line " + m + ")")
                        }

                        function n() {
                            var t = "'" === _ ? a : r;
                            t.lastIndex = p - 1;
                            var n = t.exec(e);
                            if (!n) throw i("string");
                            return p = t.lastIndex, u(_), _ = null, s(n[1])
                        }

                        function h(t) {
                            return e.charAt(t)
                        }

                        function l(t, i) {
                            g = e.charAt(t++), v = m;
                            for (var s = e.substring(t, i).split(/\n/g), n = 0; n < s.length; ++n) s[n] = s[n].replace(/^ *[*\/]+ */, "").trim();
                            y = s.join("\n").trim()
                        }

                        function c() {
                            if (b.length > 0) return b.shift();
                            if (_) return n();
                            var t, s, r, a, c;
                            do {
                                if (p === f) return null;
                                for (t = !1;
                                    /\s/.test(r = h(p));)
                                    if ("\n" === r && ++m, ++p === f) return null;
                                if ("/" === h(p)) {
                                    if (++p === f) throw i("comment");
                                    if ("/" === h(p)) {
                                        for (c = "/" === h(a = p + 1);
                                            "\n" !== h(++p);)
                                            if (p === f) return null;
                                        ++p, c && l(a, p - 1), ++m, t = !0
                                    } else {
                                        if ("*" !== (r = h(p))) return "/";
                                        c = "*" === h(a = p + 1);
                                        do {
                                            if ("\n" === r && ++m, ++p === f) throw i("comment");
                                            s = r, r = h(p)
                                        } while ("*" !== s || "/" !== r);
                                        ++p, c && l(a, p - 2), t = !0
                                    }
                                }
                            } while (t);
                            var u = p;
                            if (o.lastIndex = 0, !o.test(h(u++)))
                                for (; u < f && !o.test(h(u));) ++u;
                            var d = e.substring(p, p = u);
                            return '"' !== d && "'" !== d || (_ = d), d
                        }

                        function u(t) {
                            b.push(t)
                        }

                        function d() {
                            if (!b.length) {
                                var t = c();
                                if (null === t) return null;
                                u(t)
                            }
                            return b[0]
                        }
                        var p = 0,
                            f = (e = "" + e).length,
                            m = 1,
                            g = null,
                            y = null,
                            v = 0,
                            b = [],
                            _ = null;
                        return {
                            next: c,
                            peek: d,
                            push: u,
                            skip: function(t, e) {
                                var s = d();
                                if (s === t) return c(), !0;
                                if (!e) throw i("token '" + s + "', '" + t + "' expected");
                                return !1
                            },
                            line: function() {
                                return m
                            },
                            cmnt: function(e) {
                                var i;
                                return e === t ? i = v === m - 1 && y || null : (y || d(), i = v === e && "/" === g && y || null), i && (g = y = null, v = 0), i
                            }
                        }
                    }
                    i.exports = n;
                    var o = /[\s{}=;:[\],'"()<>]/g,
                        r = /(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,
                        a = /(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g;
                    s.map = {
                        0: "\0",
                        r: "\r",
                        n: "\n",
                        t: "\t"
                    }, n.unescape = s
                }, {}],
                34: [function(e, i) {
                    function s(e, i) {
                        o.call(this, e, i), this.fields = {}, this.oneofs = t, this.extensions = t, this.reserved = t, this.group = t, this.l = null, this.b = null, this.d = null, this.o = null
                    }

                    function n(t) {
                        return t.l = t.b = t.d = t.o = null, delete t.encode, delete t.decode, delete t.verify, t
                    }
                    i.exports = s;
                    var o = e(23);
                    ((s.prototype = Object.create(o.prototype)).constructor = s).className = "Type";
                    var r = e(15),
                        a = e(25),
                        h = e(16),
                        l = e(20),
                        c = e(32),
                        u = e(10),
                        d = e(21),
                        p = e(27),
                        f = e(40),
                        m = e(36),
                        g = e(14),
                        y = e(13),
                        v = e(39),
                        b = e(12);
                    s.fromJSON = function(e, i) {
                        var n = new s(e, i.options);
                        n.extensions = i.extensions, n.reserved = i.reserved;
                        for (var u = Object.keys(i.fields), d = 0; d < u.length; ++d) n.add((t !== i.fields[u[d]].keyType ? l.fromJSON : h.fromJSON)(u[d], i.fields[u[d]]));
                        if (i.oneofs)
                            for (u = Object.keys(i.oneofs), d = 0; d < u.length; ++d) n.add(a.fromJSON(u[d], i.oneofs[u[d]]));
                        if (i.nested)
                            for (u = Object.keys(i.nested), d = 0; d < u.length; ++d) {
                                var p = i.nested[u[d]];
                                n.add((p.id !== t ? h.fromJSON : p.fields !== t ? s.fromJSON : p.values !== t ? r.fromJSON : p.methods !== t ? c.fromJSON : o.fromJSON)(u[d], p))
                            }
                        return i.extensions && i.extensions.length && (n.extensions = i.extensions), i.reserved && i.reserved.length && (n.reserved = i.reserved), i.group && (n.group = !0), n
                    }, Object.defineProperties(s.prototype, {
                        fieldsById: {
                            get: function() {
                                if (this.l) return this.l;
                                this.l = {};
                                for (var t = Object.keys(this.fields), e = 0; e < t.length; ++e) {
                                    var i = this.fields[t[e]],
                                        s = i.id;
                                    if (this.l[s]) throw Error("duplicate id " + s + " in " + this);
                                    this.l[s] = i
                                }
                                return this.l
                            }
                        },
                        fieldsArray: {
                            get: function() {
                                return this.b || (this.b = m.toArray(this.fields))
                            }
                        },
                        oneofsArray: {
                            get: function() {
                                return this.d || (this.d = m.toArray(this.oneofs))
                            }
                        },
                        ctor: {
                            get: function() {
                                return this.o || (this.o = u(this).constructor)
                            },
                            set: function(t) {
                                if (t && !(t.prototype instanceof d)) throw TypeError("ctor must be a Message constructor");
                                t.from || (t.from = d.from), this.o = t
                            }
                        }
                    }), s.prototype.toJSON = function() {
                        var e = o.prototype.toJSON.call(this);
                        return {
                            options: e && e.options || t,
                            oneofs: o.arrayToJSON(this.oneofsArray),
                            fields: o.arrayToJSON(this.fieldsArray.filter(function(t) {
                                return !t.declaringField
                            })) || {},
                            extensions: this.extensions && this.extensions.length ? this.extensions : t,
                            reserved: this.reserved && this.reserved.length ? this.reserved : t,
                            group: this.group || t,
                            nested: e && e.nested || t
                        }
                    }, s.prototype.resolveAll = function() {
                        for (var t = this.fieldsArray, e = 0; e < t.length;) t[e++].resolve();
                        var i = this.oneofsArray;
                        for (e = 0; e < i.length;) i[e++].resolve();
                        return o.prototype.resolve.call(this)
                    }, s.prototype.get = function(t) {
                        return this.fields[t] || this.oneofs && this.oneofs[t] || this.nested && this.nested[t] || null
                    }, s.prototype.add = function(e) {
                        if (this.get(e.name)) throw Error("duplicate name '" + e.name + "' in " + this);
                        if (e instanceof h && e.extend === t) {
                            if (this.l ? this.l[e.id] : this.fieldsById[e.id]) throw Error("duplicate id " + e.id + " in " + this);
                            if (this.isReservedId(e.id)) throw Error("id " + e.id + " is reserved in " + this);
                            if (this.isReservedName(e.name)) throw Error("name '" + e.name + "' is reserved in " + this);
                            return e.parent && e.parent.remove(e), this.fields[e.name] = e, e.message = this, e.onAdd(this), n(this)
                        }
                        return e instanceof a ? (this.oneofs || (this.oneofs = {}), this.oneofs[e.name] = e, e.onAdd(this), n(this)) : o.prototype.add.call(this, e)
                    }, s.prototype.remove = function(e) {
                        if (e instanceof h && e.extend === t) {
                            if (!this.fields || this.fields[e.name] !== e) throw Error(e + " is not a member of " + this);
                            return delete this.fields[e.name], e.parent = null, e.onRemove(this), n(this)
                        }
                        if (e instanceof a) {
                            if (!this.oneofs || this.oneofs[e.name] !== e) throw Error(e + " is not a member of " + this);
                            return delete this.oneofs[e.name], e.parent = null, e.onRemove(this), n(this)
                        }
                        return o.prototype.remove.call(this, e)
                    }, s.prototype.isReservedId = function(t) {
                        if (this.reserved)
                            for (var e = 0; e < this.reserved.length; ++e)
                                if ("string" != typeof this.reserved[e] && this.reserved[e][0] <= t && this.reserved[e][1] >= t) return !0;
                        return !1
                    }, s.prototype.isReservedName = function(t) {
                        if (this.reserved)
                            for (var e = 0; e < this.reserved.length; ++e)
                                if (this.reserved[e] === t) return !0;
                        return !1
                    }, s.prototype.create = function(t) {
                        return new this.ctor(t)
                    }, s.prototype.setup = function() {
                        for (var t = this.fullName, e = [], i = 0; i < this.fieldsArray.length; ++i) e.push(this.b[i].resolve().resolvedType);
                        return this.encode = g(this).eof(t + "$encode", {
                            Writer: f,
                            types: e,
                            util: m
                        }), this.decode = y(this).eof(t + "$decode", {
                            Reader: p,
                            types: e,
                            util: m
                        }), this.verify = v(this).eof(t + "$verify", {
                            types: e,
                            util: m
                        }), this.fromObject = this.from = b.fromObject(this).eof(t + "$fromObject", {
                            types: e,
                            util: m
                        }), this.toObject = b.toObject(this).eof(t + "$toObject", {
                            types: e,
                            util: m
                        }), this
                    }, s.prototype.encode = function(t, e) {
                        return this.setup().encode(t, e)
                    }, s.prototype.encodeDelimited = function(t, e) {
                        return this.encode(t, e && e.len ? e.fork() : e).ldelim()
                    }, s.prototype.decode = function(t, e) {
                        return this.setup().decode(t, e)
                    }, s.prototype.decodeDelimited = function(t) {
                        return t instanceof p || (t = p.create(t)), this.decode(t, t.uint32())
                    }, s.prototype.verify = function(t) {
                        return this.setup().verify(t)
                    }, s.prototype.fromObject = function(t) {
                        return this.setup().fromObject(t)
                    }, s.prototype.from = s.prototype.fromObject, s.prototype.toObject = function(t, e) {
                        return this.setup().toObject(t, e)
                    }
                }, {
                    10: 10,
                    12: 12,
                    13: 13,
                    14: 14,
                    15: 15,
                    16: 16,
                    20: 20,
                    21: 21,
                    23: 23,
                    25: 25,
                    27: 27,
                    32: 32,
                    36: 36,
                    39: 39,
                    40: 40
                }],
                35: [function(t, e, i) {
                    function s(t, e) {
                        var i = 0,
                            s = {};
                        for (e |= 0; i < t.length;) s[r[i + e]] = t[i++];
                        return s
                    }
                    var n = i,
                        o = t(36),
                        r = ["double", "float", "int32", "uint32", "sint32", "fixed32", "sfixed32", "int64", "uint64", "sint64", "fixed64", "sfixed64", "bool", "string", "bytes"];
                    n.basic = s([1, 5, 0, 0, 0, 5, 5, 0, 0, 0, 1, 1, 0, 2, 2]), n.defaults = s([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, !1, "", o.emptyArray, null]), n.long = s([0, 0, 0, 1, 1], 7), n.mapKey = s([0, 0, 0, 5, 5, 0, 0, 0, 1, 1, 0, 2], 2), n.packed = s([1, 5, 0, 0, 0, 5, 5, 0, 0, 0, 1, 1, 0])
                }, {
                    36: 36
                }],
                36: [function(t, e) {
                    var i = e.exports = t(38);
                    i.codegen = t(3), i.fetch = t(5), i.path = t(7), i.fs = i.inquire("fs"), i.toArray = function(t) {
                        var e = [];
                        if (t)
                            for (var i = Object.keys(t), s = 0; s < i.length; ++s) e.push(t[i[s]]);
                        return e
                    }, i.safeProp = function(t) {
                        return '["' + t.replace(/\\/g, "\\\\").replace(/"/g, '\\"') + '"]'
                    }, i.ucFirst = function(t) {
                        return t.charAt(0).toUpperCase() + t.substring(1)
                    }
                }, {
                    3: 3,
                    38: 38,
                    5: 5,
                    7: 7
                }],
                37: [function(t, e) {
                    function i(t, e) {
                        this.lo = t >>> 0, this.hi = e >>> 0
                    }
                    e.exports = i;
                    var s = t(38),
                        n = i.zero = new i(0, 0);
                    n.toNumber = function() {
                        return 0
                    }, n.zzEncode = n.zzDecode = function() {
                        return this
                    }, n.length = function() {
                        return 1
                    };
                    var o = i.zeroHash = "\0\0\0\0\0\0\0\0";
                    i.fromNumber = function(t) {
                        if (0 === t) return n;
                        var e = t < 0;
                        e && (t = -t);
                        var s = t >>> 0,
                            o = (t - s) / 4294967296 >>> 0;
                        return e && (o = ~o >>> 0, s = ~s >>> 0, ++s > 4294967295 && (s = 0, ++o > 4294967295 && (o = 0))), new i(s, o)
                    }, i.from = function(t) {
                        if ("number" == typeof t) return i.fromNumber(t);
                        if (s.isString(t)) {
                            if (!s.Long) return i.fromNumber(parseInt(t, 10));
                            t = s.Long.fromString(t)
                        }
                        return t.low || t.high ? new i(t.low >>> 0, t.high >>> 0) : n
                    }, i.prototype.toNumber = function(t) {
                        if (!t && this.hi >>> 31) {
                            var e = 1 + ~this.lo >>> 0,
                                i = ~this.hi >>> 0;
                            return e || (i = i + 1 >>> 0), -(e + 4294967296 * i)
                        }
                        return this.lo + 4294967296 * this.hi
                    }, i.prototype.toLong = function(t) {
                        return s.Long ? new s.Long(0 | this.lo, 0 | this.hi, !!t) : {
                            low: 0 | this.lo,
                            high: 0 | this.hi,
                            unsigned: !!t
                        }
                    };
                    var r = String.prototype.charCodeAt;
                    i.fromHash = function(t) {
                        return t === o ? n : new i((r.call(t, 0) | r.call(t, 1) << 8 | r.call(t, 2) << 16 | r.call(t, 3) << 24) >>> 0, (r.call(t, 4) | r.call(t, 5) << 8 | r.call(t, 6) << 16 | r.call(t, 7) << 24) >>> 0)
                    }, i.prototype.toHash = function() {
                        return String.fromCharCode(255 & this.lo, this.lo >>> 8 & 255, this.lo >>> 16 & 255, this.lo >>> 24, 255 & this.hi, this.hi >>> 8 & 255, this.hi >>> 16 & 255, this.hi >>> 24)
                    }, i.prototype.zzEncode = function() {
                        var t = this.hi >> 31;
                        return this.hi = ((this.hi << 1 | this.lo >>> 31) ^ t) >>> 0, this.lo = (this.lo << 1 ^ t) >>> 0, this
                    }, i.prototype.zzDecode = function() {
                        var t = -(1 & this.lo);
                        return this.lo = ((this.lo >>> 1 | this.hi << 31) ^ t) >>> 0, this.hi = (this.hi >>> 1 ^ t) >>> 0, this
                    }, i.prototype.length = function() {
                        var t = this.lo,
                            e = (this.lo >>> 28 | this.hi << 4) >>> 0,
                            i = this.hi >>> 24;
                        return 0 === i ? 0 === e ? t < 16384 ? t < 128 ? 1 : 2 : t < 2097152 ? 3 : 4 : e < 16384 ? e < 128 ? 5 : 6 : e < 2097152 ? 7 : 8 : i < 128 ? 9 : 10
                    }
                }, {
                    38: 38
                }],
                38: [function(i, s, n) {
                    var o = n;
                    o.asPromise = i(1), o.base64 = i(2), o.EventEmitter = i(4), o.inquire = i(6), o.utf8 = i(9), o.pool = i(8), o.LongBits = i(37), o.emptyArray = Object.freeze ? Object.freeze([]) : [], o.emptyObject = Object.freeze ? Object.freeze({}) : {}, o.isNode = !!(e.process && e.process.versions && e.process.versions.node), o.isInteger = Number.isInteger || function(t) {
                        return "number" == typeof t && isFinite(t) && Math.floor(t) === t
                    }, o.isString = function(t) {
                        return "string" == typeof t || t instanceof String
                    }, o.isObject = function(t) {
                        return t && "object" == typeof t
                    }, o.Buffer = function() {
                        try {
                            var t = o.inquire("buffer").Buffer;
                            return t.prototype.utf8Write ? t : null
                        } catch (t) {
                            return null
                        }
                    }(), o.p = null, o.u = null, o.newBuffer = function(t) {
                        return "number" == typeof t ? o.Buffer ? o.u(t) : new o.Array(t) : o.Buffer ? o.p(t) : "undefined" == typeof Uint8Array ? t : new Uint8Array(t)
                    }, o.Array = "undefined" != typeof Uint8Array ? Uint8Array : Array, o.Long = e.dcodeIO && e.dcodeIO.Long || o.inquire("long"), o.longToHash = function(t) {
                        return t ? o.LongBits.from(t).toHash() : o.LongBits.zeroHash
                    }, o.longFromHash = function(t, e) {
                        var i = o.LongBits.fromHash(t);
                        return o.Long ? o.Long.fromBits(i.lo, i.hi, e) : i.toNumber(!!e)
                    }, o.merge = function(e, i, s) {
                        for (var n = Object.keys(i), o = 0; o < n.length; ++o) e[n[o]] !== t && s || (e[n[o]] = i[n[o]]);
                        return e
                    }, o.lcFirst = function(t) {
                        return t.charAt(0).toLowerCase() + t.substring(1)
                    }, o.oneOfGetter = function(e) {
                        for (var i = {}, s = 0; s < e.length; ++s) i[e[s]] = 1;
                        return function() {
                            for (var e = Object.keys(this), s = e.length - 1; s > -1; --s)
                                if (1 === i[e[s]] && this[e[s]] !== t && null !== this[e[s]]) return e[s]
                        }
                    }, o.oneOfSetter = function(t) {
                        return function(e) {
                            for (var i = 0; i < t.length; ++i) t[i] !== e && delete this[t[i]]
                        }
                    }, o.lazyResolve = function(t, e) {
                        for (var i = 0; i < e.length; ++i)
                            for (var s = Object.keys(e[i]), n = 0; n < s.length; ++n) {
                                for (var o = e[i][s[n]].split("."), r = t; o.length;) r = r[o.shift()];
                                e[i][s[n]] = r
                            }
                    }, o.toJSONOptions = {
                        longs: String,
                        enums: String,
                        bytes: String
                    }, o.f = function() {
                        var e = o.Buffer;
                        return e ? (o.p = e.from !== Uint8Array.from && e.from || function(t, i) {
                            return new e(t, i)
                        }, o.u = e.allocUnsafe || function(t) {
                            return new e(t)
                        }, t) : (o.p = o.u = null, t)
                    }
                }, {
                    1: 1,
                    2: 2,
                    37: 37,
                    4: 4,
                    6: 6,
                    8: 8,
                    9: 9
                }],
                39: [function(t, e) {
                    function i(t, e) {
                        return t.name + ": " + e + (t.repeated && "array" !== e ? "[]" : t.map && "object" !== e ? "{k:" + t.keyType + "}" : "") + " expected"
                    }

                    function s(t, e, s, n) {
                        if (e.resolvedType)
                            if (e.resolvedType instanceof o) {
                                t("switch(%s){", n)("default:")("return%j", i(e, "enum value"));
                                for (var r = Object.keys(e.resolvedType.values), a = 0; a < r.length; ++a) t("case %d:", e.resolvedType.values[r[a]]);
                                t("break")("}")
                            } else t("var e=types[%d].verify(%s);", s, n)("if(e)")("return%j+e", e.name + ".");
                        else switch (e.type) {
                            case "int32":
                            case "uint32":
                            case "sint32":
                            case "fixed32":
                            case "sfixed32":
                                t("if(!util.isInteger(%s))", n)("return%j", i(e, "integer"));
                                break;
                            case "int64":
                            case "uint64":
                            case "sint64":
                            case "fixed64":
                            case "sfixed64":
                                t("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))", n, n, n, n)("return%j", i(e, "integer|Long"));
                                break;
                            case "float":
                            case "double":
                                t('if(typeof %s!=="number")', n)("return%j", i(e, "number"));
                                break;
                            case "bool":
                                t('if(typeof %s!=="boolean")', n)("return%j", i(e, "boolean"));
                                break;
                            case "string":
                                t("if(!util.isString(%s))", n)("return%j", i(e, "string"));
                                break;
                            case "bytes":
                                t('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))', n, n, n)("return%j", i(e, "buffer"))
                        }
                        return t
                    }

                    function n(t, e, s) {
                        switch (e.keyType) {
                            case "int32":
                            case "uint32":
                            case "sint32":
                            case "fixed32":
                            case "sfixed32":
                                t("if(!/^-?(?:0|[1-9][0-9]*)$/.test(%s))", s)("return%j", i(e, "integer key"));
                                break;
                            case "int64":
                            case "uint64":
                            case "sint64":
                            case "fixed64":
                            case "sfixed64":
                                t("if(!/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/.test(%s))", s)("return%j", i(e, "integer|Long key"));
                                break;
                            case "bool":
                                t("if(!/^true|false|0|1$/.test(%s))", s)("return%j", i(e, "boolean key"))
                        }
                        return t
                    }
                    e.exports = function(t) {
                        for (var e = r.codegen("m")('if(typeof m!=="object"||m===null)')("return%j", "object expected"), a = 0; a < t.fieldsArray.length; ++a) {
                            var h = t.b[a].resolve(),
                                l = "m" + r.safeProp(h.name);
                            h.map ? (e("if(%s!==undefined){", l)("if(!util.isObject(%s))", l)("return%j", i(h, "object"))("var k=Object.keys(%s)", l)("for(var i=0;i<k.length;++i){"), n(e, h, "k[i]"), s(e, h, a, l + "[k[i]]")("}")("}")) : h.repeated ? (e("if(%s!==undefined){", l)("if(!Array.isArray(%s))", l)("return%j", i(h, "array"))("for(var i=0;i<%s.length;++i){", l), s(e, h, a, l + "[i]")("}")("}")) : (h.required || (!h.resolvedType || h.resolvedType instanceof o ? e("if(%s!==undefined){", l) : e("if(%s!==undefined&&%s!==null){", l, l)), s(e, h, a, l), h.required || e("}"))
                        }
                        return e("return null")
                    };
                    var o = t(15),
                        r = t(36)
                }, {
                    15: 15,
                    36: 36
                }],
                40: [function(e, i) {
                    function s(e, i, s) {
                        this.fn = e, this.len = i, this.next = t, this.val = s
                    }

                    function n() {}

                    function o(t) {
                        this.head = t.head, this.tail = t.tail, this.len = t.len, this.next = t.states
                    }

                    function r() {
                        this.len = 0, this.head = new s(n, 0, 0), this.tail = this.head, this.states = null
                    }

                    function a(t, e, i) {
                        e[i] = 255 & t
                    }

                    function h(e, i) {
                        this.len = e, this.next = t, this.val = i
                    }

                    function l(t, e, i) {
                        for (; t.hi;) e[i++] = 127 & t.lo | 128, t.lo = (t.lo >>> 7 | t.hi << 25) >>> 0, t.hi >>>= 7;
                        for (; t.lo > 127;) e[i++] = 127 & t.lo | 128, t.lo = t.lo >>> 7;
                        e[i++] = t.lo
                    }

                    function c(t, e, i) {
                        e[i++] = 255 & t, e[i++] = t >>> 8 & 255, e[i++] = t >>> 16 & 255, e[i] = t >>> 24
                    }
                    i.exports = r;
                    var u, d = e(38),
                        p = d.LongBits,
                        f = d.base64,
                        m = d.utf8;
                    r.create = d.Buffer ? function() {
                        return (r.create = function() {
                            return new u
                        })()
                    } : function() {
                        return new r
                    }, r.alloc = function(t) {
                        return new d.Array(t)
                    }, d.Array !== Array && (r.alloc = d.pool(r.alloc, d.Array.prototype.subarray)), r.prototype.push = function(t, e, i) {
                        return this.tail = this.tail.next = new s(t, e, i), this.len += e, this
                    }, h.prototype = Object.create(s.prototype), h.prototype.fn = function(t, e, i) {
                        for (; t > 127;) e[i++] = 127 & t | 128, t >>>= 7;
                        e[i] = t
                    }, r.prototype.uint32 = function(t) {
                        return this.len += (this.tail = this.tail.next = new h((t >>>= 0) < 128 ? 1 : t < 16384 ? 2 : t < 2097152 ? 3 : t < 268435456 ? 4 : 5, t)).len, this
                    }, r.prototype.int32 = function(t) {
                        return t < 0 ? this.push(l, 10, p.fromNumber(t)) : this.uint32(t)
                    }, r.prototype.sint32 = function(t) {
                        return this.uint32((t << 1 ^ t >> 31) >>> 0)
                    }, r.prototype.uint64 = function(t) {
                        var e = p.from(t);
                        return this.push(l, e.length(), e)
                    }, r.prototype.int64 = r.prototype.uint64, r.prototype.sint64 = function(t) {
                        var e = p.from(t).zzEncode();
                        return this.push(l, e.length(), e)
                    }, r.prototype.bool = function(t) {
                        return this.push(a, 1, t ? 1 : 0)
                    }, r.prototype.fixed32 = function(t) {
                        return this.push(c, 4, t >>> 0)
                    }, r.prototype.sfixed32 = r.prototype.fixed32, r.prototype.fixed64 = function(t) {
                        var e = p.from(t);
                        return this.push(c, 4, e.lo).push(c, 4, e.hi)
                    }, r.prototype.sfixed64 = r.prototype.fixed64;
                    var g = "undefined" != typeof Float32Array ? function() {
                        var t = new Float32Array(1),
                            e = new Uint8Array(t.buffer);
                        return t[0] = -0, e[3] ? function(i, s, n) {
                            t[0] = i, s[n++] = e[0], s[n++] = e[1], s[n++] = e[2], s[n] = e[3]
                        } : function(i, s, n) {
                            t[0] = i, s[n++] = e[3], s[n++] = e[2], s[n++] = e[1], s[n] = e[0]
                        }
                    }() : function(t, e, i) {
                        var s = t < 0 ? 1 : 0;
                        if (s && (t = -t), 0 === t) c(1 / t > 0 ? 0 : 2147483648, e, i);
                        else if (isNaN(t)) c(2147483647, e, i);
                        else if (t > 3.4028234663852886e38) c((s << 31 | 2139095040) >>> 0, e, i);
                        else if (t < 1.1754943508222875e-38) c((s << 31 | Math.round(t / 1.401298464324817e-45)) >>> 0, e, i);
                        else {
                            var n = Math.floor(Math.log(t) / Math.LN2);
                            c((s << 31 | n + 127 << 23 | 8388607 & Math.round(t * Math.pow(2, -n) * 8388608)) >>> 0, e, i)
                        }
                    };
                    r.prototype.float = function(t) {
                        return this.push(g, 4, t)
                    };
                    var y = "undefined" != typeof Float64Array ? function() {
                        var t = new Float64Array(1),
                            e = new Uint8Array(t.buffer);
                        return t[0] = -0, e[7] ? function(i, s, n) {
                            t[0] = i, s[n++] = e[0], s[n++] = e[1], s[n++] = e[2], s[n++] = e[3], s[n++] = e[4], s[n++] = e[5], s[n++] = e[6], s[n] = e[7]
                        } : function(i, s, n) {
                            t[0] = i, s[n++] = e[7], s[n++] = e[6], s[n++] = e[5], s[n++] = e[4], s[n++] = e[3], s[n++] = e[2], s[n++] = e[1], s[n] = e[0]
                        }
                    }() : function(t, e, i) {
                        var s = t < 0 ? 1 : 0;
                        if (s && (t = -t), 0 === t) c(0, e, i), c(1 / t > 0 ? 0 : 2147483648, e, i + 4);
                        else if (isNaN(t)) c(4294967295, e, i), c(2147483647, e, i + 4);
                        else if (t > 1.7976931348623157e308) c(0, e, i), c((s << 31 | 2146435072) >>> 0, e, i + 4);
                        else {
                            var n;
                            if (t < 2.2250738585072014e-308) c((n = t / 5e-324) >>> 0, e, i), c((s << 31 | n / 4294967296) >>> 0, e, i + 4);
                            else {
                                var o = Math.floor(Math.log(t) / Math.LN2);
                                1024 === o && (o = 1023), c(4503599627370496 * (n = t * Math.pow(2, -o)) >>> 0, e, i), c((s << 31 | o + 1023 << 20 | 1048576 * n & 1048575) >>> 0, e, i + 4)
                            }
                        }
                    };
                    r.prototype.double = function(t) {
                        return this.push(y, 8, t)
                    };
                    var v = d.Array.prototype.set ? function(t, e, i) {
                        e.set(t, i)
                    } : function(t, e, i) {
                        for (var s = 0; s < t.length; ++s) e[i + s] = t[s]
                    };
                    r.prototype.bytes = function(t) {
                        var e = t.length >>> 0;
                        if (!e) return this.push(a, 1, 0);
                        if (d.isString(t)) {
                            var i = r.alloc(e = f.length(t));
                            f.decode(t, i, 0), t = i
                        }
                        return this.uint32(e).push(v, e, t)
                    }, r.prototype.string = function(t) {
                        var e = m.length(t);
                        return e ? this.uint32(e).push(m.write, e, t) : this.push(a, 1, 0)
                    }, r.prototype.fork = function() {
                        return this.states = new o(this), this.head = this.tail = new s(n, 0, 0), this.len = 0, this
                    }, r.prototype.reset = function() {
                        return this.states ? (this.head = this.states.head, this.tail = this.states.tail, this.len = this.states.len, this.states = this.states.next) : (this.head = this.tail = new s(n, 0, 0), this.len = 0), this
                    }, r.prototype.ldelim = function() {
                        var t = this.head,
                            e = this.tail,
                            i = this.len;
                        return this.reset().uint32(i), i && (this.tail.next = t.next, this.tail = e, this.len += i), this
                    }, r.prototype.finish = function() {
                        for (var t = this.head.next, e = this.constructor.alloc(this.len), i = 0; t;) t.fn(t.val, e, i), i += t.len, t = t.next;
                        return e
                    }, r.f = function(t) {
                        u = t
                    }
                }, {
                    38: 38
                }],
                41: [function(t, e) {
                    function i() {
                        n.call(this)
                    }

                    function s(t, e, i) {
                        t.length < 40 ? o.utf8.write(t, e, i) : e.utf8Write(t, i)
                    }
                    e.exports = i;
                    var n = t(40);
                    (i.prototype = Object.create(n.prototype)).constructor = i;
                    var o = t(38),
                        r = o.Buffer;
                    i.alloc = function(t) {
                        return (i.alloc = o.u)(t)
                    };
                    var a = r && r.prototype instanceof Uint8Array && "set" === r.prototype.set.name ? function(t, e, i) {
                        e.set(t, i)
                    } : function(t, e, i) {
                        if (t.copy) t.copy(e, i, 0, t.length);
                        else
                            for (var s = 0; s < t.length;) e[i++] = t[s++]
                    };
                    i.prototype.bytes = function(t) {
                        o.isString(t) && (t = o.p(t, "base64"));
                        var e = t.length >>> 0;
                        return this.uint32(e), e && this.push(a, e, t), this
                    }, i.prototype.string = function(t) {
                        var e = r.byteLength(t);
                        return this.uint32(e), e && this.push(s, e, t), this
                    }
                }, {
                    38: 38,
                    40: 40
                }]
            }, {})
        }("object" == typeof window && window || "object" == typeof self && self || this)
    }).call(exports, __webpack_require__(134)(module))
}, function(t, e, i) {
    "use strict";
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var s = i(37),
        n = function() {
            function t() {}
            return t.increase_start_count = function() {
                t.set_start_count(t.get_start_count() + 1)
            }, t.get_start_count = function() {
                return parseInt(s.default.read("ad_start")) || 1
            }, t.set_start_count = function(t) {
                s.default.write("ad_start", t)
            }, t.increase_end_count = function() {
                t.set_end_count(t.get_end_count() + 1)
            }, t.get_end_count = function() {
                return parseInt(s.default.read("ad_end")) || 1
            }, t.set_end_count = function(t) {
                s.default.write("ad_end", t)
            }, t.drop_counts = function() {
                t.set_start_count(1), t.set_end_count(1)
            }, t.check_integrity = function() {
                return !(t.get_start_count() > t.get_end_count())
            }, t.is_need_play_ad = function() {
                if (!t.check_integrity()) return t.drop_counts(), t.set_start_count(2), t.set_end_count(2), !0;
                var e = t.get_start_count();
                return 2 === e || (e - 2) % 5 == 0
            }, t.play = function(e) {
                window.adplayer && t.is_need_play_ad() ? (window.adplayer.onadcompleted = function() {
                    t.increase_end_count(), e()
                }, t.increase_start_count(), window.adplayer.startPreRoll()) : (t.increase_start_count(), t.increase_end_count(), e())
            }, t
        }();
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = function() {
            function t(t) {
                this.container = document.createElement("div"), this.container.innerText = t, this.container.style.left = "0px", this.container.style.top = "0px", this.container.className = "speechbubble", document.body.appendChild(this.container)
            }
            return t.prototype.setPosition = function(t, e) {
                t = Math.round(t), e = Math.round(e), t -= this.container.offsetWidth / 2, e -= this.container.offsetHeight, this.container.style.left = t + "px", this.container.style.top = e + "px"
            }, t.prototype.setText = function(t) {
                this.container.innerText = t
            }, t.prototype.destroy = function() {
                this.container.parentElement.removeChild(this.container)
            }, t
        }(),
        r = function(t) {
            function e(e) {
                var i = t.call(this) || this;
                return i.chatBubble = null, i.chatBubbleTimer = null, i.offset = e, i
            }
            return s(e, t), e.prototype.start = function() {
                t.prototype.start.call(this), this.cachedTransform = this.entity.components.transform, this.cachedSprite = this.entity.components.sprite, this.entity.on("chatmessage", this.onChatMessage.bind(this))
            }, e.prototype.onChatMessage = function(t) {
                this.chatBubble ? (this.world.game.time.events.remove(this.chatBubbleTimer), this.chatBubble.setText(t)) : this.chatBubble = new o(t), this.align(), this.chatBubbleTimer = this.world.game.time.events.add(7 * Phaser.Timer.SECOND, function() {
                    this.chatBubble && (this.chatBubble.destroy(), this.chatBubble = null)
                }, this)
            }, e.prototype.align = function() {
                if (this.chatBubble) {
                    var t = this.cachedTransform.position.y + this.offset;
                    if (this.cachedSprite && (t -= this.cachedSprite.sprite.height / 2), this.world.game.scale.scaleMode === Phaser.ScaleManager.USER_SCALE) {
                        var e = this.cachedTransform.position.x - this.world.game.camera.x;
                        e = e / this.world.game.scale.scaleFactor.x - this.world.game.screenOffsetWidth, t = (t -= this.world.game.camera.y) / this.world.game.scale.scaleFactor.y - this.world.game.screenOffsetHeight, this.chatBubble.setPosition(e, t)
                    } else this.chatBubble.setPosition(this.cachedTransform.position.x - this.world.game.camera.x, t - this.world.game.camera.y)
                }
            }, e.prototype.update = function(e) {
                t.prototype.update.call(this, e), this.align()
            }, e.prototype.destroy = function() {
                this.chatBubble && (this.chatBubble.destroy(), this.chatBubble = null)
            }, e
        }(n.Component);
    e.default = r
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            return t.call(this) || this
        }
        return s(e, t), e.prototype.start = function() {
            this.cachedSpriteComponent = this.entity.components.sprite, this.entity.on("receivedamage", this.onReceiveDamage.bind(this))
        }, e.prototype.onReceiveDamage = function(t) {
            this.cachedSpriteComponent.jump(10)
        }, e
    }(i(0).Component);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(32),
        r = function(t) {
            function e() {
                var e = t.call(this) || this;
                return e.id = "level", e.currentLevel = 0, e
            }
            return s(e, t), e.prototype.start = function() {
                this.entity.on("networksync", this.onNetworkSync.bind(this)), this.updateLevel(0), this.levelService = this.world.services.getService(o.default)
            }, e.prototype.onNetworkSync = function(t) {
                t.hasOwnProperty("level") && (this.updateLevel(t.level), this.entity.isLocalPlayer() && this.levelService.setLevel(t.level)), t.hasOwnProperty("exp") && this.entity.isLocalPlayer() && this.levelService.setProgress(t.exp)
            }, e.prototype.updateLevel = function(t) {
                this.currentLevel = t;
                var e = Phaser.Math.clamp(.6 + t / 50, .6, 1.2);
                this.entity.components.sprite.scale(e, e);
                var i = this.entity.components.hat;
                i && i.setScale(e)
            }, e
        }(n.Component);
    e.default = r
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            var e = t.call(this) || this;
            return e.transportId = -1, e
        }
        return s(e, t), e.prototype.start = function() {
            t.prototype.start.call(this), this.entity.on("networksync", this.onNetworkSync.bind(this)), this.entity.on("senddamage", this.onSendDamage.bind(this)), this.addAnimation("walk", Phaser.Animation.generateFrameNames("walk", 1, 16, ".png", 0), 30, !0), this.addAnimation("pigwalk", ["onpig.png"], 15, !0), this.addAnimation("punch", Phaser.Animation.generateFrameNames("hit", 1, 10, ".png", 0), 40, !1).onComplete.add(function() {
                this.walk()
            }.bind(this)), this.addAnimation("pigpunch", Phaser.Animation.generateFrameNames("pighit", 1, 8, ".png", 0), 30, !1).onComplete.add(function() {
                this.walk()
            }.bind(this)), this.walk()
        }, e.prototype.onNetworkSync = function(t) {
            t.hasOwnProperty("transportId") && (this.transportId = t.transportId)
        }, e.prototype.walk = function() {
            try {
                this.transportId > -1 ? this.play("pigwalk") : this.play("walk")
            } catch (t) {}
        }, e.prototype.onSendDamage = function(t) {
            try {
                this.transportId > -1 ? this.play("pigpunch") : this.play("punch")
            } catch (t) {}
        }, e.prototype.update = function(e) {
            t.prototype.update.call(this, e), "punch" !== this.getCurrentName() && "pigpunch" !== this.getCurrentName() && (this.cachedTransform.isMoving() ? this.walk() : this.cachedSpriteComponent.sprite.animations.stop())
        }, e.prototype.destroy = function() {}, e
    }(i(6).default);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e(e) {
            var i = t.call(this) || this;
            return i.id = "label", i.labelColor = "#ffffff", i.desiredAlpha = 1, i.metadata = {}, i.offset = e, i
        }
        return s(e, t), e.prototype.start = function() {
            this.entity.on("networksync", this.onNetworkSync.bind(this)), this.cachedTransform = this.entity.components.transform, this.cachedSprite = this.entity.components.sprite, this.label = this.world.game.add.text(this.cachedTransform.position.x, this.cachedTransform.position.y + this.offset - this.cachedSprite.sprite.height / 2, "", {
                fontSize: "18px",
                font: "Roboto Mono"
            }), this.label.anchor.set(.5, 1), this.label.stroke = "rgba(0,0,0,0.7)", this.label.strokeThickness = 3, this.label.fill = this.labelColor, this.badge = this.world.game.add.text(this.cachedTransform.position.x, this.cachedTransform.position.y + this.offset - this.cachedSprite.sprite.height / 2, "", {}), this.badge.anchor.set(1, 1), this.badge.strokeThickness = 1, this.badge.cssFont = "bold 18px 'FontAwesome'", this.updateLabels(), this.badge.alpha = 0, this.entity.on("alpha", function(t) {
                this.desiredAlpha = t.alpha, this.updateLabels()
            }.bind(this))
        }, e.prototype.setPlayerName = function(t) {
            this.playerName = t, this.updateLabels()
        }, e.prototype.setColor = function(t) {
            this.labelColor = t, this.label.fill = this.labelColor
        }, e.prototype.updateLabels = function() {
            var t = "" + this.playerName;
            this.level > 0 && (t += " (" + (this.level + 1) + ")");
            var e = [];
            switch (this.badge.clearColors(), this.badge.cssFont = "bold 18px 'FontAwesome'", this.badge.setText(""), 7 & this.rankStatus) {
                case 3:
                    e.unshift(["user", "", "rgba(3,149,0,0.7)", "rgba(255,255,255,0.5)"]);
                    break;
                case 4:
                    e.unshift(["user", "", "rgba(255,215,0,0.7)", "rgba(0,0,0,0.7)"]);
                    break;
                case 2:
                    e.unshift(["user", "", "rgba(255,89,89,0.7)", "rgba(0,0,0,0.7)"]);
                    break;
                case 1:
                    e.unshift(["user", "", "rgba(89,178,255,0.7)", "rgba(0,0,0,0.7)"]);
                    break;
                default:
                case 0:
                    e.unshift(["user", " ", "rgba(89,178,255,0)", "rgba(0,0,0,0.7)"])
            }
            if (this.label.alpha = this.desiredAlpha, this.badge.alpha = this.desiredAlpha, this.metadata && this.metadata.badges)
                for (var i in this.metadata.badges) {
                    var s = this.metadata.badges[i];
                    e.unshift(s)
                }
            for (var i in e) {
                s = e[i];
                var n = this.badge.text;
                n += s[1] + " ", this.badge.setText(n), this.badge.addColor(s[2] || "rgba(0,0,0,0.7)", n.length - 2), this.badge.addStrokeColor(s[3] || "rgba(0,0,0,0.7)", n.length - 2)
            }
            this.badge.setShadow(0, 0), setTimeout(function() {
                this && this.badge && this.badge.setText(this.badge.text)
            }.bind(this), 500), this.label.setText(t), this.label.width > 250 && (this.label.width = 250)
        }, e.prototype.align = function() {
            var t = this.cachedTransform.position.x,
                e = this.cachedTransform.position.y + this.offset - this.cachedSprite.sprite.height / 2;
            this.label.position.set(t, e), this.badge.position.set(t - this.label.width / 2, e)
        }, e.prototype.onNetworkSync = function(t) {
            var e = !1;
            if (t.hasOwnProperty("metadata")) try {
                this.metadata = JSON.parse(t.metadata)
            } catch (t) {}
            t.hasOwnProperty("level") && (this.level = t.level, 313370 == this.level && this.entity.emit("alpha", {
                alpha: 0
            }), e = !0), t.hasOwnProperty("rankStatus") && (this.rankStatus = t.rankStatus, e = !0), t.hasOwnProperty("playerName") && t.playerName && (this.playerName = t.playerName, e = !0), e && this.updateLabels()
        }, e.prototype.update = function(t) {
            this.align()
        }, e.prototype.destroy = function() {
            this.label.destroy(), this.badge.destroy()
        }, e
    }(i(0).Component);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            var e = t.call(this) || this;
            return e.id = "teamcomponent", e.isAdmin = !1, e
        }
        return s(e, t), e.prototype.start = function() {
            this.cachedSpriteComponent = this.entity.components.sprite, this.cachedLabelComponent = this.entity.components.label, this.cachedLabelTeamComponent = this.entity.components.teamlabel, this.cachedHatComponent = this.entity.components.hat, this.entity.on("networksync", this.onNetworkSync.bind(this)), this.entity.on("hostspawn", this.updateTeamBehavior.bind(this)), this.entity.on("hostteamchanged", this.updateTeamBehavior.bind(this))
        }, e.prototype.onNetworkSync = function(t) {
            var e = !1;
            t.hasOwnProperty("networkId") && (this.networkId = t.networkId, e = !0), t.hasOwnProperty("teamId") && (this.teamId = t.teamId, e = !0), t.hasOwnProperty("teamName") && (this.teamName = t.teamName, e = !0), t.hasOwnProperty("isTeamAdmin") && (this.isAdmin = t.isTeamAdmin, e = !0), e && this.updateTeamBehavior()
        }, e.prototype.isFriend = function(t, e) {
            return t === this.world.networkId || e > -1 && e === this.world.teamId
        }, e.prototype.updateTeamBehavior = function() {
            var t = this.isFriend(this.networkId, this.teamId);
            this.cachedSpriteComponent && this.cachedSpriteComponent.setColor(t ? 16777215 : 16755370), this.cachedLabelComponent && this.cachedLabelComponent.setColor(t ? "#ffffff" : "#ff9999"), this.cachedLabelTeamComponent && this.cachedLabelTeamComponent.setColor(t ? "#ffffff" : "#ff9999"), this.cachedHatComponent && this.cachedHatComponent.setColor(t ? 16777215 : 16772846)
        }, e
    }(i(0).Component);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(5),
        r = i(4),
        a = function(t) {
            function e(e, i, s) {
                var n = t.call(this, e, i, s) || this;
                return n.addComponent(new o.default), n.addComponent(new r.default), n
            }
            return s(e, t), e
        }(n.Entity);
    e.default = a
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(2).Protocol.MessageType,
        r = i(34),
        a = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                return i.hour = 12, i.latestDarkness = 0, i.world.socket.onMessage(o.DayTimeMessage, i.onDayTimeMessage.bind(i)), i.filter = new Phaser.Filter(i.world.game, null, "\n            precision mediump float;\n    \n            varying vec2       vTextureCoord;\n            varying vec4       vColor;\n            uniform sampler2D  uSampler;\n            uniform vec3       tint;\n    \n            void main(void) {\n                gl_FragColor = texture2D(uSampler, vTextureCoord);\n                gl_FragColor.rgb = vec3(gl_FragColor.r * tint.r, gl_FragColor.g * tint.g, gl_FragColor.b * tint.b);\n            }\n        "), i.filter.uniforms.tint = {
                    type: "3f",
                    value: {
                        x: .5,
                        y: .5,
                        z: .7
                    }
                }, i.world.game.world.filters = [i.filter], i.world.socket.sendMessage(o.PlayerRequestDaytime, {}), i
            }
            return s(e, t), e.prototype.isDark = function() {
                return this.hour >= 23 || this.hour <= 4
            }, e.prototype.getDarknessValue = function(t) {
                var e = 0;
                return t > 22 && t < 23 || t > 4 && t < 5 ? e = .5 : (t >= 23 || t <= 4) && (e = 1), e
            }, e.prototype.update = function(t) {
                var e = this.getDarknessValue(this.hour);
                e = Phaser.Math.linear(this.latestDarkness, e, t), this.latestDarkness = e, this.latestDarkness = Phaser.Math.clamp(this.latestDarkness, 0, 1);
                var i = {
                    x: Phaser.Math.linear(1, .6, e),
                    y: Phaser.Math.linear(1, .6, e),
                    z: Phaser.Math.linear(1, .8, e)
                };
                this.filter.uniforms.tint.value = {
                    x: i.x,
                    y: i.y,
                    z: i.z
                }
            }, e.prototype.onDayTimeMessage = function(t) {
                var e = this.hour;
                this.hour = Math.round(t.content.hour), 21 === e && 22 === this.hour && this.world.services.getService(r.default).enqueue(45, "Night is coming.."), setTimeout(function() {
                    var e = parseFloat(t.content.hour),
                        i = Math.floor(e),
                        s = Math.floor(e % 1 * 60),
                        n = new Date;
                    n.setHours(i), n.setMinutes(s), n.setSeconds(0);
                    var o = n.toLocaleTimeString("en-US");
                    jQuery(".icon-panel .clock").html(o)
                }, 250)
            }, e
        }(n.Service);
    e.default = a
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(2).Protocol.MessageType,
        r = i(15),
        a = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                return i.isEnabled = !1, i.tmpWeaponCounter = 0, i
            }
            return s(e, t), e.prototype.onSyncHats = function(t) {}, e.prototype.toggle = function() {
                this.tmpWeaponCounter = (this.tmpWeaponCounter + 1) % 2, this.world.assignedObject instanceof r.default && this.world.socket.sendMessage(o.PlayerSetEquipment, {
                    equipment: this.tmpWeaponCounter
                })
            }, e.prototype.destroy = function() {}, e
        }(n.Service);
    e.default = a
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(38),
        r = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                return i.topId = -1, i.container = document.getElementById("leaderboard"), i
            }
            return s(e, t), e.prototype.onScoreMessagePlayer = function(t) {
                this.currentName = t.content.name, this.currentRank = t.content.rank, this.currentScore = t.content.score
            }, e.prototype.onScoreMessage = function(t) {
                this.latestLeaderboardMessage = t.content;
                var e = [],
                    i = t.content.scoreData,
                    s = t.content.nameData,
                    n = t.content.idData,
                    o = t.content.teamData,
                    r = t.content.rankData;
                n.length > 0 && (this.topId = n[0]);
                for (var a = 0; a < i.length; a++) e.push(this.format(a + 1, s[a], i[a], n[a] === this.world.id, o[a] > -1 && o[a] === this.world.teamId, r[a] || 0));
                this.currentRank > 9 && e.push(this.format(this.currentRank + 1, this.currentName, this.currentScore, !0, !0, 0)), this.container.innerHTML = '\n        <div class="ui-leaderboard-player is-header">\n            <span class="player-rank">Rank</span>\n            <span class="player-name">Name</span>\n            <span class="player-score">Score</span>\n        </div>        \n        ' + e.join(""), this.toggle(i.length > 0)
            }, e.prototype.toggle = function(t) {
                this.container.style.visibility = t ? "visible" : "hidden"
            }, e.prototype.format = function(t, e, i, s, n, r) {
                return '\n        <div class="ui-leaderboard-player player-rankstatus-' + r + " " + (s ? "is-active" : n ? "is-ally" : "") + '">\n            <span class="player-rank">#' + t + '</span>\n            <span class="player-name">' + o.escapeHtml(e) + '</span>\n            <span class="player-score">' + i + "</span>\n        </div>\n        "
            }, e
        }(n.Service);
    e.default = r
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e(e) {
            var i = t.call(this, e) || this;
            return i.levelText = document.getElementById("ui-stats-level-text"), i.levelText.innerText = "Level 1", i.levelProgressBody = document.getElementById("ui-level-bar"), i
        }
        return s(e, t), e.prototype.setLevel = function(t) {
            this.levelText.innerText = "Level " + (t + 1)
        }, e.prototype.setProgress = function(t) {
            var e = Math.round(100 * t);
            e > 100 && (e = 100), this.levelProgressBody.style.width = e + "%"
        }, e.prototype.destroy = function() {
            t.prototype.destroy.call(this)
        }, e
    }(i(1).Service);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e(e) {
            var i = t.call(this, e) || this,
                s = i.world.game.add.tilemap("mapdata");
            i.tileWidth = s.tileWidth, i.tileHeight = s.tileHeight, i.tileWidthCount = s.width, i.tileHeightCount = s.height, s.addTilesetImage("map", "mapimage");
            var n = s.createLayer("Ground");
            return n.resizeWorld(), i.world.camera.bounds.height = 29e3, i.world.game.scale.onSizeChange.add(function() {
                n.resize(this.world.game.width, this.world.game.height), this.world.camera.bounds.height = 29e3
            }, i), i.world.LAYER_BACKGROUND_0.add(n), i
        }
        return s(e, t), e
    }(i(1).Service);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = function() {
            return function(t, e) {
                this.timeout = t, this.text = e
            }
        }(),
        r = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                return i.queue = [], i.label = i.world.game.make.text(0, 0, "", {
                    fontSize: "18px",
                    font: "Roboto Mono"
                }), i.label.anchor.set(0, 1), i.label.stroke = "rgba(0,0,0,0.7)", i.label.strokeThickness = 3, i.label.fill = "#fff", i.label.fixedToCamera = !0, i
            }
            return s(e, t), e.prototype.enqueue = function(t, e) {
                this.queue.push(new o(t, e))
            }, e.prototype.update = function(t) {
                this.currentMessage ? (this.world.game.scale.scaleMode === Phaser.ScaleManager.USER_SCALE ? this.label.cameraOffset.setTo(20 + this.world.game.screenOffsetWidth * this.world.game.scale.scaleFactor.x, this.world.game.height - 180 - this.world.game.screenOffsetHeight * this.world.scale.scaleFactor.y) : this.world.game.scale.scaleMode === Phaser.ScaleManager.RESIZE && this.label.cameraOffset.setTo(20, this.world.game.height - 180), this.currentMessage.timeout > 1 && this.label.alpha < 1 ? this.label.alpha += t : this.currentMessage.timeout < 1 && (this.label.alpha = this.currentMessage.timeout), this.currentMessage.timeout -= t, this.currentMessage.timeout < 0 && (this.currentMessage = null, this.label.parent.removeChild(this.label))) : this.queue.length > 0 && (this.currentMessage = this.queue.shift(), this.label.setText(this.currentMessage.text), this.label.alpha = 0, this.world.LAYER_UI.add(this.label))
            }, e.prototype.destroy = function() {
                this.label.destroy()
            }, e
        }(n.Service);
    e.default = r
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(2).Protocol.MessageType,
        r = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                return i.MAX_TIMEOUT = 1, i.currentTimeout = 1, i.container = document.getElementById("ping-container"), i.toggle(!0), i
            }
            return s(e, t), e.prototype.update = function(t) {
                this.currentTimeout -= t, this.currentTimeout <= 0 && (this.currentTimeout = this.MAX_TIMEOUT, this.world.socket.sendMessage(o.Ping, {
                    time: this.world.game.time.totalElapsedSeconds()
                }))
            }, e.prototype.getAveragePing = function() {
                return .2
            }, e.prototype.onPingReply = function(t) {
                var e = this.world.game.time.totalElapsedSeconds() - t.content.time;
                e = Math.round(1e3 * e), this.container.innerText = e + " ms"
            }, e.prototype.toggle = function(t) {
                this.container.style.display = t ? "block" : "none"
            }, e.prototype.destroy = function() {
                this.toggle(!1)
            }, e
        }(n.Service);
    e.default = r
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(2),
        r = o.Protocol.ResourceType,
        a = o.Protocol.ParseResourceType,
        h = i(11),
        l = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                for (var s in i.currentResources = [0, 0, 0, 0], i.elements = [], i.container = document.getElementById("ui-stats-resources"), r)
                    if (isNaN(parseInt(s))) {
                        var n = document.createElement("div");
                        n.innerText = "0", n.className = "ui-stats-" + s.toLowerCase(), i.elements.push(n), i.container.appendChild(n)
                    } return i.toggle(!0), i
            }
            return s(e, t), e.prototype.toggle = function(t) {
                this.container.style.display = t ? "block" : "none"
            }, e.prototype.sync = function(t) {
                for (var e in this.currentResources = t, this.elements) this.elements[e].innerText = "" + t[e];
                this.world.services.getService(h.CraftMenuService).updateAvailability()
            }, e.prototype.hasResources = function(t) {
                for (var e = 0, i = Object.keys(t); e < i.length; e++) {
                    var s = i[e],
                        n = a(s);
                    if (this.currentResources[n] < t[s]) return !1
                }
                return !0
            }, e.prototype.destroy = function() {
                this.container.innerHTML = ""
            }, e
        }(n.Service);
    e.default = l
}, function(t, e, i) {
    "use strict";
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var s = function() {
        function t() {}
        return t.read = function(t) {
            for (var e = t + "=", i = document.cookie.split(";"), s = 0; s < i.length; s++) {
                for (var n = i[s];
                    " " === n.charAt(0);) n = n.substring(1, n.length);
                if (0 === n.indexOf(e)) return decodeURIComponent(n.substring(e.length, n.length))
            }
            return null
        }, t.write = function(t, e) {
            var i = new Date((new Date).getTime() + 2592e6),
                s = [encodeURIComponent(t) + "=" + encodeURIComponent(e), "domain=." + window.location.hostname, "path=/", "expires=" + i.toUTCString()];
            document.cookie = s.join("; ")
        }, t
    }();
    e.default = s
}, function(t, e, i) {
    "use strict";
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var s = {
        "&": "&amp;",
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#39;",
        "/": "&#x2F;"
    };
    e.escapeHtml = function(t) {
        return String(t).replace(/[&<>"'\/]/g, function(t) {
            return s[t]
        })
    }
}, function(t, e) {
    t.exports = {
        nested: {
            Assign: {
                fields: {
                    id: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    }
                }
            },
            SyncObject: {
                fields: {
                    id: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    },
                    objectType: {
                        type: "uint32",
                        id: 2
                    },
                    x: {
                        type: "float",
                        id: 3
                    },
                    y: {
                        type: "float",
                        id: 4
                    },
                    rotation: {
                        type: "float",
                        id: 5
                    },
                    health: {
                        type: "float",
                        id: 6
                    },
                    maxHealth: {
                        type: "float",
                        id: 7
                    },
                    level: {
                        type: "uint32",
                        id: 8
                    },
                    exp: {
                        type: "float",
                        id: 9
                    },
                    networkId: {
                        type: "uint32",
                        id: 10
                    },
                    playerName: {
                        type: "string",
                        id: 11
                    },
                    transportId: {
                        type: "int32",
                        id: 12
                    },
                    isOpened: {
                        type: "bool",
                        id: 13
                    },
                    parentId: {
                        type: "int32",
                        id: 14
                    },
                    teamId: {
                        type: "int32",
                        id: 15
                    },
                    teamName: {
                        type: "string",
                        id: 16
                    },
                    isTeamAdmin: {
                        type: "bool",
                        id: 17
                    },
                    hatId: {
                        type: "int32",
                        id: 18
                    },
                    rankStatus: {
                        type: "uint32",
                        id: 19
                    },
                    equipment: {
                        type: "uint32",
                        id: 20
                    },
                    metadata: {
                        type: "string",
                        id: 21
                    }
                }
            },
            SyncObjectDelete: {
                fields: {
                    id: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    }
                }
            },
            SyncChild: {
                fields: {
                    id: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    },
                    x: {
                        rule: "required",
                        type: "float",
                        id: 2
                    },
                    y: {
                        rule: "required",
                        type: "float",
                        id: 3
                    },
                    objectType: {
                        rule: "required",
                        type: "uint32",
                        id: 4
                    }
                }
            },
            SyncChildDelete: {
                fields: {
                    id: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    },
                    objectType: {
                        rule: "required",
                        type: "uint32",
                        id: 4
                    }
                }
            },
            ObjectSendDamage: {
                fields: {
                    id: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    },
                    directionX: {
                        type: "float",
                        id: 2
                    },
                    directionY: {
                        type: "float",
                        id: 3
                    }
                }
            },
            ObjectReceiveDamage: {
                fields: {
                    id: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    }
                }
            },
            ChatMessage: {
                fields: {
                    id: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    },
                    message: {
                        rule: "required",
                        type: "string",
                        id: 2
                    }
                }
            },
            ServerChatMessage: {
                fields: {
                    message: {
                        rule: "required",
                        type: "string",
                        id: 1
                    },
                    class: {
                        rule: "required",
                        type: "string",
                        id: 2
                    },
                    networkId: {
                        rule: "required",
                        type: "int32",
                        id: 3
                    }
                }
            },
            ConsoleMessage: {
                fields: {
                    message: {
                        rule: "required",
                        type: "string",
                        id: 1
                    }
                }
            },
            CodeMessage: {
                fields: {
                    message: {
                        rule: "required",
                        type: "string",
                        id: 1
                    }
                }
            },
            PlayerConfigRequest: {
                fields: {}
            },
            PlayerConfigLoad: {
                fields: {
                    config: {
                        rule: "required",
                        type: "string",
                        id: 1
                    }
                }
            },
            PlayerLoginToken: {
                fields: {
                    token: {
                        type: "string",
                        id: 1
                    }
                }
            },
            SyncBackpack: {
                fields: {
                    counts: {
                        rule: "repeated",
                        type: "int32",
                        id: 1,
                        options: {
                            packed: !1
                        }
                    }
                }
            },
            SyncHats: {
                fields: {
                    hatTypes: {
                        rule: "repeated",
                        type: "int32",
                        id: 1,
                        options: {
                            packed: !1
                        }
                    },
                    currentHat: {
                        rule: "required",
                        type: "int32",
                        id: 2
                    }
                }
            },
            Ping: {
                fields: {
                    time: {
                        rule: "required",
                        type: "float",
                        id: 1
                    }
                }
            },
            RequestServerInfo: {
                fields: {}
            },
            ResponseServerInfo: {
                fields: {
                    clientCount: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    },
                    health: {
                        rule: "required",
                        type: "int32",
                        id: 2
                    }
                }
            },
            FloatResources: {
                fields: {
                    id: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    },
                    counts: {
                        rule: "repeated",
                        type: "int32",
                        id: 2,
                        options: {
                            packed: !1
                        }
                    }
                }
            },
            MapMessage: {
                fields: {
                    data: {
                        rule: "repeated",
                        type: "int32",
                        id: 1,
                        options: {
                            packed: !1
                        }
                    },
                    teamIdData: {
                        rule: "repeated",
                        type: "int32",
                        id: 2,
                        options: {
                            packed: !1
                        }
                    }
                }
            },
            LeaderboardMessage: {
                fields: {
                    scoreData: {
                        rule: "repeated",
                        type: "int32",
                        id: 1,
                        options: {
                            packed: !1
                        }
                    },
                    nameData: {
                        rule: "repeated",
                        type: "string",
                        id: 2,
                        options: {
                            packed: !1
                        }
                    },
                    idData: {
                        rule: "repeated",
                        type: "int32",
                        id: 3,
                        options: {
                            packed: !1
                        }
                    },
                    teamData: {
                        rule: "repeated",
                        type: "int32",
                        id: 4,
                        options: {
                            packed: !1
                        }
                    },
                    teamNameData: {
                        rule: "repeated",
                        type: "string",
                        id: 5,
                        options: {
                            packed: !1
                        }
                    },
                    rankData: {
                        rule: "repeated",
                        type: "int32",
                        id: 6,
                        options: {
                            packed: !1
                        }
                    }
                }
            },
            LeaderboardMessagePlayer: {
                fields: {
                    score: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    },
                    name: {
                        rule: "required",
                        type: "string",
                        id: 2
                    },
                    id: {
                        rule: "required",
                        type: "int32",
                        id: 3
                    },
                    rank: {
                        rule: "required",
                        type: "int32",
                        id: 4
                    }
                }
            },
            ForceDisconnect: {
                fields: {
                    reason: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    }
                }
            },
            PackedMessage: {
                fields: {
                    sizes: {
                        rule: "repeated",
                        type: "uint32",
                        id: 1,
                        options: {
                            packed: !1
                        }
                    },
                    message: {
                        type: "bytes",
                        id: 2
                    }
                }
            },
            DayTimeMessage: {
                fields: {
                    hour: {
                        rule: "required",
                        type: "float",
                        id: 1
                    }
                }
            },
            ServerVersion: {
                fields: {
                    version: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    },
                    id: {
                        rule: "required",
                        type: "int32",
                        id: 2
                    }
                }
            },
            PlayerInput: {
                fields: {
                    x: {
                        rule: "required",
                        type: "float",
                        id: 1
                    },
                    y: {
                        rule: "required",
                        type: "float",
                        id: 2
                    },
                    rotation: {
                        rule: "required",
                        type: "float",
                        id: 3
                    }
                }
            },
            PlayerCheat: {
                fields: {
                    cheatType: {
                        rule: "required",
                        type: "uint32",
                        id: 1
                    },
                    password: {
                        rule: "required",
                        type: "string",
                        id: 2
                    }
                }
            },
            PlayerAction: {
                fields: {
                    x: {
                        rule: "required",
                        type: "float",
                        id: 1
                    },
                    y: {
                        rule: "required",
                        type: "float",
                        id: 2
                    },
                    action: {
                        rule: "required",
                        type: "uint32",
                        id: 3
                    }
                }
            },
            PlayerSpawnRequest: {
                fields: {
                    name: {
                        type: "string",
                        id: 1
                    }
                }
            },
            PlayerBuildRequest: {
                fields: {
                    x: {
                        rule: "required",
                        type: "float",
                        id: 1
                    },
                    y: {
                        rule: "required",
                        type: "float",
                        id: 2
                    },
                    buildingType: {
                        rule: "required",
                        type: "uint32",
                        id: 3
                    }
                }
            },
            PlayerBuildResponse: {
                fields: {
                    success: {
                        rule: "required",
                        type: "bool",
                        id: 1
                    }
                }
            },
            PlayerChatRequest: {
                fields: {
                    message: {
                        rule: "required",
                        type: "string",
                        id: 1
                    }
                }
            },
            PlayerUnmountRequest: {
                fields: {}
            },
            PlayerSetViewportSize: {
                fields: {
                    width: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    },
                    height: {
                        rule: "required",
                        type: "int32",
                        id: 2
                    }
                }
            },
            PlayerTeamPingRequest: {
                fields: {}
            },
            PlayerTeamPingResponse: {
                fields: {
                    playerId: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    },
                    playerName: {
                        rule: "required",
                        type: "string",
                        id: 2
                    },
                    x: {
                        rule: "required",
                        type: "float",
                        id: 3
                    },
                    y: {
                        rule: "required",
                        type: "float",
                        id: 4
                    }
                }
            },
            PlayerRequestDaytime: {
                fields: {}
            },
            PlayerSetEquipment: {
                fields: {
                    equipment: {
                        rule: "required",
                        type: "uint32",
                        id: 1
                    }
                }
            },
            PlayerSelectHat: {
                fields: {
                    hatType: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    }
                }
            },
            PlayerCreateTeam: {
                fields: {
                    name: {
                        rule: "required",
                        type: "string",
                        id: 1
                    }
                }
            },
            PlayerJoinTeam: {
                fields: {
                    teamId: {
                        rule: "required",
                        type: "uint32",
                        id: 1
                    }
                }
            },
            PlayerApproveRequest: {
                fields: {
                    requestId: {
                        rule: "required",
                        type: "uint32",
                        id: 1
                    }
                }
            },
            PlayerDeclineRequest: {
                fields: {
                    requestId: {
                        rule: "required",
                        type: "uint32",
                        id: 1
                    }
                }
            },
            PlayerLeaveTeam: {
                fields: {}
            },
            PlayerKickRequest: {
                fields: {
                    networkId: {
                        rule: "required",
                        type: "uint32",
                        id: 2
                    }
                }
            },
            PlayerTeamMembersRequest: {
                fields: {
                    teamId: {
                        rule: "required",
                        type: "uint32",
                        id: 1
                    }
                }
            },
            PlayerTeamMembersResponse: {
                fields: {
                    teamId: {
                        rule: "required",
                        type: "uint32",
                        id: 1
                    },
                    networkId: {
                        rule: "repeated",
                        type: "uint32",
                        id: 2,
                        options: {
                            packed: !1
                        }
                    },
                    name: {
                        rule: "repeated",
                        type: "string",
                        id: 3,
                        options: {
                            packed: !1
                        }
                    }
                }
            },
            PlayerUIEvent: {
                fields: {
                    eventType: {
                        rule: "required",
                        type: "string",
                        id: 1
                    },
                    eventData: {
                        rule: "required",
                        type: "string",
                        id: 2
                    }
                }
            },
            PlayerTeamListRequest: {
                fields: {}
            },
            PlayerTeamListResponse: {
                fields: {
                    teamId: {
                        rule: "repeated",
                        type: "uint32",
                        id: 1,
                        options: {
                            packed: !1
                        }
                    },
                    teamName: {
                        rule: "repeated",
                        type: "string",
                        id: 2,
                        options: {
                            packed: !1
                        }
                    },
                    memberCount: {
                        rule: "repeated",
                        type: "uint32",
                        id: 3,
                        options: {
                            packed: !1
                        }
                    }
                }
            },
            NotifyTeamCreated: {
                fields: {
                    teamId: {
                        rule: "required",
                        type: "uint32",
                        id: 1
                    },
                    teamName: {
                        rule: "required",
                        type: "string",
                        id: 2
                    }
                }
            },
            NotifyTeamRemoved: {
                fields: {
                    teamId: {
                        rule: "required",
                        type: "uint32",
                        id: 1
                    }
                }
            },
            NotifyJoinRequestCreated: {
                fields: {
                    id: {
                        rule: "required",
                        type: "uint32",
                        id: 1
                    },
                    teamId: {
                        rule: "required",
                        type: "uint32",
                        id: 2
                    },
                    fromName: {
                        rule: "required",
                        type: "string",
                        id: 3
                    }
                }
            },
            NotifyJoinRequestRemoved: {
                fields: {
                    id: {
                        rule: "required",
                        type: "uint32",
                        id: 1
                    }
                }
            },
            NotifyMemberJoin: {
                fields: {
                    teamId: {
                        rule: "required",
                        type: "uint32",
                        id: 1
                    },
                    memberId: {
                        rule: "required",
                        type: "uint32",
                        id: 2
                    },
                    memberName: {
                        rule: "required",
                        type: "string",
                        id: 3
                    }
                }
            },
            NotifyMemberLeave: {
                fields: {
                    teamId: {
                        rule: "required",
                        type: "uint32",
                        id: 1
                    },
                    memberId: {
                        rule: "required",
                        type: "uint32",
                        id: 2
                    }
                }
            },
            PlayerAPIResponse: {
                fields: {
                    status: {
                        rule: "required",
                        type: "int32",
                        id: 1
                    },
                    data: {
                        rule: "required",
                        type: "string",
                        id: 2
                    },
                    identifier: {
                        rule: "required",
                        type: "string",
                        id: 3
                    }
                }
            },
            PlayerAPIRequest: {
                fields: {
                    function: {
                        rule: "required",
                        type: "string",
                        id: 1
                    },
                    data: {
                        rule: "required",
                        type: "string",
                        id: 2
                    },
                    identifier: {
                        rule: "required",
                        type: "string",
                        id: 3
                    }
                }
            }
        }
    }
}, function(t, e, i) {
    "use strict";
    (function(t) {
        function s() {
            var t = {
                width: 1920,
                height: 1080,
                renderer: Phaser.AUTO,
                antialias: !0,
                resolution: 1,
                parent: "gamecanvas"
            };
            new y(t)
        }
        var n = this && this.__extends || function() {
                var t = Object.setPrototypeOf || {
                    __proto__: []
                }
                instanceof Array && function(t, e) {
                    t.__proto__ = e
                } || function(t, e) {
                    for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
                };
                return function(e, i) {
                    function s() {
                        this.constructor = e
                    }
                    t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
                }
            }(),
            o = this;
        Object.defineProperty(e, "__esModule", {
            value: !0
        }), t.Config = i(135), t.p2 = i(91), t.PIXI = i(93), t.Phaser = i(92);
        var r = (i(136), i(20));
        t.Protocol = r.Root.fromJSON(i(39));
        var a = i(131),
            h = i(122),
            l = i(129),
            c = i(123),
            u = i(126),
            d = i(124),
            p = i(128),
            f = i(125),
            m = i(127),
            g = i(3),
            y = function(t) {
                function e(e) {
                    var i = t.call(this, e) || this;
                    return i.state.add("boot", h.default), i.state.add("preloader", l.default), i.state.add("lobby", p.default), i.state.add("connection", c.default), i.state.add("game", u.default), i.state.add("crash", d.default), i.state.add("full", f.default), i.state.add("kicked", m.default), i.state.start("boot"), i
                }
                return n(e, t), e
            }(Phaser.Game);
        window.onload = function() {
            var t = null,
                e = ["Roboto Mono"];
            if (e.length > 0 && ((t = t || {}).google = {
                    families: e
                }), Object.keys(g.CustomWebFonts).length > 0)
                for (var i in (t = t || {}).custom = {
                        families: [],
                        urls: []
                    }, g.CustomWebFonts) t.custom.families.push(g.CustomWebFonts[i].getFamily()), t.custom.urls.push(g.CustomWebFonts[i].getCSS());
            var n = ['If you are a Youtuber, simply follow "For Youtubers" link at the bottom of the page!', "If you have any suggestions or ideas regarding the game, please let us know!", "Finding a pig with a saddle is a great luck!", "You need to build more towers to stay on top of the leaderboard!", 'Invite your friends using "Create party link" at the bottom of the page in order to play together!', "Nothing ventured, nothing gained.", "Are you going to attack the enemy? Don't forget to leave guards in the castle!", "If you need a lot of food, make beds as soon as possible!", "You can block enemy doors by building your walls nearby.", "The number of wall blocks is limited, but you can save some by building a castle near the border of the world.", "When attacking the enemy, you can create your guards next to him.", "If your mercenaries are killed during the battle, you can instantly create new ones. Make sure you always have enough food for it.", "Take good care of your peasants since higher-level units extract more resources.", "The stone of life saves you life, but you lose all the resources you have collected.", "If you died and used the stone of life, do not forget to build a new one!", "After defeating your enemy, you will get a quarter of all his resources, including gold.", "Sometimes the best defense is a good offense!", "The battle for glory has begun!"];
            jQuery.ajax("https://app.glar.io/api/assets/youtubers.json").done(function(t) {
                jQuery("#featuredyoutuber").html(' <div class="header">Featured youtuber:</div>');
                var e = t[Math.floor(Math.random() * t.length)],
                    i = document.createElement("div");
                i.innerHTML = '<div class="g-ytsubscribe" id="ytbutton" data-channelid="' + e + '" data-layout="full" data-theme="dark" data-count="default"></div>', document.getElementById("featuredyoutuber").appendChild(i);
                var s = document.createElement("script");
                s.src = "https://apis.google.com/js/platform.js", document.body.appendChild(s)
            }.bind(o));
            var r = document.getElementById("motd"),
                h = document.getElementById("motdcontent"),
                l = n[Math.floor(Math.random() * n.length)];
            l && (h.innerText = l, r.style.display = "block"), null === t ? s() : (t.active = s, a.load(t))
        }
    }).call(e, i(133))
}, function(t, e, i) {
    t.exports = i.p + "assets/9e3b4946d43639a1958f57840f945e59.json"
}, function(t, e, i) {
    t.exports = i.p + "assets/d014f0796d7b5fc13d46971342767bf0.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/b271fd2a8e8c23654d589be5333122ec.json"
}, function(t, e, i) {
    t.exports = i.p + "assets/51f91a1be21b6fcd86432bfc74b11a11.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/16084c631c908fc9458e641b7efc2b99.json"
}, function(t, e, i) {
    t.exports = i.p + "assets/2a44535bfcca66d440a7a9740a5ab47c.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/25781f4c69f16e821c31cbccc8a51270.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/c595bf5ba6c176d0de4f6d7d184f3fbf.json"
}, function(t, e, i) {
    t.exports = i.p + "assets/02e379b0c3ebb0011af9f6ba104a8a6f.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/a891b932ac92ecb2f343cd24c94ce7c7.json"
}, function(t, e, i) {
    t.exports = i.p + "assets/caff126eb20ae994c21efb8e57f4581c.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/c68987856846311e1af1e68a5136d288.css"
}, function(t, e, i) {
    t.exports = i.p + "assets/696c081ae56a5d4674d5da24e7810ab7.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/a5ff655c7376ab8e24439f2f23d8fbed.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/192cb9459cbc0f9e73e2591b700f1857.svg"
}, function(t, e, i) {
    t.exports = i.p + "assets/57010b43d6e298672a1e1604bfca3826.ico"
}, function(t, e, i) {
    t.exports = i.p + "assets/0db48643c69bc3fb842e5652b76d9718.gif"
}, function(t, e, i) {
    t.exports = i.p + "assets/b71fda7a86f2f8ccb7091103956a57d9.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/c3fd005976357bcd8d6f8602f9a4c8f3.svg"
}, function(t, e, i) {
    t.exports = i.p + "assets/89bfb659798f45545da975d1dc3600fb.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/daa3c9e934bd935339231a9b3c22c978.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/553fd41d991bbca46f46fbc149fe3d46.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/c6ebd091114f2e0df299c0af24826369.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/5162a275548350b68d5c041e7102ae6a.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/b50b522446ae05486451fc235869777e.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/1d7bb62d8d3106d5a43145d763eb3d93.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/90e5e08d57f64c40820cd64c5d4d2b7e.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/19ca07092a81eb9cccefad3446954ee2.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/ac9427e710619c93c8d29bec46d971b8.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/4577a7bc6ad5dd12e4a45217ae25cba1.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/1a7a0b4b62725022a408b2816b19c356.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/18142f8f6a147279c3344d44a382db0e.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/3777b218a9570fae87d2bf8f3b70fd00.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/664d43fd30e91b92145afd8310cd8c99.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/782552d7fb5e4bb0152ee27c65fb231e.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/d261925a7ef9849cc7566deb830e8e9e.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/373f8b35d47074a8e1feb770ec2e3437.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/14cc9c1fcb5ed3d7c8669d9c75327f8d.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/17f8da00f7249a55b8913d22dfde4179.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/8bb9ca3a6d5fdf10d0bd74bba485f5fd.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/3ba62ff67ed03d48b589b6d6eb79e63d.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/55983d9df69fdc99ad35327a25e63b46.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/54cc12793220036ec8d384ed1bc2d304.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/d9f056add712e42c53ceddcc3d79d559.js"
}, function(t, e, i) {
    t.exports = i.p + "assets/4670d8e88f2ab0b0d64bfc9f35839e12.js"
}, function(t, e, i) {
    t.exports = i.p + "assets/2100c36a6d289e2f43df11698756cccc.json"
}, function(t, e, i) {
    t.exports = i.p + "assets/6cfd97ac8698a1a0a591ccef77418c16.png"
}, function(t, e, i) {
    t.exports = i.p + "assets/e2177030752e51af870d02ff561e391d.wav"
}, function(t, e, i) {
    t.exports = i.p + "assets/6e3a57f5b6ad4b92099ce4fb5d5a5241.frag"
}, function(t, e, i) {
    var s, n, o;
    n = [], s = function() {
        "use strict";

        function t(t, e, i) {
            this.low = 0 | t, this.high = 0 | e, this.unsigned = !!i
        }

        function e(t) {
            return !0 === (t && t.__isLong__)
        }

        function i(t, e) {
            var i, s, o;
            return e ? (o = 0 <= (t >>>= 0) && t < 256) && (s = h[t]) ? s : (i = n(t, (0 | t) < 0 ? -1 : 0, !0), o && (h[t] = i), i) : (o = -128 <= (t |= 0) && t < 128) && (s = a[t]) ? s : (i = n(t, t < 0 ? -1 : 0, !1), o && (a[t] = i), i)
        }

        function s(t, e) {
            if (isNaN(t) || !isFinite(t)) return e ? m : f;
            if (e) {
                if (t < 0) return m;
                if (t >= u) return _
            } else {
                if (t <= -d) return w;
                if (t + 1 >= d) return b
            }
            return t < 0 ? s(-t, e).neg() : n(t % c | 0, t / c | 0, e)
        }

        function n(e, i, s) {
            return new t(e, i, s)
        }

        function o(t, e, i) {
            if (0 === t.length) throw Error("empty string");
            if ("NaN" === t || "Infinity" === t || "+Infinity" === t || "-Infinity" === t) return f;
            if ("number" == typeof e ? (i = e, e = !1) : e = !!e, (i = i || 10) < 2 || 36 < i) throw RangeError("radix");
            var n;
            if ((n = t.indexOf("-")) > 0) throw Error("interior hyphen");
            if (0 === n) return o(t.substring(1), e, i).neg();
            for (var r = s(l(i, 8)), a = f, h = 0; h < t.length; h += 8) {
                var c = Math.min(8, t.length - h),
                    u = parseInt(t.substring(h, h + c), i);
                if (c < 8) {
                    var d = s(l(i, c));
                    a = a.mul(d).add(s(u))
                } else a = (a = a.mul(r)).add(s(u))
            }
            return a.unsigned = e, a
        }

        function r(e) {
            return e instanceof t ? e : "number" == typeof e ? s(e) : "string" == typeof e ? o(e) : n(e.low, e.high, e.unsigned)
        }
        t.prototype.__isLong__, Object.defineProperty(t.prototype, "__isLong__", {
            value: !0,
            enumerable: !1,
            configurable: !1
        }), t.isLong = e;
        var a = {},
            h = {};
        t.fromInt = i, t.fromNumber = s, t.fromBits = n;
        var l = Math.pow;
        t.fromString = o, t.fromValue = r;
        var c = 4294967296,
            u = c * c,
            d = u / 2,
            p = i(1 << 24),
            f = i(0);
        t.ZERO = f;
        var m = i(0, !0);
        t.UZERO = m;
        var g = i(1);
        t.ONE = g;
        var y = i(1, !0);
        t.UONE = y;
        var v = i(-1);
        t.NEG_ONE = v;
        var b = n(-1, 2147483647, !1);
        t.MAX_VALUE = b;
        var _ = n(-1, -1, !0);
        t.MAX_UNSIGNED_VALUE = _;
        var w = n(0, -2147483648, !1);
        t.MIN_VALUE = w;
        var x = t.prototype;
        return x.toInt = function() {
            return this.unsigned ? this.low >>> 0 : this.low
        }, x.toNumber = function() {
            return this.unsigned ? (this.high >>> 0) * c + (this.low >>> 0) : this.high * c + (this.low >>> 0)
        }, x.toString = function(t) {
            if ((t = t || 10) < 2 || 36 < t) throw RangeError("radix");
            if (this.isZero()) return "0";
            if (this.isNegative()) {
                if (this.eq(w)) {
                    var e = s(t),
                        i = this.div(e),
                        n = i.mul(e).sub(this);
                    return i.toString(t) + n.toInt().toString(t)
                }
                return "-" + this.neg().toString(t)
            }
            for (var o = s(l(t, 6), this.unsigned), r = this, a = "";;) {
                var h = r.div(o),
                    c = r.sub(h.mul(o)).toInt() >>> 0,
                    u = c.toString(t);
                if ((r = h).isZero()) return u + a;
                for (; u.length < 6;) u = "0" + u;
                a = "" + u + a
            }
        }, x.getHighBits = function() {
            return this.high
        }, x.getHighBitsUnsigned = function() {
            return this.high >>> 0
        }, x.getLowBits = function() {
            return this.low
        }, x.getLowBitsUnsigned = function() {
            return this.low >>> 0
        }, x.getNumBitsAbs = function() {
            if (this.isNegative()) return this.eq(w) ? 64 : this.neg().getNumBitsAbs();
            for (var t = 0 != this.high ? this.high : this.low, e = 31; e > 0 && 0 == (t & 1 << e); e--);
            return 0 != this.high ? e + 33 : e + 1
        }, x.isZero = function() {
            return 0 === this.high && 0 === this.low
        }, x.isNegative = function() {
            return !this.unsigned && this.high < 0
        }, x.isPositive = function() {
            return this.unsigned || this.high >= 0
        }, x.isOdd = function() {
            return 1 == (1 & this.low)
        }, x.isEven = function() {
            return 0 == (1 & this.low)
        }, x.equals = function(t) {
            return e(t) || (t = r(t)), (this.unsigned === t.unsigned || this.high >>> 31 != 1 || t.high >>> 31 != 1) && this.high === t.high && this.low === t.low
        }, x.eq = x.equals, x.notEquals = function(t) {
            return !this.eq(t)
        }, x.neq = x.notEquals, x.lessThan = function(t) {
            return this.comp(t) < 0
        }, x.lt = x.lessThan, x.lessThanOrEqual = function(t) {
            return this.comp(t) <= 0
        }, x.lte = x.lessThanOrEqual, x.greaterThan = function(t) {
            return this.comp(t) > 0
        }, x.gt = x.greaterThan, x.greaterThanOrEqual = function(t) {
            return this.comp(t) >= 0
        }, x.gte = x.greaterThanOrEqual, x.compare = function(t) {
            if (e(t) || (t = r(t)), this.eq(t)) return 0;
            var i = this.isNegative(),
                s = t.isNegative();
            return i && !s ? -1 : !i && s ? 1 : this.unsigned ? t.high >>> 0 > this.high >>> 0 || t.high === this.high && t.low >>> 0 > this.low >>> 0 ? -1 : 1 : this.sub(t).isNegative() ? -1 : 1
        }, x.comp = x.compare, x.negate = function() {
            return !this.unsigned && this.eq(w) ? w : this.not().add(g)
        }, x.neg = x.negate, x.add = function(t) {
            e(t) || (t = r(t));
            var i = this.high >>> 16,
                s = 65535 & this.high,
                o = this.low >>> 16,
                a = 65535 & this.low,
                h = t.high >>> 16,
                l = 65535 & t.high,
                c = t.low >>> 16,
                u = 65535 & t.low,
                d = 0,
                p = 0,
                f = 0,
                m = 0;
            return f += (m += a + u) >>> 16, p += (f += o + c) >>> 16, d += (p += s + l) >>> 16, d += i + h, n((f &= 65535) << 16 | (m &= 65535), (d &= 65535) << 16 | (p &= 65535), this.unsigned)
        }, x.subtract = function(t) {
            return e(t) || (t = r(t)), this.add(t.neg())
        }, x.sub = x.subtract, x.multiply = function(t) {
            if (this.isZero()) return f;
            if (e(t) || (t = r(t)), t.isZero()) return f;
            if (this.eq(w)) return t.isOdd() ? w : f;
            if (t.eq(w)) return this.isOdd() ? w : f;
            if (this.isNegative()) return t.isNegative() ? this.neg().mul(t.neg()) : this.neg().mul(t).neg();
            if (t.isNegative()) return this.mul(t.neg()).neg();
            if (this.lt(p) && t.lt(p)) return s(this.toNumber() * t.toNumber(), this.unsigned);
            var i = this.high >>> 16,
                o = 65535 & this.high,
                a = this.low >>> 16,
                h = 65535 & this.low,
                l = t.high >>> 16,
                c = 65535 & t.high,
                u = t.low >>> 16,
                d = 65535 & t.low,
                m = 0,
                g = 0,
                y = 0,
                v = 0;
            return y += (v += h * d) >>> 16, g += (y += a * d) >>> 16, y &= 65535, g += (y += h * u) >>> 16, m += (g += o * d) >>> 16, g &= 65535, m += (g += a * u) >>> 16, g &= 65535, m += (g += h * c) >>> 16, m += i * d + o * u + a * c + h * l, n((y &= 65535) << 16 | (v &= 65535), (m &= 65535) << 16 | (g &= 65535), this.unsigned)
        }, x.mul = x.multiply, x.divide = function(t) {
            if (e(t) || (t = r(t)), t.isZero()) throw Error("division by zero");
            if (this.isZero()) return this.unsigned ? m : f;
            var i, n, o;
            if (this.unsigned) {
                if (t.unsigned || (t = t.toUnsigned()), t.gt(this)) return m;
                if (t.gt(this.shru(1))) return y;
                o = m
            } else {
                if (this.eq(w)) return t.eq(g) || t.eq(v) ? w : t.eq(w) ? g : (i = this.shr(1).div(t).shl(1)).eq(f) ? t.isNegative() ? g : v : (n = this.sub(t.mul(i)), o = i.add(n.div(t)));
                if (t.eq(w)) return this.unsigned ? m : f;
                if (this.isNegative()) return t.isNegative() ? this.neg().div(t.neg()) : this.neg().div(t).neg();
                if (t.isNegative()) return this.div(t.neg()).neg();
                o = f
            }
            for (n = this; n.gte(t);) {
                i = Math.max(1, Math.floor(n.toNumber() / t.toNumber()));
                for (var a = Math.ceil(Math.log(i) / Math.LN2), h = a <= 48 ? 1 : l(2, a - 48), c = s(i), u = c.mul(t); u.isNegative() || u.gt(n);) c = s(i -= h, this.unsigned), u = c.mul(t);
                c.isZero() && (c = g), o = o.add(c), n = n.sub(u)
            }
            return o
        }, x.div = x.divide, x.modulo = function(t) {
            return e(t) || (t = r(t)), this.sub(this.div(t).mul(t))
        }, x.mod = x.modulo, x.not = function() {
            return n(~this.low, ~this.high, this.unsigned)
        }, x.and = function(t) {
            return e(t) || (t = r(t)), n(this.low & t.low, this.high & t.high, this.unsigned)
        }, x.or = function(t) {
            return e(t) || (t = r(t)), n(this.low | t.low, this.high | t.high, this.unsigned)
        }, x.xor = function(t) {
            return e(t) || (t = r(t)), n(this.low ^ t.low, this.high ^ t.high, this.unsigned)
        }, x.shiftLeft = function(t) {
            return e(t) && (t = t.toInt()), 0 == (t &= 63) ? this : t < 32 ? n(this.low << t, this.high << t | this.low >>> 32 - t, this.unsigned) : n(0, this.low << t - 32, this.unsigned)
        }, x.shl = x.shiftLeft, x.shiftRight = function(t) {
            return e(t) && (t = t.toInt()), 0 == (t &= 63) ? this : t < 32 ? n(this.low >>> t | this.high << 32 - t, this.high >> t, this.unsigned) : n(this.high >> t - 32, this.high >= 0 ? 0 : -1, this.unsigned)
        }, x.shr = x.shiftRight, x.shiftRightUnsigned = function(t) {
            if (e(t) && (t = t.toInt()), 0 == (t &= 63)) return this;
            var i = this.high;
            return t < 32 ? n(this.low >>> t | i << 32 - t, i >>> t, this.unsigned) : n(32 === t ? i : i >>> t - 32, 0, this.unsigned)
        }, x.shru = x.shiftRightUnsigned, x.toSigned = function() {
            return this.unsigned ? n(this.low, this.high, !1) : this
        }, x.toUnsigned = function() {
            return this.unsigned ? this : n(this.low, this.high, !0)
        }, x.toBytes = function(t) {
            return t ? this.toBytesLE() : this.toBytesBE()
        }, x.toBytesLE = function() {
            var t = this.high,
                e = this.low;
            return [255 & e, e >>> 8 & 255, e >>> 16 & 255, e >>> 24 & 255, 255 & t, t >>> 8 & 255, t >>> 16 & 255, t >>> 24 & 255]
        }, x.toBytesBE = function() {
            var t = this.high,
                e = this.low;
            return [t >>> 24 & 255, t >>> 16 & 255, t >>> 8 & 255, 255 & t, e >>> 24 & 255, e >>> 16 & 255, e >>> 8 & 255, 255 & e]
        }, t
    }, void 0 !== (o = "function" == typeof s ? s.apply(e, n) : s) && (t.exports = o)
}, function(t, e) {
    var i, s;
    i = function() {
        return function t(e, i, s) {
            function n(r, a) {
                if (!i[r]) {
                    if (!e[r]) {
                        var h = "function" == typeof require && require;
                        if (!a && h) return h(r, !0);
                        if (o) return o(r, !0);
                        throw new Error("Cannot find module '" + r + "'")
                    }
                    var l = i[r] = {
                        exports: {}
                    };
                    e[r][0].call(l.exports, function(t) {
                        return n(e[r][1][t] || t)
                    }, l, l.exports, t, e, i, s)
                }
                return i[r].exports
            }
            for (var o = "function" == typeof require && require, r = 0; r < s.length; r++) n(s[r]);
            return n
        }({
            1: [function(t, e, i) {
                function s() {}
                var n = t("./Scalar");
                e.exports = s, s.lineInt = function(t, e, i) {
                    i = i || 0;
                    var s, o, r, a, h, l, c, u = [0, 0];
                    return s = t[1][1] - t[0][1], o = t[0][0] - t[1][0], r = s * t[0][0] + o * t[0][1], a = e[1][1] - e[0][1], h = e[0][0] - e[1][0], l = a * e[0][0] + h * e[0][1], c = s * h - a * o, n.eq(c, 0, i) || (u[0] = (h * r - o * l) / c, u[1] = (s * l - a * r) / c), u
                }, s.segmentsIntersect = function(t, e, i, s) {
                    var n = e[0] - t[0],
                        o = e[1] - t[1],
                        r = s[0] - i[0],
                        a = s[1] - i[1];
                    if (r * o - a * n == 0) return !1;
                    var h = (n * (i[1] - t[1]) + o * (t[0] - i[0])) / (r * o - a * n),
                        l = (r * (t[1] - i[1]) + a * (i[0] - t[0])) / (a * n - r * o);
                    return h >= 0 && h <= 1 && l >= 0 && l <= 1
                }
            }, {
                "./Scalar": 4
            }],
            2: [function(t, e, i) {
                function s() {}
                e.exports = s, s.area = function(t, e, i) {
                    return (e[0] - t[0]) * (i[1] - t[1]) - (i[0] - t[0]) * (e[1] - t[1])
                }, s.left = function(t, e, i) {
                    return s.area(t, e, i) > 0
                }, s.leftOn = function(t, e, i) {
                    return s.area(t, e, i) >= 0
                }, s.right = function(t, e, i) {
                    return s.area(t, e, i) < 0
                }, s.rightOn = function(t, e, i) {
                    return s.area(t, e, i) <= 0
                };
                var n = [],
                    o = [];
                s.collinear = function(t, e, i, r) {
                    if (r) {
                        var a = n,
                            h = o;
                        a[0] = e[0] - t[0], a[1] = e[1] - t[1], h[0] = i[0] - e[0], h[1] = i[1] - e[1];
                        var l = a[0] * h[0] + a[1] * h[1],
                            c = Math.sqrt(a[0] * a[0] + a[1] * a[1]),
                            u = Math.sqrt(h[0] * h[0] + h[1] * h[1]);
                        return Math.acos(l / (c * u)) < r
                    }
                    return 0 == s.area(t, e, i)
                }, s.sqdist = function(t, e) {
                    var i = e[0] - t[0],
                        s = e[1] - t[1];
                    return i * i + s * s
                }
            }, {}],
            3: [function(t, e, i) {
                function s() {
                    this.vertices = []
                }

                function n(t, e, i, s, n) {
                    n = n || 0;
                    var o = e[1] - t[1],
                        r = t[0] - e[0],
                        h = o * t[0] + r * t[1],
                        l = s[1] - i[1],
                        c = i[0] - s[0],
                        u = l * i[0] + c * i[1],
                        d = o * c - l * r;
                    return a.eq(d, 0, n) ? [0, 0] : [(c * h - r * u) / d, (o * u - l * h) / d]
                }
                var o = t("./Line"),
                    r = t("./Point"),
                    a = t("./Scalar");
                e.exports = s, s.prototype.at = function(t) {
                    var e = this.vertices,
                        i = e.length;
                    return e[t < 0 ? t % i + i : t % i]
                }, s.prototype.first = function() {
                    return this.vertices[0]
                }, s.prototype.last = function() {
                    return this.vertices[this.vertices.length - 1]
                }, s.prototype.clear = function() {
                    this.vertices.length = 0
                }, s.prototype.append = function(t, e, i) {
                    if (void 0 === e) throw new Error("From is not given!");
                    if (void 0 === i) throw new Error("To is not given!");
                    if (i - 1 < e) throw new Error("lol1");
                    if (i > t.vertices.length) throw new Error("lol2");
                    if (e < 0) throw new Error("lol3");
                    for (var s = e; s < i; s++) this.vertices.push(t.vertices[s])
                }, s.prototype.makeCCW = function() {
                    for (var t = 0, e = this.vertices, i = 1; i < this.vertices.length; ++i)(e[i][1] < e[t][1] || e[i][1] == e[t][1] && e[i][0] > e[t][0]) && (t = i);
                    r.left(this.at(t - 1), this.at(t), this.at(t + 1)) || this.reverse()
                }, s.prototype.reverse = function() {
                    for (var t = [], e = 0, i = this.vertices.length; e !== i; e++) t.push(this.vertices.pop());
                    this.vertices = t
                }, s.prototype.isReflex = function(t) {
                    return r.right(this.at(t - 1), this.at(t), this.at(t + 1))
                };
                var h = [],
                    l = [];
                s.prototype.canSee = function(t, e) {
                    var i, s, n = h,
                        a = l;
                    if (r.leftOn(this.at(t + 1), this.at(t), this.at(e)) && r.rightOn(this.at(t - 1), this.at(t), this.at(e))) return !1;
                    s = r.sqdist(this.at(t), this.at(e));
                    for (var c = 0; c !== this.vertices.length; ++c)
                        if ((c + 1) % this.vertices.length !== t && c !== t && r.leftOn(this.at(t), this.at(e), this.at(c + 1)) && r.rightOn(this.at(t), this.at(e), this.at(c)) && (n[0] = this.at(t), n[1] = this.at(e), a[0] = this.at(c), a[1] = this.at(c + 1), i = o.lineInt(n, a), r.sqdist(this.at(t), i) < s)) return !1;
                    return !0
                }, s.prototype.copy = function(t, e, i) {
                    var n = i || new s;
                    if (n.clear(), t < e)
                        for (var o = t; o <= e; o++) n.vertices.push(this.vertices[o]);
                    else {
                        for (o = 0; o <= e; o++) n.vertices.push(this.vertices[o]);
                        for (o = t; o < this.vertices.length; o++) n.vertices.push(this.vertices[o])
                    }
                    return n
                }, s.prototype.getCutEdges = function() {
                    for (var t = [], e = [], i = [], n = new s, o = Number.MAX_VALUE, r = 0; r < this.vertices.length; ++r)
                        if (this.isReflex(r))
                            for (var a = 0; a < this.vertices.length; ++a)
                                if (this.canSee(r, a)) {
                                    e = this.copy(r, a, n).getCutEdges(), i = this.copy(a, r, n).getCutEdges();
                                    for (var h = 0; h < i.length; h++) e.push(i[h]);
                                    e.length < o && (t = e, o = e.length, t.push([this.at(r), this.at(a)]))
                                } return t
                }, s.prototype.decomp = function() {
                    var t = this.getCutEdges();
                    return t.length > 0 ? this.slice(t) : [this]
                }, s.prototype.slice = function(t) {
                    if (0 == t.length) return [this];
                    if (t instanceof Array && t.length && t[0] instanceof Array && 2 == t[0].length && t[0][0] instanceof Array) {
                        for (var e = [this], i = 0; i < t.length; i++)
                            for (var s = t[i], n = 0; n < e.length; n++) {
                                var o = e[n].slice(s);
                                if (o) {
                                    e.splice(n, 1), e.push(o[0], o[1]);
                                    break
                                }
                            }
                        return e
                    }
                    s = t, i = this.vertices.indexOf(s[0]), n = this.vertices.indexOf(s[1]);
                    return -1 != i && -1 != n && [this.copy(i, n), this.copy(n, i)]
                }, s.prototype.isSimple = function() {
                    for (var t = this.vertices, e = 0; e < t.length - 1; e++)
                        for (var i = 0; i < e - 1; i++)
                            if (o.segmentsIntersect(t[e], t[e + 1], t[i], t[i + 1])) return !1;
                    for (e = 1; e < t.length - 2; e++)
                        if (o.segmentsIntersect(t[0], t[t.length - 1], t[e], t[e + 1])) return !1;
                    return !0
                }, s.prototype.quickDecomp = function(t, e, i, o, a, h) {
                    a = a || 100, h = h || 0, o = o || 25, t = void 0 !== t ? t : [], e = e || [], i = i || [];
                    var l = [0, 0],
                        c = [0, 0],
                        u = [0, 0],
                        d = 0,
                        p = 0,
                        f = 0,
                        m = 0,
                        g = 0,
                        y = 0,
                        v = 0,
                        b = new s,
                        _ = new s,
                        w = this,
                        x = this.vertices;
                    if (x.length < 3) return t;
                    if (++h > a) return console.warn("quickDecomp: max level (" + a + ") reached."), t;
                    for (var P = 0; P < this.vertices.length; ++P)
                        if (w.isReflex(P)) {
                            e.push(w.vertices[P]), d = p = Number.MAX_VALUE;
                            for (var T = 0; T < this.vertices.length; ++T) r.left(w.at(P - 1), w.at(P), w.at(T)) && r.rightOn(w.at(P - 1), w.at(P), w.at(T - 1)) && (u = n(w.at(P - 1), w.at(P), w.at(T), w.at(T - 1)), r.right(w.at(P + 1), w.at(P), u) && (f = r.sqdist(w.vertices[P], u)) < p && (p = f, c = u, y = T)), r.left(w.at(P + 1), w.at(P), w.at(T + 1)) && r.rightOn(w.at(P + 1), w.at(P), w.at(T)) && (u = n(w.at(P + 1), w.at(P), w.at(T), w.at(T + 1)), r.left(w.at(P - 1), w.at(P), u) && (f = r.sqdist(w.vertices[P], u)) < d && (d = f, l = u, g = T));
                            if (y == (g + 1) % this.vertices.length) u[0] = (c[0] + l[0]) / 2, u[1] = (c[1] + l[1]) / 2, i.push(u), P < g ? (b.append(w, P, g + 1), b.vertices.push(u), _.vertices.push(u), 0 != y && _.append(w, y, w.vertices.length), _.append(w, 0, P + 1)) : (0 != P && b.append(w, P, w.vertices.length), b.append(w, 0, g + 1), b.vertices.push(u), _.vertices.push(u), _.append(w, y, P + 1));
                            else {
                                if (y > g && (g += this.vertices.length), m = Number.MAX_VALUE, g < y) return t;
                                for (T = y; T <= g; ++T) r.leftOn(w.at(P - 1), w.at(P), w.at(T)) && r.rightOn(w.at(P + 1), w.at(P), w.at(T)) && (f = r.sqdist(w.at(P), w.at(T))) < m && (m = f, v = T % this.vertices.length);
                                P < v ? (b.append(w, P, v + 1), 0 != v && _.append(w, v, x.length), _.append(w, 0, P + 1)) : (0 != P && b.append(w, P, x.length), b.append(w, 0, v + 1), _.append(w, v, P + 1))
                            }
                            return b.vertices.length < _.vertices.length ? (b.quickDecomp(t, e, i, o, a, h), _.quickDecomp(t, e, i, o, a, h)) : (_.quickDecomp(t, e, i, o, a, h), b.quickDecomp(t, e, i, o, a, h)), t
                        } return t.push(this), t
                }, s.prototype.removeCollinearPoints = function(t) {
                    for (var e = 0, i = this.vertices.length - 1; this.vertices.length > 3 && i >= 0; --i) r.collinear(this.at(i - 1), this.at(i), this.at(i + 1), t) && (this.vertices.splice(i % this.vertices.length, 1), i--, e++);
                    return e
                }
            }, {
                "./Line": 1,
                "./Point": 2,
                "./Scalar": 4
            }],
            4: [function(t, e, i) {
                function s() {}
                e.exports = s, s.eq = function(t, e, i) {
                    return i = i || 0, Math.abs(t - e) < i
                }
            }, {}],
            5: [function(t, e, i) {
                e.exports = {
                    Polygon: t("./Polygon"),
                    Point: t("./Point")
                }
            }, {
                "./Point": 2,
                "./Polygon": 3
            }],
            6: [function(t, e, i) {
                e.exports = {
                    name: "p2",
                    version: "0.7.1",
                    description: "A JavaScript 2D physics engine.",
                    author: "Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",
                    keywords: ["p2.js", "p2", "physics", "engine", "2d"],
                    main: "./src/p2.js",
                    engines: {
                        node: "*"
                    },
                    repository: {
                        type: "git",
                        url: "https://github.com/schteppe/p2.js.git"
                    },
                    bugs: {
                        url: "https://github.com/schteppe/p2.js/issues"
                    },
                    licenses: [{
                        type: "MIT"
                    }],
                    devDependencies: {
                        grunt: "^0.4.5",
                        "grunt-contrib-jshint": "^0.11.2",
                        "grunt-contrib-nodeunit": "^0.4.1",
                        "grunt-contrib-uglify": "~0.4.0",
                        "grunt-contrib-watch": "~0.5.0",
                        "grunt-browserify": "~2.0.1",
                        "grunt-contrib-concat": "^0.4.0"
                    },
                    dependencies: {
                        "poly-decomp": "0.1.1"
                    }
                }
            }, {}],
            7: [function(t, e, i) {
                function s(t) {
                    this.lowerBound = n.create(), t && t.lowerBound && n.copy(this.lowerBound, t.lowerBound), this.upperBound = n.create(), t && t.upperBound && n.copy(this.upperBound, t.upperBound)
                }
                var n = t("../math/vec2");
                t("../utils/Utils"), e.exports = s;
                var o = n.create();
                s.prototype.setFromPoints = function(t, e, i, s) {
                    var r = this.lowerBound,
                        a = this.upperBound;
                    "number" != typeof i && (i = 0), 0 !== i ? n.rotate(r, t[0], i) : n.copy(r, t[0]), n.copy(a, r);
                    for (var h = Math.cos(i), l = Math.sin(i), c = 1; c < t.length; c++) {
                        var u = t[c];
                        if (0 !== i) {
                            var d = u[0],
                                p = u[1];
                            o[0] = h * d - l * p, o[1] = l * d + h * p, u = o
                        }
                        for (var f = 0; f < 2; f++) u[f] > a[f] && (a[f] = u[f]), u[f] < r[f] && (r[f] = u[f])
                    }
                    e && (n.add(this.lowerBound, this.lowerBound, e), n.add(this.upperBound, this.upperBound, e)), s && (this.lowerBound[0] -= s, this.lowerBound[1] -= s, this.upperBound[0] += s, this.upperBound[1] += s)
                }, s.prototype.copy = function(t) {
                    n.copy(this.lowerBound, t.lowerBound), n.copy(this.upperBound, t.upperBound)
                }, s.prototype.extend = function(t) {
                    for (var e = 2; e--;) {
                        var i = t.lowerBound[e];
                        this.lowerBound[e] > i && (this.lowerBound[e] = i);
                        var s = t.upperBound[e];
                        this.upperBound[e] < s && (this.upperBound[e] = s)
                    }
                }, s.prototype.overlaps = function(t) {
                    var e = this.lowerBound,
                        i = this.upperBound,
                        s = t.lowerBound,
                        n = t.upperBound;
                    return (s[0] <= i[0] && i[0] <= n[0] || e[0] <= n[0] && n[0] <= i[0]) && (s[1] <= i[1] && i[1] <= n[1] || e[1] <= n[1] && n[1] <= i[1])
                }, s.prototype.containsPoint = function(t) {
                    var e = this.lowerBound,
                        i = this.upperBound;
                    return e[0] <= t[0] && t[0] <= i[0] && e[1] <= t[1] && t[1] <= i[1]
                }, s.prototype.overlapsRay = function(t) {
                    var e = 1 / t.direction[0],
                        i = 1 / t.direction[1],
                        s = (this.lowerBound[0] - t.from[0]) * e,
                        n = (this.upperBound[0] - t.from[0]) * e,
                        o = (this.lowerBound[1] - t.from[1]) * i,
                        r = (this.upperBound[1] - t.from[1]) * i,
                        a = Math.max(Math.max(Math.min(s, n), Math.min(o, r))),
                        h = Math.min(Math.min(Math.max(s, n), Math.max(o, r)));
                    return h < 0 ? -1 : a > h ? -1 : a
                }
            }, {
                "../math/vec2": 30,
                "../utils/Utils": 57
            }],
            8: [function(t, e, i) {
                function s(t) {
                    this.type = t, this.result = [], this.world = null, this.boundingVolumeType = s.AABB
                }
                var n = t("../math/vec2"),
                    o = t("../objects/Body");
                e.exports = s, s.AABB = 1, s.BOUNDING_CIRCLE = 2, s.prototype.setWorld = function(t) {
                    this.world = t
                }, s.prototype.getCollisionPairs = function(t) {};
                var r = n.create();
                s.boundingRadiusCheck = function(t, e) {
                    n.sub(r, t.position, e.position);
                    var i = n.squaredLength(r),
                        s = t.boundingRadius + e.boundingRadius;
                    return i <= s * s
                }, s.aabbCheck = function(t, e) {
                    return t.getAABB().overlaps(e.getAABB())
                }, s.prototype.boundingVolumeCheck = function(t, e) {
                    var i;
                    switch (this.boundingVolumeType) {
                        case s.BOUNDING_CIRCLE:
                            i = s.boundingRadiusCheck(t, e);
                            break;
                        case s.AABB:
                            i = s.aabbCheck(t, e);
                            break;
                        default:
                            throw new Error("Bounding volume type not recognized: " + this.boundingVolumeType)
                    }
                    return i
                }, s.canCollide = function(t, e) {
                    var i = o.KINEMATIC,
                        s = o.STATIC;
                    return !(t.type === s && e.type === s || t.type === i && e.type === s || t.type === s && e.type === i || t.type === i && e.type === i || t.sleepState === o.SLEEPING && e.sleepState === o.SLEEPING || t.sleepState === o.SLEEPING && e.type === s || e.sleepState === o.SLEEPING && t.type === s)
                }, s.NAIVE = 1, s.SAP = 2
            }, {
                "../math/vec2": 30,
                "../objects/Body": 31
            }],
            9: [function(t, e, i) {
                function s() {
                    n.call(this, n.NAIVE)
                }
                var n = (t("../shapes/Circle"), t("../shapes/Plane"), t("../shapes/Shape"), t("../shapes/Particle"), t("../collision/Broadphase"));
                t("../math/vec2"), e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.getCollisionPairs = function(t) {
                    var e = t.bodies,
                        i = this.result;
                    i.length = 0;
                    for (var s = 0, o = e.length; s !== o; s++)
                        for (var r = e[s], a = 0; a < s; a++) {
                            var h = e[a];
                            n.canCollide(r, h) && this.boundingVolumeCheck(r, h) && i.push(r, h)
                        }
                    return i
                }, s.prototype.aabbQuery = function(t, e, i) {
                    i = i || [];
                    for (var s = t.bodies, n = 0; n < s.length; n++) {
                        var o = s[n];
                        o.aabbNeedsUpdate && o.updateAABB(), o.aabb.overlaps(e) && i.push(o)
                    }
                    return i
                }
            }, {
                "../collision/Broadphase": 8,
                "../math/vec2": 30,
                "../shapes/Circle": 39,
                "../shapes/Particle": 43,
                "../shapes/Plane": 44,
                "../shapes/Shape": 45
            }],
            10: [function(t, e, i) {
                function s() {
                    this.contactEquations = [], this.frictionEquations = [], this.enableFriction = !0, this.enabledEquations = !0, this.slipForce = 10, this.frictionCoefficient = .3, this.surfaceVelocity = 0, this.contactEquationPool = new c({
                        size: 32
                    }), this.frictionEquationPool = new u({
                        size: 64
                    }), this.restitution = 0, this.stiffness = p.DEFAULT_STIFFNESS, this.relaxation = p.DEFAULT_RELAXATION, this.frictionStiffness = p.DEFAULT_STIFFNESS, this.frictionRelaxation = p.DEFAULT_RELAXATION, this.enableFrictionReduction = !0, this.collidingBodiesLastStep = new d, this.contactSkinSize = .01
                }

                function n(t, e) {
                    r.set(t.vertices[0], .5 * -e.length, -e.radius), r.set(t.vertices[1], .5 * e.length, -e.radius), r.set(t.vertices[2], .5 * e.length, e.radius), r.set(t.vertices[3], .5 * -e.length, e.radius)
                }

                function o(t, e, i, s) {
                    for (var n = X, o = V, l = Y, c = z, u = t, d = e.vertices, p = null, f = 0; f !== d.length + 1; f++) {
                        var m = d[f % d.length],
                            g = d[(f + 1) % d.length];
                        r.rotate(n, m, s), r.rotate(o, g, s), h(n, n, i), h(o, o, i), a(l, n, u), a(c, o, u);
                        var y = r.crossLength(l, c);
                        if (null === p && (p = y), y * p <= 0) return !1;
                        p = y
                    }
                    return !0
                }
                var r = t("../math/vec2"),
                    a = r.sub,
                    h = r.add,
                    l = r.dot,
                    c = (t("../utils/Utils"), t("../utils/ContactEquationPool")),
                    u = t("../utils/FrictionEquationPool"),
                    d = t("../utils/TupleDictionary"),
                    p = t("../equations/Equation"),
                    f = (t("../equations/ContactEquation"), t("../equations/FrictionEquation"), t("../shapes/Circle")),
                    m = t("../shapes/Convex"),
                    g = t("../shapes/Shape"),
                    y = (t("../objects/Body"), t("../shapes/Box"));
                e.exports = s;
                var v = r.fromValues(0, 1),
                    b = r.fromValues(0, 0),
                    _ = r.fromValues(0, 0),
                    w = r.fromValues(0, 0),
                    x = r.fromValues(0, 0),
                    P = r.fromValues(0, 0),
                    T = r.fromValues(0, 0),
                    C = r.fromValues(0, 0),
                    S = r.fromValues(0, 0),
                    A = r.fromValues(0, 0),
                    E = r.fromValues(0, 0),
                    k = r.fromValues(0, 0),
                    M = r.fromValues(0, 0),
                    O = r.fromValues(0, 0),
                    R = r.fromValues(0, 0),
                    B = r.fromValues(0, 0),
                    I = r.fromValues(0, 0),
                    L = r.fromValues(0, 0),
                    D = r.fromValues(0, 0),
                    F = [],
                    U = r.create(),
                    N = r.create();
                s.prototype.bodiesOverlap = function(t, e) {
                    for (var i = U, s = N, n = 0, o = t.shapes.length; n !== o; n++) {
                        var r = t.shapes[n];
                        t.toWorldFrame(i, r.position);
                        for (var a = 0, h = e.shapes.length; a !== h; a++) {
                            var l = e.shapes[a];
                            if (e.toWorldFrame(s, l.position), this[r.type | l.type](t, r, i, r.angle + t.angle, e, l, s, l.angle + e.angle, !0)) return !0
                        }
                    }
                    return !1
                }, s.prototype.collidedLastStep = function(t, e) {
                    var i = 0 | t.id,
                        s = 0 | e.id;
                    return !!this.collidingBodiesLastStep.get(i, s)
                }, s.prototype.reset = function() {
                    this.collidingBodiesLastStep.reset();
                    for (var t = this.contactEquations, e = t.length; e--;) {
                        var i = t[e],
                            s = i.bodyA.id,
                            n = i.bodyB.id;
                        this.collidingBodiesLastStep.set(s, n, !0)
                    }
                    for (var o = this.contactEquations, r = this.frictionEquations, a = 0; a < o.length; a++) this.contactEquationPool.release(o[a]);
                    for (a = 0; a < r.length; a++) this.frictionEquationPool.release(r[a]);
                    this.contactEquations.length = this.frictionEquations.length = 0
                }, s.prototype.createContactEquation = function(t, e, i, s) {
                    var n = this.contactEquationPool.get();
                    return n.bodyA = t, n.bodyB = e, n.shapeA = i, n.shapeB = s, n.restitution = this.restitution, n.firstImpact = !this.collidedLastStep(t, e), n.stiffness = this.stiffness, n.relaxation = this.relaxation, n.needsUpdate = !0, n.enabled = this.enabledEquations, n.offset = this.contactSkinSize, n
                }, s.prototype.createFrictionEquation = function(t, e, i, s) {
                    var n = this.frictionEquationPool.get();
                    return n.bodyA = t, n.bodyB = e, n.shapeA = i, n.shapeB = s, n.setSlipForce(this.slipForce), n.frictionCoefficient = this.frictionCoefficient, n.relativeVelocity = this.surfaceVelocity, n.enabled = this.enabledEquations, n.needsUpdate = !0, n.stiffness = this.frictionStiffness, n.relaxation = this.frictionRelaxation, n.contactEquations.length = 0, n
                }, s.prototype.createFrictionFromContact = function(t) {
                    var e = this.createFrictionEquation(t.bodyA, t.bodyB, t.shapeA, t.shapeB);
                    return r.copy(e.contactPointA, t.contactPointA), r.copy(e.contactPointB, t.contactPointB), r.rotate90cw(e.t, t.normalA), e.contactEquations.push(t), e
                }, s.prototype.createFrictionFromAverage = function(t) {
                    var e = this.contactEquations[this.contactEquations.length - 1],
                        i = this.createFrictionEquation(e.bodyA, e.bodyB, e.shapeA, e.shapeB),
                        s = e.bodyA;
                    e.bodyB, r.set(i.contactPointA, 0, 0), r.set(i.contactPointB, 0, 0), r.set(i.t, 0, 0);
                    for (var n = 0; n !== t; n++)(e = this.contactEquations[this.contactEquations.length - 1 - n]).bodyA === s ? (r.add(i.t, i.t, e.normalA), r.add(i.contactPointA, i.contactPointA, e.contactPointA), r.add(i.contactPointB, i.contactPointB, e.contactPointB)) : (r.sub(i.t, i.t, e.normalA), r.add(i.contactPointA, i.contactPointA, e.contactPointB), r.add(i.contactPointB, i.contactPointB, e.contactPointA)), i.contactEquations.push(e);
                    var o = 1 / t;
                    return r.scale(i.contactPointA, i.contactPointA, o), r.scale(i.contactPointB, i.contactPointB, o), r.normalize(i.t, i.t), r.rotate90cw(i.t, i.t), i
                }, s.prototype[g.LINE | g.CONVEX] = s.prototype.convexLine = function(t, e, i, s, n, o, r, a, h) {
                    return !h && 0
                }, s.prototype[g.LINE | g.BOX] = s.prototype.lineBox = function(t, e, i, s, n, o, r, a, h) {
                    return !h && 0
                };
                var G = new y({
                        width: 1,
                        height: 1
                    }),
                    j = r.create();
                s.prototype[g.CAPSULE | g.CONVEX] = s.prototype[g.CAPSULE | g.BOX] = s.prototype.convexCapsule = function(t, e, i, s, o, a, h, l, c) {
                    var u = j;
                    r.set(u, a.length / 2, 0), r.rotate(u, u, l), r.add(u, u, h);
                    var d = this.circleConvex(o, a, u, l, t, e, i, s, c, a.radius);
                    r.set(u, -a.length / 2, 0), r.rotate(u, u, l), r.add(u, u, h);
                    var p = this.circleConvex(o, a, u, l, t, e, i, s, c, a.radius);
                    if (c && (d || p)) return !0;
                    var f = G;
                    return n(f, a), this.convexConvex(t, e, i, s, o, f, h, l, c) + d + p
                }, s.prototype[g.CAPSULE | g.LINE] = s.prototype.lineCapsule = function(t, e, i, s, n, o, r, a, h) {
                    return !h && 0
                };
                var W = r.create(),
                    q = r.create(),
                    H = new y({
                        width: 1,
                        height: 1
                    });
                s.prototype[g.CAPSULE | g.CAPSULE] = s.prototype.capsuleCapsule = function(t, e, i, s, o, a, h, l, c) {
                    for (var u = W, d = q, p = 0, f = 0; f < 2; f++) {
                        r.set(u, (0 === f ? -1 : 1) * e.length / 2, 0), r.rotate(u, u, s), r.add(u, u, i);
                        for (var m = 0; m < 2; m++) {
                            r.set(d, (0 === m ? -1 : 1) * a.length / 2, 0), r.rotate(d, d, l), r.add(d, d, h), this.enableFrictionReduction && (b = this.enableFriction, this.enableFriction = !1);
                            var g = this.circleCircle(t, e, u, s, o, a, d, l, c, e.radius, a.radius);
                            if (this.enableFrictionReduction && (this.enableFriction = b), c && g) return !0;
                            p += g
                        }
                    }
                    this.enableFrictionReduction && (b = this.enableFriction, this.enableFriction = !1);
                    var y = H;
                    n(y, e);
                    var v = this.convexCapsule(t, y, i, s, o, a, h, l, c);
                    if (this.enableFrictionReduction && (this.enableFriction = b), c && v) return !0;
                    if (p += v, this.enableFrictionReduction) {
                        var b = this.enableFriction;
                        this.enableFriction = !1
                    }
                    n(y, a);
                    var _ = this.convexCapsule(o, y, h, l, t, e, i, s, c);
                    return this.enableFrictionReduction && (this.enableFriction = b), !(!c || !_) || (p += _, this.enableFrictionReduction && p && this.enableFriction && this.frictionEquations.push(this.createFrictionFromAverage(p)), p)
                }, s.prototype[g.LINE | g.LINE] = s.prototype.lineLine = function(t, e, i, s, n, o, r, a, h) {
                    return !h && 0
                }, s.prototype[g.PLANE | g.LINE] = s.prototype.planeLine = function(t, e, i, s, n, o, c, u, d) {
                    var p = b,
                        f = _,
                        m = w,
                        g = x,
                        y = P,
                        E = T,
                        k = C,
                        M = S,
                        O = A,
                        R = F,
                        B = 0;
                    r.set(p, -o.length / 2, 0), r.set(f, o.length / 2, 0), r.rotate(m, p, u), r.rotate(g, f, u), h(m, m, c), h(g, g, c), r.copy(p, m), r.copy(f, g), a(y, f, p), r.normalize(E, y), r.rotate90cw(O, E), r.rotate(M, v, s), R[0] = p, R[1] = f;
                    for (var I = 0; I < R.length; I++) {
                        var L = R[I];
                        a(k, L, i);
                        var D = l(k, M);
                        if (D < 0) {
                            if (d) return !0;
                            var U = this.createContactEquation(t, n, e, o);
                            B++, r.copy(U.normalA, M), r.normalize(U.normalA, U.normalA), r.scale(k, M, D), a(U.contactPointA, L, k), a(U.contactPointA, U.contactPointA, t.position), a(U.contactPointB, L, c), h(U.contactPointB, U.contactPointB, c), a(U.contactPointB, U.contactPointB, n.position), this.contactEquations.push(U), this.enableFrictionReduction || this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(U))
                        }
                    }
                    return !d && (this.enableFrictionReduction || B && this.enableFriction && this.frictionEquations.push(this.createFrictionFromAverage(B)), B)
                }, s.prototype[g.PARTICLE | g.CAPSULE] = s.prototype.particleCapsule = function(t, e, i, s, n, o, r, a, h) {
                    return this.circleLine(t, e, i, s, n, o, r, a, h, o.radius, 0)
                }, s.prototype[g.CIRCLE | g.LINE] = s.prototype.circleLine = function(t, e, i, s, n, o, c, u, d, p, f) {
                    p = p || 0, f = void 0 !== f ? f : e.radius;
                    var m = b,
                        g = _,
                        y = w,
                        v = x,
                        B = P,
                        I = T,
                        L = C,
                        D = S,
                        U = A,
                        N = E,
                        G = k,
                        j = M,
                        W = O,
                        q = R,
                        H = F;
                    r.set(D, -o.length / 2, 0), r.set(U, o.length / 2, 0), r.rotate(N, D, u), r.rotate(G, U, u), h(N, N, c), h(G, G, c), r.copy(D, N), r.copy(U, G), a(I, U, D), r.normalize(L, I), r.rotate90cw(B, L), a(j, i, D);
                    var X = l(j, B);
                    a(v, D, c), a(W, i, c);
                    var V = f + p;
                    if (Math.abs(X) < V) {
                        r.scale(m, B, X), a(y, i, m), r.scale(g, B, l(B, W)), r.normalize(g, g), r.scale(g, g, p), h(y, y, g);
                        var Y = l(L, y),
                            z = l(L, D),
                            K = l(L, U);
                        if (Y > z && Y < K) {
                            if (d) return !0;
                            var J = this.createContactEquation(t, n, e, o);
                            return r.scale(J.normalA, m, -1), r.normalize(J.normalA, J.normalA), r.scale(J.contactPointA, J.normalA, f), h(J.contactPointA, J.contactPointA, i), a(J.contactPointA, J.contactPointA, t.position), a(J.contactPointB, y, c), h(J.contactPointB, J.contactPointB, c), a(J.contactPointB, J.contactPointB, n.position), this.contactEquations.push(J), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(J)), 1
                        }
                    }
                    H[0] = D, H[1] = U;
                    for (var Q = 0; Q < H.length; Q++) {
                        var Z = H[Q];
                        if (a(j, Z, i), r.squaredLength(j) < Math.pow(V, 2)) {
                            if (d) return !0;
                            J = this.createContactEquation(t, n, e, o);
                            return r.copy(J.normalA, j), r.normalize(J.normalA, J.normalA), r.scale(J.contactPointA, J.normalA, f), h(J.contactPointA, J.contactPointA, i), a(J.contactPointA, J.contactPointA, t.position), a(J.contactPointB, Z, c), r.scale(q, J.normalA, -p), h(J.contactPointB, J.contactPointB, q), h(J.contactPointB, J.contactPointB, c), a(J.contactPointB, J.contactPointB, n.position), this.contactEquations.push(J), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(J)), 1
                        }
                    }
                    return 0
                }, s.prototype[g.CIRCLE | g.CAPSULE] = s.prototype.circleCapsule = function(t, e, i, s, n, o, r, a, h) {
                    return this.circleLine(t, e, i, s, n, o, r, a, h, o.radius)
                }, s.prototype[g.CIRCLE | g.CONVEX] = s.prototype[g.CIRCLE | g.BOX] = s.prototype.circleConvex = function(t, e, i, s, n, l, c, u, d, p) {
                    p = "number" == typeof p ? p : e.radius;
                    for (var f = b, m = _, g = w, y = x, v = P, T = E, C = k, S = O, A = R, M = B, L = I, D = !1, F = Number.MAX_VALUE, U = l.vertices, N = 0; N !== U.length + 1; N++) {
                        var G = U[N % U.length],
                            j = U[(N + 1) % U.length];
                        if (r.rotate(f, G, u), r.rotate(m, j, u), h(f, f, c), h(m, m, c), a(g, m, f), r.normalize(y, g), r.rotate90cw(v, y), r.scale(A, v, -e.radius), h(A, A, i), o(A, l, c, u)) {
                            r.sub(M, f, A);
                            var W = Math.abs(r.dot(M, v));
                            W < F && (r.copy(L, A), F = W, r.scale(S, v, W), r.add(S, S, A), D = !0)
                        }
                    }
                    if (D) {
                        if (d) return !0;
                        var q = this.createContactEquation(t, n, e, l);
                        return r.sub(q.normalA, L, i), r.normalize(q.normalA, q.normalA), r.scale(q.contactPointA, q.normalA, p), h(q.contactPointA, q.contactPointA, i), a(q.contactPointA, q.contactPointA, t.position), a(q.contactPointB, S, c), h(q.contactPointB, q.contactPointB, c), a(q.contactPointB, q.contactPointB, n.position), this.contactEquations.push(q), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(q)), 1
                    }
                    if (p > 0)
                        for (N = 0; N < U.length; N++) {
                            var H = U[N];
                            if (r.rotate(C, H, u), h(C, C, c), a(T, C, i), r.squaredLength(T) < Math.pow(p, 2)) {
                                if (d) return !0;
                                q = this.createContactEquation(t, n, e, l);
                                return r.copy(q.normalA, T), r.normalize(q.normalA, q.normalA), r.scale(q.contactPointA, q.normalA, p), h(q.contactPointA, q.contactPointA, i), a(q.contactPointA, q.contactPointA, t.position), a(q.contactPointB, C, c), h(q.contactPointB, q.contactPointB, c), a(q.contactPointB, q.contactPointB, n.position), this.contactEquations.push(q), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(q)), 1
                            }
                        }
                    return 0
                };
                var X = r.create(),
                    V = r.create(),
                    Y = r.create(),
                    z = r.create();
                s.prototype[g.PARTICLE | g.CONVEX] = s.prototype[g.PARTICLE | g.BOX] = s.prototype.particleConvex = function(t, e, i, s, n, c, u, d, p) {
                    var f = b,
                        m = _,
                        g = w,
                        y = x,
                        v = P,
                        S = T,
                        A = C,
                        k = E,
                        M = O,
                        R = L,
                        B = D,
                        I = Number.MAX_VALUE,
                        F = !1,
                        U = c.vertices;
                    if (!o(i, c, u, d)) return 0;
                    if (p) return !0;
                    for (var N = 0; N !== U.length + 1; N++) {
                        var G = U[N % U.length],
                            j = U[(N + 1) % U.length];
                        r.rotate(f, G, d), r.rotate(m, j, d), h(f, f, u), h(m, m, u), a(g, m, f), r.normalize(y, g), r.rotate90cw(v, y), a(k, i, f), l(k, v), a(S, f, u), a(A, i, u), r.sub(R, f, i);
                        var W = Math.abs(r.dot(R, v));
                        W < I && (I = W, r.scale(M, v, W), r.add(M, M, i), r.copy(B, v), F = !0)
                    }
                    if (F) {
                        var q = this.createContactEquation(t, n, e, c);
                        return r.scale(q.normalA, B, -1), r.normalize(q.normalA, q.normalA), r.set(q.contactPointA, 0, 0), h(q.contactPointA, q.contactPointA, i), a(q.contactPointA, q.contactPointA, t.position), a(q.contactPointB, M, u), h(q.contactPointB, q.contactPointB, u), a(q.contactPointB, q.contactPointB, n.position), this.contactEquations.push(q), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(q)), 1
                    }
                    return 0
                }, s.prototype[g.CIRCLE] = s.prototype.circleCircle = function(t, e, i, s, n, o, l, c, u, d, p) {
                    var f = b;
                    d = d || e.radius, p = p || o.radius;
                    a(f, i, l);
                    var m = d + p;
                    if (r.squaredLength(f) > Math.pow(m, 2)) return 0;
                    if (u) return !0;
                    var g = this.createContactEquation(t, n, e, o);
                    return a(g.normalA, l, i), r.normalize(g.normalA, g.normalA), r.scale(g.contactPointA, g.normalA, d), r.scale(g.contactPointB, g.normalA, -p), h(g.contactPointA, g.contactPointA, i), a(g.contactPointA, g.contactPointA, t.position), h(g.contactPointB, g.contactPointB, l), a(g.contactPointB, g.contactPointB, n.position), this.contactEquations.push(g), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(g)), 1
                }, s.prototype[g.PLANE | g.CONVEX] = s.prototype[g.PLANE | g.BOX] = s.prototype.planeConvex = function(t, e, i, s, n, o, c, u, d) {
                    var p = b,
                        f = _,
                        m = w,
                        g = 0;
                    r.rotate(f, v, s);
                    for (var y = 0; y !== o.vertices.length; y++) {
                        var x = o.vertices[y];
                        if (r.rotate(p, x, u), h(p, p, c), a(m, p, i), l(m, f) <= 0) {
                            if (d) return !0;
                            g++;
                            var P = this.createContactEquation(t, n, e, o);
                            a(m, p, i), r.copy(P.normalA, f);
                            var T = l(m, P.normalA);
                            r.scale(m, P.normalA, T), a(P.contactPointB, p, n.position), a(P.contactPointA, p, m), a(P.contactPointA, P.contactPointA, t.position), this.contactEquations.push(P), this.enableFrictionReduction || this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(P))
                        }
                    }
                    return this.enableFrictionReduction && this.enableFriction && g && this.frictionEquations.push(this.createFrictionFromAverage(g)), g
                }, s.prototype[g.PARTICLE | g.PLANE] = s.prototype.particlePlane = function(t, e, i, s, n, o, h, c, u) {
                    var d = b,
                        p = _;
                    c = c || 0, a(d, i, h), r.rotate(p, v, c);
                    var f = l(d, p);
                    if (f > 0) return 0;
                    if (u) return !0;
                    var m = this.createContactEquation(n, t, o, e);
                    return r.copy(m.normalA, p), r.scale(d, m.normalA, f), a(m.contactPointA, i, d), a(m.contactPointA, m.contactPointA, n.position), a(m.contactPointB, i, t.position), this.contactEquations.push(m), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(m)), 1
                }, s.prototype[g.CIRCLE | g.PARTICLE] = s.prototype.circleParticle = function(t, e, i, s, n, o, l, c, u) {
                    var d = b;
                    if (a(d, l, i), r.squaredLength(d) > Math.pow(e.radius, 2)) return 0;
                    if (u) return !0;
                    var p = this.createContactEquation(t, n, e, o);
                    return r.copy(p.normalA, d), r.normalize(p.normalA, p.normalA), r.scale(p.contactPointA, p.normalA, e.radius), h(p.contactPointA, p.contactPointA, i), a(p.contactPointA, p.contactPointA, t.position), a(p.contactPointB, l, n.position), this.contactEquations.push(p), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(p)), 1
                };
                var K = new f({
                        radius: 1
                    }),
                    J = r.create(),
                    Q = r.create();
                r.create(), s.prototype[g.PLANE | g.CAPSULE] = s.prototype.planeCapsule = function(t, e, i, s, n, o, a, l, c) {
                    var u, d = J,
                        p = Q,
                        f = K;
                    r.set(d, -o.length / 2, 0), r.rotate(d, d, l), h(d, d, a), r.set(p, o.length / 2, 0), r.rotate(p, p, l), h(p, p, a), f.radius = o.radius, this.enableFrictionReduction && (u = this.enableFriction, this.enableFriction = !1);
                    var m = this.circlePlane(n, f, d, 0, t, e, i, s, c),
                        g = this.circlePlane(n, f, p, 0, t, e, i, s, c);
                    if (this.enableFrictionReduction && (this.enableFriction = u), c) return m || g;
                    var y = m + g;
                    return this.enableFrictionReduction && y && this.frictionEquations.push(this.createFrictionFromAverage(y)), y
                }, s.prototype[g.CIRCLE | g.PLANE] = s.prototype.circlePlane = function(t, e, i, s, n, o, c, u, d) {
                    var p = t,
                        f = e,
                        m = i,
                        g = n,
                        y = c,
                        x = u;
                    x = x || 0;
                    var P = b,
                        T = _,
                        C = w;
                    a(P, m, y), r.rotate(T, v, x);
                    var S = l(T, P);
                    if (S > f.radius) return 0;
                    if (d) return !0;
                    var A = this.createContactEquation(g, p, o, e);
                    return r.copy(A.normalA, T), r.scale(A.contactPointB, A.normalA, -f.radius), h(A.contactPointB, A.contactPointB, m), a(A.contactPointB, A.contactPointB, p.position), r.scale(C, A.normalA, S), a(A.contactPointA, P, C), h(A.contactPointA, A.contactPointA, y), a(A.contactPointA, A.contactPointA, g.position), this.contactEquations.push(A), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(A)), 1
                }, s.prototype[g.CONVEX] = s.prototype[g.CONVEX | g.BOX] = s.prototype[g.BOX] = s.prototype.convexConvex = function(t, e, i, n, o, c, u, d, p, f) {
                    var m = b,
                        g = _,
                        y = w,
                        v = x,
                        T = P,
                        E = C,
                        k = S,
                        M = A,
                        O = 0;
                    f = "number" == typeof f ? f : 0;
                    if (!s.findSeparatingAxis(e, i, n, c, u, d, m)) return 0;
                    a(k, u, i), l(m, k) > 0 && r.scale(m, m, -1);
                    var R = s.getClosestEdge(e, n, m, !0),
                        B = s.getClosestEdge(c, d, m);
                    if (-1 === R || -1 === B) return 0;
                    for (var I = 0; I < 2; I++) {
                        var L, D = R,
                            F = B,
                            U = e,
                            N = c,
                            G = i,
                            j = u,
                            W = n,
                            q = d,
                            H = t,
                            X = o;
                        if (0 === I) L = D, D = F, F = L, L = U, U = N, N = L, L = G, G = j, j = L, L = W, W = q, q = L, L = H, H = X, X = L;
                        for (var V = F; V < F + 2; V++) {
                            var Y = N.vertices[(V + N.vertices.length) % N.vertices.length];
                            r.rotate(g, Y, q), h(g, g, j);
                            for (var z = 0, K = D - 1; K < D + 2; K++) {
                                var J = U.vertices[(K + U.vertices.length) % U.vertices.length],
                                    Q = U.vertices[(K + 1 + U.vertices.length) % U.vertices.length];
                                r.rotate(y, J, W), r.rotate(v, Q, W), h(y, y, G), h(v, v, G), a(T, v, y), r.rotate90cw(M, T), r.normalize(M, M), a(k, g, y);
                                var Z = l(M, k);
                                (K === D && Z <= f || K !== D && Z <= 0) && z++
                            }
                            if (z >= 3) {
                                if (p) return !0;
                                var $ = this.createContactEquation(H, X, U, N);
                                O++;
                                J = U.vertices[D % U.vertices.length], Q = U.vertices[(D + 1) % U.vertices.length];
                                r.rotate(y, J, W), r.rotate(v, Q, W), h(y, y, G), h(v, v, G), a(T, v, y), r.rotate90cw($.normalA, T), r.normalize($.normalA, $.normalA), a(k, g, y);
                                Z = l($.normalA, k);
                                r.scale(E, $.normalA, Z), a($.contactPointA, g, G), a($.contactPointA, $.contactPointA, E), h($.contactPointA, $.contactPointA, G), a($.contactPointA, $.contactPointA, H.position), a($.contactPointB, g, j), h($.contactPointB, $.contactPointB, j), a($.contactPointB, $.contactPointB, X.position), this.contactEquations.push($), this.enableFrictionReduction || this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact($))
                            }
                        }
                    }
                    return this.enableFrictionReduction && this.enableFriction && O && this.frictionEquations.push(this.createFrictionFromAverage(O)), O
                };
                var Z = r.fromValues(0, 0);
                s.projectConvexOntoAxis = function(t, e, i, s, n) {
                    var o, a, h = null,
                        c = null,
                        u = Z;
                    r.rotate(u, s, -i);
                    for (var d = 0; d < t.vertices.length; d++) o = t.vertices[d], a = l(o, u), (null === h || a > h) && (h = a), (null === c || a < c) && (c = a);
                    if (c > h) {
                        var p = c;
                        c = h, h = p
                    }
                    var f = l(e, s);
                    r.set(n, c + f, h + f)
                };
                var $ = r.fromValues(0, 0),
                    tt = r.fromValues(0, 0),
                    et = r.fromValues(0, 0),
                    it = r.fromValues(0, 0),
                    st = r.fromValues(0, 0),
                    nt = r.fromValues(0, 0);
                s.findSeparatingAxis = function(t, e, i, n, o, h, l) {
                    var c = null,
                        u = !1,
                        d = !1,
                        p = $,
                        f = tt,
                        m = et,
                        g = it,
                        v = st,
                        b = nt;
                    if (t instanceof y && n instanceof y)
                        for (var _ = 0; 2 !== _; _++) {
                            var w = t,
                                x = i;
                            1 === _ && (w = n, x = h);
                            for (var P = 0; 2 !== P; P++) {
                                0 === P ? r.set(g, 0, 1) : 1 === P && r.set(g, 1, 0), 0 !== x && r.rotate(g, g, x), s.projectConvexOntoAxis(t, e, i, g, v), s.projectConvexOntoAxis(n, o, h, g, b);
                                var T = v,
                                    C = b;
                                v[0] > b[0] && (C = v, T = b), u = (S = C[0] - T[1]) <= 0, (null === c || S > c) && (r.copy(l, g), c = S, d = u)
                            }
                        } else
                            for (_ = 0; 2 !== _; _++) {
                                w = t, x = i;
                                1 === _ && (w = n, x = h);
                                for (P = 0; P !== w.vertices.length; P++) {
                                    r.rotate(f, w.vertices[P], x), r.rotate(m, w.vertices[(P + 1) % w.vertices.length], x), a(p, m, f), r.rotate90cw(g, p), r.normalize(g, g), s.projectConvexOntoAxis(t, e, i, g, v), s.projectConvexOntoAxis(n, o, h, g, b);
                                    var S;
                                    T = v, C = b;
                                    v[0] > b[0] && (C = v, T = b), u = (S = C[0] - T[1]) <= 0, (null === c || S > c) && (r.copy(l, g), c = S, d = u)
                                }
                            }
                    return d
                };
                var ot = r.fromValues(0, 0),
                    rt = r.fromValues(0, 0),
                    at = r.fromValues(0, 0);
                s.getClosestEdge = function(t, e, i, s) {
                    var n = ot,
                        o = rt,
                        h = at;
                    r.rotate(n, i, -e), s && r.scale(n, n, -1);
                    for (var c = -1, u = t.vertices.length, d = -1, p = 0; p !== u; p++) {
                        a(o, t.vertices[(p + 1) % u], t.vertices[p % u]), r.rotate90cw(h, o), r.normalize(h, h);
                        var f = l(h, n);
                        (-1 === c || f > d) && (c = p % u, d = f)
                    }
                    return c
                };
                var ht = r.create(),
                    lt = r.create(),
                    ct = r.create(),
                    ut = r.create(),
                    dt = r.create(),
                    pt = r.create(),
                    ft = r.create();
                s.prototype[g.CIRCLE | g.HEIGHTFIELD] = s.prototype.circleHeightfield = function(t, e, i, s, n, o, l, c, u, d) {
                    var p = o.heights,
                        f = (d = d || e.radius, o.elementWidth),
                        m = lt,
                        g = ht,
                        y = dt,
                        v = ft,
                        b = pt,
                        _ = ct,
                        w = ut,
                        x = Math.floor((i[0] - d - l[0]) / f),
                        P = Math.ceil((i[0] + d - l[0]) / f);
                    x < 0 && (x = 0), P >= p.length && (P = p.length - 1);
                    for (var T = p[x], C = p[P], S = x; S < P; S++) p[S] < C && (C = p[S]), p[S] > T && (T = p[S]);
                    if (i[1] - d > T) return !u && 0;
                    var A = !1;
                    for (S = x; S < P; S++) {
                        r.set(_, S * f, p[S]), r.set(w, (S + 1) * f, p[S + 1]), r.add(_, _, l), r.add(w, w, l), r.sub(b, w, _), r.rotate(b, b, Math.PI / 2), r.normalize(b, b), r.scale(g, b, -d), r.add(g, g, i), r.sub(m, g, _);
                        var E = r.dot(m, b);
                        if (g[0] >= _[0] && g[0] < w[0] && E <= 0) {
                            if (u) return !0;
                            A = !0, r.scale(m, b, -E), r.add(y, g, m), r.copy(v, b);
                            var k = this.createContactEquation(n, t, o, e);
                            r.copy(k.normalA, v), r.scale(k.contactPointB, k.normalA, -d), h(k.contactPointB, k.contactPointB, i), a(k.contactPointB, k.contactPointB, t.position), r.copy(k.contactPointA, y), r.sub(k.contactPointA, k.contactPointA, n.position), this.contactEquations.push(k), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(k))
                        }
                    }
                    if (A = !1, d > 0)
                        for (S = x; S <= P; S++)
                            if (r.set(_, S * f, p[S]), r.add(_, _, l), r.sub(m, i, _), r.squaredLength(m) < Math.pow(d, 2)) {
                                if (u) return !0;
                                A = !0;
                                k = this.createContactEquation(n, t, o, e);
                                r.copy(k.normalA, m), r.normalize(k.normalA, k.normalA), r.scale(k.contactPointB, k.normalA, -d), h(k.contactPointB, k.contactPointB, i), a(k.contactPointB, k.contactPointB, t.position), a(k.contactPointA, _, l), h(k.contactPointA, k.contactPointA, l), a(k.contactPointA, k.contactPointA, n.position), this.contactEquations.push(k), this.enableFriction && this.frictionEquations.push(this.createFrictionFromContact(k))
                            } return A ? 1 : 0
                };
                var mt = r.create(),
                    gt = r.create(),
                    yt = r.create(),
                    vt = new m({
                        vertices: [r.create(), r.create(), r.create(), r.create()]
                    });
                s.prototype[g.BOX | g.HEIGHTFIELD] = s.prototype[g.CONVEX | g.HEIGHTFIELD] = s.prototype.convexHeightfield = function(t, e, i, s, n, o, a, h, l) {
                    var c = o.heights,
                        u = o.elementWidth,
                        d = mt,
                        p = gt,
                        f = yt,
                        m = vt,
                        g = Math.floor((t.aabb.lowerBound[0] - a[0]) / u),
                        y = Math.ceil((t.aabb.upperBound[0] - a[0]) / u);
                    g < 0 && (g = 0), y >= c.length && (y = c.length - 1);
                    for (var v = c[g], b = c[y], _ = g; _ < y; _++) c[_] < b && (b = c[_]), c[_] > v && (v = c[_]);
                    if (t.aabb.lowerBound[1] > v) return !l && 0;
                    var w = 0;
                    for (_ = g; _ < y; _++) {
                        r.set(d, _ * u, c[_]), r.set(p, (_ + 1) * u, c[_ + 1]), r.add(d, d, a), r.add(p, p, a);
                        r.set(f, .5 * (p[0] + d[0]), .5 * (p[1] + d[1] - 100)), r.sub(m.vertices[0], p, f), r.sub(m.vertices[1], d, f), r.copy(m.vertices[2], m.vertices[1]), r.copy(m.vertices[3], m.vertices[0]), m.vertices[2][1] -= 100, m.vertices[3][1] -= 100, w += this.convexConvex(t, e, i, s, n, m, f, 0, l)
                    }
                    return w
                }
            }, {
                "../equations/ContactEquation": 21,
                "../equations/Equation": 22,
                "../equations/FrictionEquation": 23,
                "../math/vec2": 30,
                "../objects/Body": 31,
                "../shapes/Box": 37,
                "../shapes/Circle": 39,
                "../shapes/Convex": 40,
                "../shapes/Shape": 45,
                "../utils/ContactEquationPool": 48,
                "../utils/FrictionEquationPool": 49,
                "../utils/TupleDictionary": 56,
                "../utils/Utils": 57
            }],
            11: [function(t, e, i) {
                function s(t) {
                    t = t || {}, this.from = t.from ? o.fromValues(t.from[0], t.from[1]) : o.create(), this.to = t.to ? o.fromValues(t.to[0], t.to[1]) : o.create(), this.checkCollisionResponse = void 0 === t.checkCollisionResponse || t.checkCollisionResponse, this.skipBackfaces = !!t.skipBackfaces, this.collisionMask = void 0 !== t.collisionMask ? t.collisionMask : -1, this.collisionGroup = void 0 !== t.collisionGroup ? t.collisionGroup : -1, this.mode = void 0 !== t.mode ? t.mode : s.ANY, this.callback = t.callback || function(t) {}, this.direction = o.create(), this.length = 1, this.update()
                }

                function n(t, e, i) {
                    o.sub(a, i, t);
                    var s = o.dot(a, e);
                    return o.scale(h, e, s), o.add(h, h, t), o.squaredDistance(i, h)
                }
                e.exports = s;
                var o = t("../math/vec2");
                t("../collision/RaycastResult"), t("../shapes/Shape"), t("../collision/AABB"), s.prototype.constructor = s, s.CLOSEST = 1, s.ANY = 2, s.ALL = 4, s.prototype.update = function() {
                    var t = this.direction;
                    o.sub(t, this.to, this.from), this.length = o.length(t), o.normalize(t, t)
                }, s.prototype.intersectBodies = function(t, e) {
                    for (var i = 0, s = e.length; !t.shouldStop(this) && i < s; i++) {
                        var n = e[i],
                            o = n.getAABB();
                        (o.overlapsRay(this) >= 0 || o.containsPoint(this.from)) && this.intersectBody(t, n)
                    }
                };
                var r = o.create();
                s.prototype.intersectBody = function(t, e) {
                    var i = this.checkCollisionResponse;
                    if (!i || e.collisionResponse)
                        for (var s = r, n = 0, a = e.shapes.length; n < a; n++) {
                            var h = e.shapes[n];
                            if ((!i || h.collisionResponse) && 0 != (this.collisionGroup & h.collisionMask) && 0 != (h.collisionGroup & this.collisionMask)) {
                                o.rotate(s, h.position, e.angle), o.add(s, s, e.position);
                                var l = h.angle + e.angle;
                                if (this.intersectShape(t, h, l, s, e), t.shouldStop(this)) break
                            }
                        }
                }, s.prototype.intersectShape = function(t, e, i, s, o) {
                    n(this.from, this.direction, s) > e.boundingRadius * e.boundingRadius || (this._currentBody = o, this._currentShape = e, e.raycast(t, this, s, i), this._currentBody = this._currentShape = null)
                }, s.prototype.getAABB = function(t) {
                    var e = this.to,
                        i = this.from;
                    o.set(t.lowerBound, Math.min(e[0], i[0]), Math.min(e[1], i[1])), o.set(t.upperBound, Math.max(e[0], i[0]), Math.max(e[1], i[1]))
                }, o.create(), s.prototype.reportIntersection = function(t, e, i, n) {
                    var r = (this.from, this.to, this._currentShape),
                        a = this._currentBody;
                    if (!(this.skipBackfaces && o.dot(i, this.direction) > 0)) switch (this.mode) {
                        case s.ALL:
                            t.set(i, r, a, e, n), this.callback(t);
                            break;
                        case s.CLOSEST:
                            (e < t.fraction || !t.hasHit()) && t.set(i, r, a, e, n);
                            break;
                        case s.ANY:
                            t.set(i, r, a, e, n)
                    }
                };
                var a = o.create(),
                    h = o.create()
            }, {
                "../collision/AABB": 7,
                "../collision/RaycastResult": 12,
                "../math/vec2": 30,
                "../shapes/Shape": 45
            }],
            12: [function(t, e, i) {
                function s() {
                    this.normal = n.create(), this.shape = null, this.body = null, this.faceIndex = -1, this.fraction = -1, this.isStopped = !1
                }
                var n = t("../math/vec2"),
                    o = t("../collision/Ray");
                e.exports = s, s.prototype.reset = function() {
                    n.set(this.normal, 0, 0), this.shape = null, this.body = null, this.faceIndex = -1, this.fraction = -1, this.isStopped = !1
                }, s.prototype.getHitDistance = function(t) {
                    return n.distance(t.from, t.to) * this.fraction
                }, s.prototype.hasHit = function() {
                    return -1 !== this.fraction
                }, s.prototype.getHitPoint = function(t, e) {
                    n.lerp(t, e.from, e.to, this.fraction)
                }, s.prototype.stop = function() {
                    this.isStopped = !0
                }, s.prototype.shouldStop = function(t) {
                    return this.isStopped || -1 !== this.fraction && t.mode === o.ANY
                }, s.prototype.set = function(t, e, i, s, o) {
                    n.copy(this.normal, t), this.shape = e, this.body = i, this.fraction = s, this.faceIndex = o
                }
            }, {
                "../collision/Ray": 11,
                "../math/vec2": 30
            }],
            13: [function(t, e, i) {
                function s() {
                    o.call(this, o.SAP), this.axisList = [], this.axisIndex = 0;
                    var t = this;
                    this._addBodyHandler = function(e) {
                        t.axisList.push(e.body)
                    }, this._removeBodyHandler = function(e) {
                        var i = t.axisList.indexOf(e.body); - 1 !== i && t.axisList.splice(i, 1)
                    }
                }
                var n = t("../utils/Utils"),
                    o = t("../collision/Broadphase");
                e.exports = s, s.prototype = new o, s.prototype.constructor = s, s.prototype.setWorld = function(t) {
                    this.axisList.length = 0, n.appendArray(this.axisList, t.bodies), t.off("addBody", this._addBodyHandler).off("removeBody", this._removeBodyHandler), t.on("addBody", this._addBodyHandler).on("removeBody", this._removeBodyHandler), this.world = t
                }, s.sortAxisList = function(t, e) {
                    e |= 0;
                    for (var i = 1, s = t.length; i < s; i++) {
                        for (var n = t[i], o = i - 1; o >= 0 && !(t[o].aabb.lowerBound[e] <= n.aabb.lowerBound[e]); o--) t[o + 1] = t[o];
                        t[o + 1] = n
                    }
                    return t
                }, s.prototype.sortList = function() {
                    var t = this.axisList,
                        e = this.axisIndex;
                    s.sortAxisList(t, e)
                }, s.prototype.getCollisionPairs = function(t) {
                    var e = this.axisList,
                        i = this.result,
                        s = this.axisIndex;
                    i.length = 0;
                    for (var n = e.length; n--;) {
                        var r = e[n];
                        r.aabbNeedsUpdate && r.updateAABB()
                    }
                    this.sortList();
                    for (var a = 0, h = 0 | e.length; a !== h; a++)
                        for (var l = e[a], c = a + 1; c < h; c++) {
                            var u = e[c];
                            if (!(u.aabb.lowerBound[s] <= l.aabb.upperBound[s])) break;
                            o.canCollide(l, u) && this.boundingVolumeCheck(l, u) && i.push(l, u)
                        }
                    return i
                }, s.prototype.aabbQuery = function(t, e, i) {
                    i = i || [], this.sortList();
                    var s = this.axisIndex,
                        n = "x";
                    1 === s && (n = "y"), 2 === s && (n = "z");
                    for (var o = this.axisList, r = (e.lowerBound[n], e.upperBound[n], 0); r < o.length; r++) {
                        var a = o[r];
                        a.aabbNeedsUpdate && a.updateAABB(), a.aabb.overlaps(e) && i.push(a)
                    }
                    return i
                }
            }, {
                "../collision/Broadphase": 8,
                "../utils/Utils": 57
            }],
            14: [function(t, e, i) {
                function s(t, e, i, s) {
                    this.type = i, s = n.defaults(s, {
                        collideConnected: !0,
                        wakeUpBodies: !0
                    }), this.equations = [], this.bodyA = t, this.bodyB = e, this.collideConnected = s.collideConnected, s.wakeUpBodies && (t && t.wakeUp(), e && e.wakeUp())
                }
                e.exports = s;
                var n = t("../utils/Utils");
                s.prototype.update = function() {
                    throw new Error("method update() not implmemented in this Constraint subclass!")
                }, s.DISTANCE = 1, s.GEAR = 2, s.LOCK = 3, s.PRISMATIC = 4, s.REVOLUTE = 5, s.prototype.setStiffness = function(t) {
                    for (var e = this.equations, i = 0; i !== e.length; i++) {
                        var s = e[i];
                        s.stiffness = t, s.needsUpdate = !0
                    }
                }, s.prototype.setRelaxation = function(t) {
                    for (var e = this.equations, i = 0; i !== e.length; i++) {
                        var s = e[i];
                        s.relaxation = t, s.needsUpdate = !0
                    }
                }
            }, {
                "../utils/Utils": 57
            }],
            15: [function(t, e, i) {
                function s(t, e, i) {
                    i = a.defaults(i, {
                        localAnchorA: [0, 0],
                        localAnchorB: [0, 0]
                    }), n.call(this, t, e, n.DISTANCE, i), this.localAnchorA = r.fromValues(i.localAnchorA[0], i.localAnchorA[1]), this.localAnchorB = r.fromValues(i.localAnchorB[0], i.localAnchorB[1]);
                    var s, h = this.localAnchorA,
                        l = this.localAnchorB;
                    if (this.distance = 0, "number" == typeof i.distance) this.distance = i.distance;
                    else {
                        var c = r.create(),
                            u = r.create(),
                            d = r.create();
                        r.rotate(c, h, t.angle), r.rotate(u, l, e.angle), r.add(d, e.position, u), r.sub(d, d, c), r.sub(d, d, t.position), this.distance = r.length(d)
                    }
                    s = void 0 === i.maxForce ? Number.MAX_VALUE : i.maxForce;
                    var p = new o(t, e, -s, s);
                    this.equations = [p], this.maxForce = s;
                    d = r.create();
                    var f = r.create(),
                        m = r.create(),
                        g = this;
                    p.computeGq = function() {
                        var t = this.bodyA,
                            e = this.bodyB,
                            i = t.position,
                            s = e.position;
                        return r.rotate(f, h, t.angle), r.rotate(m, l, e.angle), r.add(d, s, m), r.sub(d, d, f), r.sub(d, d, i), r.length(d) - g.distance
                    }, this.setMaxForce(s), this.upperLimitEnabled = !1, this.upperLimit = 1, this.lowerLimitEnabled = !1, this.lowerLimit = 0, this.position = 0
                }
                var n = t("./Constraint"),
                    o = t("../equations/Equation"),
                    r = t("../math/vec2"),
                    a = t("../utils/Utils");
                e.exports = s, s.prototype = new n, s.prototype.constructor = s;
                var h = r.create(),
                    l = r.create(),
                    c = r.create();
                s.prototype.update = function() {
                    var t = this.equations[0],
                        e = this.bodyA,
                        i = this.bodyB,
                        s = (this.distance, e.position),
                        n = i.position,
                        o = this.equations[0],
                        a = t.G;
                    r.rotate(l, this.localAnchorA, e.angle), r.rotate(c, this.localAnchorB, i.angle), r.add(h, n, c), r.sub(h, h, l), r.sub(h, h, s), this.position = r.length(h);
                    var u = !1;
                    if (this.upperLimitEnabled && this.position > this.upperLimit && (o.maxForce = 0, o.minForce = -this.maxForce, this.distance = this.upperLimit, u = !0), this.lowerLimitEnabled && this.position < this.lowerLimit && (o.maxForce = this.maxForce, o.minForce = 0, this.distance = this.lowerLimit, u = !0), !this.lowerLimitEnabled && !this.upperLimitEnabled || u) {
                        o.enabled = !0, r.normalize(h, h);
                        var d = r.crossLength(l, h),
                            p = r.crossLength(c, h);
                        a[0] = -h[0], a[1] = -h[1], a[2] = -d, a[3] = h[0], a[4] = h[1], a[5] = p
                    } else o.enabled = !1
                }, s.prototype.setMaxForce = function(t) {
                    var e = this.equations[0];
                    e.minForce = -t, e.maxForce = t
                }, s.prototype.getMaxForce = function() {
                    return this.equations[0].maxForce
                }
            }, {
                "../equations/Equation": 22,
                "../math/vec2": 30,
                "../utils/Utils": 57,
                "./Constraint": 14
            }],
            16: [function(t, e, i) {
                function s(t, e, i) {
                    i = i || {}, n.call(this, t, e, n.GEAR, i), this.ratio = void 0 !== i.ratio ? i.ratio : 1, this.angle = void 0 !== i.angle ? i.angle : e.angle - this.ratio * t.angle, i.angle = this.angle, i.ratio = this.ratio, this.equations = [new o(t, e, i)], void 0 !== i.maxTorque && this.setMaxTorque(i.maxTorque)
                }
                var n = t("./Constraint"),
                    o = (t("../equations/Equation"), t("../equations/AngleLockEquation"));
                t("../math/vec2"), e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.update = function() {
                    var t = this.equations[0];
                    t.ratio !== this.ratio && t.setRatio(this.ratio), t.angle = this.angle
                }, s.prototype.setMaxTorque = function(t) {
                    this.equations[0].setMaxTorque(t)
                }, s.prototype.getMaxTorque = function(t) {
                    return this.equations[0].maxForce
                }
            }, {
                "../equations/AngleLockEquation": 20,
                "../equations/Equation": 22,
                "../math/vec2": 30,
                "./Constraint": 14
            }],
            17: [function(t, e, i) {
                function s(t, e, i) {
                    i = i || {}, n.call(this, t, e, n.LOCK, i);
                    var s = void 0 === i.maxForce ? Number.MAX_VALUE : i.maxForce,
                        a = (i.localAngleB, new r(t, e, -s, s)),
                        h = new r(t, e, -s, s),
                        l = new r(t, e, -s, s),
                        c = o.create(),
                        u = o.create(),
                        d = this;
                    a.computeGq = function() {
                        return o.rotate(c, d.localOffsetB, t.angle), o.sub(u, e.position, t.position), o.sub(u, u, c), u[0]
                    }, h.computeGq = function() {
                        return o.rotate(c, d.localOffsetB, t.angle), o.sub(u, e.position, t.position), o.sub(u, u, c), u[1]
                    };
                    var p = o.create(),
                        f = o.create();
                    l.computeGq = function() {
                        return o.rotate(p, d.localOffsetB, e.angle - d.localAngleB), o.scale(p, p, -1), o.sub(u, t.position, e.position), o.add(u, u, p), o.rotate(f, p, -Math.PI / 2), o.normalize(f, f), o.dot(u, f)
                    }, this.localOffsetB = o.create(), i.localOffsetB ? o.copy(this.localOffsetB, i.localOffsetB) : (o.sub(this.localOffsetB, e.position, t.position), o.rotate(this.localOffsetB, this.localOffsetB, -t.angle)), this.localAngleB = 0, "number" == typeof i.localAngleB ? this.localAngleB = i.localAngleB : this.localAngleB = e.angle - t.angle, this.equations.push(a, h, l), this.setMaxForce(s)
                }
                var n = t("./Constraint"),
                    o = t("../math/vec2"),
                    r = t("../equations/Equation");
                e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.setMaxForce = function(t) {
                    for (var e = this.equations, i = 0; i < this.equations.length; i++) e[i].maxForce = t, e[i].minForce = -t
                }, s.prototype.getMaxForce = function() {
                    return this.equations[0].maxForce
                };
                var a = o.create(),
                    h = o.create(),
                    l = o.create(),
                    c = o.fromValues(1, 0),
                    u = o.fromValues(0, 1);
                s.prototype.update = function() {
                    var t = this.equations[0],
                        e = this.equations[1],
                        i = this.equations[2],
                        s = this.bodyA,
                        n = this.bodyB;
                    o.rotate(a, this.localOffsetB, s.angle), o.rotate(h, this.localOffsetB, n.angle - this.localAngleB), o.scale(h, h, -1), o.rotate(l, h, Math.PI / 2), o.normalize(l, l), t.G[0] = -1, t.G[1] = 0, t.G[2] = -o.crossLength(a, c), t.G[3] = 1, e.G[0] = 0, e.G[1] = -1, e.G[2] = -o.crossLength(a, u), e.G[4] = 1, i.G[0] = -l[0], i.G[1] = -l[1], i.G[3] = l[0], i.G[4] = l[1], i.G[5] = o.crossLength(h, l)
                }
            }, {
                "../equations/Equation": 22,
                "../math/vec2": 30,
                "./Constraint": 14
            }],
            18: [function(t, e, i) {
                function s(t, e, i) {
                    i = i || {}, n.call(this, t, e, n.PRISMATIC, i);
                    var s = a.fromValues(0, 0),
                        l = a.fromValues(1, 0),
                        c = a.fromValues(0, 0);
                    i.localAnchorA && a.copy(s, i.localAnchorA), i.localAxisA && a.copy(l, i.localAxisA), i.localAnchorB && a.copy(c, i.localAnchorB), this.localAnchorA = s, this.localAnchorB = c, this.localAxisA = l;
                    var u = this.maxForce = void 0 !== i.maxForce ? i.maxForce : Number.MAX_VALUE,
                        d = new r(t, e, -u, u),
                        p = new a.create,
                        f = new a.create,
                        m = new a.create,
                        g = new a.create;
                    if (d.computeGq = function() {
                            return a.dot(m, g)
                        }, d.updateJacobian = function() {
                            var i = this.G,
                                n = t.position,
                                o = e.position;
                            a.rotate(p, s, t.angle), a.rotate(f, c, e.angle), a.add(m, o, f), a.sub(m, m, n), a.sub(m, m, p), a.rotate(g, l, t.angle + Math.PI / 2), i[0] = -g[0], i[1] = -g[1], i[2] = -a.crossLength(p, g) + a.crossLength(g, m), i[3] = g[0], i[4] = g[1], i[5] = a.crossLength(f, g)
                        }, this.equations.push(d), !i.disableRotationalLock) {
                        var y = new h(t, e, -u, u);
                        this.equations.push(y)
                    }
                    this.position = 0, this.velocity = 0, this.lowerLimitEnabled = void 0 !== i.lowerLimit, this.upperLimitEnabled = void 0 !== i.upperLimit, this.lowerLimit = void 0 !== i.lowerLimit ? i.lowerLimit : 0, this.upperLimit = void 0 !== i.upperLimit ? i.upperLimit : 1, this.upperLimitEquation = new o(t, e), this.lowerLimitEquation = new o(t, e), this.upperLimitEquation.minForce = this.lowerLimitEquation.minForce = 0, this.upperLimitEquation.maxForce = this.lowerLimitEquation.maxForce = u, this.motorEquation = new r(t, e), this.motorEnabled = !1, this.motorSpeed = 0;
                    var v = this,
                        b = this.motorEquation;
                    b.computeGW, b.computeGq = function() {
                        return 0
                    }, b.computeGW = function() {
                        var t = this.G,
                            e = this.bodyA,
                            i = this.bodyB,
                            s = e.velocity,
                            n = i.velocity,
                            o = e.angularVelocity,
                            r = i.angularVelocity;
                        return this.gmult(t, s, o, n, r) + v.motorSpeed
                    }
                }
                var n = t("./Constraint"),
                    o = t("../equations/ContactEquation"),
                    r = t("../equations/Equation"),
                    a = t("../math/vec2"),
                    h = t("../equations/RotationalLockEquation");
                e.exports = s, s.prototype = new n, s.prototype.constructor = s;
                var l = a.create(),
                    c = a.create(),
                    u = a.create(),
                    d = a.create(),
                    p = a.create(),
                    f = a.create();
                s.prototype.update = function() {
                    var t = this.equations,
                        e = t[0],
                        i = this.upperLimit,
                        s = this.lowerLimit,
                        n = this.upperLimitEquation,
                        o = this.lowerLimitEquation,
                        r = this.bodyA,
                        h = this.bodyB,
                        m = this.localAxisA,
                        g = this.localAnchorA,
                        y = this.localAnchorB;
                    e.updateJacobian(), a.rotate(l, m, r.angle), a.rotate(d, g, r.angle), a.add(c, d, r.position), a.rotate(p, y, h.angle), a.add(u, p, h.position);
                    var v, b = this.position = a.dot(u, l) - a.dot(c, l);
                    if (this.motorEnabled) {
                        var _ = this.motorEquation.G;
                        _[0] = l[0], _[1] = l[1], _[2] = a.crossLength(l, p), _[3] = -l[0], _[4] = -l[1], _[5] = -a.crossLength(l, d)
                    }
                    this.upperLimitEnabled && b > i ? (a.scale(n.normalA, l, -1), a.sub(n.contactPointA, c, r.position), a.sub(n.contactPointB, u, h.position), a.scale(f, l, i), a.add(n.contactPointA, n.contactPointA, f), -1 === t.indexOf(n) && t.push(n)) : -1 !== (v = t.indexOf(n)) && t.splice(v, 1);
                    this.lowerLimitEnabled && b < s ? (a.scale(o.normalA, l, 1), a.sub(o.contactPointA, c, r.position), a.sub(o.contactPointB, u, h.position), a.scale(f, l, s), a.sub(o.contactPointB, o.contactPointB, f), -1 === t.indexOf(o) && t.push(o)) : -1 !== (v = t.indexOf(o)) && t.splice(v, 1)
                }, s.prototype.enableMotor = function() {
                    this.motorEnabled || (this.equations.push(this.motorEquation), this.motorEnabled = !0)
                }, s.prototype.disableMotor = function() {
                    if (this.motorEnabled) {
                        var t = this.equations.indexOf(this.motorEquation);
                        this.equations.splice(t, 1), this.motorEnabled = !1
                    }
                }, s.prototype.setLimits = function(t, e) {
                    "number" == typeof t ? (this.lowerLimit = t, this.lowerLimitEnabled = !0) : (this.lowerLimit = t, this.lowerLimitEnabled = !1), "number" == typeof e ? (this.upperLimit = e, this.upperLimitEnabled = !0) : (this.upperLimit = e, this.upperLimitEnabled = !1)
                }
            }, {
                "../equations/ContactEquation": 21,
                "../equations/Equation": 22,
                "../equations/RotationalLockEquation": 24,
                "../math/vec2": 30,
                "./Constraint": 14
            }],
            19: [function(t, e, i) {
                function s(t, e, i) {
                    i = i || {}, n.call(this, t, e, n.REVOLUTE, i);
                    var s = this.maxForce = void 0 !== i.maxForce ? i.maxForce : Number.MAX_VALUE;
                    this.pivotA = h.create(), this.pivotB = h.create(), i.worldPivot ? (h.sub(this.pivotA, i.worldPivot, t.position), h.sub(this.pivotB, i.worldPivot, e.position), h.rotate(this.pivotA, this.pivotA, -t.angle), h.rotate(this.pivotB, this.pivotB, -e.angle)) : (h.copy(this.pivotA, i.localPivotA), h.copy(this.pivotB, i.localPivotB));
                    var f = this.equations = [new o(t, e, -s, s), new o(t, e, -s, s)],
                        m = f[0],
                        g = f[1],
                        y = this;
                    m.computeGq = function() {
                        return h.rotate(l, y.pivotA, t.angle), h.rotate(c, y.pivotB, e.angle), h.add(p, e.position, c), h.sub(p, p, t.position), h.sub(p, p, l), h.dot(p, u)
                    }, g.computeGq = function() {
                        return h.rotate(l, y.pivotA, t.angle), h.rotate(c, y.pivotB, e.angle), h.add(p, e.position, c), h.sub(p, p, t.position), h.sub(p, p, l), h.dot(p, d)
                    }, g.minForce = m.minForce = -s, g.maxForce = m.maxForce = s, this.motorEquation = new r(t, e), this.motorEnabled = !1, this.angle = 0, this.lowerLimitEnabled = !1, this.upperLimitEnabled = !1, this.lowerLimit = 0, this.upperLimit = 0, this.upperLimitEquation = new a(t, e), this.lowerLimitEquation = new a(t, e), this.upperLimitEquation.minForce = 0, this.lowerLimitEquation.maxForce = 0
                }
                var n = t("./Constraint"),
                    o = t("../equations/Equation"),
                    r = t("../equations/RotationalVelocityEquation"),
                    a = t("../equations/RotationalLockEquation"),
                    h = t("../math/vec2");
                e.exports = s;
                var l = h.create(),
                    c = h.create(),
                    u = h.fromValues(1, 0),
                    d = h.fromValues(0, 1),
                    p = h.create();
                s.prototype = new n, s.prototype.constructor = s, s.prototype.setLimits = function(t, e) {
                    "number" == typeof t ? (this.lowerLimit = t, this.lowerLimitEnabled = !0) : (this.lowerLimit = t, this.lowerLimitEnabled = !1), "number" == typeof e ? (this.upperLimit = e, this.upperLimitEnabled = !0) : (this.upperLimit = e, this.upperLimitEnabled = !1)
                }, s.prototype.update = function() {
                    var t, e = this.bodyA,
                        i = this.bodyB,
                        s = this.pivotA,
                        n = this.pivotB,
                        o = this.equations,
                        r = (o[0], o[1], o[0]),
                        a = o[1],
                        p = this.upperLimit,
                        f = this.lowerLimit,
                        m = this.upperLimitEquation,
                        g = this.lowerLimitEquation,
                        y = this.angle = i.angle - e.angle;
                    this.upperLimitEnabled && y > p ? (m.angle = p, -1 === o.indexOf(m) && o.push(m)) : -1 !== (t = o.indexOf(m)) && o.splice(t, 1);
                    this.lowerLimitEnabled && y < f ? (g.angle = f, -1 === o.indexOf(g) && o.push(g)) : -1 !== (t = o.indexOf(g)) && o.splice(t, 1);
                    h.rotate(l, s, e.angle), h.rotate(c, n, i.angle), r.G[0] = -1, r.G[1] = 0, r.G[2] = -h.crossLength(l, u), r.G[3] = 1, r.G[4] = 0, r.G[5] = h.crossLength(c, u), a.G[0] = 0, a.G[1] = -1, a.G[2] = -h.crossLength(l, d), a.G[3] = 0, a.G[4] = 1, a.G[5] = h.crossLength(c, d)
                }, s.prototype.enableMotor = function() {
                    this.motorEnabled || (this.equations.push(this.motorEquation), this.motorEnabled = !0)
                }, s.prototype.disableMotor = function() {
                    if (this.motorEnabled) {
                        var t = this.equations.indexOf(this.motorEquation);
                        this.equations.splice(t, 1), this.motorEnabled = !1
                    }
                }, s.prototype.motorIsEnabled = function() {
                    return !!this.motorEnabled
                }, s.prototype.setMotorSpeed = function(t) {
                    if (this.motorEnabled) {
                        var e = this.equations.indexOf(this.motorEquation);
                        this.equations[e].relativeVelocity = t
                    }
                }, s.prototype.getMotorSpeed = function() {
                    return !!this.motorEnabled && this.motorEquation.relativeVelocity
                }
            }, {
                "../equations/Equation": 22,
                "../equations/RotationalLockEquation": 24,
                "../equations/RotationalVelocityEquation": 25,
                "../math/vec2": 30,
                "./Constraint": 14
            }],
            20: [function(t, e, i) {
                function s(t, e, i) {
                    i = i || {}, n.call(this, t, e, -Number.MAX_VALUE, Number.MAX_VALUE), this.angle = i.angle || 0, this.ratio = "number" == typeof i.ratio ? i.ratio : 1, this.setRatio(this.ratio)
                }
                var n = t("./Equation");
                t("../math/vec2"), e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.computeGq = function() {
                    return this.ratio * this.bodyA.angle - this.bodyB.angle + this.angle
                }, s.prototype.setRatio = function(t) {
                    var e = this.G;
                    e[2] = t, e[5] = -1, this.ratio = t
                }, s.prototype.setMaxTorque = function(t) {
                    this.maxForce = t, this.minForce = -t
                }
            }, {
                "../math/vec2": 30,
                "./Equation": 22
            }],
            21: [function(t, e, i) {
                function s(t, e) {
                    n.call(this, t, e, 0, Number.MAX_VALUE), this.contactPointA = o.create(), this.penetrationVec = o.create(), this.contactPointB = o.create(), this.normalA = o.create(), this.restitution = 0, this.firstImpact = !1, this.shapeA = null, this.shapeB = null
                }
                var n = t("./Equation"),
                    o = t("../math/vec2");
                e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.computeB = function(t, e, i) {
                    var s, n, r = this.bodyA,
                        a = this.bodyB,
                        h = this.contactPointA,
                        l = this.contactPointB,
                        c = r.position,
                        u = a.position,
                        d = this.penetrationVec,
                        p = this.normalA,
                        f = this.G,
                        m = o.crossLength(h, p),
                        g = o.crossLength(l, p);
                    return f[0] = -p[0], f[1] = -p[1], f[2] = -m, f[3] = p[0], f[4] = p[1], f[5] = g, o.add(d, u, l), o.sub(d, d, c), o.sub(d, d, h), this.firstImpact && 0 !== this.restitution ? (n = 0, s = 1 / e * (1 + this.restitution) * this.computeGW()) : (n = o.dot(p, d) + this.offset, s = this.computeGW()), -n * t - s * e - i * this.computeGiMf()
                };
                var r = o.create(),
                    a = o.create(),
                    h = o.create();
                s.prototype.getVelocityAlongNormal = function() {
                    return this.bodyA.getVelocityAtPoint(r, this.contactPointA), this.bodyB.getVelocityAtPoint(a, this.contactPointB), o.subtract(h, r, a), o.dot(this.normalA, h)
                }
            }, {
                "../math/vec2": 30,
                "./Equation": 22
            }],
            22: [function(t, e, i) {
                function s(t, e, i, n) {
                    this.minForce = void 0 === i ? -Number.MAX_VALUE : i, this.maxForce = void 0 === n ? Number.MAX_VALUE : n, this.bodyA = t, this.bodyB = e, this.stiffness = s.DEFAULT_STIFFNESS, this.relaxation = s.DEFAULT_RELAXATION, this.G = new o.ARRAY_TYPE(6);
                    for (var r = 0; r < 6; r++) this.G[r] = 0;
                    this.offset = 0, this.a = 0, this.b = 0, this.epsilon = 0, this.timeStep = 1 / 60, this.needsUpdate = !0, this.multiplier = 0, this.relativeVelocity = 0, this.enabled = !0
                }
                e.exports = s;
                var n = t("../math/vec2"),
                    o = t("../utils/Utils");
                t("../objects/Body"), s.prototype.constructor = s, s.DEFAULT_STIFFNESS = 1e6, s.DEFAULT_RELAXATION = 4, s.prototype.update = function() {
                    var t = this.stiffness,
                        e = this.relaxation,
                        i = this.timeStep;
                    this.a = 4 / (i * (1 + 4 * e)), this.b = 4 * e / (1 + 4 * e), this.epsilon = 4 / (i * i * t * (1 + 4 * e)), this.needsUpdate = !1
                }, s.prototype.gmult = function(t, e, i, s, n) {
                    return t[0] * e[0] + t[1] * e[1] + t[2] * i + t[3] * s[0] + t[4] * s[1] + t[5] * n
                }, s.prototype.computeB = function(t, e, i) {
                    var s = this.computeGW();
                    return -this.computeGq() * t - s * e - this.computeGiMf() * i
                };
                var r = n.create(),
                    a = n.create();
                s.prototype.computeGq = function() {
                    var t = this.G,
                        e = this.bodyA,
                        i = this.bodyB,
                        s = (e.position, i.position, e.angle),
                        n = i.angle;
                    return this.gmult(t, r, s, a, n) + this.offset
                }, s.prototype.computeGW = function() {
                    var t = this.G,
                        e = this.bodyA,
                        i = this.bodyB,
                        s = e.velocity,
                        n = i.velocity,
                        o = e.angularVelocity,
                        r = i.angularVelocity;
                    return this.gmult(t, s, o, n, r) + this.relativeVelocity
                }, s.prototype.computeGWlambda = function() {
                    var t = this.G,
                        e = this.bodyA,
                        i = this.bodyB,
                        s = e.vlambda,
                        n = i.vlambda,
                        o = e.wlambda,
                        r = i.wlambda;
                    return this.gmult(t, s, o, n, r)
                };
                var h = n.create(),
                    l = n.create();
                s.prototype.computeGiMf = function() {
                    var t = this.bodyA,
                        e = this.bodyB,
                        i = t.force,
                        s = t.angularForce,
                        o = e.force,
                        r = e.angularForce,
                        a = t.invMassSolve,
                        c = e.invMassSolve,
                        u = t.invInertiaSolve,
                        d = e.invInertiaSolve,
                        p = this.G;
                    return n.scale(h, i, a), n.multiply(h, t.massMultiplier, h), n.scale(l, o, c), n.multiply(l, e.massMultiplier, l), this.gmult(p, h, s * u, l, r * d)
                }, s.prototype.computeGiMGt = function() {
                    var t = this.bodyA,
                        e = this.bodyB,
                        i = t.invMassSolve,
                        s = e.invMassSolve,
                        n = t.invInertiaSolve,
                        o = e.invInertiaSolve,
                        r = this.G;
                    return r[0] * r[0] * i * t.massMultiplier[0] + r[1] * r[1] * i * t.massMultiplier[1] + r[2] * r[2] * n + r[3] * r[3] * s * e.massMultiplier[0] + r[4] * r[4] * s * e.massMultiplier[1] + r[5] * r[5] * o
                };
                var c = n.create(),
                    u = n.create(),
                    d = n.create();
                n.create(), n.create(), n.create(), s.prototype.addToWlambda = function(t) {
                    var e = this.bodyA,
                        i = this.bodyB,
                        s = c,
                        o = u,
                        r = d,
                        a = e.invMassSolve,
                        h = i.invMassSolve,
                        l = e.invInertiaSolve,
                        p = i.invInertiaSolve,
                        f = this.G;
                    o[0] = f[0], o[1] = f[1], r[0] = f[3], r[1] = f[4], n.scale(s, o, a * t), n.multiply(s, s, e.massMultiplier), n.add(e.vlambda, e.vlambda, s), e.wlambda += l * f[2] * t, n.scale(s, r, h * t), n.multiply(s, s, i.massMultiplier), n.add(i.vlambda, i.vlambda, s), i.wlambda += p * f[5] * t
                }, s.prototype.computeInvC = function(t) {
                    return 1 / (this.computeGiMGt() + t)
                }
            }, {
                "../math/vec2": 30,
                "../objects/Body": 31,
                "../utils/Utils": 57
            }],
            23: [function(t, e, i) {
                function s(t, e, i) {
                    o.call(this, t, e, -i, i), this.contactPointA = n.create(), this.contactPointB = n.create(), this.t = n.create(), this.contactEquations = [], this.shapeA = null, this.shapeB = null, this.frictionCoefficient = .3
                }
                var n = t("../math/vec2"),
                    o = t("./Equation");
                t("../utils/Utils"), e.exports = s, s.prototype = new o, s.prototype.constructor = s, s.prototype.setSlipForce = function(t) {
                    this.maxForce = t, this.minForce = -t
                }, s.prototype.getSlipForce = function() {
                    return this.maxForce
                }, s.prototype.computeB = function(t, e, i) {
                    var s = (this.bodyA, this.bodyB, this.contactPointA),
                        o = this.contactPointB,
                        r = this.t,
                        a = this.G;
                    return a[0] = -r[0], a[1] = -r[1], a[2] = -n.crossLength(s, r), a[3] = r[0], a[4] = r[1], a[5] = n.crossLength(o, r), -this.computeGW() * e - i * this.computeGiMf()
                }
            }, {
                "../math/vec2": 30,
                "../utils/Utils": 57,
                "./Equation": 22
            }],
            24: [function(t, e, i) {
                function s(t, e, i) {
                    i = i || {}, n.call(this, t, e, -Number.MAX_VALUE, Number.MAX_VALUE), this.angle = i.angle || 0;
                    var s = this.G;
                    s[2] = 1, s[5] = -1
                }
                var n = t("./Equation"),
                    o = t("../math/vec2");
                e.exports = s, s.prototype = new n, s.prototype.constructor = s;
                var r = o.create(),
                    a = o.create(),
                    h = o.fromValues(1, 0),
                    l = o.fromValues(0, 1);
                s.prototype.computeGq = function() {
                    return o.rotate(r, h, this.bodyA.angle + this.angle), o.rotate(a, l, this.bodyB.angle), o.dot(r, a)
                }
            }, {
                "../math/vec2": 30,
                "./Equation": 22
            }],
            25: [function(t, e, i) {
                function s(t, e) {
                    n.call(this, t, e, -Number.MAX_VALUE, Number.MAX_VALUE), this.relativeVelocity = 1, this.ratio = 1
                }
                var n = t("./Equation");
                t("../math/vec2"), e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.computeB = function(t, e, i) {
                    var s = this.G;
                    s[2] = -1, s[5] = this.ratio;
                    var n = this.computeGiMf();
                    return -this.computeGW() * e - i * n
                }
            }, {
                "../math/vec2": 30,
                "./Equation": 22
            }],
            26: [function(t, e, i) {
                var s = function() {};
                e.exports = s, s.prototype = {
                    constructor: s,
                    on: function(t, e, i) {
                        e.context = i || this, void 0 === this._listeners && (this._listeners = {});
                        var s = this._listeners;
                        return void 0 === s[t] && (s[t] = []), -1 === s[t].indexOf(e) && s[t].push(e), this
                    },
                    has: function(t, e) {
                        if (void 0 === this._listeners) return !1;
                        var i = this._listeners;
                        if (e) {
                            if (void 0 !== i[t] && -1 !== i[t].indexOf(e)) return !0
                        } else if (void 0 !== i[t]) return !0;
                        return !1
                    },
                    off: function(t, e) {
                        if (void 0 === this._listeners) return this;
                        var i = this._listeners,
                            s = i[t].indexOf(e);
                        return -1 !== s && i[t].splice(s, 1), this
                    },
                    emit: function(t) {
                        if (void 0 === this._listeners) return this;
                        var e = this._listeners[t.type];
                        if (void 0 !== e) {
                            t.target = this;
                            for (var i = 0, s = e.length; i < s; i++) {
                                var n = e[i];
                                n.call(n.context, t)
                            }
                        }
                        return this
                    }
                }
            }, {}],
            27: [function(t, e, i) {
                function s(t, e, i) {
                    if (i = i || {}, !(t instanceof n && e instanceof n)) throw new Error("First two arguments must be Material instances.");
                    this.id = s.idCounter++, this.materialA = t, this.materialB = e, this.friction = void 0 !== i.friction ? Number(i.friction) : .3, this.restitution = void 0 !== i.restitution ? Number(i.restitution) : 0, this.stiffness = void 0 !== i.stiffness ? Number(i.stiffness) : o.DEFAULT_STIFFNESS, this.relaxation = void 0 !== i.relaxation ? Number(i.relaxation) : o.DEFAULT_RELAXATION, this.frictionStiffness = void 0 !== i.frictionStiffness ? Number(i.frictionStiffness) : o.DEFAULT_STIFFNESS, this.frictionRelaxation = void 0 !== i.frictionRelaxation ? Number(i.frictionRelaxation) : o.DEFAULT_RELAXATION, this.surfaceVelocity = void 0 !== i.surfaceVelocity ? Number(i.surfaceVelocity) : 0, this.contactSkinSize = .005
                }
                var n = t("./Material"),
                    o = t("../equations/Equation");
                e.exports = s, s.idCounter = 0
            }, {
                "../equations/Equation": 22,
                "./Material": 28
            }],
            28: [function(t, e, i) {
                function s(t) {
                    this.id = t || s.idCounter++
                }
                e.exports = s, s.idCounter = 0
            }, {}],
            29: [function(t, e, i) {
                var s = {
                    GetArea: function(t) {
                        if (t.length < 6) return 0;
                        for (var e = t.length - 2, i = 0, s = 0; s < e; s += 2) i += (t[s + 2] - t[s]) * (t[s + 1] + t[s + 3]);
                        return .5 * -(i += (t[0] - t[e]) * (t[e + 1] + t[1]))
                    },
                    Triangulate: function(t) {
                        var e = t.length >> 1;
                        if (e < 3) return [];
                        for (var i = [], n = [], o = 0; o < e; o++) n.push(o);
                        o = 0;
                        for (var r = e; r > 3;) {
                            var a = n[(o + 0) % r],
                                h = n[(o + 1) % r],
                                l = n[(o + 2) % r],
                                c = t[2 * a],
                                u = t[2 * a + 1],
                                d = t[2 * h],
                                p = t[2 * h + 1],
                                f = t[2 * l],
                                m = t[2 * l + 1],
                                g = !1;
                            if (s._convex(c, u, d, p, f, m)) {
                                g = !0;
                                for (var y = 0; y < r; y++) {
                                    var v = n[y];
                                    if (v != a && v != h && v != l && s._PointInTriangle(t[2 * v], t[2 * v + 1], c, u, d, p, f, m)) {
                                        g = !1;
                                        break
                                    }
                                }
                            }
                            if (g) i.push(a, h, l), n.splice((o + 1) % r, 1), r--, o = 0;
                            else if (o++ > 3 * r) break
                        }
                        return i.push(n[0], n[1], n[2]), i
                    },
                    _PointInTriangle: function(t, e, i, s, n, o, r, a) {
                        var h = r - i,
                            l = a - s,
                            c = n - i,
                            u = o - s,
                            d = t - i,
                            p = e - s,
                            f = h * h + l * l,
                            m = h * c + l * u,
                            g = h * d + l * p,
                            y = c * c + u * u,
                            v = c * d + u * p,
                            b = 1 / (f * y - m * m),
                            _ = (y * g - m * v) * b,
                            w = (f * v - m * g) * b;
                        return _ >= 0 && w >= 0 && _ + w < 1
                    },
                    _convex: function(t, e, i, s, n, o) {
                        return (e - s) * (n - i) + (i - t) * (o - s) >= 0
                    }
                };
                e.exports = s
            }, {}],
            30: [function(t, e, i) {
                var s = e.exports = {},
                    n = t("../utils/Utils");
                s.crossLength = function(t, e) {
                    return t[0] * e[1] - t[1] * e[0]
                }, s.crossVZ = function(t, e, i) {
                    return s.rotate(t, e, -Math.PI / 2), s.scale(t, t, i), t
                }, s.crossZV = function(t, e, i) {
                    return s.rotate(t, i, Math.PI / 2), s.scale(t, t, e), t
                }, s.rotate = function(t, e, i) {
                    if (0 !== i) {
                        var s = Math.cos(i),
                            n = Math.sin(i),
                            o = e[0],
                            r = e[1];
                        t[0] = s * o - n * r, t[1] = n * o + s * r
                    } else t[0] = e[0], t[1] = e[1]
                }, s.rotate90cw = function(t, e) {
                    var i = e[0],
                        s = e[1];
                    t[0] = s, t[1] = -i
                }, s.toLocalFrame = function(t, e, i, n) {
                    s.copy(t, e), s.sub(t, t, i), s.rotate(t, t, -n)
                }, s.toGlobalFrame = function(t, e, i, n) {
                    s.copy(t, e), s.rotate(t, t, n), s.add(t, t, i)
                }, s.vectorToLocalFrame = function(t, e, i) {
                    s.rotate(t, e, -i)
                }, s.vectorToGlobalFrame = function(t, e, i) {
                    s.rotate(t, e, i)
                }, s.centroid = function(t, e, i, n) {
                    return s.add(t, e, i), s.add(t, t, n), s.scale(t, t, 1 / 3), t
                }, s.create = function() {
                    var t = new n.ARRAY_TYPE(2);
                    return t[0] = 0, t[1] = 0, t
                }, s.clone = function(t) {
                    var e = new n.ARRAY_TYPE(2);
                    return e[0] = t[0], e[1] = t[1], e
                }, s.fromValues = function(t, e) {
                    var i = new n.ARRAY_TYPE(2);
                    return i[0] = t, i[1] = e, i
                }, s.copy = function(t, e) {
                    return t[0] = e[0], t[1] = e[1], t
                }, s.set = function(t, e, i) {
                    return t[0] = e, t[1] = i, t
                }, s.add = function(t, e, i) {
                    return t[0] = e[0] + i[0], t[1] = e[1] + i[1], t
                }, s.subtract = function(t, e, i) {
                    return t[0] = e[0] - i[0], t[1] = e[1] - i[1], t
                }, s.sub = s.subtract, s.multiply = function(t, e, i) {
                    return t[0] = e[0] * i[0], t[1] = e[1] * i[1], t
                }, s.mul = s.multiply, s.divide = function(t, e, i) {
                    return t[0] = e[0] / i[0], t[1] = e[1] / i[1], t
                }, s.div = s.divide, s.scale = function(t, e, i) {
                    return t[0] = e[0] * i, t[1] = e[1] * i, t
                }, s.distance = function(t, e) {
                    var i = e[0] - t[0],
                        s = e[1] - t[1];
                    return Math.sqrt(i * i + s * s)
                }, s.dist = s.distance, s.squaredDistance = function(t, e) {
                    var i = e[0] - t[0],
                        s = e[1] - t[1];
                    return i * i + s * s
                }, s.sqrDist = s.squaredDistance, s.length = function(t) {
                    var e = t[0],
                        i = t[1];
                    return Math.sqrt(e * e + i * i)
                }, s.len = s.length, s.squaredLength = function(t) {
                    var e = t[0],
                        i = t[1];
                    return e * e + i * i
                }, s.sqrLen = s.squaredLength, s.negate = function(t, e) {
                    return t[0] = -e[0], t[1] = -e[1], t
                }, s.normalize = function(t, e) {
                    var i = e[0],
                        s = e[1],
                        n = i * i + s * s;
                    return n > 0 && (n = 1 / Math.sqrt(n), t[0] = e[0] * n, t[1] = e[1] * n), t
                }, s.dot = function(t, e) {
                    return t[0] * e[0] + t[1] * e[1]
                }, s.str = function(t) {
                    return "vec2(" + t[0] + ", " + t[1] + ")"
                }, s.lerp = function(t, e, i, s) {
                    var n = e[0],
                        o = e[1];
                    return t[0] = n + s * (i[0] - n), t[1] = o + s * (i[1] - o), t
                }, s.reflect = function(t, e, i) {
                    var s = e[0] * i[0] + e[1] * i[1];
                    t[0] = e[0] - 2 * i[0] * s, t[1] = e[1] - 2 * i[1] * s
                }, s.getLineSegmentsIntersection = function(t, e, i, n, o) {
                    var r = s.getLineSegmentsIntersectionFraction(e, i, n, o);
                    return !(r < 0 || (t[0] = e[0] + r * (i[0] - e[0]), t[1] = e[1] + r * (i[1] - e[1]), 0))
                }, s.getLineSegmentsIntersectionFraction = function(t, e, i, s) {
                    var n, o, r = e[0] - t[0],
                        a = e[1] - t[1],
                        h = s[0] - i[0],
                        l = s[1] - i[1];
                    return n = (-a * (t[0] - i[0]) + r * (t[1] - i[1])) / (-h * a + r * l), o = (h * (t[1] - i[1]) - l * (t[0] - i[0])) / (-h * a + r * l), n >= 0 && n <= 1 && o >= 0 && o <= 1 ? o : -1
                }
            }, {
                "../utils/Utils": 57
            }],
            31: [function(t, e, i) {
                function s(t) {
                    t = t || {}, c.call(this), this.id = t.id || ++s._idCounter, this.world = null, this.shapes = [], this.mass = t.mass || 0, this.invMass = 0, this.inertia = 0, this.invInertia = 0, this.invMassSolve = 0, this.invInertiaSolve = 0, this.fixedRotation = !!t.fixedRotation, this.fixedX = !!t.fixedX, this.fixedY = !!t.fixedY, this.massMultiplier = n.create(), this.position = n.fromValues(0, 0), t.position && n.copy(this.position, t.position), this.interpolatedPosition = n.fromValues(0, 0), this.interpolatedAngle = 0, this.previousPosition = n.fromValues(0, 0), this.previousAngle = 0, this.velocity = n.fromValues(0, 0), t.velocity && n.copy(this.velocity, t.velocity), this.vlambda = n.fromValues(0, 0), this.wlambda = 0, this.angle = t.angle || 0, this.angularVelocity = t.angularVelocity || 0, this.force = n.create(), t.force && n.copy(this.force, t.force), this.angularForce = t.angularForce || 0, this.damping = "number" == typeof t.damping ? t.damping : .1, this.angularDamping = "number" == typeof t.angularDamping ? t.angularDamping : .1, this.type = s.STATIC, void 0 !== t.type ? this.type = t.type : t.mass ? this.type = s.DYNAMIC : this.type = s.STATIC, this.boundingRadius = 0, this.aabb = new l, this.aabbNeedsUpdate = !0, this.allowSleep = void 0 === t.allowSleep || t.allowSleep, this.wantsToSleep = !1, this.sleepState = s.AWAKE, this.sleepSpeedLimit = void 0 !== t.sleepSpeedLimit ? t.sleepSpeedLimit : .2, this.sleepTimeLimit = void 0 !== t.sleepTimeLimit ? t.sleepTimeLimit : 1, this.gravityScale = void 0 !== t.gravityScale ? t.gravityScale : 1, this.collisionResponse = void 0 === t.collisionResponse || t.collisionResponse, this.idleTime = 0, this.timeLastSleepy = 0, this.ccdSpeedThreshold = void 0 !== t.ccdSpeedThreshold ? t.ccdSpeedThreshold : -1, this.ccdIterations = void 0 !== t.ccdIterations ? t.ccdIterations : 10, this.concavePath = null, this._wakeUpAfterNarrowphase = !1, this.updateMassProperties()
                }
                var n = t("../math/vec2"),
                    o = t("poly-decomp"),
                    r = t("../shapes/Convex"),
                    a = t("../collision/RaycastResult"),
                    h = t("../collision/Ray"),
                    l = t("../collision/AABB"),
                    c = t("../events/EventEmitter");
                e.exports = s, s.prototype = new c, s.prototype.constructor = s, s._idCounter = 0, s.prototype.updateSolveMassProperties = function() {
                    this.sleepState === s.SLEEPING || this.type === s.KINEMATIC ? (this.invMassSolve = 0, this.invInertiaSolve = 0) : (this.invMassSolve = this.invMass, this.invInertiaSolve = this.invInertia)
                }, s.prototype.setDensity = function(t) {
                    var e = this.getArea();
                    this.mass = e * t, this.updateMassProperties()
                }, s.prototype.getArea = function() {
                    for (var t = 0, e = 0; e < this.shapes.length; e++) t += this.shapes[e].area;
                    return t
                }, s.prototype.getAABB = function() {
                    return this.aabbNeedsUpdate && this.updateAABB(), this.aabb
                };
                var u = new l,
                    d = n.create();
                s.prototype.updateAABB = function() {
                    for (var t = this.shapes, e = t.length, i = d, s = this.angle, o = 0; o !== e; o++) {
                        var r = t[o],
                            a = r.angle + s;
                        n.rotate(i, r.position, s), n.add(i, i, this.position), r.computeAABB(u, i, a), 0 === o ? this.aabb.copy(u) : this.aabb.extend(u)
                    }
                    this.aabbNeedsUpdate = !1
                }, s.prototype.updateBoundingRadius = function() {
                    for (var t = this.shapes, e = t.length, i = 0, s = 0; s !== e; s++) {
                        var o = t[s],
                            r = n.length(o.position),
                            a = o.boundingRadius;
                        r + a > i && (i = r + a)
                    }
                    this.boundingRadius = i
                }, s.prototype.addShape = function(t, e, i) {
                    if (t.body) throw new Error("A shape can only be added to one body.");
                    t.body = this, e ? n.copy(t.position, e) : n.set(t.position, 0, 0), t.angle = i || 0, this.shapes.push(t), this.updateMassProperties(), this.updateBoundingRadius(), this.aabbNeedsUpdate = !0
                }, s.prototype.removeShape = function(t) {
                    var e = this.shapes.indexOf(t);
                    return -1 !== e && (this.shapes.splice(e, 1), this.aabbNeedsUpdate = !0, t.body = null, !0)
                }, s.prototype.updateMassProperties = function() {
                    if (this.type === s.STATIC || this.type === s.KINEMATIC) this.mass = Number.MAX_VALUE, this.invMass = 0, this.inertia = Number.MAX_VALUE, this.invInertia = 0;
                    else {
                        var t = this.shapes,
                            e = t.length,
                            i = this.mass / e,
                            o = 0;
                        if (this.fixedRotation) this.inertia = Number.MAX_VALUE, this.invInertia = 0;
                        else {
                            for (var r = 0; r < e; r++) {
                                var a = t[r],
                                    h = n.squaredLength(a.position);
                                o += a.computeMomentOfInertia(i) + i * h
                            }
                            this.inertia = o, this.invInertia = o > 0 ? 1 / o : 0
                        }
                        this.invMass = 1 / this.mass, n.set(this.massMultiplier, this.fixedX ? 0 : 1, this.fixedY ? 0 : 1)
                    }
                }, n.create(), s.prototype.applyForce = function(t, e) {
                    if (n.add(this.force, this.force, t), e) {
                        var i = n.crossLength(e, t);
                        this.angularForce += i
                    }
                };
                var p = n.create(),
                    f = n.create(),
                    m = n.create();
                s.prototype.applyForceLocal = function(t, e) {
                    e = e || m;
                    var i = p,
                        s = f;
                    this.vectorToWorldFrame(i, t), this.vectorToWorldFrame(s, e), this.applyForce(i, s)
                };
                var g = n.create();
                s.prototype.applyImpulse = function(t, e) {
                    if (this.type === s.DYNAMIC) {
                        var i = g;
                        if (n.scale(i, t, this.invMass), n.multiply(i, this.massMultiplier, i), n.add(this.velocity, i, this.velocity), e) {
                            var o = n.crossLength(e, t);
                            o *= this.invInertia, this.angularVelocity += o
                        }
                    }
                };
                var y = n.create(),
                    v = n.create(),
                    b = n.create();
                s.prototype.applyImpulseLocal = function(t, e) {
                    e = e || b;
                    var i = y,
                        s = v;
                    this.vectorToWorldFrame(i, t), this.vectorToWorldFrame(s, e), this.applyImpulse(i, s)
                }, s.prototype.toLocalFrame = function(t, e) {
                    n.toLocalFrame(t, e, this.position, this.angle)
                }, s.prototype.toWorldFrame = function(t, e) {
                    n.toGlobalFrame(t, e, this.position, this.angle)
                }, s.prototype.vectorToLocalFrame = function(t, e) {
                    n.vectorToLocalFrame(t, e, this.angle)
                }, s.prototype.vectorToWorldFrame = function(t, e) {
                    n.vectorToGlobalFrame(t, e, this.angle)
                }, s.prototype.fromPolygon = function(t, e) {
                    e = e || {};
                    for (var i = this.shapes.length; i >= 0; --i) this.removeShape(this.shapes[i]);
                    var s, a = new o.Polygon;
                    if (a.vertices = t, a.makeCCW(), "number" == typeof e.removeCollinearPoints && a.removeCollinearPoints(e.removeCollinearPoints), void 0 === e.skipSimpleCheck && !a.isSimple()) return !1;
                    this.concavePath = a.vertices.slice(0);
                    for (i = 0; i < this.concavePath.length; i++) {
                        var h = [0, 0];
                        n.copy(h, this.concavePath[i]), this.concavePath[i] = h
                    }
                    s = e.optimalDecomp ? a.decomp() : a.quickDecomp();
                    var l = n.create();
                    for (i = 0; i !== s.length; i++) {
                        for (var c = new r({
                                vertices: s[i].vertices
                            }), u = 0; u !== c.vertices.length; u++) {
                            h = c.vertices[u];
                            n.sub(h, h, c.centerOfMass)
                        }
                        n.scale(l, c.centerOfMass, 1), c.updateTriangles(), c.updateCenterOfMass(), c.updateBoundingRadius(), this.addShape(c, l)
                    }
                    return this.adjustCenterOfMass(), this.aabbNeedsUpdate = !0, !0
                };
                var _ = (n.fromValues(0, 0), n.fromValues(0, 0)),
                    w = n.fromValues(0, 0),
                    x = n.fromValues(0, 0);
                s.prototype.adjustCenterOfMass = function() {
                    var t = _,
                        e = w,
                        i = x,
                        s = 0;
                    n.set(e, 0, 0);
                    for (var o = 0; o !== this.shapes.length; o++) {
                        var r = this.shapes[o];
                        n.scale(t, r.position, r.area), n.add(e, e, t), s += r.area
                    }
                    n.scale(i, e, 1 / s);
                    for (o = 0; o !== this.shapes.length; o++) {
                        r = this.shapes[o];
                        n.sub(r.position, r.position, i)
                    }
                    n.add(this.position, this.position, i);
                    for (o = 0; this.concavePath && o < this.concavePath.length; o++) n.sub(this.concavePath[o], this.concavePath[o], i);
                    this.updateMassProperties(), this.updateBoundingRadius()
                }, s.prototype.setZeroForce = function() {
                    n.set(this.force, 0, 0), this.angularForce = 0
                }, s.prototype.resetConstraintVelocity = function() {
                    var t = this.vlambda;
                    n.set(t, 0, 0), this.wlambda = 0
                }, s.prototype.addConstraintVelocity = function() {
                    var t = this,
                        e = t.velocity;
                    n.add(e, e, t.vlambda), t.angularVelocity += t.wlambda
                }, s.prototype.applyDamping = function(t) {
                    if (this.type === s.DYNAMIC) {
                        var e = this.velocity;
                        n.scale(e, e, Math.pow(1 - this.damping, t)), this.angularVelocity *= Math.pow(1 - this.angularDamping, t)
                    }
                }, s.prototype.wakeUp = function() {
                    var t = this.sleepState;
                    this.sleepState = s.AWAKE, this.idleTime = 0, t !== s.AWAKE && this.emit(s.wakeUpEvent)
                }, s.prototype.sleep = function() {
                    this.sleepState = s.SLEEPING, this.angularVelocity = 0, this.angularForce = 0, n.set(this.velocity, 0, 0), n.set(this.force, 0, 0), this.emit(s.sleepEvent)
                }, s.prototype.sleepTick = function(t, e, i) {
                    this.allowSleep && this.type !== s.SLEEPING && (this.wantsToSleep = !1, this.sleepState, n.squaredLength(this.velocity) + Math.pow(this.angularVelocity, 2) >= Math.pow(this.sleepSpeedLimit, 2) ? (this.idleTime = 0, this.sleepState = s.AWAKE) : (this.idleTime += i, this.sleepState = s.SLEEPY), this.idleTime > this.sleepTimeLimit && (e ? this.wantsToSleep = !0 : this.sleep()))
                }, s.prototype.overlaps = function(t) {
                    return this.world.overlapKeeper.bodiesAreOverlapping(this, t)
                };
                var P = n.create(),
                    T = n.create();
                s.prototype.integrate = function(t) {
                    var e = this.invMass,
                        i = this.force,
                        s = this.position,
                        o = this.velocity;
                    n.copy(this.previousPosition, this.position), this.previousAngle = this.angle, this.fixedRotation || (this.angularVelocity += this.angularForce * this.invInertia * t), n.scale(P, i, t * e), n.multiply(P, this.massMultiplier, P), n.add(o, P, o), this.integrateToTimeOfImpact(t) || (n.scale(T, o, t), n.add(s, s, T), this.fixedRotation || (this.angle += this.angularVelocity * t)), this.aabbNeedsUpdate = !0
                };
                var C = new a,
                    S = new h({
                        mode: h.ALL
                    }),
                    A = n.create(),
                    E = n.create(),
                    k = n.create(),
                    M = n.create();
                s.prototype.integrateToTimeOfImpact = function(t) {
                    if (this.ccdSpeedThreshold < 0 || n.squaredLength(this.velocity) < Math.pow(this.ccdSpeedThreshold, 2)) return !1;
                    n.normalize(A, this.velocity), n.scale(E, this.velocity, t), n.add(E, E, this.position), n.sub(k, E, this.position);
                    var e, i = this.angularVelocity * t,
                        s = n.length(k),
                        o = 1,
                        r = this;
                    if (C.reset(), S.callback = function(t) {
                            t.body !== r && (e = t.body, t.getHitPoint(E, S), n.sub(k, E, r.position), o = n.length(k) / s, t.stop())
                        }, n.copy(S.from, this.position), n.copy(S.to, E), S.update(), this.world.raycast(C, S), !e) return !1;
                    var a = this.angle;
                    n.copy(M, this.position);
                    for (var h = 0, l = 0, c = 0, u = o; u >= l && h < this.ccdIterations;) h++, c = (u - l) / 2, n.scale(T, k, o), n.add(this.position, M, T), this.angle = a + i * o, this.updateAABB(), this.aabb.overlaps(e.aabb) && this.world.narrowphase.bodiesOverlap(this, e) ? l = c : u = c;
                    return o = c, n.copy(this.position, M), this.angle = a, n.scale(T, k, o), n.add(this.position, this.position, T), this.fixedRotation || (this.angle += i * o), !0
                }, s.prototype.getVelocityAtPoint = function(t, e) {
                    return n.crossVZ(t, e, this.angularVelocity), n.subtract(t, this.velocity, t), t
                }, s.sleepyEvent = {
                    type: "sleepy"
                }, s.sleepEvent = {
                    type: "sleep"
                }, s.wakeUpEvent = {
                    type: "wakeup"
                }, s.DYNAMIC = 1, s.STATIC = 2, s.KINEMATIC = 4, s.AWAKE = 0, s.SLEEPY = 1, s.SLEEPING = 2
            }, {
                "../collision/AABB": 7,
                "../collision/Ray": 11,
                "../collision/RaycastResult": 12,
                "../events/EventEmitter": 26,
                "../math/vec2": 30,
                "../shapes/Convex": 40,
                "poly-decomp": 5
            }],
            32: [function(t, e, i) {
                function s(t, e, i) {
                    i = i || {}, o.call(this, t, e, i), this.localAnchorA = n.fromValues(0, 0), this.localAnchorB = n.fromValues(0, 0), i.localAnchorA && n.copy(this.localAnchorA, i.localAnchorA), i.localAnchorB && n.copy(this.localAnchorB, i.localAnchorB), i.worldAnchorA && this.setWorldAnchorA(i.worldAnchorA), i.worldAnchorB && this.setWorldAnchorB(i.worldAnchorB);
                    var s = n.create(),
                        r = n.create();
                    this.getWorldAnchorA(s), this.getWorldAnchorB(r);
                    var a = n.distance(s, r);
                    this.restLength = "number" == typeof i.restLength ? i.restLength : a
                }
                var n = t("../math/vec2"),
                    o = t("./Spring");
                t("../utils/Utils"), e.exports = s, s.prototype = new o, s.prototype.constructor = s, s.prototype.setWorldAnchorA = function(t) {
                    this.bodyA.toLocalFrame(this.localAnchorA, t)
                }, s.prototype.setWorldAnchorB = function(t) {
                    this.bodyB.toLocalFrame(this.localAnchorB, t)
                }, s.prototype.getWorldAnchorA = function(t) {
                    this.bodyA.toWorldFrame(t, this.localAnchorA)
                }, s.prototype.getWorldAnchorB = function(t) {
                    this.bodyB.toWorldFrame(t, this.localAnchorB)
                };
                var r = n.create(),
                    a = n.create(),
                    h = n.create(),
                    l = n.create(),
                    c = n.create(),
                    u = n.create(),
                    d = n.create(),
                    p = n.create(),
                    f = n.create();
                s.prototype.applyForce = function() {
                    var t = this.stiffness,
                        e = this.damping,
                        i = this.restLength,
                        s = this.bodyA,
                        o = this.bodyB,
                        m = r,
                        g = a,
                        y = h,
                        v = l,
                        b = f,
                        _ = c,
                        w = u,
                        x = d,
                        P = p;
                    this.getWorldAnchorA(_), this.getWorldAnchorB(w), n.sub(x, _, s.position), n.sub(P, w, o.position), n.sub(m, w, _);
                    var T = n.len(m);
                    n.normalize(g, m), n.sub(y, o.velocity, s.velocity), n.crossZV(b, o.angularVelocity, P), n.add(y, y, b), n.crossZV(b, s.angularVelocity, x), n.sub(y, y, b), n.scale(v, g, -t * (T - i) - e * n.dot(y, g)), n.sub(s.force, s.force, v), n.add(o.force, o.force, v);
                    var C = n.crossLength(x, v),
                        S = n.crossLength(P, v);
                    s.angularForce -= C, o.angularForce += S
                }
            }, {
                "../math/vec2": 30,
                "../utils/Utils": 57,
                "./Spring": 34
            }],
            33: [function(t, e, i) {
                function s(t, e, i) {
                    i = i || {}, n.call(this, t, e, i), this.restAngle = "number" == typeof i.restAngle ? i.restAngle : e.angle - t.angle
                }
                var n = (t("../math/vec2"), t("./Spring"));
                e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.applyForce = function() {
                    var t = this.stiffness,
                        e = this.damping,
                        i = this.restAngle,
                        s = this.bodyA,
                        n = this.bodyB,
                        o = -t * (n.angle - s.angle - i) - e * (n.angularVelocity - s.angularVelocity) * 0;
                    s.angularForce -= o, n.angularForce += o
                }
            }, {
                "../math/vec2": 30,
                "./Spring": 34
            }],
            34: [function(t, e, i) {
                function s(t, e, i) {
                    i = n.defaults(i, {
                        stiffness: 100,
                        damping: 1
                    }), this.stiffness = i.stiffness, this.damping = i.damping, this.bodyA = t, this.bodyB = e
                }
                var n = (t("../math/vec2"), t("../utils/Utils"));
                e.exports = s, s.prototype.applyForce = function() {}
            }, {
                "../math/vec2": 30,
                "../utils/Utils": 57
            }],
            35: [function(t, e, i) {
                function s(t, e) {
                    e = e || {}, this.chassisBody = t, this.wheels = [], this.groundBody = new h({
                        mass: 0
                    }), this.world = null;
                    var i = this;
                    this.preStepCallback = function() {
                        i.update()
                    }
                }

                function n(t, e) {
                    e = e || {}, this.vehicle = t, this.forwardEquation = new a(t.chassisBody, t.groundBody), this.sideEquation = new a(t.chassisBody, t.groundBody), this.steerValue = 0, this.engineForce = 0, this.setSideFriction(void 0 !== e.sideFriction ? e.sideFriction : 5), this.localForwardVector = o.fromValues(0, 1), e.localForwardVector && o.copy(this.localForwardVector, e.localForwardVector), this.localPosition = o.fromValues(0, 0), e.localPosition && o.copy(this.localPosition, e.localPosition), r.apply(this, t.chassisBody, t.groundBody), this.equations.push(this.forwardEquation, this.sideEquation), this.setBrakeForce(0)
                }
                var o = t("../math/vec2"),
                    r = (t("../utils/Utils"), t("../constraints/Constraint")),
                    a = t("../equations/FrictionEquation"),
                    h = t("../objects/Body");
                e.exports = s, s.prototype.addToWorld = function(t) {
                    this.world = t, t.addBody(this.groundBody), t.on("preStep", this.preStepCallback);
                    for (var e = 0; e < this.wheels.length; e++) {
                        var i = this.wheels[e];
                        t.addConstraint(i)
                    }
                }, s.prototype.removeFromWorld = function() {
                    var t = this.world;
                    t.removeBody(this.groundBody), t.off("preStep", this.preStepCallback);
                    for (var e = 0; e < this.wheels.length; e++) {
                        var i = this.wheels[e];
                        t.removeConstraint(i)
                    }
                    this.world = null
                }, s.prototype.addWheel = function(t) {
                    var e = new n(this, t);
                    return this.wheels.push(e), e
                }, s.prototype.update = function() {
                    for (var t = 0; t < this.wheels.length; t++) this.wheels[t].update()
                }, n.prototype = new r, n.prototype.setBrakeForce = function(t) {
                    this.forwardEquation.setSlipForce(t)
                }, n.prototype.setSideFriction = function(t) {
                    this.sideEquation.setSlipForce(t)
                };
                var l = o.create(),
                    c = o.create();
                n.prototype.getSpeed = function() {
                    return this.vehicle.chassisBody.vectorToWorldFrame(c, this.localForwardVector), this.vehicle.chassisBody.getVelocityAtPoint(l, c), o.dot(l, c)
                };
                var u = o.create();
                n.prototype.update = function() {
                    this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t, this.localForwardVector), o.rotate(this.sideEquation.t, this.localForwardVector, Math.PI / 2), this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t, this.sideEquation.t), o.rotate(this.forwardEquation.t, this.forwardEquation.t, this.steerValue), o.rotate(this.sideEquation.t, this.sideEquation.t, this.steerValue), this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB, this.localPosition), o.copy(this.sideEquation.contactPointB, this.forwardEquation.contactPointB), this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA, this.localPosition), o.copy(this.sideEquation.contactPointA, this.forwardEquation.contactPointA), o.normalize(u, this.forwardEquation.t), o.scale(u, u, this.engineForce), this.vehicle.chassisBody.applyForce(u, this.forwardEquation.contactPointA)
                }
            }, {
                "../constraints/Constraint": 14,
                "../equations/FrictionEquation": 23,
                "../math/vec2": 30,
                "../objects/Body": 31,
                "../utils/Utils": 57
            }],
            36: [function(t, e, i) {
                var s = e.exports = {
                    AABB: t("./collision/AABB"),
                    AngleLockEquation: t("./equations/AngleLockEquation"),
                    Body: t("./objects/Body"),
                    Broadphase: t("./collision/Broadphase"),
                    Capsule: t("./shapes/Capsule"),
                    Circle: t("./shapes/Circle"),
                    Constraint: t("./constraints/Constraint"),
                    ContactEquation: t("./equations/ContactEquation"),
                    ContactEquationPool: t("./utils/ContactEquationPool"),
                    ContactMaterial: t("./material/ContactMaterial"),
                    Convex: t("./shapes/Convex"),
                    DistanceConstraint: t("./constraints/DistanceConstraint"),
                    Equation: t("./equations/Equation"),
                    EventEmitter: t("./events/EventEmitter"),
                    FrictionEquation: t("./equations/FrictionEquation"),
                    FrictionEquationPool: t("./utils/FrictionEquationPool"),
                    GearConstraint: t("./constraints/GearConstraint"),
                    GSSolver: t("./solver/GSSolver"),
                    Heightfield: t("./shapes/Heightfield"),
                    Line: t("./shapes/Line"),
                    LockConstraint: t("./constraints/LockConstraint"),
                    Material: t("./material/Material"),
                    Narrowphase: t("./collision/Narrowphase"),
                    NaiveBroadphase: t("./collision/NaiveBroadphase"),
                    Particle: t("./shapes/Particle"),
                    Plane: t("./shapes/Plane"),
                    Pool: t("./utils/Pool"),
                    RevoluteConstraint: t("./constraints/RevoluteConstraint"),
                    PrismaticConstraint: t("./constraints/PrismaticConstraint"),
                    Ray: t("./collision/Ray"),
                    RaycastResult: t("./collision/RaycastResult"),
                    Box: t("./shapes/Box"),
                    RotationalVelocityEquation: t("./equations/RotationalVelocityEquation"),
                    SAPBroadphase: t("./collision/SAPBroadphase"),
                    Shape: t("./shapes/Shape"),
                    Solver: t("./solver/Solver"),
                    Spring: t("./objects/Spring"),
                    TopDownVehicle: t("./objects/TopDownVehicle"),
                    LinearSpring: t("./objects/LinearSpring"),
                    RotationalSpring: t("./objects/RotationalSpring"),
                    Utils: t("./utils/Utils"),
                    World: t("./world/World"),
                    vec2: t("./math/vec2"),
                    version: t("../package.json").version
                };
                Object.defineProperty(s, "Rectangle", {
                    get: function() {
                        return console.warn("The Rectangle class has been renamed to Box."), this.Box
                    }
                })
            }, {
                "../package.json": 6,
                "./collision/AABB": 7,
                "./collision/Broadphase": 8,
                "./collision/NaiveBroadphase": 9,
                "./collision/Narrowphase": 10,
                "./collision/Ray": 11,
                "./collision/RaycastResult": 12,
                "./collision/SAPBroadphase": 13,
                "./constraints/Constraint": 14,
                "./constraints/DistanceConstraint": 15,
                "./constraints/GearConstraint": 16,
                "./constraints/LockConstraint": 17,
                "./constraints/PrismaticConstraint": 18,
                "./constraints/RevoluteConstraint": 19,
                "./equations/AngleLockEquation": 20,
                "./equations/ContactEquation": 21,
                "./equations/Equation": 22,
                "./equations/FrictionEquation": 23,
                "./equations/RotationalVelocityEquation": 25,
                "./events/EventEmitter": 26,
                "./material/ContactMaterial": 27,
                "./material/Material": 28,
                "./math/vec2": 30,
                "./objects/Body": 31,
                "./objects/LinearSpring": 32,
                "./objects/RotationalSpring": 33,
                "./objects/Spring": 34,
                "./objects/TopDownVehicle": 35,
                "./shapes/Box": 37,
                "./shapes/Capsule": 38,
                "./shapes/Circle": 39,
                "./shapes/Convex": 40,
                "./shapes/Heightfield": 41,
                "./shapes/Line": 42,
                "./shapes/Particle": 43,
                "./shapes/Plane": 44,
                "./shapes/Shape": 45,
                "./solver/GSSolver": 46,
                "./solver/Solver": 47,
                "./utils/ContactEquationPool": 48,
                "./utils/FrictionEquationPool": 49,
                "./utils/Pool": 55,
                "./utils/Utils": 57,
                "./world/World": 61
            }],
            37: [function(t, e, i) {
                function s(t) {
                    "number" == typeof arguments[0] && "number" == typeof arguments[1] && (t = {
                        width: arguments[0],
                        height: arguments[1]
                    }, console.warn("The Rectangle has been renamed to Box and its constructor signature has changed. Please use the following format: new Box({ width: 1, height: 1, ... })")), t = t || {};
                    var e = this.width = t.width || 1,
                        i = this.height = t.height || 1,
                        s = [n.fromValues(-e / 2, -i / 2), n.fromValues(e / 2, -i / 2), n.fromValues(e / 2, i / 2), n.fromValues(-e / 2, i / 2)],
                        a = [n.fromValues(1, 0), n.fromValues(0, 1)];
                    t.vertices = s, t.axes = a, t.type = o.BOX, r.call(this, t)
                }
                var n = t("../math/vec2"),
                    o = t("./Shape"),
                    r = t("./Convex");
                e.exports = s, s.prototype = new r, s.prototype.constructor = s, s.prototype.computeMomentOfInertia = function(t) {
                    var e = this.width,
                        i = this.height;
                    return t * (i * i + e * e) / 12
                }, s.prototype.updateBoundingRadius = function() {
                    var t = this.width,
                        e = this.height;
                    this.boundingRadius = Math.sqrt(t * t + e * e) / 2
                }, n.create(), n.create(), n.create(), n.create(), s.prototype.computeAABB = function(t, e, i) {
                    t.setFromPoints(this.vertices, e, i, 0)
                }, s.prototype.updateArea = function() {
                    this.area = this.width * this.height
                }
            }, {
                "../math/vec2": 30,
                "./Convex": 40,
                "./Shape": 45
            }],
            38: [function(t, e, i) {
                function s(t) {
                    "number" == typeof arguments[0] && "number" == typeof arguments[1] && (t = {
                        length: arguments[0],
                        radius: arguments[1]
                    }, console.warn("The Capsule constructor signature has changed. Please use the following format: new Capsule({ radius: 1, length: 1 })")), t = t || {}, this.length = t.length || 1, this.radius = t.radius || 1, t.type = n.CAPSULE, n.call(this, t)
                }
                var n = t("./Shape"),
                    o = t("../math/vec2");
                e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.computeMomentOfInertia = function(t) {
                    var e = this.radius,
                        i = this.length + e,
                        s = 2 * e;
                    return t * (s * s + i * i) / 12
                }, s.prototype.updateBoundingRadius = function() {
                    this.boundingRadius = this.radius + this.length / 2
                }, s.prototype.updateArea = function() {
                    this.area = Math.PI * this.radius * this.radius + 2 * this.radius * this.length
                };
                var r = o.create();
                s.prototype.computeAABB = function(t, e, i) {
                    var s = this.radius;
                    o.set(r, this.length / 2, 0), 0 !== i && o.rotate(r, r, i), o.set(t.upperBound, Math.max(r[0] + s, -r[0] + s), Math.max(r[1] + s, -r[1] + s)), o.set(t.lowerBound, Math.min(r[0] - s, -r[0] - s), Math.min(r[1] - s, -r[1] - s)), o.add(t.lowerBound, t.lowerBound, e), o.add(t.upperBound, t.upperBound, e)
                };
                var a = o.create(),
                    h = o.create(),
                    l = o.create(),
                    c = o.create(),
                    u = o.fromValues(0, 1);
                s.prototype.raycast = function(t, e, i, s) {
                    for (var n = e.from, r = e.to, d = (e.direction, a), p = h, f = l, m = c, g = this.length / 2, y = 0; y < 2; y++) {
                        var v = this.radius * (2 * y - 1);
                        if (o.set(f, -g, v), o.set(m, g, v), o.toGlobalFrame(f, f, i, s), o.toGlobalFrame(m, m, i, s), (_ = o.getLineSegmentsIntersectionFraction(n, r, f, m)) >= 0 && (o.rotate(p, u, s), o.scale(p, p, 2 * y - 1), e.reportIntersection(t, _, p, -1), t.shouldStop(e))) return
                    }
                    var b = Math.pow(this.radius, 2) + Math.pow(g, 2);
                    for (y = 0; y < 2; y++) {
                        o.set(f, g * (2 * y - 1), 0), o.toGlobalFrame(f, f, i, s);
                        var _, w = Math.pow(r[0] - n[0], 2) + Math.pow(r[1] - n[1], 2),
                            x = 2 * ((r[0] - n[0]) * (n[0] - f[0]) + (r[1] - n[1]) * (n[1] - f[1])),
                            P = Math.pow(n[0] - f[0], 2) + Math.pow(n[1] - f[1], 2) - Math.pow(this.radius, 2);
                        if (!((_ = Math.pow(x, 2) - 4 * w * P) < 0))
                            if (0 === _) {
                                if (o.lerp(d, n, r, _), o.squaredDistance(d, i) > b && (o.sub(p, d, f), o.normalize(p, p), e.reportIntersection(t, _, p, -1), t.shouldStop(e))) return
                            } else {
                                var T = Math.sqrt(_),
                                    C = 1 / (2 * w),
                                    S = (-x - T) * C,
                                    A = (-x + T) * C;
                                if (S >= 0 && S <= 1 && (o.lerp(d, n, r, S), o.squaredDistance(d, i) > b && (o.sub(p, d, f), o.normalize(p, p), e.reportIntersection(t, S, p, -1), t.shouldStop(e)))) return;
                                if (A >= 0 && A <= 1 && (o.lerp(d, n, r, A), o.squaredDistance(d, i) > b && (o.sub(p, d, f), o.normalize(p, p), e.reportIntersection(t, A, p, -1), t.shouldStop(e)))) return
                            }
                    }
                }
            }, {
                "../math/vec2": 30,
                "./Shape": 45
            }],
            39: [function(t, e, i) {
                function s(t) {
                    "number" == typeof arguments[0] && (t = {
                        radius: arguments[0]
                    }, console.warn("The Circle constructor signature has changed. Please use the following format: new Circle({ radius: 1 })")), t = t || {}, this.radius = t.radius || 1, t.type = n.CIRCLE, n.call(this, t)
                }
                var n = t("./Shape"),
                    o = t("../math/vec2");
                e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.computeMomentOfInertia = function(t) {
                    var e = this.radius;
                    return t * e * e / 2
                }, s.prototype.updateBoundingRadius = function() {
                    this.boundingRadius = this.radius
                }, s.prototype.updateArea = function() {
                    this.area = Math.PI * this.radius * this.radius
                }, s.prototype.computeAABB = function(t, e, i) {
                    var s = this.radius;
                    o.set(t.upperBound, s, s), o.set(t.lowerBound, -s, -s), e && (o.add(t.lowerBound, t.lowerBound, e), o.add(t.upperBound, t.upperBound, e))
                };
                var r = o.create(),
                    a = o.create();
                s.prototype.raycast = function(t, e, i, s) {
                    var n = e.from,
                        h = e.to,
                        l = this.radius,
                        c = Math.pow(h[0] - n[0], 2) + Math.pow(h[1] - n[1], 2),
                        u = 2 * ((h[0] - n[0]) * (n[0] - i[0]) + (h[1] - n[1]) * (n[1] - i[1])),
                        d = Math.pow(n[0] - i[0], 2) + Math.pow(n[1] - i[1], 2) - Math.pow(l, 2),
                        p = Math.pow(u, 2) - 4 * c * d,
                        f = r,
                        m = a;
                    if (!(p < 0))
                        if (0 === p) o.lerp(f, n, h, p), o.sub(m, f, i), o.normalize(m, m), e.reportIntersection(t, p, m, -1);
                        else {
                            var g = Math.sqrt(p),
                                y = 1 / (2 * c),
                                v = (-u - g) * y,
                                b = (-u + g) * y;
                            if (v >= 0 && v <= 1 && (o.lerp(f, n, h, v), o.sub(m, f, i), o.normalize(m, m), e.reportIntersection(t, v, m, -1), t.shouldStop(e))) return;
                            b >= 0 && b <= 1 && (o.lerp(f, n, h, b), o.sub(m, f, i), o.normalize(m, m), e.reportIntersection(t, b, m, -1))
                        }
                }
            }, {
                "../math/vec2": 30,
                "./Shape": 45
            }],
            40: [function(t, e, i) {
                function s(t) {
                    Array.isArray(arguments[0]) && (t = {
                        vertices: arguments[0],
                        axes: arguments[1]
                    }, console.warn("The Convex constructor signature has changed. Please use the following format: new Convex({ vertices: [...], ... })")), t = t || {}, this.vertices = [];
                    for (var e = void 0 !== t.vertices ? t.vertices : [], i = 0; i < e.length; i++) {
                        var s = o.create();
                        o.copy(s, e[i]), this.vertices.push(s)
                    }
                    if (this.axes = [], t.axes)
                        for (i = 0; i < t.axes.length; i++) {
                            var r = o.create();
                            o.copy(r, t.axes[i]), this.axes.push(r)
                        } else
                            for (i = 0; i < this.vertices.length; i++) {
                                var a = this.vertices[i],
                                    h = this.vertices[(i + 1) % this.vertices.length],
                                    l = o.create();
                                o.sub(l, h, a), o.rotate90cw(l, l), o.normalize(l, l), this.axes.push(l)
                            }
                    if (this.centerOfMass = o.fromValues(0, 0), this.triangles = [], this.vertices.length && (this.updateTriangles(), this.updateCenterOfMass()), this.boundingRadius = 0, t.type = n.CONVEX, n.call(this, t), this.updateBoundingRadius(), this.updateArea(), this.area < 0) throw new Error("Convex vertices must be given in conter-clockwise winding.")
                }
                var n = t("./Shape"),
                    o = t("../math/vec2"),
                    r = t("../math/polyk");
                t("poly-decomp"), e.exports = s, s.prototype = new n, s.prototype.constructor = s;
                var a = o.create(),
                    h = o.create();
                s.prototype.projectOntoLocalAxis = function(t, e) {
                    for (var i, s, n = null, r = null, h = (t = a, 0); h < this.vertices.length; h++) i = this.vertices[h], s = o.dot(i, t), (null === n || s > n) && (n = s), (null === r || s < r) && (r = s);
                    if (r > n) {
                        var l = r;
                        r = n, n = l
                    }
                    o.set(e, r, n)
                }, s.prototype.projectOntoWorldAxis = function(t, e, i, s) {
                    var n = h;
                    this.projectOntoLocalAxis(t, s), 0 !== i ? o.rotate(n, t, i) : n = t;
                    var r = o.dot(e, n);
                    o.set(s, s[0] + r, s[1] + r)
                }, s.prototype.updateTriangles = function() {
                    this.triangles.length = 0;
                    for (var t = [], e = 0; e < this.vertices.length; e++) {
                        var i = this.vertices[e];
                        t.push(i[0], i[1])
                    }
                    var s = r.Triangulate(t);
                    for (e = 0; e < s.length; e += 3) {
                        var n = s[e],
                            o = s[e + 1],
                            a = s[e + 2];
                        this.triangles.push([n, o, a])
                    }
                };
                var l = o.create(),
                    c = o.create(),
                    u = o.create(),
                    d = o.create(),
                    p = o.create();
                o.create(), o.create(), o.create(), o.create(), s.prototype.updateCenterOfMass = function() {
                    var t = this.triangles,
                        e = this.vertices,
                        i = this.centerOfMass,
                        n = l,
                        r = u,
                        a = d,
                        h = p,
                        f = c;
                    o.set(i, 0, 0);
                    for (var m = 0, g = 0; g !== t.length; g++) {
                        var y = t[g];
                        r = e[y[0]], a = e[y[1]], h = e[y[2]];
                        o.centroid(n, r, a, h);
                        var v = s.triangleArea(r, a, h);
                        m += v, o.scale(f, n, v), o.add(i, i, f)
                    }
                    o.scale(i, i, 1 / m)
                }, s.prototype.computeMomentOfInertia = function(t) {
                    for (var e = 0, i = 0, s = this.vertices.length, n = s - 1, r = 0; r < s; n = r, r++) {
                        var a = this.vertices[n],
                            h = this.vertices[r],
                            l = Math.abs(o.crossLength(a, h));
                        e += l * (o.dot(h, h) + o.dot(h, a) + o.dot(a, a)), i += l
                    }
                    return t / 6 * (e / i)
                }, s.prototype.updateBoundingRadius = function() {
                    for (var t = this.vertices, e = 0, i = 0; i !== t.length; i++) {
                        var s = o.squaredLength(t[i]);
                        s > e && (e = s)
                    }
                    this.boundingRadius = Math.sqrt(e)
                }, s.triangleArea = function(t, e, i) {
                    return .5 * ((e[0] - t[0]) * (i[1] - t[1]) - (i[0] - t[0]) * (e[1] - t[1]))
                }, s.prototype.updateArea = function() {
                    this.updateTriangles(), this.area = 0;
                    for (var t = this.triangles, e = this.vertices, i = 0; i !== t.length; i++) {
                        var n = t[i],
                            o = e[n[0]],
                            r = e[n[1]],
                            a = e[n[2]],
                            h = s.triangleArea(o, r, a);
                        this.area += h
                    }
                }, s.prototype.computeAABB = function(t, e, i) {
                    t.setFromPoints(this.vertices, e, i, 0)
                };
                var f = o.create(),
                    m = o.create(),
                    g = o.create();
                s.prototype.raycast = function(t, e, i, s) {
                    var n = f,
                        r = m,
                        a = g,
                        h = this.vertices;
                    o.toLocalFrame(n, e.from, i, s), o.toLocalFrame(r, e.to, i, s);
                    for (var l = h.length, c = 0; c < l && !t.shouldStop(e); c++) {
                        var u = h[c],
                            d = h[(c + 1) % l],
                            p = o.getLineSegmentsIntersectionFraction(n, r, u, d);
                        p >= 0 && (o.sub(a, d, u), o.rotate(a, a, -Math.PI / 2 + s), o.normalize(a, a), e.reportIntersection(t, p, a, c))
                    }
                }
            }, {
                "../math/polyk": 29,
                "../math/vec2": 30,
                "./Shape": 45,
                "poly-decomp": 5
            }],
            41: [function(t, e, i) {
                function s(t) {
                    if (Array.isArray(arguments[0])) {
                        if (t = {
                                heights: arguments[0]
                            }, "object" == typeof arguments[1])
                            for (var e in arguments[1]) t[e] = arguments[1][e];
                        console.warn("The Heightfield constructor signature has changed. Please use the following format: new Heightfield({ heights: [...], ... })")
                    }
                    t = t || {}, this.heights = t.heights ? t.heights.slice(0) : [], this.maxValue = t.maxValue || null, this.minValue = t.minValue || null, this.elementWidth = t.elementWidth || .1, void 0 !== t.maxValue && void 0 !== t.minValue || this.updateMaxMinValues(), t.type = n.HEIGHTFIELD, n.call(this, t)
                }
                var n = t("./Shape"),
                    o = t("../math/vec2");
                t("../utils/Utils"), e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.updateMaxMinValues = function() {
                    for (var t = this.heights, e = t[0], i = t[0], s = 0; s !== t.length; s++) {
                        var n = t[s];
                        n > e && (e = n), n < i && (i = n)
                    }
                    this.maxValue = e, this.minValue = i
                }, s.prototype.computeMomentOfInertia = function(t) {
                    return Number.MAX_VALUE
                }, s.prototype.updateBoundingRadius = function() {
                    this.boundingRadius = Number.MAX_VALUE
                }, s.prototype.updateArea = function() {
                    for (var t = this.heights, e = 0, i = 0; i < t.length - 1; i++) e += (t[i] + t[i + 1]) / 2 * this.elementWidth;
                    this.area = e
                };
                var r = [o.create(), o.create(), o.create(), o.create()];
                s.prototype.computeAABB = function(t, e, i) {
                    o.set(r[0], 0, this.maxValue), o.set(r[1], this.elementWidth * this.heights.length, this.maxValue), o.set(r[2], this.elementWidth * this.heights.length, this.minValue), o.set(r[3], 0, this.minValue), t.setFromPoints(r, e, i)
                }, s.prototype.getLineSegment = function(t, e, i) {
                    var s = this.heights,
                        n = this.elementWidth;
                    o.set(t, i * n, s[i]), o.set(e, (i + 1) * n, s[i + 1])
                }, s.prototype.getSegmentIndex = function(t) {
                    return Math.floor(t[0] / this.elementWidth)
                }, s.prototype.getClampedSegmentIndex = function(t) {
                    var e = this.getSegmentIndex(t);
                    return Math.min(this.heights.length, Math.max(e, 0))
                };
                var a = (o.create(), o.create()),
                    h = o.create(),
                    l = o.create(),
                    c = o.create(),
                    u = o.create();
                o.fromValues(0, 1), s.prototype.raycast = function(t, e, i, s) {
                    var n = e.from,
                        r = e.to,
                        d = (e.direction, a),
                        p = h,
                        f = l,
                        m = c,
                        g = u;
                    o.toLocalFrame(m, n, i, s), o.toLocalFrame(g, r, i, s);
                    var y = this.getClampedSegmentIndex(m),
                        v = this.getClampedSegmentIndex(g);
                    if (y > v) {
                        var b = y;
                        y = v, v = b
                    }
                    for (var _ = 0; _ < this.heights.length - 1; _++) {
                        this.getLineSegment(p, f, _);
                        var w = o.getLineSegmentsIntersectionFraction(m, g, p, f);
                        if (w >= 0 && (o.sub(d, f, p), o.rotate(d, d, s + Math.PI / 2), o.normalize(d, d), e.reportIntersection(t, w, d, -1), t.shouldStop(e))) return
                    }
                }
            }, {
                "../math/vec2": 30,
                "../utils/Utils": 57,
                "./Shape": 45
            }],
            42: [function(t, e, i) {
                function s(t) {
                    "number" == typeof arguments[0] && (t = {
                        length: arguments[0]
                    }, console.warn("The Line constructor signature has changed. Please use the following format: new Line({ length: 1, ... })")), t = t || {}, this.length = t.length || 1, t.type = n.LINE, n.call(this, t)
                }
                var n = t("./Shape"),
                    o = t("../math/vec2");
                e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.computeMomentOfInertia = function(t) {
                    return t * Math.pow(this.length, 2) / 12
                }, s.prototype.updateBoundingRadius = function() {
                    this.boundingRadius = this.length / 2
                };
                var r = [o.create(), o.create()];
                s.prototype.computeAABB = function(t, e, i) {
                    var s = this.length / 2;
                    o.set(r[0], -s, 0), o.set(r[1], s, 0), t.setFromPoints(r, e, i, 0)
                };
                var a = (o.create(), o.create()),
                    h = o.create(),
                    l = o.create(),
                    c = o.fromValues(0, 1);
                s.prototype.raycast = function(t, e, i, s) {
                    var n = e.from,
                        r = e.to,
                        u = h,
                        d = l,
                        p = this.length / 2;
                    o.set(u, -p, 0), o.set(d, p, 0), o.toGlobalFrame(u, u, i, s), o.toGlobalFrame(d, d, i, s);
                    var f = o.getLineSegmentsIntersectionFraction(u, d, n, r);
                    if (f >= 0) {
                        var m = a;
                        o.rotate(m, c, s), e.reportIntersection(t, f, m, -1)
                    }
                }
            }, {
                "../math/vec2": 30,
                "./Shape": 45
            }],
            43: [function(t, e, i) {
                function s(t) {
                    (t = t || {}).type = n.PARTICLE, n.call(this, t)
                }
                var n = t("./Shape"),
                    o = t("../math/vec2");
                e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.computeMomentOfInertia = function(t) {
                    return 0
                }, s.prototype.updateBoundingRadius = function() {
                    this.boundingRadius = 0
                }, s.prototype.computeAABB = function(t, e, i) {
                    o.copy(t.lowerBound, e), o.copy(t.upperBound, e)
                }
            }, {
                "../math/vec2": 30,
                "./Shape": 45
            }],
            44: [function(t, e, i) {
                function s(t) {
                    (t = t || {}).type = n.PLANE, n.call(this, t)
                }
                var n = t("./Shape"),
                    o = t("../math/vec2");
                t("../utils/Utils"), e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.computeMomentOfInertia = function(t) {
                    return 0
                }, s.prototype.updateBoundingRadius = function() {
                    this.boundingRadius = Number.MAX_VALUE
                }, s.prototype.computeAABB = function(t, e, i) {
                    var s = i % (2 * Math.PI),
                        n = o.set,
                        r = 1e7,
                        a = t.lowerBound,
                        h = t.upperBound;
                    n(a, -r, -r), n(h, r, r), 0 === s ? h[1] = 0 : s === Math.PI / 2 ? a[0] = 0 : s === Math.PI ? a[1] = 0 : s === 3 * Math.PI / 2 && (h[0] = 0)
                }, s.prototype.updateArea = function() {
                    this.area = Number.MAX_VALUE
                };
                var r = o.create(),
                    a = (o.create(), o.create(), o.create()),
                    h = o.create();
                s.prototype.raycast = function(t, e, i, s) {
                    var n = e.from,
                        l = e.to,
                        c = e.direction,
                        u = r,
                        d = a,
                        p = h;
                    o.set(d, 0, 1), o.rotate(d, d, s), o.sub(p, n, i);
                    var f = o.dot(p, d);
                    if (o.sub(p, l, i), !(f * o.dot(p, d) > 0 || o.squaredDistance(n, l) < f * f)) {
                        var m = o.dot(d, c);
                        o.sub(u, n, i);
                        var g = -o.dot(d, u) / m / e.length;
                        e.reportIntersection(t, g, d, -1)
                    }
                }
            }, {
                "../math/vec2": 30,
                "../utils/Utils": 57,
                "./Shape": 45
            }],
            45: [function(t, e, i) {
                function s(t) {
                    t = t || {}, this.body = null, this.position = n.fromValues(0, 0), t.position && n.copy(this.position, t.position), this.angle = t.angle || 0, this.type = t.type || 0, this.id = s.idCounter++, this.boundingRadius = 0, this.collisionGroup = void 0 !== t.collisionGroup ? t.collisionGroup : 1, this.collisionResponse = void 0 === t.collisionResponse || t.collisionResponse, this.collisionMask = void 0 !== t.collisionMask ? t.collisionMask : 1, this.material = t.material || null, this.area = 0, this.sensor = void 0 !== t.sensor && t.sensor, this.type && this.updateBoundingRadius(), this.updateArea()
                }
                e.exports = s;
                var n = t("../math/vec2");
                s.idCounter = 0, s.CIRCLE = 1, s.PARTICLE = 2, s.PLANE = 4, s.CONVEX = 8, s.LINE = 16, s.BOX = 32, Object.defineProperty(s, "RECTANGLE", {
                    get: function() {
                        return console.warn("Shape.RECTANGLE is deprecated, use Shape.BOX instead."), s.BOX
                    }
                }), s.CAPSULE = 64, s.HEIGHTFIELD = 128, s.prototype.computeMomentOfInertia = function(t) {}, s.prototype.updateBoundingRadius = function() {}, s.prototype.updateArea = function() {}, s.prototype.computeAABB = function(t, e, i) {}, s.prototype.raycast = function(t, e, i, s) {}
            }, {
                "../math/vec2": 30
            }],
            46: [function(t, e, i) {
                function s(t) {
                    o.call(this, t, o.GS), t = t || {}, this.iterations = t.iterations || 10, this.tolerance = t.tolerance || 1e-7, this.arrayStep = 30, this.lambda = new r.ARRAY_TYPE(this.arrayStep), this.Bs = new r.ARRAY_TYPE(this.arrayStep), this.invCs = new r.ARRAY_TYPE(this.arrayStep), this.useZeroRHS = !1, this.frictionIterations = void 0 !== t.frictionIterations ? 0 : t.frictionIterations, this.usedIterations = 0
                }
                var n = t("../math/vec2"),
                    o = t("./Solver"),
                    r = t("../utils/Utils"),
                    a = t("../equations/FrictionEquation");
                e.exports = s, s.prototype = new o, s.prototype.constructor = s, s.prototype.solve = function(t, e) {
                    this.sortEquations();
                    var i, o, h = 0,
                        l = this.iterations,
                        c = this.frictionIterations,
                        u = this.equations,
                        d = u.length,
                        p = Math.pow(this.tolerance * d, 2),
                        f = e.bodies,
                        m = e.bodies.length,
                        g = (n.add, n.set, this.useZeroRHS),
                        y = this.lambda;
                    if (this.usedIterations = 0, d)
                        for (var v = 0; v !== m; v++) {
                            f[v].updateSolveMassProperties()
                        }
                    y.length < d && (y = this.lambda = new r.ARRAY_TYPE(d + this.arrayStep), this.Bs = new r.ARRAY_TYPE(d + this.arrayStep), this.invCs = new r.ARRAY_TYPE(d + this.arrayStep)),
                        function(t) {
                            for (var e = t.length; e--;) t[e] = 0
                        }(y);
                    for (var b = this.invCs, _ = this.Bs, v = (y = this.lambda, 0); v !== u.length; v++) {
                        var w;
                        ((w = u[v]).timeStep !== t || w.needsUpdate) && (w.timeStep = t, w.update()), _[v] = w.computeB(w.a, w.b, t), b[v] = w.computeInvC(w.epsilon)
                    }
                    if (0 !== d) {
                        for (v = 0; v !== m; v++) {
                            f[v].resetConstraintVelocity()
                        }
                        if (c) {
                            for (h = 0; h !== c; h++) {
                                for (i = 0, o = 0; o !== d; o++) {
                                    w = u[o];
                                    var x = s.iterateEquation(o, w, w.epsilon, _, b, y, g, t, h);
                                    i += Math.abs(x)
                                }
                                if (this.usedIterations++, i * i <= p) break
                            }
                            for (s.updateMultipliers(u, y, 1 / t), o = 0; o !== d; o++) {
                                var P = u[o];
                                if (P instanceof a) {
                                    for (var T = 0, C = 0; C !== P.contactEquations.length; C++) T += P.contactEquations[C].multiplier;
                                    T *= P.frictionCoefficient / P.contactEquations.length, P.maxForce = T, P.minForce = -T
                                }
                            }
                        }
                        for (h = 0; h !== l; h++) {
                            for (i = 0, o = 0; o !== d; o++) {
                                w = u[o];
                                x = s.iterateEquation(o, w, w.epsilon, _, b, y, g, t, h);
                                i += Math.abs(x)
                            }
                            if (this.usedIterations++, i * i <= p) break
                        }
                        for (v = 0; v !== m; v++) f[v].addConstraintVelocity();
                        s.updateMultipliers(u, y, 1 / t)
                    }
                }, s.updateMultipliers = function(t, e, i) {
                    for (var s = t.length; s--;) t[s].multiplier = e[s] * i
                }, s.iterateEquation = function(t, e, i, s, n, o, r, a, h) {
                    var l = s[t],
                        c = n[t],
                        u = o[t],
                        d = e.computeGWlambda(),
                        p = e.maxForce,
                        f = e.minForce;
                    r && (l = 0);
                    var m = c * (l - d - i * u),
                        g = u + m;
                    return g < f * a ? m = f * a - u : g > p * a && (m = p * a - u), o[t] += m, e.addToWlambda(m), m
                }
            }, {
                "../equations/FrictionEquation": 23,
                "../math/vec2": 30,
                "../utils/Utils": 57,
                "./Solver": 47
            }],
            47: [function(t, e, i) {
                function s(t, e) {
                    t = t || {}, n.call(this), this.type = e, this.equations = [], this.equationSortFunction = t.equationSortFunction || !1
                }
                var n = (t("../utils/Utils"), t("../events/EventEmitter"));
                e.exports = s, s.prototype = new n, s.prototype.constructor = s, s.prototype.solve = function(t, e) {
                    throw new Error("Solver.solve should be implemented by subclasses!")
                };
                var o = {
                    bodies: []
                };
                s.prototype.solveIsland = function(t, e) {
                    this.removeAllEquations(), e.equations.length && (this.addEquations(e.equations), o.bodies.length = 0, e.getBodies(o.bodies), o.bodies.length && this.solve(t, o))
                }, s.prototype.sortEquations = function() {
                    this.equationSortFunction && this.equations.sort(this.equationSortFunction)
                }, s.prototype.addEquation = function(t) {
                    t.enabled && this.equations.push(t)
                }, s.prototype.addEquations = function(t) {
                    for (var e = 0, i = t.length; e !== i; e++) {
                        var s = t[e];
                        s.enabled && this.equations.push(s)
                    }
                }, s.prototype.removeEquation = function(t) {
                    var e = this.equations.indexOf(t); - 1 !== e && this.equations.splice(e, 1)
                }, s.prototype.removeAllEquations = function() {
                    this.equations.length = 0
                }, s.GS = 1, s.ISLAND = 2
            }, {
                "../events/EventEmitter": 26,
                "../utils/Utils": 57
            }],
            48: [function(t, e, i) {
                function s() {
                    o.apply(this, arguments)
                }
                var n = t("../equations/ContactEquation"),
                    o = t("./Pool");
                e.exports = s, s.prototype = new o, s.prototype.constructor = s, s.prototype.create = function() {
                    return new n
                }, s.prototype.destroy = function(t) {
                    return t.bodyA = t.bodyB = null, this
                }
            }, {
                "../equations/ContactEquation": 21,
                "./Pool": 55
            }],
            49: [function(t, e, i) {
                function s() {
                    o.apply(this, arguments)
                }
                var n = t("../equations/FrictionEquation"),
                    o = t("./Pool");
                e.exports = s, s.prototype = new o, s.prototype.constructor = s, s.prototype.create = function() {
                    return new n
                }, s.prototype.destroy = function(t) {
                    return t.bodyA = t.bodyB = null, this
                }
            }, {
                "../equations/FrictionEquation": 23,
                "./Pool": 55
            }],
            50: [function(t, e, i) {
                function s() {
                    o.apply(this, arguments)
                }
                var n = t("../world/IslandNode"),
                    o = t("./Pool");
                e.exports = s, s.prototype = new o, s.prototype.constructor = s, s.prototype.create = function() {
                    return new n
                }, s.prototype.destroy = function(t) {
                    return t.reset(), this
                }
            }, {
                "../world/IslandNode": 60,
                "./Pool": 55
            }],
            51: [function(t, e, i) {
                function s() {
                    o.apply(this, arguments)
                }
                var n = t("../world/Island"),
                    o = t("./Pool");
                e.exports = s, s.prototype = new o, s.prototype.constructor = s, s.prototype.create = function() {
                    return new n
                }, s.prototype.destroy = function(t) {
                    return t.reset(), this
                }
            }, {
                "../world/Island": 58,
                "./Pool": 55
            }],
            52: [function(t, e, i) {
                function s() {
                    this.overlappingShapesLastState = new n, this.overlappingShapesCurrentState = new n, this.recordPool = new o({
                        size: 16
                    }), this.tmpDict = new n, this.tmpArray1 = []
                }
                var n = t("./TupleDictionary"),
                    o = (t("./OverlapKeeperRecord"), t("./OverlapKeeperRecordPool"));
                t("./Utils"), e.exports = s, s.prototype.tick = function() {
                    for (var t = this.overlappingShapesLastState, e = this.overlappingShapesCurrentState, i = t.keys.length; i--;) {
                        var s = t.keys[i],
                            n = t.getByKey(s);
                        e.getByKey(s), n && this.recordPool.release(n)
                    }
                    t.reset(), t.copy(e), e.reset()
                }, s.prototype.setOverlapping = function(t, e, i, s) {
                    var n = (this.overlappingShapesLastState, this.overlappingShapesCurrentState);
                    if (!n.get(e.id, s.id)) {
                        var o = this.recordPool.get();
                        o.set(t, e, i, s), n.set(e.id, s.id, o)
                    }
                }, s.prototype.getNewOverlaps = function(t) {
                    return this.getDiff(this.overlappingShapesLastState, this.overlappingShapesCurrentState, t)
                }, s.prototype.getEndOverlaps = function(t) {
                    return this.getDiff(this.overlappingShapesCurrentState, this.overlappingShapesLastState, t)
                }, s.prototype.bodiesAreOverlapping = function(t, e) {
                    for (var i = this.overlappingShapesCurrentState, s = i.keys.length; s--;) {
                        var n = i.keys[s],
                            o = i.data[n];
                        if (o.bodyA === t && o.bodyB === e || o.bodyA === e && o.bodyB === t) return !0
                    }
                    return !1
                }, s.prototype.getDiff = function(t, e, i) {
                    var s = t,
                        n = e;
                    (i = i || []).length = 0;
                    for (var o = n.keys.length; o--;) {
                        var r = n.keys[o],
                            a = n.data[r];
                        if (!a) throw new Error("Key " + r + " had no data!");
                        s.data[r] || i.push(a)
                    }
                    return i
                }, s.prototype.isNewOverlap = function(t, e) {
                    var i = 0 | t.id,
                        s = 0 | e.id,
                        n = this.overlappingShapesLastState,
                        o = this.overlappingShapesCurrentState;
                    return !n.get(i, s) && !!o.get(i, s)
                }, s.prototype.getNewBodyOverlaps = function(t) {
                    this.tmpArray1.length = 0;
                    var e = this.getNewOverlaps(this.tmpArray1);
                    return this.getBodyDiff(e, t)
                }, s.prototype.getEndBodyOverlaps = function(t) {
                    this.tmpArray1.length = 0;
                    var e = this.getEndOverlaps(this.tmpArray1);
                    return this.getBodyDiff(e, t)
                }, s.prototype.getBodyDiff = function(t, e) {
                    e = e || [];
                    for (var i = this.tmpDict, s = t.length; s--;) {
                        var n = t[s];
                        i.set(0 | n.bodyA.id, 0 | n.bodyB.id, n)
                    }
                    for (s = i.keys.length; s--;) {
                        (n = i.getByKey(i.keys[s])) && e.push(n.bodyA, n.bodyB)
                    }
                    return i.reset(), e
                }
            }, {
                "./OverlapKeeperRecord": 53,
                "./OverlapKeeperRecordPool": 54,
                "./TupleDictionary": 56,
                "./Utils": 57
            }],
            53: [function(t, e, i) {
                function s(t, e, i, s) {
                    this.shapeA = e, this.shapeB = s, this.bodyA = t, this.bodyB = i
                }
                e.exports = s, s.prototype.set = function(t, e, i, n) {
                    s.call(this, t, e, i, n)
                }
            }, {}],
            54: [function(t, e, i) {
                function s() {
                    o.apply(this, arguments)
                }
                var n = t("./OverlapKeeperRecord"),
                    o = t("./Pool");
                e.exports = s, s.prototype = new o, s.prototype.constructor = s, s.prototype.create = function() {
                    return new n
                }, s.prototype.destroy = function(t) {
                    return t.bodyA = t.bodyB = t.shapeA = t.shapeB = null, this
                }
            }, {
                "./OverlapKeeperRecord": 53,
                "./Pool": 55
            }],
            55: [function(t, e, i) {
                function s(t) {
                    t = t || {}, this.objects = [], void 0 !== t.size && this.resize(t.size)
                }
                e.exports = s, s.prototype.resize = function(t) {
                    for (var e = this.objects; e.length > t;) e.pop();
                    for (; e.length < t;) e.push(this.create());
                    return this
                }, s.prototype.get = function() {
                    var t = this.objects;
                    return t.length ? t.pop() : this.create()
                }, s.prototype.release = function(t) {
                    return this.destroy(t), this.objects.push(t), this
                }
            }, {}],
            56: [function(t, e, i) {
                function s() {
                    this.data = {}, this.keys = []
                }
                var n = t("./Utils");
                e.exports = s, s.prototype.getKey = function(t, e) {
                    return (0 | (t |= 0)) == (0 | (e |= 0)) ? -1 : 0 | ((0 | t) > (0 | e) ? t << 16 | 65535 & e : e << 16 | 65535 & t)
                }, s.prototype.getByKey = function(t) {
                    return t |= 0, this.data[t]
                }, s.prototype.get = function(t, e) {
                    return this.data[this.getKey(t, e)]
                }, s.prototype.set = function(t, e, i) {
                    if (!i) throw new Error("No data!");
                    var s = this.getKey(t, e);
                    return this.data[s] || this.keys.push(s), this.data[s] = i, s
                }, s.prototype.reset = function() {
                    for (var t = this.data, e = this.keys, i = e.length; i--;) delete t[e[i]];
                    e.length = 0
                }, s.prototype.copy = function(t) {
                    this.reset(), n.appendArray(this.keys, t.keys);
                    for (var e = t.keys.length; e--;) {
                        var i = t.keys[e];
                        this.data[i] = t.data[i]
                    }
                }
            }, {
                "./Utils": 57
            }],
            57: [function(t, e, i) {
                function s() {}
                e.exports = s, s.appendArray = function(t, e) {
                    if (e.length < 15e4) t.push.apply(t, e);
                    else
                        for (var i = 0, s = e.length; i !== s; ++i) t.push(e[i])
                }, s.splice = function(t, e, i) {
                    i = i || 1;
                    for (var s = e, n = t.length - i; s < n; s++) t[s] = t[s + i];
                    t.length = n
                }, "undefined" != typeof P2_ARRAY_TYPE ? s.ARRAY_TYPE = P2_ARRAY_TYPE : "undefined" != typeof Float32Array ? s.ARRAY_TYPE = Float32Array : s.ARRAY_TYPE = Array, s.extend = function(t, e) {
                    for (var i in e) t[i] = e[i]
                }, s.defaults = function(t, e) {
                    for (var i in t = t || {}, e) i in t || (t[i] = e[i]);
                    return t
                }
            }, {}],
            58: [function(t, e, i) {
                function s() {
                    this.equations = [], this.bodies = []
                }
                var n = t("../objects/Body");
                e.exports = s, s.prototype.reset = function() {
                    this.equations.length = this.bodies.length = 0
                };
                var o = [];
                s.prototype.getBodies = function(t) {
                    var e = t || [],
                        i = this.equations;
                    o.length = 0;
                    for (var s = 0; s !== i.length; s++) {
                        var n = i[s]; - 1 === o.indexOf(n.bodyA.id) && (e.push(n.bodyA), o.push(n.bodyA.id)), -1 === o.indexOf(n.bodyB.id) && (e.push(n.bodyB), o.push(n.bodyB.id))
                    }
                    return e
                }, s.prototype.wantsToSleep = function() {
                    for (var t = 0; t < this.bodies.length; t++) {
                        var e = this.bodies[t];
                        if (e.type === n.DYNAMIC && !e.wantsToSleep) return !1
                    }
                    return !0
                }, s.prototype.sleep = function() {
                    for (var t = 0; t < this.bodies.length; t++) this.bodies[t].sleep();
                    return !0
                }
            }, {
                "../objects/Body": 31
            }],
            59: [function(t, e, i) {
                function s(t) {
                    this.nodePool = new n({
                        size: 16
                    }), this.islandPool = new o({
                        size: 8
                    }), this.equations = [], this.islands = [], this.nodes = [], this.queue = []
                }
                var n = (t("../math/vec2"), t("./Island"), t("./IslandNode"), t("./../utils/IslandNodePool")),
                    o = t("./../utils/IslandPool"),
                    r = t("../objects/Body");
                e.exports = s, s.getUnvisitedNode = function(t) {
                    for (var e = t.length, i = 0; i !== e; i++) {
                        var s = t[i];
                        if (!s.visited && s.body.type === r.DYNAMIC) return s
                    }
                    return !1
                }, s.prototype.visit = function(t, e, i) {
                    e.push(t.body);
                    for (var s = t.equations.length, n = 0; n !== s; n++) {
                        var o = t.equations[n]; - 1 === i.indexOf(o) && i.push(o)
                    }
                }, s.prototype.bfs = function(t, e, i) {
                    var n = this.queue;
                    for (n.length = 0, n.push(t), t.visited = !0, this.visit(t, e, i); n.length;)
                        for (var o, a = n.pop(); o = s.getUnvisitedNode(a.neighbors);) o.visited = !0, this.visit(o, e, i), o.body.type === r.DYNAMIC && n.push(o)
                }, s.prototype.split = function(t) {
                    for (var e = t.bodies, i = this.nodes, n = this.equations; i.length;) this.nodePool.release(i.pop());
                    for (var o = 0; o !== e.length; o++) {
                        var r = this.nodePool.get();
                        r.body = e[o], i.push(r)
                    }
                    for (var a = 0; a !== n.length; a++) {
                        var h = n[a],
                            l = (o = e.indexOf(h.bodyA), e.indexOf(h.bodyB)),
                            c = i[o],
                            u = i[l];
                        c.neighbors.push(u), u.neighbors.push(c), c.equations.push(h), u.equations.push(h)
                    }
                    var d = this.islands;
                    for (o = 0; o < d.length; o++) this.islandPool.release(d[o]);
                    d.length = 0;
                    for (var p; p = s.getUnvisitedNode(i);) {
                        var f = this.islandPool.get();
                        this.bfs(p, f.bodies, f.equations), d.push(f)
                    }
                    return d
                }
            }, {
                "../math/vec2": 30,
                "../objects/Body": 31,
                "./../utils/IslandNodePool": 50,
                "./../utils/IslandPool": 51,
                "./Island": 58,
                "./IslandNode": 60
            }],
            60: [function(t, e, i) {
                function s(t) {
                    this.body = t, this.neighbors = [], this.equations = [], this.visited = !1
                }
                e.exports = s, s.prototype.reset = function() {
                    this.equations.length = 0, this.neighbors.length = 0, this.visited = !1, this.body = null
                }
            }, {}],
            61: [function(t, e, i) {
                function s(t) {
                    u.apply(this), t = t || {}, this.springs = [], this.bodies = [], this.disabledBodyCollisionPairs = [], this.solver = t.solver || new n, this.narrowphase = new y(this), this.islandManager = new _, this.gravity = o.fromValues(0, -9.78), t.gravity && o.copy(this.gravity, t.gravity), this.frictionGravity = o.length(this.gravity) || 10, this.useWorldGravityAsFrictionGravity = !0, this.useFrictionGravityOnZeroGravity = !0, this.broadphase = t.broadphase || new g, this.broadphase.setWorld(this), this.constraints = [], this.defaultMaterial = new p, this.defaultContactMaterial = new f(this.defaultMaterial, this.defaultMaterial), this.lastTimeStep = 1 / 60, this.applySpringForces = !0, this.applyDamping = !0, this.applyGravity = !0, this.solveConstraints = !0, this.contactMaterials = [], this.time = 0, this.accumulator = 0, this.stepping = !1, this.bodiesToBeRemoved = [], this.islandSplit = void 0 === t.islandSplit || !!t.islandSplit, this.emitImpactEvent = !0, this._constraintIdCounter = 0, this._bodyIdCounter = 0, this.postStepEvent = {
                        type: "postStep"
                    }, this.addBodyEvent = {
                        type: "addBody",
                        body: null
                    }, this.removeBodyEvent = {
                        type: "removeBody",
                        body: null
                    }, this.addSpringEvent = {
                        type: "addSpring",
                        spring: null
                    }, this.impactEvent = {
                        type: "impact",
                        bodyA: null,
                        bodyB: null,
                        shapeA: null,
                        shapeB: null,
                        contactEquation: null
                    }, this.postBroadphaseEvent = {
                        type: "postBroadphase",
                        pairs: null
                    }, this.sleepMode = s.NO_SLEEPING, this.beginContactEvent = {
                        type: "beginContact",
                        shapeA: null,
                        shapeB: null,
                        bodyA: null,
                        bodyB: null,
                        contactEquations: []
                    }, this.endContactEvent = {
                        type: "endContact",
                        shapeA: null,
                        shapeB: null,
                        bodyA: null,
                        bodyB: null
                    }, this.preSolveEvent = {
                        type: "preSolve",
                        contactEquations: null,
                        frictionEquations: null
                    }, this.overlappingShapesLastState = {
                        keys: []
                    }, this.overlappingShapesCurrentState = {
                        keys: []
                    }, this.overlapKeeper = new b
                }
                var n = t("../solver/GSSolver"),
                    o = (t("../solver/Solver"), t("../collision/Ray"), t("../math/vec2")),
                    r = t("../shapes/Circle"),
                    a = t("../shapes/Convex"),
                    h = (t("../shapes/Line"), t("../shapes/Plane")),
                    l = t("../shapes/Capsule"),
                    c = t("../shapes/Particle"),
                    u = t("../events/EventEmitter"),
                    d = t("../objects/Body"),
                    p = (t("../shapes/Shape"), t("../objects/LinearSpring"), t("../material/Material")),
                    f = t("../material/ContactMaterial"),
                    m = (t("../constraints/DistanceConstraint"), t("../constraints/Constraint"), t("../constraints/LockConstraint"), t("../constraints/RevoluteConstraint"), t("../constraints/PrismaticConstraint"), t("../constraints/GearConstraint"), t("../../package.json"), t("../collision/Broadphase"), t("../collision/AABB")),
                    g = t("../collision/SAPBroadphase"),
                    y = t("../collision/Narrowphase"),
                    v = t("../utils/Utils"),
                    b = t("../utils/OverlapKeeper"),
                    _ = t("./IslandManager");
                t("../objects/RotationalSpring"), e.exports = s, s.prototype = new Object(u.prototype), s.prototype.constructor = s, s.NO_SLEEPING = 1, s.BODY_SLEEPING = 2, s.ISLAND_SLEEPING = 4, s.prototype.addConstraint = function(t) {
                    this.constraints.push(t)
                }, s.prototype.addContactMaterial = function(t) {
                    this.contactMaterials.push(t)
                }, s.prototype.removeContactMaterial = function(t) {
                    var e = this.contactMaterials.indexOf(t); - 1 !== e && v.splice(this.contactMaterials, e, 1)
                }, s.prototype.getContactMaterial = function(t, e) {
                    for (var i = this.contactMaterials, s = 0, n = i.length; s !== n; s++) {
                        var o = i[s];
                        if (o.materialA.id === t.id && o.materialB.id === e.id || o.materialA.id === e.id && o.materialB.id === t.id) return o
                    }
                    return !1
                }, s.prototype.removeConstraint = function(t) {
                    var e = this.constraints.indexOf(t); - 1 !== e && v.splice(this.constraints, e, 1)
                };
                var w = (o.create(), o.create(), o.create(), o.create(), o.create(), o.create(), o.create()),
                    x = o.fromValues(0, 0),
                    P = o.fromValues(0, 0);
                o.fromValues(0, 0), o.fromValues(0, 0), s.prototype.step = function(t, e, i) {
                    if (i = i || 10, 0 === (e = e || 0)) this.internalStep(t), this.time += t;
                    else {
                        this.accumulator += e;
                        for (var s = 0; this.accumulator >= t && s < i;) this.internalStep(t), this.time += t, this.accumulator -= t, s++;
                        for (var n = this.accumulator % t / t, r = 0; r !== this.bodies.length; r++) {
                            var a = this.bodies[r];
                            o.lerp(a.interpolatedPosition, a.previousPosition, a.position, n), a.interpolatedAngle = a.previousAngle + n * (a.angle - a.previousAngle)
                        }
                    }
                };
                var T = [];
                s.prototype.internalStep = function(t) {
                    this.stepping = !0;
                    var e = this.springs.length,
                        i = this.springs,
                        n = this.bodies,
                        r = this.gravity,
                        a = this.solver,
                        h = this.bodies.length,
                        l = this.broadphase,
                        c = this.narrowphase,
                        u = this.constraints,
                        p = w,
                        f = (o.scale, o.add),
                        m = (o.rotate, this.islandManager);
                    if (this.overlapKeeper.tick(), this.lastTimeStep = t, this.useWorldGravityAsFrictionGravity) {
                        var g = o.length(this.gravity);
                        0 === g && this.useFrictionGravityOnZeroGravity || (this.frictionGravity = g)
                    }
                    if (this.applyGravity)
                        for (var y = 0; y !== h; y++) {
                            var b = (_ = n[y]).force;
                            _.type === d.DYNAMIC && _.sleepState !== d.SLEEPING && (o.scale(p, r, _.mass * _.gravityScale), f(b, b, p))
                        }
                    if (this.applySpringForces)
                        for (y = 0; y !== e; y++) {
                            i[y].applyForce()
                        }
                    if (this.applyDamping)
                        for (y = 0; y !== h; y++) {
                            var _;
                            (_ = n[y]).type === d.DYNAMIC && _.applyDamping(t)
                        }
                    var x = l.getCollisionPairs(this),
                        P = this.disabledBodyCollisionPairs;
                    for (y = P.length - 2; y >= 0; y -= 2)
                        for (var C = x.length - 2; C >= 0; C -= 2)(P[y] === x[C] && P[y + 1] === x[C + 1] || P[y + 1] === x[C] && P[y] === x[C + 1]) && x.splice(C, 2);
                    var S = u.length;
                    for (y = 0; y !== S; y++) {
                        var A = u[y];
                        if (!A.collideConnected)
                            for (C = x.length - 2; C >= 0; C -= 2)(A.bodyA === x[C] && A.bodyB === x[C + 1] || A.bodyB === x[C] && A.bodyA === x[C + 1]) && x.splice(C, 2)
                    }
                    this.postBroadphaseEvent.pairs = x, this.emit(this.postBroadphaseEvent), this.postBroadphaseEvent.pairs = null, c.reset(this);
                    y = 0;
                    for (var E = x.length; y !== E; y += 2)
                        for (var k = x[y], M = x[y + 1], O = 0, R = k.shapes.length; O !== R; O++)
                            for (var B = k.shapes[O], I = B.position, L = B.angle, D = 0, F = M.shapes.length; D !== F; D++) {
                                var U = M.shapes[D],
                                    N = U.position,
                                    G = U.angle,
                                    j = this.defaultContactMaterial;
                                if (B.material && U.material) {
                                    var W = this.getContactMaterial(B.material, U.material);
                                    W && (j = W)
                                }
                                this.runNarrowphase(c, k, B, I, L, M, U, N, G, j, this.frictionGravity)
                            }
                    for (y = 0; y !== h; y++) {
                        (V = n[y])._wakeUpAfterNarrowphase && (V.wakeUp(), V._wakeUpAfterNarrowphase = !1)
                    }
                    if (this.has("endContact")) {
                        this.overlapKeeper.getEndOverlaps(T);
                        var q = this.endContactEvent;
                        for (D = T.length; D--;) {
                            var H = T[D];
                            q.shapeA = H.shapeA, q.shapeB = H.shapeB, q.bodyA = H.bodyA, q.bodyB = H.bodyB, this.emit(q)
                        }
                        T.length = 0
                    }
                    var X = this.preSolveEvent;
                    X.contactEquations = c.contactEquations, X.frictionEquations = c.frictionEquations, this.emit(X), X.contactEquations = X.frictionEquations = null;
                    S = u.length;
                    for (y = 0; y !== S; y++) u[y].update();
                    if (c.contactEquations.length || c.frictionEquations.length || S)
                        if (this.islandSplit) {
                            for (m.equations.length = 0, v.appendArray(m.equations, c.contactEquations), v.appendArray(m.equations, c.frictionEquations), y = 0; y !== S; y++) v.appendArray(m.equations, u[y].equations);
                            m.split(this);
                            for (y = 0; y !== m.islands.length; y++) {
                                (K = m.islands[y]).equations.length && a.solveIsland(t, K)
                            }
                        } else {
                            for (a.addEquations(c.contactEquations), a.addEquations(c.frictionEquations), y = 0; y !== S; y++) a.addEquations(u[y].equations);
                            this.solveConstraints && a.solve(t, this), a.removeAllEquations()
                        } for (y = 0; y !== h; y++) {
                        var V;
                        (V = n[y]).integrate(t)
                    }
                    for (y = 0; y !== h; y++) n[y].setZeroForce();
                    if (this.emitImpactEvent && this.has("impact")) {
                        var Y = this.impactEvent;
                        for (y = 0; y !== c.contactEquations.length; y++) {
                            var z = c.contactEquations[y];
                            z.firstImpact && (Y.bodyA = z.bodyA, Y.bodyB = z.bodyB, Y.shapeA = z.shapeA, Y.shapeB = z.shapeB, Y.contactEquation = z, this.emit(Y))
                        }
                    }
                    if (this.sleepMode === s.BODY_SLEEPING)
                        for (y = 0; y !== h; y++) n[y].sleepTick(this.time, !1, t);
                    else if (this.sleepMode === s.ISLAND_SLEEPING && this.islandSplit) {
                        for (y = 0; y !== h; y++) n[y].sleepTick(this.time, !0, t);
                        for (y = 0; y < this.islandManager.islands.length; y++) {
                            var K;
                            (K = this.islandManager.islands[y]).wantsToSleep() && K.sleep()
                        }
                    }
                    this.stepping = !1;
                    var J = this.bodiesToBeRemoved;
                    for (y = 0; y !== J.length; y++) this.removeBody(J[y]);
                    J.length = 0, this.emit(this.postStepEvent)
                }, s.prototype.runNarrowphase = function(t, e, i, s, n, r, a, h, l, c, u) {
                    if (0 != (i.collisionGroup & a.collisionMask) && 0 != (a.collisionGroup & i.collisionMask)) {
                        o.rotate(x, s, e.angle), o.rotate(P, h, r.angle), o.add(x, x, e.position), o.add(P, P, r.position);
                        var p, f = n + e.angle,
                            m = l + r.angle;
                        t.enableFriction = c.friction > 0, t.frictionCoefficient = c.friction, p = e.type === d.STATIC || e.type === d.KINEMATIC ? r.mass : r.type === d.STATIC || r.type === d.KINEMATIC ? e.mass : e.mass * r.mass / (e.mass + r.mass), t.slipForce = c.friction * u * p, t.restitution = c.restitution, t.surfaceVelocity = c.surfaceVelocity, t.frictionStiffness = c.frictionStiffness, t.frictionRelaxation = c.frictionRelaxation, t.stiffness = c.stiffness, t.relaxation = c.relaxation, t.contactSkinSize = c.contactSkinSize, t.enabledEquations = e.collisionResponse && r.collisionResponse && i.collisionResponse && a.collisionResponse;
                        var g = t[i.type | a.type],
                            y = 0;
                        if (g) {
                            var v = i.sensor || a.sensor,
                                b = t.frictionEquations.length;
                            y = i.type < a.type ? g.call(t, e, i, x, f, r, a, P, m, v) : g.call(t, r, a, P, m, e, i, x, f, v);
                            var _ = t.frictionEquations.length - b;
                            if (y) {
                                if (e.allowSleep && e.type === d.DYNAMIC && e.sleepState === d.SLEEPING && r.sleepState === d.AWAKE && r.type !== d.STATIC && o.squaredLength(r.velocity) + Math.pow(r.angularVelocity, 2) >= 2 * Math.pow(r.sleepSpeedLimit, 2) && (e._wakeUpAfterNarrowphase = !0), r.allowSleep && r.type === d.DYNAMIC && r.sleepState === d.SLEEPING && e.sleepState === d.AWAKE && e.type !== d.STATIC && o.squaredLength(e.velocity) + Math.pow(e.angularVelocity, 2) >= 2 * Math.pow(e.sleepSpeedLimit, 2) && (r._wakeUpAfterNarrowphase = !0), this.overlapKeeper.setOverlapping(e, i, r, a), this.has("beginContact") && this.overlapKeeper.isNewOverlap(i, a)) {
                                    var w = this.beginContactEvent;
                                    if (w.shapeA = i, w.shapeB = a, w.bodyA = e, w.bodyB = r, w.contactEquations.length = 0, "number" == typeof y)
                                        for (var T = t.contactEquations.length - y; T < t.contactEquations.length; T++) w.contactEquations.push(t.contactEquations[T]);
                                    this.emit(w)
                                }
                                if ("number" == typeof y && _ > 1)
                                    for (T = t.frictionEquations.length - _; T < t.frictionEquations.length; T++) {
                                        var C = t.frictionEquations[T];
                                        C.setSlipForce(C.getSlipForce() / _)
                                    }
                            }
                        }
                    }
                }, s.prototype.addSpring = function(t) {
                    this.springs.push(t);
                    var e = this.addSpringEvent;
                    e.spring = t, this.emit(e), e.spring = null
                }, s.prototype.removeSpring = function(t) {
                    var e = this.springs.indexOf(t); - 1 !== e && v.splice(this.springs, e, 1)
                }, s.prototype.addBody = function(t) {
                    if (-1 === this.bodies.indexOf(t)) {
                        this.bodies.push(t), t.world = this;
                        var e = this.addBodyEvent;
                        e.body = t, this.emit(e), e.body = null
                    }
                }, s.prototype.removeBody = function(t) {
                    if (this.stepping) this.bodiesToBeRemoved.push(t);
                    else {
                        t.world = null;
                        var e = this.bodies.indexOf(t); - 1 !== e && (v.splice(this.bodies, e, 1), this.removeBodyEvent.body = t, t.resetConstraintVelocity(), this.emit(this.removeBodyEvent), this.removeBodyEvent.body = null)
                    }
                }, s.prototype.getBodyById = function(t) {
                    for (var e = this.bodies, i = 0; i < e.length; i++) {
                        var s = e[i];
                        if (s.id === t) return s
                    }
                    return !1
                }, s.prototype.disableBodyCollision = function(t, e) {
                    this.disabledBodyCollisionPairs.push(t, e)
                }, s.prototype.enableBodyCollision = function(t, e) {
                    for (var i = this.disabledBodyCollisionPairs, s = 0; s < i.length; s += 2)
                        if (i[s] === t && i[s + 1] === e || i[s + 1] === t && i[s] === e) return void i.splice(s, 2)
                }, s.prototype.clear = function() {
                    this.time = 0, this.solver && this.solver.equations.length && this.solver.removeAllEquations();
                    for (var t = this.constraints, e = t.length - 1; e >= 0; e--) this.removeConstraint(t[e]);
                    var i = this.bodies;
                    for (e = i.length - 1; e >= 0; e--) this.removeBody(i[e]);
                    var n = this.springs;
                    for (e = n.length - 1; e >= 0; e--) this.removeSpring(n[e]);
                    var o = this.contactMaterials;
                    for (e = o.length - 1; e >= 0; e--) this.removeContactMaterial(o[e]);
                    s.apply(this)
                };
                var C = o.create(),
                    S = (o.fromValues(0, 0), o.fromValues(0, 0));
                s.prototype.hitTest = function(t, e, i) {
                    i = i || 0;
                    var s = new d({
                            position: t
                        }),
                        n = new c,
                        u = t,
                        p = C,
                        f = S;
                    s.addShape(n);
                    for (var m = this.narrowphase, g = [], y = 0, v = e.length; y !== v; y++)
                        for (var b = e[y], _ = 0, w = b.shapes.length; _ !== w; _++) {
                            var x = b.shapes[_];
                            o.rotate(p, x.position, b.angle), o.add(p, p, b.position);
                            var P = x.angle + b.angle;
                            (x instanceof r && m.circleParticle(b, x, p, P, s, n, u, 0, !0) || x instanceof a && m.particleConvex(s, n, u, 0, b, x, p, P, !0) || x instanceof h && m.particlePlane(s, n, u, 0, b, x, p, P, !0) || x instanceof l && m.particleCapsule(s, n, u, 0, b, x, p, P, !0) || x instanceof c && o.squaredLength(o.sub(f, p, t)) < i * i) && g.push(b)
                        }
                    return g
                }, s.prototype.setGlobalStiffness = function(t) {
                    for (var e = this.constraints, i = 0; i !== e.length; i++)
                        for (var s = e[i], n = 0; n !== s.equations.length; n++) {
                            var o = s.equations[n];
                            o.stiffness = t, o.needsUpdate = !0
                        }
                    var r = this.contactMaterials;
                    for (i = 0; i !== r.length; i++) {
                        (s = r[i]).stiffness = s.frictionStiffness = t
                    }(s = this.defaultContactMaterial).stiffness = s.frictionStiffness = t
                }, s.prototype.setGlobalRelaxation = function(t) {
                    for (var e = 0; e !== this.constraints.length; e++)
                        for (var i = this.constraints[e], s = 0; s !== i.equations.length; s++) {
                            var n = i.equations[s];
                            n.relaxation = t, n.needsUpdate = !0
                        }
                    for (e = 0; e !== this.contactMaterials.length; e++) {
                        (i = this.contactMaterials[e]).relaxation = i.frictionRelaxation = t
                    }(i = this.defaultContactMaterial).relaxation = i.frictionRelaxation = t
                };
                var A = new m,
                    E = [];
                s.prototype.raycast = function(t, e) {
                    return e.getAABB(A), this.broadphase.aabbQuery(this, A, E), e.intersectBodies(t, E), E.length = 0, t.hasHit()
                }
            }, {
                "../../package.json": 6,
                "../collision/AABB": 7,
                "../collision/Broadphase": 8,
                "../collision/Narrowphase": 10,
                "../collision/Ray": 11,
                "../collision/SAPBroadphase": 13,
                "../constraints/Constraint": 14,
                "../constraints/DistanceConstraint": 15,
                "../constraints/GearConstraint": 16,
                "../constraints/LockConstraint": 17,
                "../constraints/PrismaticConstraint": 18,
                "../constraints/RevoluteConstraint": 19,
                "../events/EventEmitter": 26,
                "../material/ContactMaterial": 27,
                "../material/Material": 28,
                "../math/vec2": 30,
                "../objects/Body": 31,
                "../objects/LinearSpring": 32,
                "../objects/RotationalSpring": 33,
                "../shapes/Capsule": 38,
                "../shapes/Circle": 39,
                "../shapes/Convex": 40,
                "../shapes/Line": 42,
                "../shapes/Particle": 43,
                "../shapes/Plane": 44,
                "../shapes/Shape": 45,
                "../solver/GSSolver": 46,
                "../solver/Solver": 47,
                "../utils/OverlapKeeper": 52,
                "../utils/Utils": 57,
                "./IslandManager": 59
            }]
        }, {}, [36])(36)
    }, "object" == typeof e ? t.exports = i() : ("undefined" != typeof window ? s = window : "undefined" != typeof global ? s = global : "undefined" != typeof self && (s = self), s.p2 = i())
}, function(t, e) {
    (function() {
        function i(t, e) {
            this._scaleFactor = t, this._deltaMode = e, this.originalEvent = null
        }
        var s = this,
            n = n || {
                VERSION: "2.7.3",
                GAMES: [],
                AUTO: 0,
                CANVAS: 1,
                WEBGL: 2,
                HEADLESS: 3,
                WEBGL_MULTI: 4,
                NONE: 0,
                LEFT: 1,
                RIGHT: 2,
                UP: 3,
                DOWN: 4,
                SPRITE: 0,
                BUTTON: 1,
                IMAGE: 2,
                GRAPHICS: 3,
                TEXT: 4,
                TILESPRITE: 5,
                BITMAPTEXT: 6,
                GROUP: 7,
                RENDERTEXTURE: 8,
                TILEMAP: 9,
                TILEMAPLAYER: 10,
                EMITTER: 11,
                POLYGON: 12,
                BITMAPDATA: 13,
                CANVAS_FILTER: 14,
                WEBGL_FILTER: 15,
                ELLIPSE: 16,
                SPRITEBATCH: 17,
                RETROFONT: 18,
                POINTER: 19,
                ROPE: 20,
                CIRCLE: 21,
                RECTANGLE: 22,
                LINE: 23,
                MATRIX: 24,
                POINT: 25,
                ROUNDEDRECTANGLE: 26,
                CREATURE: 27,
                VIDEO: 28,
                PENDING_ATLAS: -1,
                HORIZONTAL: 0,
                VERTICAL: 1,
                LANDSCAPE: 0,
                PORTRAIT: 1,
                ANGLE_UP: 270,
                ANGLE_DOWN: 90,
                ANGLE_LEFT: 180,
                ANGLE_RIGHT: 0,
                ANGLE_NORTH_EAST: 315,
                ANGLE_NORTH_WEST: 225,
                ANGLE_SOUTH_EAST: 45,
                ANGLE_SOUTH_WEST: 135,
                TOP_LEFT: 0,
                TOP_CENTER: 1,
                TOP_RIGHT: 2,
                LEFT_TOP: 3,
                LEFT_CENTER: 4,
                LEFT_BOTTOM: 5,
                CENTER: 6,
                RIGHT_TOP: 7,
                RIGHT_CENTER: 8,
                RIGHT_BOTTOM: 9,
                BOTTOM_LEFT: 10,
                BOTTOM_CENTER: 11,
                BOTTOM_RIGHT: 12,
                blendModes: {
                    NORMAL: 0,
                    ADD: 1,
                    MULTIPLY: 2,
                    SCREEN: 3,
                    OVERLAY: 4,
                    DARKEN: 5,
                    LIGHTEN: 6,
                    COLOR_DODGE: 7,
                    COLOR_BURN: 8,
                    HARD_LIGHT: 9,
                    SOFT_LIGHT: 10,
                    DIFFERENCE: 11,
                    EXCLUSION: 12,
                    HUE: 13,
                    SATURATION: 14,
                    COLOR: 15,
                    LUMINOSITY: 16
                },
                scaleModes: {
                    DEFAULT: 0,
                    LINEAR: 0,
                    NEAREST: 1
                },
                PIXI: PIXI || {},
                _UID: 0
            };
        if (Math.trunc || (Math.trunc = function(t) {
                return t < 0 ? Math.ceil(t) : Math.floor(t)
            }), Function.prototype.bind || (Function.prototype.bind = function() {
                var t = Array.prototype.slice;
                return function(e) {
                    function i() {
                        var o = n.concat(t.call(arguments));
                        s.apply(this instanceof i ? this : e, o)
                    }
                    var s = this,
                        n = t.call(arguments, 1);
                    if ("function" != typeof s) throw new TypeError;
                    return i.prototype = function t(e) {
                        if (e && (t.prototype = e), !(this instanceof t)) return new t
                    }(s.prototype), i
                }
            }()), Array.isArray || (Array.isArray = function(t) {
                return "[object Array]" === Object.prototype.toString.call(t)
            }), Array.prototype.forEach || (Array.prototype.forEach = function(t) {
                "use strict";
                if (null == this) throw new TypeError;
                var e = Object(this),
                    i = e.length >>> 0;
                if ("function" != typeof t) throw new TypeError;
                for (var s = arguments.length >= 2 ? arguments[1] : void 0, n = 0; n < i; n++) n in e && t.call(s, e[n], n, e)
            }), "function" != typeof window.Uint32Array && "object" != typeof window.Uint32Array) {
            var o = function(t) {
                var e = new Array;
                window[t] = function(t) {
                    if ("number" == typeof t) {
                        Array.call(this, t), this.length = t;
                        for (var e = 0; e < this.length; e++) this[e] = 0
                    } else {
                        Array.call(this, t.length), this.length = t.length;
                        for (e = 0; e < this.length; e++) this[e] = t[e]
                    }
                }, window[t].prototype = e, window[t].constructor = window[t]
            };
            o("Float32Array"), o("Uint32Array"), o("Uint16Array"), o("Int16Array"), o("ArrayBuffer")
        }
        for (var r in window.console || (window.console = {}, window.console.log = window.console.assert = function() {}, window.console.warn = window.console.assert = function() {}), n.Utils = {
                reverseString: function(t) {
                    return t.split("").reverse().join("")
                },
                getProperty: function(t, e) {
                    for (var i = e.split("."), s = i.pop(), n = i.length, o = 1, r = i[0]; o < n && (t = t[r]);) r = i[o], o++;
                    return t ? t[s] : null
                },
                setProperty: function(t, e, i) {
                    for (var s = e.split("."), n = s.pop(), o = s.length, r = 1, a = s[0]; r < o && (t = t[a]);) a = s[r], r++;
                    return t && (t[n] = i), t
                },
                chanceRoll: function(t) {
                    return void 0 === t && (t = 50), t > 0 && 100 * Math.random() <= t
                },
                randomChoice: function(t, e) {
                    return Math.random() < .5 ? t : e
                },
                parseDimension: function(t, e) {
                    var i = 0,
                        s = 0;
                    return "string" == typeof t ? "%" === t.substr(-1) ? (i = parseInt(t, 10) / 100, s = 0 === e ? window.innerWidth * i : window.innerHeight * i) : s = parseInt(t, 10) : s = t, s
                },
                pad: function(t, e, i, s) {
                    if (void 0 === e) e = 0;
                    if (void 0 === i) i = " ";
                    if (void 0 === s) s = 3;
                    var n = 0;
                    if (e + 1 >= (t = t.toString()).length) switch (s) {
                        case 1:
                            t = new Array(e + 1 - t.length).join(i) + t;
                            break;
                        case 3:
                            var o = Math.ceil((n = e - t.length) / 2);
                            t = new Array(n - o + 1).join(i) + t + new Array(o + 1).join(i);
                            break;
                        default:
                            t += new Array(e + 1 - t.length).join(i)
                    }
                    return t
                },
                isPlainObject: function(t) {
                    if ("object" != typeof t || t.nodeType || t === t.window) return !1;
                    try {
                        if (t.constructor && !{}.hasOwnProperty.call(t.constructor.prototype, "isPrototypeOf")) return !1
                    } catch (t) {
                        return !1
                    }
                    return !0
                },
                extend: function() {
                    var t, e, i, s, o, r, a = arguments[0] || {},
                        h = 1,
                        l = arguments.length,
                        c = !1;
                    for ("boolean" == typeof a && (c = a, a = arguments[1] || {}, h = 2), l === h && (a = this, --h); h < l; h++)
                        if (null != (t = arguments[h]))
                            for (e in t) i = a[e], a !== (s = t[e]) && (c && s && (n.Utils.isPlainObject(s) || (o = Array.isArray(s))) ? (o ? (o = !1, r = i && Array.isArray(i) ? i : []) : r = i && n.Utils.isPlainObject(i) ? i : {}, a[e] = n.Utils.extend(c, r, s)) : void 0 !== s && (a[e] = s));
                    return a
                },
                mixinPrototype: function(t, e, i) {
                    void 0 === i && (i = !1);
                    for (var s = Object.keys(e), n = 0; n < s.length; n++) {
                        var o = s[n],
                            r = e[o];
                        !i && o in t || (!r || "function" != typeof r.get && "function" != typeof r.set ? t[o] = r : "function" == typeof r.clone ? t[o] = r.clone() : Object.defineProperty(t, o, r))
                    }
                },
                mixin: function(t, e) {
                    if (!t || "object" != typeof t) return e;
                    for (var i in t) {
                        var s = t[i];
                        if (!s.childNodes && !s.cloneNode) {
                            var o = typeof t[i];
                            t[i] && "object" === o ? typeof e[i] === o ? e[i] = n.Utils.mixin(t[i], e[i]) : e[i] = n.Utils.mixin(t[i], new s.constructor) : e[i] = t[i]
                        }
                    }
                    return e
                }
            }, n.Circle = function(t, e, i) {
                t = t || 0, e = e || 0, i = i || 0, this.x = t, this.y = e, this._diameter = i, this._radius = 0, i > 0 && (this._radius = .5 * i), this.type = n.CIRCLE
            }, n.Circle.prototype = {
                circumference: function() {
                    return Math.PI * this._radius * 2
                },
                random: function(t) {
                    void 0 === t && (t = new n.Point);
                    var e = 2 * Math.PI * Math.random(),
                        i = Math.random() + Math.random(),
                        s = i > 1 ? 2 - i : i,
                        o = s * Math.cos(e),
                        r = s * Math.sin(e);
                    return t.x = this.x + o * this.radius, t.y = this.y + r * this.radius, t
                },
                getBounds: function() {
                    return new n.Rectangle(this.x - this.radius, this.y - this.radius, this.diameter, this.diameter)
                },
                setTo: function(t, e, i) {
                    return this.x = t, this.y = e, this._diameter = i, this._radius = .5 * i, this
                },
                copyFrom: function(t) {
                    return this.setTo(t.x, t.y, t.diameter)
                },
                copyTo: function(t) {
                    return t.x = this.x, t.y = this.y, t.diameter = this._diameter, t
                },
                distance: function(t, e) {
                    var i = n.Math.distance(this.x, this.y, t.x, t.y);
                    return e ? Math.round(i) : i
                },
                clone: function(t) {
                    return null == t ? t = new n.Circle(this.x, this.y, this.diameter) : t.setTo(this.x, this.y, this.diameter), t
                },
                contains: function(t, e) {
                    return n.Circle.contains(this, t, e)
                },
                circumferencePoint: function(t, e, i) {
                    return n.Circle.circumferencePoint(this, t, e, i)
                },
                offset: function(t, e) {
                    return this.x += t, this.y += e, this
                },
                offsetPoint: function(t) {
                    return this.offset(t.x, t.y)
                },
                toString: function() {
                    return "[{Phaser.Circle (x=" + this.x + " y=" + this.y + " diameter=" + this.diameter + " radius=" + this.radius + ")}]"
                }
            }, n.Circle.prototype.constructor = n.Circle, Object.defineProperty(n.Circle.prototype, "diameter", {
                get: function() {
                    return this._diameter
                },
                set: function(t) {
                    t > 0 && (this._diameter = t, this._radius = .5 * t)
                }
            }), Object.defineProperty(n.Circle.prototype, "radius", {
                get: function() {
                    return this._radius
                },
                set: function(t) {
                    t > 0 && (this._radius = t, this._diameter = 2 * t)
                }
            }), Object.defineProperty(n.Circle.prototype, "left", {
                get: function() {
                    return this.x - this._radius
                },
                set: function(t) {
                    t > this.x ? (this._radius = 0, this._diameter = 0) : this.radius = this.x - t
                }
            }), Object.defineProperty(n.Circle.prototype, "right", {
                get: function() {
                    return this.x + this._radius
                },
                set: function(t) {
                    t < this.x ? (this._radius = 0, this._diameter = 0) : this.radius = t - this.x
                }
            }), Object.defineProperty(n.Circle.prototype, "top", {
                get: function() {
                    return this.y - this._radius
                },
                set: function(t) {
                    t > this.y ? (this._radius = 0, this._diameter = 0) : this.radius = this.y - t
                }
            }), Object.defineProperty(n.Circle.prototype, "bottom", {
                get: function() {
                    return this.y + this._radius
                },
                set: function(t) {
                    t < this.y ? (this._radius = 0, this._diameter = 0) : this.radius = t - this.y
                }
            }), Object.defineProperty(n.Circle.prototype, "area", {
                get: function() {
                    return this._radius > 0 ? Math.PI * this._radius * this._radius : 0
                }
            }), Object.defineProperty(n.Circle.prototype, "empty", {
                get: function() {
                    return 0 === this._diameter
                },
                set: function(t) {
                    !0 === t && this.setTo(0, 0, 0)
                }
            }), n.Circle.contains = function(t, e, i) {
                return t.radius > 0 && e >= t.left && e <= t.right && i >= t.top && i <= t.bottom && (t.x - e) * (t.x - e) + (t.y - i) * (t.y - i) <= t.radius * t.radius
            }, n.Circle.equals = function(t, e) {
                return t.x === e.x && t.y === e.y && t.diameter === e.diameter
            }, n.Circle.intersects = function(t, e) {
                return n.Math.distance(t.x, t.y, e.x, e.y) <= t.radius + e.radius
            }, n.Circle.circumferencePoint = function(t, e, i, s) {
                return void 0 === i && (i = !1), void 0 === s && (s = new n.Point), !0 === i && (e = n.Math.degToRad(e)), s.x = t.x + t.radius * Math.cos(e), s.y = t.y + t.radius * Math.sin(e), s
            }, n.Circle.intersectsRectangle = function(t, e) {
                var i = Math.abs(t.x - e.x - e.halfWidth);
                if (i > e.halfWidth + t.radius) return !1;
                var s = Math.abs(t.y - e.y - e.halfHeight);
                if (s > e.halfHeight + t.radius) return !1;
                if (i <= e.halfWidth || s <= e.halfHeight) return !0;
                var n = i - e.halfWidth,
                    o = s - e.halfHeight;
                return n * n + o * o <= t.radius * t.radius
            }, PIXI.Circle = n.Circle, n.Ellipse = function(t, e, i, s) {
                t = t || 0, e = e || 0, i = i || 0, s = s || 0, this.x = t, this.y = e, this.width = i, this.height = s, this.type = n.ELLIPSE
            }, n.Ellipse.prototype = {
                setTo: function(t, e, i, s) {
                    return this.x = t, this.y = e, this.width = i, this.height = s, this
                },
                getBounds: function() {
                    return new n.Rectangle(this.x - this.width, this.y - this.height, this.width, this.height)
                },
                copyFrom: function(t) {
                    return this.setTo(t.x, t.y, t.width, t.height)
                },
                copyTo: function(t) {
                    return t.x = this.x, t.y = this.y, t.width = this.width, t.height = this.height, t
                },
                clone: function(t) {
                    return null == t ? t = new n.Ellipse(this.x, this.y, this.width, this.height) : t.setTo(this.x, this.y, this.width, this.height), t
                },
                contains: function(t, e) {
                    return n.Ellipse.contains(this, t, e)
                },
                random: function(t) {
                    void 0 === t && (t = new n.Point);
                    var e = Math.random() * Math.PI * 2,
                        i = Math.random();
                    return t.x = Math.sqrt(i) * Math.cos(e), t.y = Math.sqrt(i) * Math.sin(e), t.x = this.x + t.x * this.width / 2, t.y = this.y + t.y * this.height / 2, t
                },
                toString: function() {
                    return "[{Phaser.Ellipse (x=" + this.x + " y=" + this.y + " width=" + this.width + " height=" + this.height + ")}]"
                }
            }, n.Ellipse.prototype.constructor = n.Ellipse, Object.defineProperty(n.Ellipse.prototype, "left", {
                get: function() {
                    return this.x
                },
                set: function(t) {
                    this.x = t
                }
            }), Object.defineProperty(n.Ellipse.prototype, "right", {
                get: function() {
                    return this.x + this.width
                },
                set: function(t) {
                    t < this.x ? this.width = 0 : this.width = t - this.x
                }
            }), Object.defineProperty(n.Ellipse.prototype, "top", {
                get: function() {
                    return this.y
                },
                set: function(t) {
                    this.y = t
                }
            }), Object.defineProperty(n.Ellipse.prototype, "bottom", {
                get: function() {
                    return this.y + this.height
                },
                set: function(t) {
                    t < this.y ? this.height = 0 : this.height = t - this.y
                }
            }), Object.defineProperty(n.Ellipse.prototype, "empty", {
                get: function() {
                    return 0 === this.width || 0 === this.height
                },
                set: function(t) {
                    !0 === t && this.setTo(0, 0, 0, 0)
                }
            }), n.Ellipse.contains = function(t, e, i) {
                if (t.width <= 0 || t.height <= 0) return !1;
                var s = (e - t.x) / t.width - .5,
                    n = (i - t.y) / t.height - .5;
                return (s *= s) + (n *= n) < .25
            }, PIXI.Ellipse = n.Ellipse, n.Line = function(t, e, i, s) {
                t = t || 0, e = e || 0, i = i || 0, s = s || 0, this.start = new n.Point(t, e), this.end = new n.Point(i, s), this.type = n.LINE
            }, n.Line.prototype = {
                setTo: function(t, e, i, s) {
                    return this.start.setTo(t, e), this.end.setTo(i, s), this
                },
                fromSprite: function(t, e, i) {
                    return void 0 === i && (i = !1), i ? this.setTo(t.centerX, t.centerY, e.centerX, e.centerY) : this.setTo(t.x, t.y, e.x, e.y)
                },
                fromAngle: function(t, e, i, s) {
                    return this.start.setTo(t, e), this.end.setTo(t + Math.cos(i) * s, e + Math.sin(i) * s), this
                },
                rotate: function(t, e) {
                    var i = (this.start.x + this.end.x) / 2,
                        s = (this.start.y + this.end.y) / 2;
                    return this.start.rotate(i, s, t, e), this.end.rotate(i, s, t, e), this
                },
                rotateAround: function(t, e, i, s) {
                    return this.start.rotate(t, e, i, s), this.end.rotate(t, e, i, s), this
                },
                intersects: function(t, e, i) {
                    return n.Line.intersectsPoints(this.start, this.end, t.start, t.end, e, i)
                },
                reflect: function(t) {
                    return n.Line.reflect(this, t)
                },
                midPoint: function(t) {
                    return void 0 === t && (t = new n.Point), t.x = (this.start.x + this.end.x) / 2, t.y = (this.start.y + this.end.y) / 2, t
                },
                centerOn: function(t, e) {
                    var i = t - (this.start.x + this.end.x) / 2,
                        s = e - (this.start.y + this.end.y) / 2;
                    this.start.add(i, s), this.end.add(i, s)
                },
                pointOnLine: function(t, e) {
                    return (t - this.start.x) * (this.end.y - this.start.y) == (this.end.x - this.start.x) * (e - this.start.y)
                },
                pointOnSegment: function(t, e) {
                    var i = Math.min(this.start.x, this.end.x),
                        s = Math.max(this.start.x, this.end.x),
                        n = Math.min(this.start.y, this.end.y),
                        o = Math.max(this.start.y, this.end.y);
                    return this.pointOnLine(t, e) && t >= i && t <= s && e >= n && e <= o
                },
                random: function(t) {
                    void 0 === t && (t = new n.Point);
                    var e = Math.random();
                    return t.x = this.start.x + e * (this.end.x - this.start.x), t.y = this.start.y + e * (this.end.y - this.start.y), t
                },
                coordinatesOnLine: function(t, e) {
                    void 0 === t && (t = 1), void 0 === e && (e = []);
                    var i = Math.round(this.start.x),
                        s = Math.round(this.start.y),
                        n = Math.round(this.end.x),
                        o = Math.round(this.end.y),
                        r = Math.abs(n - i),
                        a = Math.abs(o - s),
                        h = i < n ? 1 : -1,
                        l = s < o ? 1 : -1,
                        c = r - a;
                    e.push([i, s]);
                    for (var u = 1; i !== n || s !== o;) {
                        var d = c << 1;
                        d > -a && (c -= a, i += h), d < r && (c += r, s += l), u % t == 0 && e.push([i, s]), u++
                    }
                    return e
                },
                clone: function(t) {
                    return null == t ? t = new n.Line(this.start.x, this.start.y, this.end.x, this.end.y) : t.setTo(this.start.x, this.start.y, this.end.x, this.end.y), t
                }
            }, Object.defineProperty(n.Line.prototype, "length", {
                get: function() {
                    return Math.sqrt((this.end.x - this.start.x) * (this.end.x - this.start.x) + (this.end.y - this.start.y) * (this.end.y - this.start.y))
                }
            }), Object.defineProperty(n.Line.prototype, "angle", {
                get: function() {
                    return Math.atan2(this.end.y - this.start.y, this.end.x - this.start.x)
                }
            }), Object.defineProperty(n.Line.prototype, "slope", {
                get: function() {
                    return (this.end.y - this.start.y) / (this.end.x - this.start.x)
                }
            }), Object.defineProperty(n.Line.prototype, "perpSlope", {
                get: function() {
                    return -(this.end.x - this.start.x) / (this.end.y - this.start.y)
                }
            }), Object.defineProperty(n.Line.prototype, "x", {
                get: function() {
                    return Math.min(this.start.x, this.end.x)
                }
            }), Object.defineProperty(n.Line.prototype, "y", {
                get: function() {
                    return Math.min(this.start.y, this.end.y)
                }
            }), Object.defineProperty(n.Line.prototype, "left", {
                get: function() {
                    return Math.min(this.start.x, this.end.x)
                }
            }), Object.defineProperty(n.Line.prototype, "right", {
                get: function() {
                    return Math.max(this.start.x, this.end.x)
                }
            }), Object.defineProperty(n.Line.prototype, "top", {
                get: function() {
                    return Math.min(this.start.y, this.end.y)
                }
            }), Object.defineProperty(n.Line.prototype, "bottom", {
                get: function() {
                    return Math.max(this.start.y, this.end.y)
                }
            }), Object.defineProperty(n.Line.prototype, "width", {
                get: function() {
                    return Math.abs(this.start.x - this.end.x)
                }
            }), Object.defineProperty(n.Line.prototype, "height", {
                get: function() {
                    return Math.abs(this.start.y - this.end.y)
                }
            }), Object.defineProperty(n.Line.prototype, "normalX", {
                get: function() {
                    return Math.cos(this.angle - 1.5707963267948966)
                }
            }), Object.defineProperty(n.Line.prototype, "normalY", {
                get: function() {
                    return Math.sin(this.angle - 1.5707963267948966)
                }
            }), Object.defineProperty(n.Line.prototype, "normalAngle", {
                get: function() {
                    return n.Math.wrap(this.angle - 1.5707963267948966, -Math.PI, Math.PI)
                }
            }), n.Line.intersectsPoints = function(t, e, i, s, o, r) {
                void 0 === o && (o = !0), void 0 === r && (r = new n.Point);
                var a = e.y - t.y,
                    h = s.y - i.y,
                    l = t.x - e.x,
                    c = i.x - s.x,
                    u = e.x * t.y - t.x * e.y,
                    d = s.x * i.y - i.x * s.y,
                    p = a * c - h * l;
                if (0 === p) return null;
                if (r.x = (l * d - c * u) / p, r.y = (h * u - a * d) / p, o) {
                    var f = (s.y - i.y) * (e.x - t.x) - (s.x - i.x) * (e.y - t.y),
                        m = ((s.x - i.x) * (t.y - i.y) - (s.y - i.y) * (t.x - i.x)) / f,
                        g = ((e.x - t.x) * (t.y - i.y) - (e.y - t.y) * (t.x - i.x)) / f;
                    return m >= 0 && m <= 1 && g >= 0 && g <= 1 ? r : null
                }
                return r
            }, n.Line.intersects = function(t, e, i, s) {
                return n.Line.intersectsPoints(t.start, t.end, e.start, e.end, i, s)
            }, n.Line.intersectsRectangle = function(t, e) {
                if (0 === t.length || e.empty) return !1;
                var i = t.start.x,
                    s = t.start.y,
                    n = t.end.x,
                    o = t.end.y,
                    r = e.x,
                    a = e.y,
                    h = e.right,
                    l = e.bottom,
                    c = 0;
                if (i >= r && i <= h && s >= a && s <= l || n >= r && n <= h && o >= a && o <= l) return !0;
                if (i < r && n >= r) {
                    if ((c = s + (o - s) * (r - i) / (n - i)) > a && c <= l) return !0
                } else if (i > h && n <= h && (c = s + (o - s) * (h - i) / (n - i)) >= a && c <= l) return !0;
                if (s < a && o >= a) {
                    if ((c = i + (n - i) * (a - s) / (o - s)) >= r && c <= h) return !0
                } else if (s > l && o <= l && (c = i + (n - i) * (l - s) / (o - s)) >= r && c <= h) return !0;
                return !1
            }, n.Line.reflect = function(t, e) {
                return 2 * e.normalAngle - 3.141592653589793 - t.angle
            }, n.Matrix = function(t, e, i, s, o, r) {
                null != t || (t = 1), null != e || (e = 0), null != i || (i = 0), null != s || (s = 1), null != o || (o = 0), null != r || (r = 0), this.a = t, this.b = e, this.c = i, this.d = s, this.tx = o, this.ty = r, this.type = n.MATRIX
            }, n.Matrix.prototype = {
                fromArray: function(t) {
                    return this.setTo(t[0], t[1], t[3], t[4], t[2], t[5])
                },
                setTo: function(t, e, i, s, n, o) {
                    return this.a = t, this.b = e, this.c = i, this.d = s, this.tx = n, this.ty = o, this
                },
                clone: function(t) {
                    return null == t ? t = new n.Matrix(this.a, this.b, this.c, this.d, this.tx, this.ty) : (t.a = this.a, t.b = this.b, t.c = this.c, t.d = this.d, t.tx = this.tx, t.ty = this.ty), t
                },
                copyTo: function(t) {
                    return t.copyFrom(this), t
                },
                copyFrom: function(t) {
                    return this.a = t.a, this.b = t.b, this.c = t.c, this.d = t.d, this.tx = t.tx, this.ty = t.ty, this
                },
                toArray: function(t, e) {
                    return void 0 === e && (e = new Float32Array(9)), t ? (e[0] = this.a, e[1] = this.b, e[2] = 0, e[3] = this.c, e[4] = this.d, e[5] = 0, e[6] = this.tx, e[7] = this.ty, e[8] = 1) : (e[0] = this.a, e[1] = this.c, e[2] = this.tx, e[3] = this.b, e[4] = this.d, e[5] = this.ty, e[6] = 0, e[7] = 0, e[8] = 1), e
                },
                apply: function(t, e) {
                    return void 0 === e && (e = new n.Point), e.x = this.a * t.x + this.c * t.y + this.tx, e.y = this.b * t.x + this.d * t.y + this.ty, e
                },
                applyInverse: function(t, e) {
                    void 0 === e && (e = new n.Point);
                    var i = 1 / (this.a * this.d + this.c * -this.b),
                        s = t.x,
                        o = t.y;
                    return e.x = this.d * i * s + -this.c * i * o + (this.ty * this.c - this.tx * this.d) * i, e.y = this.a * i * o + -this.b * i * s + (-this.ty * this.a + this.tx * this.b) * i, e
                },
                translate: function(t, e) {
                    return this.tx += t, this.ty += e, this
                },
                scale: function(t, e) {
                    return this.a *= t, this.d *= e, this.c *= t, this.b *= e, this.tx *= t, this.ty *= e, this
                },
                rotate: function(t) {
                    var e = Math.cos(t),
                        i = Math.sin(t),
                        s = this.a,
                        n = this.c,
                        o = this.tx;
                    return this.a = s * e - this.b * i, this.b = s * i + this.b * e, this.c = n * e - this.d * i, this.d = n * i + this.d * e, this.tx = o * e - this.ty * i, this.ty = o * i + this.ty * e, this
                },
                append: function(t) {
                    var e = this.a,
                        i = this.b,
                        s = this.c,
                        n = this.d;
                    return this.a = t.a * e + t.b * s, this.b = t.a * i + t.b * n, this.c = t.c * e + t.d * s, this.d = t.c * i + t.d * n, this.tx = t.tx * e + t.ty * s + this.tx, this.ty = t.tx * i + t.ty * n + this.ty, this
                },
                identity: function() {
                    return this.setTo(1, 0, 0, 1, 0, 0)
                }
            }, n.identityMatrix = new n.Matrix, PIXI.Matrix = n.Matrix, PIXI.identityMatrix = n.identityMatrix, n.Point = function(t, e) {
                t = t || 0, e = e || 0, this.x = t, this.y = e, this.type = n.POINT
            }, n.Point.prototype = {
                copyFrom: function(t) {
                    return this.setTo(t.x, t.y)
                },
                invert: function() {
                    return this.setTo(this.y, this.x)
                },
                setTo: function(t, e) {
                    return this.x = t || 0, this.y = e || (0 !== e ? this.x : 0), this
                },
                set: function(t, e) {
                    return this.x = t || 0, this.y = e || (0 !== e ? this.x : 0), this
                },
                add: function(t, e) {
                    return this.x += t, this.y += e, this
                },
                subtract: function(t, e) {
                    return this.x -= t, this.y -= e, this
                },
                multiply: function(t, e) {
                    return this.x *= t, this.y *= e, this
                },
                divide: function(t, e) {
                    return this.x /= t, this.y /= e, this
                },
                clampX: function(t, e) {
                    return this.x = n.Math.clamp(this.x, t, e), this
                },
                clampY: function(t, e) {
                    return this.y = n.Math.clamp(this.y, t, e), this
                },
                clamp: function(t, e) {
                    return this.x = n.Math.clamp(this.x, t, e), this.y = n.Math.clamp(this.y, t, e), this
                },
                clone: function(t) {
                    return null == t ? t = new n.Point(this.x, this.y) : t.setTo(this.x, this.y), t
                },
                copyTo: function(t) {
                    return t.x = this.x, t.y = this.y, t
                },
                distance: function(t, e) {
                    return n.Point.distance(this, t, e)
                },
                equals: function(t) {
                    return t.x === this.x && t.y === this.y
                },
                angle: function(t, e) {
                    return void 0 === e && (e = !1), e ? n.Math.radToDeg(Math.atan2(t.y - this.y, t.x - this.x)) : Math.atan2(t.y - this.y, t.x - this.x)
                },
                rotate: function(t, e, i, s, o) {
                    return n.Point.rotate(this, t, e, i, s, o)
                },
                getMagnitude: function() {
                    return Math.sqrt(this.x * this.x + this.y * this.y)
                },
                getMagnitudeSq: function() {
                    return this.x * this.x + this.y * this.y
                },
                setMagnitude: function(t) {
                    return this.normalize().multiply(t, t)
                },
                normalize: function() {
                    if (!this.isZero()) {
                        var t = this.getMagnitude();
                        this.x /= t, this.y /= t
                    }
                    return this
                },
                limit: function(t) {
                    return this.getMagnitudeSq() > t * t && this.setMagnitude(t), this
                },
                isZero: function() {
                    return 0 === this.x && 0 === this.y
                },
                dot: function(t) {
                    return this.x * t.x + this.y * t.y
                },
                cross: function(t) {
                    return this.x * t.y - this.y * t.x
                },
                perp: function() {
                    return this.setTo(-this.y, this.x)
                },
                rperp: function() {
                    return this.setTo(this.y, -this.x)
                },
                normalRightHand: function() {
                    return this.setTo(-1 * this.y, this.x)
                },
                floor: function() {
                    return this.setTo(Math.floor(this.x), Math.floor(this.y))
                },
                ceil: function() {
                    return this.setTo(Math.ceil(this.x), Math.ceil(this.y))
                },
                toString: function() {
                    return "[{Point (x=" + this.x + " y=" + this.y + ")}]"
                }
            }, n.Point.prototype.constructor = n.Point, n.Point.add = function(t, e, i) {
                return void 0 === i && (i = new n.Point), i.x = t.x + e.x, i.y = t.y + e.y, i
            }, n.Point.subtract = function(t, e, i) {
                return void 0 === i && (i = new n.Point), i.x = t.x - e.x, i.y = t.y - e.y, i
            }, n.Point.multiply = function(t, e, i) {
                return void 0 === i && (i = new n.Point), i.x = t.x * e.x, i.y = t.y * e.y, i
            }, n.Point.divide = function(t, e, i) {
                return void 0 === i && (i = new n.Point), i.x = t.x / e.x, i.y = t.y / e.y, i
            }, n.Point.equals = function(t, e) {
                return t.x === e.x && t.y === e.y
            }, n.Point.angle = function(t, e) {
                return Math.atan2(t.y - e.y, t.x - e.x)
            }, n.Point.negative = function(t, e) {
                return void 0 === e && (e = new n.Point), e.setTo(-t.x, -t.y)
            }, n.Point.multiplyAdd = function(t, e, i, s) {
                return void 0 === s && (s = new n.Point), s.setTo(t.x + e.x * i, t.y + e.y * i)
            }, n.Point.interpolate = function(t, e, i, s) {
                return void 0 === s && (s = new n.Point), s.setTo(t.x + (e.x - t.x) * i, t.y + (e.y - t.y) * i)
            }, n.Point.perp = function(t, e) {
                return void 0 === e && (e = new n.Point), e.setTo(-t.y, t.x)
            }, n.Point.rperp = function(t, e) {
                return void 0 === e && (e = new n.Point), e.setTo(t.y, -t.x)
            }, n.Point.distance = function(t, e, i) {
                var s = n.Math.distance(t.x, t.y, e.x, e.y);
                return i ? Math.round(s) : s
            }, n.Point.project = function(t, e, i) {
                void 0 === i && (i = new n.Point);
                var s = t.dot(e) / e.getMagnitudeSq();
                return 0 !== s && i.setTo(s * e.x, s * e.y), i
            }, n.Point.projectUnit = function(t, e, i) {
                void 0 === i && (i = new n.Point);
                var s = t.dot(e);
                return 0 !== s && i.setTo(s * e.x, s * e.y), i
            }, n.Point.normalRightHand = function(t, e) {
                return void 0 === e && (e = new n.Point), e.setTo(-1 * t.y, t.x)
            }, n.Point.normalize = function(t, e) {
                void 0 === e && (e = new n.Point);
                var i = t.getMagnitude();
                return 0 !== i && e.setTo(t.x / i, t.y / i), e
            }, n.Point.rotate = function(t, e, i, s, o, r) {
                if (o && (s = n.Math.degToRad(s)), void 0 === r) {
                    t.subtract(e, i);
                    var a = Math.sin(s),
                        h = Math.cos(s),
                        l = h * t.x - a * t.y,
                        c = a * t.x + h * t.y;
                    t.x = l + e, t.y = c + i
                } else {
                    var u = s + Math.atan2(t.y - i, t.x - e);
                    t.x = e + r * Math.cos(u), t.y = i + r * Math.sin(u)
                }
                return t
            }, n.Point.centroid = function(t, e) {
                if (void 0 === e && (e = new n.Point), "[object Array]" !== Object.prototype.toString.call(t)) throw new Error("Phaser.Point. Parameter 'points' must be an array");
                var i = t.length;
                if (i < 1) throw new Error("Phaser.Point. Parameter 'points' array must not be empty");
                if (1 === i) return e.copyFrom(t[0]), e;
                for (var s = 0; s < i; s++) n.Point.add(e, t[s], e);
                return e.divide(i, i), e
            }, n.Point.parse = function(t, e, i) {
                e = e || "x", i = i || "y";
                var s = new n.Point;
                return t[e] && (s.x = parseInt(t[e], 10)), t[i] && (s.y = parseInt(t[i], 10)), s
            }, PIXI.Point = n.Point, n.Polygon = function() {
                this.area = 0, this._points = [], arguments.length > 0 && this.setTo.apply(this, arguments), this.closed = !0, this.flattened = !1, this.type = n.POLYGON
            }, n.Polygon.prototype = {
                toNumberArray: function(t) {
                    void 0 === t && (t = []);
                    for (var e = 0; e < this._points.length; e++) "number" == typeof this._points[e] ? (t.push(this._points[e]), t.push(this._points[e + 1]), e++) : (t.push(this._points[e].x), t.push(this._points[e].y));
                    return t
                },
                flatten: function() {
                    return this._points = this.toNumberArray(), this.flattened = !0, this
                },
                clone: function(t) {
                    var e = this._points.slice();
                    return null == t ? t = new n.Polygon(e) : t.setTo(e), t
                },
                contains: function(t, e) {
                    var i = !1;
                    if (this.flattened)
                        for (var s = -2, n = this._points.length - 2;
                            (s += 2) < this._points.length; n = s) {
                            var o = this._points[s],
                                r = this._points[s + 1],
                                a = this._points[n],
                                h = this._points[n + 1];
                            (r <= e && e < h || h <= e && e < r) && t < (a - o) * (e - r) / (h - r) + o && (i = !i)
                        } else
                            for (s = -1, n = this._points.length - 1; ++s < this._points.length; n = s) {
                                o = this._points[s].x, r = this._points[s].y, a = this._points[n].x, h = this._points[n].y;
                                (r <= e && e < h || h <= e && e < r) && t < (a - o) * (e - r) / (h - r) + o && (i = !i)
                            }
                    return i
                },
                setTo: function(t) {
                    if (this.area = 0, this._points = [], arguments.length > 0) {
                        Array.isArray(t) || (t = Array.prototype.slice.call(arguments));
                        for (var e = Number.MAX_VALUE, i = 0, s = t.length; i < s; i++) {
                            if ("number" == typeof t[i]) {
                                var n = new PIXI.Point(t[i], t[i + 1]);
                                i++
                            } else if (Array.isArray(t[i])) n = new PIXI.Point(t[i][0], t[i][1]);
                            else n = new PIXI.Point(t[i].x, t[i].y);
                            this._points.push(n), n.y < e && (e = n.y)
                        }
                        this.calculateArea(e)
                    }
                    return this
                },
                calculateArea: function(t) {
                    for (var e, i, s, n, o = 0, r = this._points.length; o < r; o++) e = this._points[o], i = o === r - 1 ? this._points[0] : this._points[o + 1], s = (e.y - t + (i.y - t)) / 2, n = e.x - i.x, this.area += s * n;
                    return this.area
                }
            }, n.Polygon.prototype.constructor = n.Polygon, Object.defineProperty(n.Polygon.prototype, "points", {
                get: function() {
                    return this._points
                },
                set: function(t) {
                    null != t ? this.setTo(t) : this.setTo()
                }
            }), PIXI.Polygon = n.Polygon, n.Rectangle = function(t, e, i, s) {
                t = t || 0, e = e || 0, i = i || 0, s = s || 0, this.x = t, this.y = e, this.width = i, this.height = s, this.type = n.RECTANGLE
            }, n.Rectangle.prototype = {
                offset: function(t, e) {
                    return this.x += t, this.y += e, this
                },
                offsetPoint: function(t) {
                    return this.offset(t.x, t.y)
                },
                setTo: function(t, e, i, s) {
                    return this.x = t, this.y = e, this.width = i, this.height = s, this
                },
                scale: function(t, e) {
                    return void 0 === e && (e = t), this.width *= t, this.height *= e, this
                },
                centerOn: function(t, e) {
                    return this.centerX = t, this.centerY = e, this
                },
                floor: function() {
                    this.x = Math.floor(this.x), this.y = Math.floor(this.y)
                },
                floorAll: function() {
                    this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.width = Math.floor(this.width), this.height = Math.floor(this.height)
                },
                ceil: function() {
                    this.x = Math.ceil(this.x), this.y = Math.ceil(this.y)
                },
                ceilAll: function() {
                    this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.width = Math.ceil(this.width), this.height = Math.ceil(this.height)
                },
                copyFrom: function(t) {
                    return this.setTo(t.x, t.y, t.width, t.height)
                },
                copyTo: function(t) {
                    return t.x = this.x, t.y = this.y, t.width = this.width, t.height = this.height, t
                },
                inflate: function(t, e) {
                    return n.Rectangle.inflate(this, t, e)
                },
                size: function(t) {
                    return n.Rectangle.size(this, t)
                },
                resize: function(t, e) {
                    return this.width = t, this.height = e, this
                },
                clone: function(t) {
                    return n.Rectangle.clone(this, t)
                },
                contains: function(t, e) {
                    return n.Rectangle.contains(this, t, e)
                },
                containsRect: function(t) {
                    return n.Rectangle.containsRect(t, this)
                },
                equals: function(t) {
                    return n.Rectangle.equals(this, t)
                },
                intersection: function(t, e) {
                    return n.Rectangle.intersection(this, t, e)
                },
                intersects: function(t) {
                    return n.Rectangle.intersects(this, t)
                },
                intersectsRaw: function(t, e, i, s, o) {
                    return n.Rectangle.intersectsRaw(this, t, e, i, s, o)
                },
                union: function(t, e) {
                    return n.Rectangle.union(this, t, e)
                },
                random: function(t) {
                    return void 0 === t && (t = new n.Point), t.x = this.randomX, t.y = this.randomY, t
                },
                getPoint: function(t, e) {
                    switch (void 0 === e && (e = new n.Point), t) {
                        default:
                        case n.TOP_LEFT:
                            return e.set(this.x, this.y);
                        case n.TOP_CENTER:
                            return e.set(this.centerX, this.y);
                        case n.TOP_RIGHT:
                            return e.set(this.right, this.y);
                        case n.LEFT_CENTER:
                            return e.set(this.x, this.centerY);
                        case n.CENTER:
                            return e.set(this.centerX, this.centerY);
                        case n.RIGHT_CENTER:
                            return e.set(this.right, this.centerY);
                        case n.BOTTOM_LEFT:
                            return e.set(this.x, this.bottom);
                        case n.BOTTOM_CENTER:
                            return e.set(this.centerX, this.bottom);
                        case n.BOTTOM_RIGHT:
                            return e.set(this.right, this.bottom)
                    }
                },
                toString: function() {
                    return "[{Rectangle (x=" + this.x + " y=" + this.y + " width=" + this.width + " height=" + this.height + " empty=" + this.empty + ")}]"
                }
            }, Object.defineProperty(n.Rectangle.prototype, "halfWidth", {
                get: function() {
                    return Math.round(this.width / 2)
                }
            }), Object.defineProperty(n.Rectangle.prototype, "halfHeight", {
                get: function() {
                    return Math.round(this.height / 2)
                }
            }), Object.defineProperty(n.Rectangle.prototype, "bottom", {
                get: function() {
                    return this.y + this.height
                },
                set: function(t) {
                    t <= this.y ? this.height = 0 : this.height = t - this.y
                }
            }), Object.defineProperty(n.Rectangle.prototype, "bottomLeft", {
                get: function() {
                    return new n.Point(this.x, this.bottom)
                },
                set: function(t) {
                    this.x = t.x, this.bottom = t.y
                }
            }), Object.defineProperty(n.Rectangle.prototype, "bottomRight", {
                get: function() {
                    return new n.Point(this.right, this.bottom)
                },
                set: function(t) {
                    this.right = t.x, this.bottom = t.y
                }
            }), Object.defineProperty(n.Rectangle.prototype, "left", {
                get: function() {
                    return this.x
                },
                set: function(t) {
                    t >= this.right ? this.width = 0 : this.width = this.right - t, this.x = t
                }
            }), Object.defineProperty(n.Rectangle.prototype, "right", {
                get: function() {
                    return this.x + this.width
                },
                set: function(t) {
                    t <= this.x ? this.width = 0 : this.width = t - this.x
                }
            }), Object.defineProperty(n.Rectangle.prototype, "volume", {
                get: function() {
                    return this.width * this.height
                }
            }), Object.defineProperty(n.Rectangle.prototype, "perimeter", {
                get: function() {
                    return 2 * this.width + 2 * this.height
                }
            }), Object.defineProperty(n.Rectangle.prototype, "centerX", {
                get: function() {
                    return this.x + this.halfWidth
                },
                set: function(t) {
                    this.x = t - this.halfWidth
                }
            }), Object.defineProperty(n.Rectangle.prototype, "centerY", {
                get: function() {
                    return this.y + this.halfHeight
                },
                set: function(t) {
                    this.y = t - this.halfHeight
                }
            }), Object.defineProperty(n.Rectangle.prototype, "randomX", {
                get: function() {
                    return this.x + Math.random() * this.width
                }
            }), Object.defineProperty(n.Rectangle.prototype, "randomY", {
                get: function() {
                    return this.y + Math.random() * this.height
                }
            }), Object.defineProperty(n.Rectangle.prototype, "top", {
                get: function() {
                    return this.y
                },
                set: function(t) {
                    t >= this.bottom ? (this.height = 0, this.y = t) : this.height = this.bottom - t
                }
            }), Object.defineProperty(n.Rectangle.prototype, "topLeft", {
                get: function() {
                    return new n.Point(this.x, this.y)
                },
                set: function(t) {
                    this.x = t.x, this.y = t.y
                }
            }), Object.defineProperty(n.Rectangle.prototype, "topRight", {
                get: function() {
                    return new n.Point(this.x + this.width, this.y)
                },
                set: function(t) {
                    this.right = t.x, this.y = t.y
                }
            }), Object.defineProperty(n.Rectangle.prototype, "empty", {
                get: function() {
                    return !this.width || !this.height
                },
                set: function(t) {
                    !0 === t && this.setTo(0, 0, 0, 0)
                }
            }), n.Rectangle.prototype.constructor = n.Rectangle, n.Rectangle.inflate = function(t, e, i) {
                return t.x -= e, t.width += 2 * e, t.y -= i, t.height += 2 * i, t
            }, n.Rectangle.inflatePoint = function(t, e) {
                return n.Rectangle.inflate(t, e.x, e.y)
            }, n.Rectangle.size = function(t, e) {
                return null == e ? e = new n.Point(t.width, t.height) : e.setTo(t.width, t.height), e
            }, n.Rectangle.clone = function(t, e) {
                return null == e ? e = new n.Rectangle(t.x, t.y, t.width, t.height) : e.setTo(t.x, t.y, t.width, t.height), e
            }, n.Rectangle.contains = function(t, e, i) {
                return !(t.width <= 0 || t.height <= 0) && e >= t.x && e < t.right && i >= t.y && i < t.bottom
            }, n.Rectangle.containsRaw = function(t, e, i, s, n, o) {
                return n >= t && n < t + i && o >= e && o < e + s
            }, n.Rectangle.containsPoint = function(t, e) {
                return n.Rectangle.contains(t, e.x, e.y)
            }, n.Rectangle.containsRect = function(t, e) {
                return !(t.volume > e.volume) && t.x >= e.x && t.y >= e.y && t.right < e.right && t.bottom < e.bottom
            }, n.Rectangle.equals = function(t, e) {
                return t.x === e.x && t.y === e.y && t.width === e.width && t.height === e.height
            }, n.Rectangle.sameDimensions = function(t, e) {
                return t.width === e.width && t.height === e.height
            }, n.Rectangle.intersection = function(t, e, i) {
                return void 0 === i && (i = new n.Rectangle), n.Rectangle.intersects(t, e) && (i.x = Math.max(t.x, e.x), i.y = Math.max(t.y, e.y), i.width = Math.min(t.right, e.right) - i.x, i.height = Math.min(t.bottom, e.bottom) - i.y), i
            }, n.Rectangle.intersects = function(t, e) {
                return !(t.width <= 0 || t.height <= 0 || e.width <= 0 || e.height <= 0 || t.right < e.x || t.bottom < e.y || t.x > e.right || t.y > e.bottom)
            }, n.Rectangle.intersectsRaw = function(t, e, i, s, n, o) {
                return void 0 === o && (o = 0), !(e > t.right + o || i < t.left - o || s > t.bottom + o || n < t.top - o)
            }, n.Rectangle.union = function(t, e, i) {
                return void 0 === i && (i = new n.Rectangle), i.setTo(Math.min(t.x, e.x), Math.min(t.y, e.y), Math.max(t.right, e.right) - Math.min(t.left, e.left), Math.max(t.bottom, e.bottom) - Math.min(t.top, e.top))
            }, n.Rectangle.aabb = function(t, e) {
                void 0 === e && (e = new n.Rectangle);
                var i = Number.NEGATIVE_INFINITY,
                    s = Number.POSITIVE_INFINITY,
                    o = Number.NEGATIVE_INFINITY,
                    r = Number.POSITIVE_INFINITY;
                return t.forEach(function(t) {
                    t.x > i && (i = t.x), t.x < s && (s = t.x), t.y > o && (o = t.y), t.y < r && (r = t.y)
                }), e.setTo(s, r, i - s, o - r), e
            }, PIXI.Rectangle = n.Rectangle, PIXI.EmptyRectangle = new n.Rectangle(0, 0, 0, 0), n.RoundedRectangle = function(t, e, i, s, o) {
                void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === s && (s = 0), void 0 === o && (o = 20), this.x = t, this.y = e, this.width = i, this.height = s, this.radius = o || 20, this.type = n.ROUNDEDRECTANGLE
            }, n.RoundedRectangle.prototype = {
                clone: function() {
                    return new n.RoundedRectangle(this.x, this.y, this.width, this.height, this.radius)
                },
                contains: function(t, e) {
                    if (this.width <= 0 || this.height <= 0) return !1;
                    var i = this.x;
                    if (t >= i && t <= i + this.width) {
                        var s = this.y;
                        if (e >= s && e <= s + this.height) return !0
                    }
                    return !1
                }
            }, n.RoundedRectangle.prototype.constructor = n.RoundedRectangle, PIXI.RoundedRectangle = n.RoundedRectangle, n.Camera = function(t, e, i, s, o, r) {
                this.game = t, this.world = t.world, this.id = 0, this.view = new n.Rectangle(i, s, o, r), this.bounds = new n.Rectangle(i, s, o, r), this.deadzone = null, this.visible = !0, this.roundPx = !0, this.atLimit = {
                    x: !1,
                    y: !1
                }, this.target = null, this.displayObject = null, this.scale = null, this.totalInView = 0, this.lerp = new n.Point(1, 1), this.onShakeComplete = new n.Signal, this.onFlashComplete = new n.Signal, this.onFadeComplete = new n.Signal, this.fx = null, this._targetPosition = new n.Point, this._edge = 0, this._position = new n.Point, this._shake = {
                    intensity: 0,
                    duration: 0,
                    horizontal: !1,
                    vertical: !1,
                    shakeBounds: !0,
                    x: 0,
                    y: 0
                }, this._fxDuration = 0, this._fxType = 0
            }, n.Camera.FOLLOW_LOCKON = 0, n.Camera.FOLLOW_PLATFORMER = 1, n.Camera.FOLLOW_TOPDOWN = 2, n.Camera.FOLLOW_TOPDOWN_TIGHT = 3, n.Camera.SHAKE_BOTH = 4, n.Camera.SHAKE_HORIZONTAL = 5, n.Camera.SHAKE_VERTICAL = 6, n.Camera.ENABLE_FX = !0, n.Camera.prototype = {
                boot: function() {
                    this.displayObject = this.game.world, this.scale = this.game.world.scale, this.game.camera = this, n.Graphics && n.Camera.ENABLE_FX && (this.fx = new n.Graphics(this.game), this.game.stage.addChild(this.fx))
                },
                preUpdate: function() {
                    this.totalInView = 0
                },
                follow: function(t, e, i, s) {
                    var o;
                    switch (void 0 === e && (e = n.Camera.FOLLOW_LOCKON), void 0 === i && (i = 1), void 0 === s && (s = 1), this.target = t, this.lerp.set(i, s), e) {
                        case n.Camera.FOLLOW_PLATFORMER:
                            var r = this.width / 8,
                                a = this.height / 3;
                            this.deadzone = new n.Rectangle((this.width - r) / 2, (this.height - a) / 2 - .25 * a, r, a);
                            break;
                        case n.Camera.FOLLOW_TOPDOWN:
                            o = Math.max(this.width, this.height) / 4, this.deadzone = new n.Rectangle((this.width - o) / 2, (this.height - o) / 2, o, o);
                            break;
                        case n.Camera.FOLLOW_TOPDOWN_TIGHT:
                            o = Math.max(this.width, this.height) / 8, this.deadzone = new n.Rectangle((this.width - o) / 2, (this.height - o) / 2, o, o);
                            break;
                        case n.Camera.FOLLOW_LOCKON:
                        default:
                            this.deadzone = null
                    }
                },
                unfollow: function() {
                    this.target = null
                },
                focusOn: function(t) {
                    this.setPosition(Math.round(t.x - this.view.halfWidth), Math.round(t.y - this.view.halfHeight))
                },
                focusOnXY: function(t, e) {
                    this.setPosition(Math.round(t - this.view.halfWidth), Math.round(e - this.view.halfHeight))
                },
                shake: function(t, e, i, s, o) {
                    return void 0 === t && (t = .05), void 0 === e && (e = 500), void 0 === i && (i = !0), void 0 === s && (s = n.Camera.SHAKE_BOTH), void 0 === o && (o = !0), !(!i && this._shake.duration > 0 || (this._shake.intensity = t, this._shake.duration = e, this._shake.shakeBounds = o, this._shake.x = 0, this._shake.y = 0, this._shake.horizontal = s === n.Camera.SHAKE_BOTH || s === n.Camera.SHAKE_HORIZONTAL, this._shake.vertical = s === n.Camera.SHAKE_BOTH || s === n.Camera.SHAKE_VERTICAL, 0))
                },
                flash: function(t, e, i, s) {
                    return void 0 === t && (t = 16777215), void 0 === e && (e = 500), void 0 === i && (i = !1), void 0 === s && (s = 1), !(!this.fx || !i && this._fxDuration > 0 || (this.fx.clear(), this.fx.beginFill(t, s), this.fx.drawRect(0, 0, this.width, this.height), this.fx.endFill(), this.fx.alpha = 1, this._fxDuration = e, this._fxType = 0, 0))
                },
                fade: function(t, e, i, s) {
                    return void 0 === t && (t = 0), void 0 === e && (e = 500), void 0 === i && (i = !1), void 0 === s && (s = 1), !(!this.fx || !i && this._fxDuration > 0 || (this.fx.clear(), this.fx.beginFill(t, s), this.fx.drawRect(0, 0, this.width, this.height), this.fx.endFill(), this.fx.alpha = 0, this._fxDuration = e, this._fxType = 1, 0))
                },
                update: function() {
                    this._fxDuration > 0 && this.updateFX(), this._shake.duration > 0 && this.updateShake(), this.bounds && this.checkBounds(), this.roundPx && (this.view.floor(), this._shake.x = Math.floor(this._shake.x), this._shake.y = Math.floor(this._shake.y)), this.displayObject.position.x = -this.view.x, this.displayObject.position.y = -this.view.y
                },
                updateFX: function() {
                    0 === this._fxType ? (this.fx.alpha -= this.game.time.elapsedMS / this._fxDuration, this.fx.alpha <= 0 && (this._fxDuration = 0, this.fx.alpha = 0, this.onFlashComplete.dispatch())) : (this.fx.alpha += this.game.time.elapsedMS / this._fxDuration, this.fx.alpha >= 1 && (this._fxDuration = 0, this.fx.alpha = 1, this.onFadeComplete.dispatch()))
                },
                updateShake: function() {
                    this._shake.duration -= this.game.time.elapsedMS, this._shake.duration <= 0 ? (this.onShakeComplete.dispatch(), this._shake.x = 0, this._shake.y = 0) : (this._shake.horizontal && (this._shake.x = this.game.rnd.frac() * this._shake.intensity * this.view.width * 2 - this._shake.intensity * this.view.width), this._shake.vertical && (this._shake.y = this.game.rnd.frac() * this._shake.intensity * this.view.height * 2 - this._shake.intensity * this.view.height))
                },
                updateTarget: function() {
                    this._targetPosition.x = this.view.x + this.target.worldPosition.x, this._targetPosition.y = this.view.y + this.target.worldPosition.y, this.deadzone ? (this._edge = this._targetPosition.x - this.view.x, this._edge < this.deadzone.left ? this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.deadzone.left, this.lerp.x) : this._edge > this.deadzone.right && (this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.deadzone.right, this.lerp.x)), this._edge = this._targetPosition.y - this.view.y, this._edge < this.deadzone.top ? this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.deadzone.top, this.lerp.y) : this._edge > this.deadzone.bottom && (this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.deadzone.bottom, this.lerp.y))) : (this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.view.halfWidth, this.lerp.x), this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.view.halfHeight, this.lerp.y)), this.bounds && this.checkBounds(), this.roundPx && this.view.floor(), this.displayObject.position.x = -this.view.x, this.displayObject.position.y = -this.view.y
                },
                setBoundsToWorld: function() {
                    this.bounds && this.bounds.copyFrom(this.game.world.bounds)
                },
                checkBounds: function() {
                    this.atLimit.x = !1, this.atLimit.y = !1;
                    var t = this.view.x + this._shake.x,
                        e = this.view.right + this._shake.x,
                        i = this.view.y + this._shake.y,
                        s = this.view.bottom + this._shake.y;
                    t <= this.bounds.x * this.scale.x && (this.atLimit.x = !0, this.view.x = this.bounds.x * this.scale.x, this._shake.shakeBounds || (this._shake.x = 0)), e >= this.bounds.right * this.scale.x && (this.atLimit.x = !0, this.view.x = this.bounds.right * this.scale.x - this.width, this._shake.shakeBounds || (this._shake.x = 0)), i <= this.bounds.top * this.scale.y && (this.atLimit.y = !0, this.view.y = this.bounds.top * this.scale.y, this._shake.shakeBounds || (this._shake.y = 0)), s >= this.bounds.bottom * this.scale.y && (this.atLimit.y = !0, this.view.y = this.bounds.bottom * this.scale.y - this.height, this._shake.shakeBounds || (this._shake.y = 0))
                },
                setPosition: function(t, e) {
                    this.view.x = t, this.view.y = e, this.bounds && this.checkBounds()
                },
                setSize: function(t, e) {
                    this.view.width = t, this.view.height = e
                },
                reset: function() {
                    this.target = null, this.view.x = 0, this.view.y = 0, this._shake.duration = 0, this.resetFX()
                },
                resetFX: function() {
                    this.fx && (this.fx.clear(), this.fx.alpha = 0), this._fxDuration = 0
                }
            }, n.Camera.prototype.constructor = n.Camera, Object.defineProperty(n.Camera.prototype, "x", {
                get: function() {
                    return this.view.x
                },
                set: function(t) {
                    this.view.x = t, this.bounds && this.checkBounds()
                }
            }), Object.defineProperty(n.Camera.prototype, "y", {
                get: function() {
                    return this.view.y
                },
                set: function(t) {
                    this.view.y = t, this.bounds && this.checkBounds()
                }
            }), Object.defineProperty(n.Camera.prototype, "position", {
                get: function() {
                    return this._position.set(this.view.x, this.view.y), this._position
                },
                set: function(t) {
                    void 0 !== t.x && (this.view.x = t.x), void 0 !== t.y && (this.view.y = t.y), this.bounds && this.checkBounds()
                }
            }), Object.defineProperty(n.Camera.prototype, "width", {
                get: function() {
                    return this.view.width
                },
                set: function(t) {
                    this.view.width = t
                }
            }), Object.defineProperty(n.Camera.prototype, "height", {
                get: function() {
                    return this.view.height
                },
                set: function(t) {
                    this.view.height = t
                }
            }), Object.defineProperty(n.Camera.prototype, "shakeIntensity", {
                get: function() {
                    return this._shake.intensity
                },
                set: function(t) {
                    this._shake.intensity = t
                }
            }), n.State = function() {
                this.game = null, this.key = "", this.add = null, this.make = null, this.camera = null, this.cache = null, this.input = null, this.load = null, this.math = null, this.sound = null, this.scale = null, this.stage = null, this.state = null, this.time = null, this.tweens = null, this.world = null, this.particles = null, this.physics = null, this.rnd = null
            }, n.State.prototype = {
                init: function() {},
                preload: function() {},
                loadUpdate: function() {},
                loadRender: function() {},
                create: function() {},
                update: function() {},
                preRender: function() {},
                render: function() {},
                resize: function() {},
                paused: function() {},
                resumed: function() {},
                pauseUpdate: function() {},
                shutdown: function() {}
            }, n.State.prototype.constructor = n.State, n.StateManager = function(t, e) {
                this.game = t, this.states = {}, this._pendingState = null, null != e && (this._pendingState = e), this._clearWorld = !1, this._clearCache = !1, this._created = !1, this._args = [], this.current = "", this.onStateChange = new n.Signal, this.onInitCallback = null, this.onPreloadCallback = null, this.onCreateCallback = null, this.onUpdateCallback = null, this.onRenderCallback = null, this.onResizeCallback = null, this.onPreRenderCallback = null, this.onLoadUpdateCallback = null, this.onLoadRenderCallback = null, this.onPausedCallback = null, this.onResumedCallback = null, this.onPauseUpdateCallback = null, this.onShutDownCallback = null
            }, n.StateManager.prototype = {
                boot: function() {
                    this.game.onPause.add(this.pause, this), this.game.onResume.add(this.resume, this), null !== this._pendingState && "string" != typeof this._pendingState && this.add("default", this._pendingState, !0)
                },
                add: function(t, e, i) {
                    var s;
                    return void 0 === i && (i = !1), e instanceof n.State ? s = e : "object" == typeof e ? (s = e).game = this.game : "function" == typeof e && (s = new e(this.game)), this.states[t] = s, i && (this.game.isBooted ? this.start(t) : this._pendingState = t), s
                },
                remove: function(t) {
                    this.current === t && (this.callbackContext = null, this.onInitCallback = null, this.onShutDownCallback = null, this.onPreloadCallback = null, this.onLoadRenderCallback = null, this.onLoadUpdateCallback = null, this.onCreateCallback = null, this.onUpdateCallback = null, this.onPreRenderCallback = null, this.onRenderCallback = null, this.onResizeCallback = null, this.onPausedCallback = null, this.onResumedCallback = null, this.onPauseUpdateCallback = null), delete this.states[t]
                },
                start: function(t, e, i) {
                    void 0 === e && (e = !0), void 0 === i && (i = !1), this.checkState(t) && (this._pendingState = t, this._clearWorld = e, this._clearCache = i, arguments.length > 3 && (this._args = Array.prototype.splice.call(arguments, 3)))
                },
                restart: function(t, e) {
                    void 0 === t && (t = !0), void 0 === e && (e = !1), this._pendingState = this.current, this._clearWorld = t, this._clearCache = e, arguments.length > 2 && (this._args = Array.prototype.slice.call(arguments, 2))
                },
                dummy: function() {},
                preUpdate: function() {
                    if (this._pendingState && this.game.isBooted) {
                        var t = this.current;
                        if (this.clearCurrentState(), this.setCurrentState(this._pendingState), this.onStateChange.dispatch(this.current, t), this.current !== this._pendingState) return;
                        this._pendingState = null, this.onPreloadCallback ? (this.game.load.reset(!0), this.onPreloadCallback.call(this.callbackContext, this.game), 0 === this.game.load.totalQueuedFiles() && 0 === this.game.load.totalQueuedPacks() ? this.loadComplete() : this.game.load.start()) : this.loadComplete()
                    }
                },
                clearCurrentState: function() {
                    this.current && (this.onShutDownCallback && this.onShutDownCallback.call(this.callbackContext, this.game), this.game.tweens.removeAll(), this.game.camera.reset(), this.game.input.reset(!0), this.game.physics.clear(), this.game.time.removeAll(), this.game.scale.reset(this._clearWorld), this.game.debug && this.game.debug.reset(), this._clearWorld && (this.game.world.shutdown(), this._clearCache && this.game.cache.destroy()))
                },
                checkState: function(t) {
                    return this.states[t] ? !!(this.states[t].preload || this.states[t].create || this.states[t].update || this.states[t].render) || (console.warn("Invalid Phaser State object given. Must contain at least a one of the required functions: preload, create, update or render"), !1) : (console.warn("Phaser.StateManager - No state found with the key: " + t), !1)
                },
                link: function(t) {
                    this.states[t].game = this.game, this.states[t].add = this.game.add, this.states[t].make = this.game.make, this.states[t].camera = this.game.camera, this.states[t].cache = this.game.cache, this.states[t].input = this.game.input, this.states[t].load = this.game.load, this.states[t].math = this.game.math, this.states[t].sound = this.game.sound, this.states[t].scale = this.game.scale, this.states[t].state = this, this.states[t].stage = this.game.stage, this.states[t].time = this.game.time, this.states[t].tweens = this.game.tweens, this.states[t].world = this.game.world, this.states[t].particles = this.game.particles, this.states[t].rnd = this.game.rnd, this.states[t].physics = this.game.physics, this.states[t].key = t
                },
                unlink: function(t) {
                    this.states[t] && (this.states[t].game = null, this.states[t].add = null, this.states[t].make = null, this.states[t].camera = null, this.states[t].cache = null, this.states[t].input = null, this.states[t].load = null, this.states[t].math = null, this.states[t].sound = null, this.states[t].scale = null, this.states[t].state = null, this.states[t].stage = null, this.states[t].time = null, this.states[t].tweens = null, this.states[t].world = null, this.states[t].particles = null, this.states[t].rnd = null, this.states[t].physics = null)
                },
                setCurrentState: function(t) {
                    this.callbackContext = this.states[t], this.link(t), this.onInitCallback = this.states[t].init || this.dummy, this.onPreloadCallback = this.states[t].preload || null, this.onLoadRenderCallback = this.states[t].loadRender || null, this.onLoadUpdateCallback = this.states[t].loadUpdate || null, this.onCreateCallback = this.states[t].create || null, this.onUpdateCallback = this.states[t].update || null, this.onPreRenderCallback = this.states[t].preRender || null, this.onRenderCallback = this.states[t].render || null, this.onResizeCallback = this.states[t].resize || null, this.onPausedCallback = this.states[t].paused || null, this.onResumedCallback = this.states[t].resumed || null, this.onPauseUpdateCallback = this.states[t].pauseUpdate || null, this.onShutDownCallback = this.states[t].shutdown || this.dummy, "" !== this.current && this.game.physics.reset(), this.current = t, this._created = !1, this.onInitCallback.apply(this.callbackContext, this._args), t === this._pendingState && (this._args = []), this.game._kickstart = !0
                },
                getCurrentState: function() {
                    return this.states[this.current]
                },
                loadComplete: function() {
                    !1 === this._created && this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game), !1 === this._created && this.onCreateCallback ? (this._created = !0, this.onCreateCallback.call(this.callbackContext, this.game)) : this._created = !0
                },
                pause: function() {
                    this._created && this.onPausedCallback && this.onPausedCallback.call(this.callbackContext, this.game)
                },
                resume: function() {
                    this._created && this.onResumedCallback && this.onResumedCallback.call(this.callbackContext, this.game)
                },
                update: function() {
                    this._created ? this.onUpdateCallback && this.onUpdateCallback.call(this.callbackContext, this.game) : this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game)
                },
                pauseUpdate: function() {
                    this._created ? this.onPauseUpdateCallback && this.onPauseUpdateCallback.call(this.callbackContext, this.game) : this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game)
                },
                preRender: function(t) {
                    this._created && this.onPreRenderCallback && this.onPreRenderCallback.call(this.callbackContext, this.game, t)
                },
                resize: function(t, e) {
                    this.onResizeCallback && this.onResizeCallback.call(this.callbackContext, t, e)
                },
                render: function() {
                    this._created ? this.onRenderCallback && (this.game.renderType === n.CANVAS ? (this.game.context.save(), this.game.context.setTransform(1, 0, 0, 1, 0, 0), this.onRenderCallback.call(this.callbackContext, this.game), this.game.context.restore()) : this.onRenderCallback.call(this.callbackContext, this.game)) : this.onLoadRenderCallback && this.onLoadRenderCallback.call(this.callbackContext, this.game)
                },
                destroy: function() {
                    this._clearWorld = !0, this._clearCache = !0, this.clearCurrentState(), this.callbackContext = null, this.onInitCallback = null, this.onShutDownCallback = null, this.onPreloadCallback = null, this.onLoadRenderCallback = null, this.onLoadUpdateCallback = null, this.onCreateCallback = null, this.onUpdateCallback = null, this.onRenderCallback = null, this.onPausedCallback = null, this.onResumedCallback = null, this.onPauseUpdateCallback = null, this.game = null, this.states = {}, this._pendingState = null, this.current = ""
                }
            }, n.StateManager.prototype.constructor = n.StateManager, Object.defineProperty(n.StateManager.prototype, "created", {
                get: function() {
                    return this._created
                }
            }), n.Signal = function() {}, n.Signal.prototype = {
                _bindings: null,
                _prevParams: null,
                memorize: !1,
                _shouldPropagate: !0,
                active: !0,
                _boundDispatch: !1,
                validateListener: function(t, e) {
                    if ("function" != typeof t) throw new Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}", e))
                },
                _registerListener: function(t, e, i, s, o) {
                    var r, a = this._indexOfListener(t, i);
                    if (-1 !== a) {
                        if ((r = this._bindings[a]).isOnce() !== e) throw new Error("You cannot add" + (e ? "" : "Once") + "() then add" + (e ? "Once" : "") + "() the same listener without removing the relationship first.")
                    } else r = new n.SignalBinding(this, t, e, i, s, o), this._addBinding(r);
                    return this.memorize && this._prevParams && r.execute(this._prevParams), r
                },
                _addBinding: function(t) {
                    this._bindings || (this._bindings = []);
                    var e = this._bindings.length;
                    do {
                        e--
                    } while (this._bindings[e] && t._priority <= this._bindings[e]._priority);
                    this._bindings.splice(e + 1, 0, t)
                },
                _indexOfListener: function(t, e) {
                    if (!this._bindings) return -1;
                    void 0 === e && (e = null);
                    for (var i, s = this._bindings.length; s--;)
                        if ((i = this._bindings[s])._listener === t && i.context === e) return s;
                    return -1
                },
                has: function(t, e) {
                    return -1 !== this._indexOfListener(t, e)
                },
                add: function(t, e, i) {
                    this.validateListener(t, "add");
                    var s = [];
                    if (arguments.length > 3)
                        for (var n = 3; n < arguments.length; n++) s.push(arguments[n]);
                    return this._registerListener(t, !1, e, i, s)
                },
                addOnce: function(t, e, i) {
                    this.validateListener(t, "addOnce");
                    var s = [];
                    if (arguments.length > 3)
                        for (var n = 3; n < arguments.length; n++) s.push(arguments[n]);
                    return this._registerListener(t, !0, e, i, s)
                },
                remove: function(t, e) {
                    this.validateListener(t, "remove");
                    var i = this._indexOfListener(t, e);
                    return -1 !== i && (this._bindings[i]._destroy(), this._bindings.splice(i, 1)), t
                },
                removeAll: function(t) {
                    if (void 0 === t && (t = null), this._bindings) {
                        for (var e = this._bindings.length; e--;) t ? this._bindings[e].context === t && (this._bindings[e]._destroy(), this._bindings.splice(e, 1)) : this._bindings[e]._destroy();
                        t || (this._bindings.length = 0)
                    }
                },
                getNumListeners: function() {
                    return this._bindings ? this._bindings.length : 0
                },
                halt: function() {
                    this._shouldPropagate = !1
                },
                dispatch: function() {
                    if (this.active && this._bindings) {
                        var t, e = Array.prototype.slice.call(arguments),
                            i = this._bindings.length;
                        if (this.memorize && (this._prevParams = e), i) {
                            t = this._bindings.slice(), this._shouldPropagate = !0;
                            do {
                                i--
                            } while (t[i] && this._shouldPropagate && !1 !== t[i].execute(e))
                        }
                    }
                },
                forget: function() {
                    this._prevParams && (this._prevParams = null)
                },
                dispose: function() {
                    this.removeAll(), this._bindings = null, this._prevParams && (this._prevParams = null)
                },
                toString: function() {
                    return "[Phaser.Signal active:" + this.active + " numListeners:" + this.getNumListeners() + "]"
                }
            }, Object.defineProperty(n.Signal.prototype, "boundDispatch", {
                get: function() {
                    var t = this;
                    return this._boundDispatch || (this._boundDispatch = function() {
                        return t.dispatch.apply(t, arguments)
                    })
                }
            }), n.Signal.prototype.constructor = n.Signal, n.SignalBinding = function(t, e, i, s, n, o) {
                this._listener = e, i && (this._isOnce = !0), null != s && (this.context = s), this._signal = t, n && (this._priority = n), o && o.length && (this._args = o)
            }, n.SignalBinding.prototype = {
                context: null,
                _isOnce: !1,
                _priority: 0,
                _args: null,
                callCount: 0,
                active: !0,
                params: null,
                execute: function(t) {
                    var e, i;
                    return this.active && this._listener && (i = this.params ? this.params.concat(t) : t, this._args && (i = i.concat(this._args)), e = this._listener.apply(this.context, i), this.callCount++, this._isOnce && this.detach()), e
                },
                detach: function() {
                    return this.isBound() ? this._signal.remove(this._listener, this.context) : null
                },
                isBound: function() {
                    return !!this._signal && !!this._listener
                },
                isOnce: function() {
                    return this._isOnce
                },
                getListener: function() {
                    return this._listener
                },
                getSignal: function() {
                    return this._signal
                },
                _destroy: function() {
                    delete this._signal, delete this._listener, delete this.context
                },
                toString: function() {
                    return "[Phaser.SignalBinding isOnce:" + this._isOnce + ", isBound:" + this.isBound() + ", active:" + this.active + "]"
                }
            }, n.SignalBinding.prototype.constructor = n.SignalBinding, n.Filter = function(t, e, i) {
                this.game = t, this.type = n.WEBGL_FILTER, this.passes = [this], this.shaders = [], this.dirty = !0, this.padding = 0, this.prevPoint = new n.Point;
                var s = new Date;
                if (this.uniforms = {
                        resolution: {
                            type: "2f",
                            value: {
                                x: 256,
                                y: 256
                            }
                        },
                        time: {
                            type: "1f",
                            value: 0
                        },
                        mouse: {
                            type: "2f",
                            value: {
                                x: 0,
                                y: 0
                            }
                        },
                        date: {
                            type: "4fv",
                            value: [s.getFullYear(), s.getMonth(), s.getDate(), 60 * s.getHours() * 60 + 60 * s.getMinutes() + s.getSeconds()]
                        },
                        sampleRate: {
                            type: "1f",
                            value: 44100
                        },
                        iChannel0: {
                            type: "sampler2D",
                            value: null,
                            textureData: {
                                repeat: !0
                            }
                        },
                        iChannel1: {
                            type: "sampler2D",
                            value: null,
                            textureData: {
                                repeat: !0
                            }
                        },
                        iChannel2: {
                            type: "sampler2D",
                            value: null,
                            textureData: {
                                repeat: !0
                            }
                        },
                        iChannel3: {
                            type: "sampler2D",
                            value: null,
                            textureData: {
                                repeat: !0
                            }
                        }
                    }, e)
                    for (var o in e) this.uniforms[o] = e[o];
                "string" == typeof i && (i = i.split("\n")), this.fragmentSrc = i || []
            }, n.Filter.prototype = {
                init: function() {},
                setResolution: function(t, e) {
                    this.uniforms.resolution.value.x = t, this.uniforms.resolution.value.y = e
                },
                update: function(t) {
                    if (t) {
                        var e = t.x / this.game.width,
                            i = 1 - t.y / this.game.height;
                        e === this.prevPoint.x && i === this.prevPoint.y || (this.uniforms.mouse.value.x = e.toFixed(2), this.uniforms.mouse.value.y = i.toFixed(2), this.prevPoint.set(e, i))
                    }
                    this.uniforms.time.value = this.game.time.totalElapsedSeconds()
                },
                addToWorld: function(t, e, i, s, n, o) {
                    void 0 === n && (n = 0), void 0 === o && (o = 0), null != i ? this.width = i : i = this.width, null != s ? this.height = s : s = this.height;
                    var r = this.game.add.image(t, e, "__default");
                    return r.width = i, r.height = s, r.anchor.set(n, o), r.filters = [this], r
                },
                syncUniforms: function() {
                    for (var t = 0; t < this.shaders.length; t++) this.shaders[t].dirty = !0
                },
                destroy: function() {
                    this.passes.length = 0, this.shaders.length = 0, this.fragmentSrc.length = 0, this.game = null, this.uniforms = null, this.prevPoint = null
                }
            }, n.Filter.prototype.constructor = n.Filter, Object.defineProperty(n.Filter.prototype, "width", {
                get: function() {
                    return this.uniforms.resolution.value.x
                },
                set: function(t) {
                    this.uniforms.resolution.value.x = t
                }
            }), Object.defineProperty(n.Filter.prototype, "height", {
                get: function() {
                    return this.uniforms.resolution.value.y
                },
                set: function(t) {
                    this.uniforms.resolution.value.y = t
                }
            }), n.Plugin = function(t, e) {
                void 0 === e && (e = null), this.game = t, this.parent = e, this.active = !1, this.visible = !1, this.hasPreUpdate = !1, this.hasUpdate = !1, this.hasPostUpdate = !1, this.hasRender = !1, this.hasPostRender = !1
            }, n.Plugin.prototype = {
                preUpdate: function() {},
                update: function() {},
                render: function() {},
                postRender: function() {},
                destroy: function() {
                    this.game = null, this.parent = null, this.active = !1, this.visible = !1
                }
            }, n.Plugin.prototype.constructor = n.Plugin, n.PluginManager = function(t) {
                this.game = t, this.plugins = [], this._len = 0, this._i = 0
            }, n.PluginManager.prototype = {
                add: function(t) {
                    var e = Array.prototype.slice.call(arguments, 1),
                        i = !1;
                    return "function" == typeof t ? t = new t(this.game, this) : (t.game = this.game, t.parent = this), "function" == typeof t.preUpdate && (t.hasPreUpdate = !0, i = !0), "function" == typeof t.update && (t.hasUpdate = !0, i = !0), "function" == typeof t.postUpdate && (t.hasPostUpdate = !0, i = !0), "function" == typeof t.render && (t.hasRender = !0, i = !0), "function" == typeof t.postRender && (t.hasPostRender = !0, i = !0), i ? ((t.hasPreUpdate || t.hasUpdate || t.hasPostUpdate) && (t.active = !0), (t.hasRender || t.hasPostRender) && (t.visible = !0), this._len = this.plugins.push(t), "function" == typeof t.init && t.init.apply(t, e), t) : null
                },
                remove: function(t, e) {
                    for (void 0 === e && (e = !0), this._i = this._len; this._i--;)
                        if (this.plugins[this._i] === t) return e && t.destroy(), this.plugins.splice(this._i, 1), void this._len--
                },
                removeAll: function() {
                    for (this._i = this._len; this._i--;) this.plugins[this._i].destroy();
                    this.plugins.length = 0, this._len = 0
                },
                preUpdate: function() {
                    for (this._i = this._len; this._i--;) this.plugins[this._i].active && this.plugins[this._i].hasPreUpdate && this.plugins[this._i].preUpdate()
                },
                update: function() {
                    for (this._i = this._len; this._i--;) this.plugins[this._i].active && this.plugins[this._i].hasUpdate && this.plugins[this._i].update()
                },
                postUpdate: function() {
                    for (this._i = this._len; this._i--;) this.plugins[this._i].active && this.plugins[this._i].hasPostUpdate && this.plugins[this._i].postUpdate()
                },
                render: function() {
                    for (this._i = this._len; this._i--;) this.plugins[this._i].visible && this.plugins[this._i].hasRender && this.plugins[this._i].render()
                },
                postRender: function() {
                    for (this._i = this._len; this._i--;) this.plugins[this._i].visible && this.plugins[this._i].hasPostRender && this.plugins[this._i].postRender()
                },
                destroy: function() {
                    this.removeAll(), this.game = null
                }
            }, n.PluginManager.prototype.constructor = n.PluginManager, n.Stage = function(t) {
                this.game = t, PIXI.DisplayObjectContainer.call(this), this.name = "_stage_root", this.disableVisibilityChange = !1, this.exists = !0, this.worldTransform = new PIXI.Matrix, this.stage = this, this.currentRenderOrderID = 0, this._hiddenVar = "hidden", this._onChange = null, this._bgColor = {
                    r: 0,
                    g: 0,
                    b: 0,
                    a: 0,
                    color: 0,
                    rgba: "#000000"
                }, this.game.transparent || (this._bgColor.a = 1), t.config && this.parseConfig(t.config)
            }, n.Stage.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), n.Stage.prototype.constructor = n.Stage, n.Stage.prototype.parseConfig = function(t) {
                t.disableVisibilityChange && (this.disableVisibilityChange = t.disableVisibilityChange), t.backgroundColor && this.setBackgroundColor(t.backgroundColor)
            }, n.Stage.prototype.boot = function() {
                n.DOM.getOffset(this.game.canvas, this.offset), n.Canvas.setUserSelect(this.game.canvas, "none"), n.Canvas.setTouchAction(this.game.canvas, "none"), this.checkVisibility()
            }, n.Stage.prototype.preUpdate = function() {
                this.currentRenderOrderID = 0;
                for (var t = 0; t < this.children.length; t++) this.children[t].preUpdate()
            }, n.Stage.prototype.update = function() {
                for (var t = this.children.length; t--;) this.children[t].update()
            }, n.Stage.prototype.postUpdate = function() {
                this.game.camera.update(), this.game.camera.target && (this.game.camera.target.postUpdate(), this.updateTransform(), this.game.camera.updateTarget());
                for (var t = 0; t < this.children.length; t++) this.children[t].postUpdate();
                this.updateTransform()
            }, n.Stage.prototype.updateTransform = function() {
                this.worldAlpha = 1;
                for (var t = 0; t < this.children.length; t++) this.children[t].updateTransform()
            }, n.Stage.prototype.checkVisibility = function() {
                void 0 !== document.hidden ? this._hiddenVar = "visibilitychange" : void 0 !== document.webkitHidden ? this._hiddenVar = "webkitvisibilitychange" : void 0 !== document.mozHidden ? this._hiddenVar = "mozvisibilitychange" : void 0 !== document.msHidden ? this._hiddenVar = "msvisibilitychange" : this._hiddenVar = null;
                var t = this;
                this._onChange = function(e) {
                    return t.visibilityChange(e)
                }, this._hiddenVar && document.addEventListener(this._hiddenVar, this._onChange, !1), window.onblur = this._onChange, window.onfocus = this._onChange, window.onpagehide = this._onChange, window.onpageshow = this._onChange, this.game.device.cocoonJSApp && (CocoonJS.App.onSuspended.addEventListener(function() {
                    n.Stage.prototype.visibilityChange.call(t, {
                        type: "pause"
                    })
                }), CocoonJS.App.onActivated.addEventListener(function() {
                    n.Stage.prototype.visibilityChange.call(t, {
                        type: "resume"
                    })
                }))
            }, n.Stage.prototype.visibilityChange = function(t) {
                "pagehide" !== t.type && "blur" !== t.type && "pageshow" !== t.type && "focus" !== t.type ? this.disableVisibilityChange || (document.hidden || document.mozHidden || document.msHidden || document.webkitHidden || "pause" === t.type ? this.game.gamePaused(t) : this.game.gameResumed(t)) : "pagehide" === t.type || "blur" === t.type ? this.game.focusLoss(t) : "pageshow" !== t.type && "focus" !== t.type || this.game.focusGain(t)
            }, n.Stage.prototype.setBackgroundColor = function(t) {
                this.game.transparent || (n.Color.valueToColor(t, this._bgColor), n.Color.updateColor(this._bgColor), this._bgColor.r /= 255, this._bgColor.g /= 255, this._bgColor.b /= 255, this._bgColor.a = 1)
            }, n.Stage.prototype.destroy = function() {
                this._hiddenVar && document.removeEventListener(this._hiddenVar, this._onChange, !1), window.onpagehide = null, window.onpageshow = null, window.onblur = null, window.onfocus = null
            }, Object.defineProperty(n.Stage.prototype, "backgroundColor", {
                get: function() {
                    return this._bgColor.color
                },
                set: function(t) {
                    this.setBackgroundColor(t)
                }
            }), Object.defineProperty(n.Stage.prototype, "smoothed", {
                get: function() {
                    return PIXI.scaleModes.DEFAULT === PIXI.scaleModes.LINEAR
                },
                set: function(t) {
                    PIXI.scaleModes.DEFAULT = t ? PIXI.scaleModes.LINEAR : PIXI.scaleModes.NEAREST
                }
            }), n.Group = function(t, e, i, s, o, r) {
                void 0 === s && (s = !1), void 0 === o && (o = !1), void 0 === r && (r = n.Physics.ARCADE), this.game = t, void 0 === e && (e = t.world), this.name = i || "group", this.z = 0, PIXI.DisplayObjectContainer.call(this), s ? (this.game.stage.addChild(this), this.z = this.game.stage.children.length) : e && (e.addChild(this), this.z = e.children.length), this.type = n.GROUP, this.physicsType = n.GROUP, this.alive = !0, this.exists = !0, this.ignoreDestroy = !1, this.pendingDestroy = !1, this.classType = n.Sprite, this.cursor = null, this.inputEnableChildren = !1, this.onChildInputDown = new n.Signal, this.onChildInputUp = new n.Signal, this.onChildInputOver = new n.Signal, this.onChildInputOut = new n.Signal, this.enableBody = o, this.enableBodyDebug = !1, this.physicsBodyType = r, this.physicsSortDirection = null, this.onDestroy = new n.Signal, this.cursorIndex = 0, this.fixedToCamera = !1, this.cameraOffset = new n.Point, this.hash = [], this._sortProperty = "z"
            }, n.Group.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), n.Group.prototype.constructor = n.Group, n.Group.RETURN_NONE = 0, n.Group.RETURN_TOTAL = 1, n.Group.RETURN_CHILD = 2, n.Group.RETURN_ALL = 3, n.Group.SORT_ASCENDING = -1, n.Group.SORT_DESCENDING = 1, n.Group.prototype.add = function(t, e, i) {
                return void 0 === e && (e = !1), t.parent === this ? t : (t.body && t.parent && t.parent.hash && t.parent.removeFromHash(t), void 0 === i ? (t.z = this.children.length, this.addChild(t)) : (this.addChildAt(t, i), this.updateZ()), this.enableBody && t.hasOwnProperty("body") && null === t.body ? this.game.physics.enable(t, this.physicsBodyType) : t.body && this.addToHash(t), !this.inputEnableChildren || t.input && !t.inputEnabled || (t.inputEnabled = !0), !e && t.events && t.events.onAddedToGroup$dispatch(t, this), null === this.cursor && (this.cursor = t), t)
            }, n.Group.prototype.addAt = function(t, e, i) {
                return this.add(t, i, e)
            }, n.Group.prototype.addToHash = function(t) {
                return t.parent === this && -1 === this.hash.indexOf(t) && (this.hash.push(t), !0)
            }, n.Group.prototype.removeFromHash = function(t) {
                if (t) {
                    var e = this.hash.indexOf(t);
                    if (-1 !== e) return this.hash.splice(e, 1), !0
                }
                return !1
            }, n.Group.prototype.addMultiple = function(t, e) {
                if (t instanceof n.Group) t.moveAll(this, e);
                else if (Array.isArray(t))
                    for (var i = 0; i < t.length; i++) this.add(t[i], e);
                return t
            }, n.Group.prototype.getAt = function(t) {
                return t < 0 || t >= this.children.length ? -1 : this.getChildAt(t)
            }, n.Group.prototype.create = function(t, e, i, s, n, o) {
                void 0 === n && (n = !0);
                var r = new this.classType(this.game, t, e, i, s);
                return r.exists = n, r.visible = n, r.alive = n, this.add(r, !1, o)
            }, n.Group.prototype.createMultiple = function(t, e, i, s) {
                void 0 === i && (i = 0), void 0 === s && (s = !1), Array.isArray(e) || (e = [e]), Array.isArray(i) || (i = [i]);
                var n = this,
                    o = [];
                return e.forEach(function(e) {
                    i.forEach(function(i) {
                        for (var r = 0; r < t; r++) o.push(n.create(0, 0, e, i, s))
                    })
                }), o
            }, n.Group.prototype.updateZ = function() {
                for (var t = this.children.length; t--;) this.children[t].z = t
            }, n.Group.prototype.align = function(t, e, i, s, o, r) {
                if (void 0 === o && (o = n.TOP_LEFT), void 0 === r && (r = 0), 0 === this.children.length || r > this.children.length || -1 === t && -1 === e) return !1;
                for (var a = new n.Rectangle(0, 0, i, s), h = t * i, l = e * s, c = r; c < this.children.length; c++) {
                    var u = this.children[c];
                    if (u.alignIn)
                        if (u.alignIn(a, o), -1 === t) a.y += s, a.y === l && (a.x += i, a.y = 0);
                        else if (-1 === e) a.x += i, a.x === h && (a.x = 0, a.y += s);
                    else if (a.x += i, a.x === h && (a.x = 0, a.y += s, a.y === l)) return !0
                }
                return !0
            }, n.Group.prototype.resetCursor = function(t) {
                if (void 0 === t && (t = 0), t > this.children.length - 1 && (t = 0), this.cursor) return this.cursorIndex = t, this.cursor = this.children[this.cursorIndex], this.cursor
            }, n.Group.prototype.next = function() {
                if (this.cursor) return this.cursorIndex >= this.children.length - 1 ? this.cursorIndex = 0 : this.cursorIndex++, this.cursor = this.children[this.cursorIndex], this.cursor
            }, n.Group.prototype.previous = function() {
                if (this.cursor) return 0 === this.cursorIndex ? this.cursorIndex = this.children.length - 1 : this.cursorIndex--, this.cursor = this.children[this.cursorIndex], this.cursor
            }, n.Group.prototype.swap = function(t, e) {
                this.swapChildren(t, e), this.updateZ()
            }, n.Group.prototype.bringToTop = function(t) {
                return t.parent === this && this.getIndex(t) < this.children.length && (this.remove(t, !1, !0), this.add(t, !0)), t
            }, n.Group.prototype.sendToBack = function(t) {
                return t.parent === this && this.getIndex(t) > 0 && (this.remove(t, !1, !0), this.addAt(t, 0, !0)), t
            }, n.Group.prototype.moveUp = function(t) {
                if (t.parent === this && this.getIndex(t) < this.children.length - 1) {
                    var e = this.getIndex(t),
                        i = this.getAt(e + 1);
                    i && this.swap(t, i)
                }
                return t
            }, n.Group.prototype.moveDown = function(t) {
                if (t.parent === this && this.getIndex(t) > 0) {
                    var e = this.getIndex(t),
                        i = this.getAt(e - 1);
                    i && this.swap(t, i)
                }
                return t
            }, n.Group.prototype.xy = function(t, e, i) {
                if (t < 0 || t > this.children.length) return -1;
                this.getChildAt(t).x = e, this.getChildAt(t).y = i
            }, n.Group.prototype.reverse = function() {
                this.children.reverse(), this.updateZ()
            }, n.Group.prototype.getIndex = function(t) {
                return this.children.indexOf(t)
            }, n.Group.prototype.getByName = function(t) {
                for (var e = 0; e < this.children.length; e++)
                    if (this.children[e].name === t) return this.children[e];
                return null
            }, n.Group.prototype.replace = function(t, e) {
                var i = this.getIndex(t);
                if (-1 !== i) return e.parent && (e.parent instanceof n.Group ? e.parent.remove(e) : e.parent.removeChild(e)), this.remove(t), this.addAt(e, i), t
            }, n.Group.prototype.hasProperty = function(t, e) {
                var i = e.length;
                return 1 === i && e[0] in t || 2 === i && e[0] in t && e[1] in t[e[0]] || 3 === i && e[0] in t && e[1] in t[e[0]] && e[2] in t[e[0]][e[1]] || 4 === i && e[0] in t && e[1] in t[e[0]] && e[2] in t[e[0]][e[1]] && e[3] in t[e[0]][e[1]][e[2]]
            }, n.Group.prototype.setProperty = function(t, e, i, s, n) {
                if (void 0 === n && (n = !1), s = s || 0, !this.hasProperty(t, e) && (!n || s > 0)) return !1;
                var o = e.length;
                return 1 === o ? 0 === s ? t[e[0]] = i : 1 === s ? t[e[0]] += i : 2 === s ? t[e[0]] -= i : 3 === s ? t[e[0]] *= i : 4 === s && (t[e[0]] /= i) : 2 === o ? 0 === s ? t[e[0]][e[1]] = i : 1 === s ? t[e[0]][e[1]] += i : 2 === s ? t[e[0]][e[1]] -= i : 3 === s ? t[e[0]][e[1]] *= i : 4 === s && (t[e[0]][e[1]] /= i) : 3 === o ? 0 === s ? t[e[0]][e[1]][e[2]] = i : 1 === s ? t[e[0]][e[1]][e[2]] += i : 2 === s ? t[e[0]][e[1]][e[2]] -= i : 3 === s ? t[e[0]][e[1]][e[2]] *= i : 4 === s && (t[e[0]][e[1]][e[2]] /= i) : 4 === o && (0 === s ? t[e[0]][e[1]][e[2]][e[3]] = i : 1 === s ? t[e[0]][e[1]][e[2]][e[3]] += i : 2 === s ? t[e[0]][e[1]][e[2]][e[3]] -= i : 3 === s ? t[e[0]][e[1]][e[2]][e[3]] *= i : 4 === s && (t[e[0]][e[1]][e[2]][e[3]] /= i)), !0
            }, n.Group.prototype.checkProperty = function(t, e, i, s) {
                return void 0 === s && (s = !1), !(!n.Utils.getProperty(t, e) && s) && n.Utils.getProperty(t, e) === i
            }, n.Group.prototype.set = function(t, e, i, s, n, o, r) {
                if (void 0 === r && (r = !1), e = e.split("."), void 0 === s && (s = !1), void 0 === n && (n = !1), (!1 === s || s && t.alive) && (!1 === n || n && t.visible)) return this.setProperty(t, e, i, o, r)
            }, n.Group.prototype.setAll = function(t, e, i, s, n, o) {
                void 0 === i && (i = !1), void 0 === s && (s = !1), void 0 === o && (o = !1), t = t.split("."), n = n || 0;
                for (var r = 0; r < this.children.length; r++)(!i || i && this.children[r].alive) && (!s || s && this.children[r].visible) && this.setProperty(this.children[r], t, e, n, o)
            }, n.Group.prototype.setAllChildren = function(t, e, i, s, o, r) {
                void 0 === i && (i = !1), void 0 === s && (s = !1), void 0 === r && (r = !1), o = o || 0;
                for (var a = 0; a < this.children.length; a++)(!i || i && this.children[a].alive) && (!s || s && this.children[a].visible) && (this.children[a] instanceof n.Group ? this.children[a].setAllChildren(t, e, i, s, o, r) : this.setProperty(this.children[a], t.split("."), e, o, r))
            }, n.Group.prototype.checkAll = function(t, e, i, s, n) {
                void 0 === i && (i = !1), void 0 === s && (s = !1), void 0 === n && (n = !1);
                for (var o = 0; o < this.children.length; o++)
                    if ((!i || i && this.children[o].alive) && (!s || s && this.children[o].visible) && !this.checkProperty(this.children[o], t, e, n)) return !1;
                return !0
            }, n.Group.prototype.addAll = function(t, e, i, s) {
                this.setAll(t, e, i, s, 1)
            }, n.Group.prototype.subAll = function(t, e, i, s) {
                this.setAll(t, e, i, s, 2)
            }, n.Group.prototype.multiplyAll = function(t, e, i, s) {
                this.setAll(t, e, i, s, 3)
            }, n.Group.prototype.divideAll = function(t, e, i, s) {
                this.setAll(t, e, i, s, 4)
            }, n.Group.prototype.callAllExists = function(t, e) {
                var i;
                if (arguments.length > 2) {
                    i = [];
                    for (var s = 2; s < arguments.length; s++) i.push(arguments[s])
                }
                for (s = 0; s < this.children.length; s++) this.children[s].exists === e && this.children[s][t] && this.children[s][t].apply(this.children[s], i)
            }, n.Group.prototype.callbackFromArray = function(t, e, i) {
                if (1 === i) {
                    if (t[e[0]]) return t[e[0]]
                } else if (2 === i) {
                    if (t[e[0]][e[1]]) return t[e[0]][e[1]]
                } else if (3 === i) {
                    if (t[e[0]][e[1]][e[2]]) return t[e[0]][e[1]][e[2]]
                } else if (4 === i) {
                    if (t[e[0]][e[1]][e[2]][e[3]]) return t[e[0]][e[1]][e[2]][e[3]]
                } else if (t[e]) return t[e];
                return !1
            }, n.Group.prototype.callAll = function(t, e) {
                if (void 0 !== t) {
                    var i, s = (t = t.split(".")).length;
                    if (null == e || "" === e) e = null;
                    else if ("string" == typeof e) var n = (e = e.split(".")).length;
                    if (arguments.length > 2) {
                        i = [];
                        for (var o = 2; o < arguments.length; o++) i.push(arguments[o])
                    }
                    var r = null,
                        a = null;
                    for (o = 0; o < this.children.length; o++) r = this.callbackFromArray(this.children[o], t, s), e && r ? (a = this.callbackFromArray(this.children[o], e, n), r && r.apply(a, i)) : r && r.apply(this.children[o], i)
                }
            }, n.Group.prototype.preUpdate = function() {
                if (this.pendingDestroy) return this.destroy(), !1;
                if (!this.exists || !this.parent.exists) return this.renderOrderID = -1, !1;
                for (var t = 0; t < this.children.length; t++) this.children[t].preUpdate();
                return !0
            }, n.Group.prototype.update = function() {
                for (var t = this.children.length; t--;) this.children[t].update()
            }, n.Group.prototype.postUpdate = function() {
                this.fixedToCamera && (this.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, this.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y);
                for (var t = 0; t < this.children.length; t++) this.children[t].postUpdate()
            }, n.Group.prototype.filter = function(t, e) {
                for (var i = -1, s = this.children.length, o = []; ++i < s;) {
                    var r = this.children[i];
                    (!e || e && r.exists) && t(r, i, this.children) && o.push(r)
                }
                return new n.ArraySet(o)
            }, n.Group.prototype.forEach = function(t, e, i) {
                if (void 0 === i && (i = !1), arguments.length <= 3)
                    for (var s = 0; s < this.children.length; s++)(!i || i && this.children[s].exists) && t.call(e, this.children[s]);
                else {
                    var n = [null];
                    for (s = 3; s < arguments.length; s++) n.push(arguments[s]);
                    for (s = 0; s < this.children.length; s++)(!i || i && this.children[s].exists) && (n[0] = this.children[s], t.apply(e, n))
                }
            }, n.Group.prototype.forEachExists = function(t, e) {
                var i;
                if (arguments.length > 2) {
                    i = [null];
                    for (var s = 2; s < arguments.length; s++) i.push(arguments[s])
                }
                this.iterate("exists", !0, n.Group.RETURN_TOTAL, t, e, i)
            }, n.Group.prototype.forEachAlive = function(t, e) {
                var i;
                if (arguments.length > 2) {
                    i = [null];
                    for (var s = 2; s < arguments.length; s++) i.push(arguments[s])
                }
                this.iterate("alive", !0, n.Group.RETURN_TOTAL, t, e, i)
            }, n.Group.prototype.forEachDead = function(t, e) {
                var i;
                if (arguments.length > 2) {
                    i = [null];
                    for (var s = 2; s < arguments.length; s++) i.push(arguments[s])
                }
                this.iterate("alive", !1, n.Group.RETURN_TOTAL, t, e, i)
            }, n.Group.prototype.sort = function(t, e) {
                this.children.length < 2 || (void 0 === t && (t = "z"), void 0 === e && (e = n.Group.SORT_ASCENDING), this._sortProperty = t, e === n.Group.SORT_ASCENDING ? this.children.sort(this.ascendingSortHandler.bind(this)) : this.children.sort(this.descendingSortHandler.bind(this)), this.updateZ())
            }, n.Group.prototype.customSort = function(t, e) {
                this.children.length < 2 || (this.children.sort(t.bind(e)), this.updateZ())
            }, n.Group.prototype.ascendingSortHandler = function(t, e) {
                return t[this._sortProperty] < e[this._sortProperty] ? -1 : t[this._sortProperty] > e[this._sortProperty] ? 1 : t.z < e.z ? -1 : 1
            }, n.Group.prototype.descendingSortHandler = function(t, e) {
                return t[this._sortProperty] < e[this._sortProperty] ? 1 : t[this._sortProperty] > e[this._sortProperty] ? -1 : 0
            }, n.Group.prototype.iterate = function(t, e, i, s, o, r) {
                if (0 === this.children.length) {
                    if (i === n.Group.RETURN_TOTAL) return 0;
                    if (i === n.Group.RETURN_ALL) return []
                }
                var a = 0;
                if (i === n.Group.RETURN_ALL) var h = [];
                for (var l = 0; l < this.children.length; l++)
                    if (this.children[l][t] === e) {
                        if (a++, s && (r ? (r[0] = this.children[l], s.apply(o, r)) : s.call(o, this.children[l])), i === n.Group.RETURN_CHILD) return this.children[l];
                        i === n.Group.RETURN_ALL && h.push(this.children[l])
                    } return i === n.Group.RETURN_TOTAL ? a : i === n.Group.RETURN_ALL ? h : null
            }, n.Group.prototype.getFirstExists = function(t, e, i, s, o, r) {
                void 0 === e && (e = !1), "boolean" != typeof t && (t = !0);
                var a = this.iterate("exists", t, n.Group.RETURN_CHILD);
                return null === a && e ? this.create(i, s, o, r) : this.resetChild(a, i, s, o, r)
            }, n.Group.prototype.getFirstAlive = function(t, e, i, s, o) {
                void 0 === t && (t = !1);
                var r = this.iterate("alive", !0, n.Group.RETURN_CHILD);
                return null === r && t ? this.create(e, i, s, o) : this.resetChild(r, e, i, s, o)
            }, n.Group.prototype.getFirstDead = function(t, e, i, s, o) {
                void 0 === t && (t = !1);
                var r = this.iterate("alive", !1, n.Group.RETURN_CHILD);
                return null === r && t ? this.create(e, i, s, o) : this.resetChild(r, e, i, s, o)
            }, n.Group.prototype.resetChild = function(t, e, i, s, n) {
                return null === t ? null : (void 0 === e && (e = null), void 0 === i && (i = null), null !== e && null !== i && t.reset(e, i), void 0 !== s && t.loadTexture(s, n), t)
            }, n.Group.prototype.getTop = function() {
                if (this.children.length > 0) return this.children[this.children.length - 1]
            }, n.Group.prototype.getBottom = function() {
                if (this.children.length > 0) return this.children[0]
            }, n.Group.prototype.getClosestTo = function(t, e, i) {
                for (var s = Number.MAX_VALUE, o = 0, r = null, a = 0; a < this.children.length; a++) {
                    var h = this.children[a];
                    h.exists && (o = Math.abs(n.Point.distance(t, h))) < s && (!e || e.call(i, h, o)) && (s = o, r = h)
                }
                return r
            }, n.Group.prototype.getFurthestFrom = function(t, e, i) {
                for (var s = 0, o = 0, r = null, a = 0; a < this.children.length; a++) {
                    var h = this.children[a];
                    h.exists && (o = Math.abs(n.Point.distance(t, h))) > s && (!e || e.call(i, h, o)) && (s = o, r = h)
                }
                return r
            }, n.Group.prototype.countLiving = function() {
                return this.iterate("alive", !0, n.Group.RETURN_TOTAL)
            }, n.Group.prototype.countDead = function() {
                return this.iterate("alive", !1, n.Group.RETURN_TOTAL)
            }, n.Group.prototype.getRandom = function(t, e) {
                return void 0 === t && (t = 0), void 0 === e && (e = this.children.length), 0 === e ? null : n.ArrayUtils.getRandomItem(this.children, t, e)
            }, n.Group.prototype.getRandomExists = function(t, e) {
                var i = this.getAll("exists", !0, t, e);
                return this.game.rnd.pick(i)
            }, n.Group.prototype.getAll = function(t, e, i, s) {
                void 0 === i && (i = 0), void 0 === s && (s = this.children.length);
                for (var n = [], o = i; o < s; o++) {
                    var r = this.children[o];
                    t && r[t] === e && n.push(r)
                }
                return n
            }, n.Group.prototype.remove = function(t, e, i) {
                if (void 0 === e && (e = !1), void 0 === i && (i = !1), 0 === this.children.length || -1 === this.children.indexOf(t)) return !1;
                i || !t.events || t.destroyPhase || t.events.onRemovedFromGroup$dispatch(t, this);
                var s = this.removeChild(t);
                return this.removeFromHash(t), this.updateZ(), this.cursor === t && this.next(), e && s && s.destroy(!0), !0
            }, n.Group.prototype.moveAll = function(t, e) {
                if (void 0 === e && (e = !1), this.children.length > 0 && t instanceof n.Group) {
                    do {
                        t.add(this.children[0], e)
                    } while (this.children.length > 0);
                    this.hash = [], this.cursor = null
                }
                return t
            }, n.Group.prototype.removeAll = function(t, e, i) {
                if (void 0 === t && (t = !1), void 0 === e && (e = !1), void 0 === i && (i = !1), 0 !== this.children.length) {
                    do {
                        !e && this.children[0].events && this.children[0].events.onRemovedFromGroup$dispatch(this.children[0], this);
                        var s = this.removeChild(this.children[0]);
                        this.removeFromHash(s), t && s && s.destroy(!0, i)
                    } while (this.children.length > 0);
                    this.hash = [], this.cursor = null
                }
            }, n.Group.prototype.removeBetween = function(t, e, i, s) {
                if (void 0 === e && (e = this.children.length - 1), void 0 === i && (i = !1), void 0 === s && (s = !1), 0 !== this.children.length) {
                    if (t > e || t < 0 || e > this.children.length) return !1;
                    for (var n = e; n >= t;) {
                        !s && this.children[n].events && this.children[n].events.onRemovedFromGroup$dispatch(this.children[n], this);
                        var o = this.removeChild(this.children[n]);
                        this.removeFromHash(o), i && o && o.destroy(!0), this.cursor === this.children[n] && (this.cursor = null), n--
                    }
                    this.updateZ()
                }
            }, n.Group.prototype.destroy = function(t, e) {
                null === this.game || this.ignoreDestroy || (void 0 === t && (t = !0), void 0 === e && (e = !1), this.onDestroy.dispatch(this, t, e), this.removeAll(t), this.cursor = null, this.filters = null, this.pendingDestroy = !1, e || (this.parent && this.parent.removeChild(this), this.game = null, this.exists = !1))
            }, Object.defineProperty(n.Group.prototype, "total", {
                get: function() {
                    return this.iterate("exists", !0, n.Group.RETURN_TOTAL)
                }
            }), Object.defineProperty(n.Group.prototype, "length", {
                get: function() {
                    return this.children.length
                }
            }), Object.defineProperty(n.Group.prototype, "angle", {
                get: function() {
                    return n.Math.radToDeg(this.rotation)
                },
                set: function(t) {
                    this.rotation = n.Math.degToRad(t)
                }
            }), Object.defineProperty(n.Group.prototype, "centerX", {
                get: function() {
                    return this.getBounds(this.parent).centerX
                },
                set: function(t) {
                    var e = this.getBounds(this.parent),
                        i = this.x - e.x;
                    this.x = t + i - e.halfWidth
                }
            }), Object.defineProperty(n.Group.prototype, "centerY", {
                get: function() {
                    return this.getBounds(this.parent).centerY
                },
                set: function(t) {
                    var e = this.getBounds(this.parent),
                        i = this.y - e.y;
                    this.y = t + i - e.halfHeight
                }
            }), Object.defineProperty(n.Group.prototype, "left", {
                get: function() {
                    return this.getBounds(this.parent).left
                },
                set: function(t) {
                    var e = this.getBounds(this.parent),
                        i = this.x - e.x;
                    this.x = t + i
                }
            }), Object.defineProperty(n.Group.prototype, "right", {
                get: function() {
                    return this.getBounds(this.parent).right
                },
                set: function(t) {
                    var e = this.getBounds(this.parent),
                        i = this.x - e.x;
                    this.x = t + i - e.width
                }
            }), Object.defineProperty(n.Group.prototype, "top", {
                get: function() {
                    return this.getBounds(this.parent).top
                },
                set: function(t) {
                    var e = this.getBounds(this.parent),
                        i = this.y - e.y;
                    this.y = t + i
                }
            }), Object.defineProperty(n.Group.prototype, "bottom", {
                get: function() {
                    return this.getBounds(this.parent).bottom
                },
                set: function(t) {
                    var e = this.getBounds(this.parent),
                        i = this.y - e.y;
                    this.y = t + i - e.height
                }
            }), n.World = function(t) {
                n.Group.call(this, t, null, "__world", !1), this.bounds = new n.Rectangle(0, 0, t.width, t.height), this.camera = null, this._definedSize = !1, this._width = t.width, this._height = t.height, this.game.state.onStateChange.add(this.stateChange, this)
            }, n.World.prototype = Object.create(n.Group.prototype), n.World.prototype.constructor = n.World, n.World.prototype.boot = function() {
                this.camera = new n.Camera(this.game, 0, 0, 0, this.game.width, this.game.height), this.game.stage.addChild(this), this.camera.boot()
            }, n.World.prototype.stateChange = function() {
                this.x = 0, this.y = 0, this.camera.reset()
            }, n.World.prototype.setBounds = function(t, e, i, s) {
                this._definedSize = !0, this._width = i, this._height = s, this.bounds.setTo(t, e, i, s), this.x = t, this.y = e, this.camera.bounds && this.camera.bounds.setTo(t, e, Math.max(i, this.game.width), Math.max(s, this.game.height)), this.game.physics.setBoundsToWorld()
            }, n.World.prototype.resize = function(t, e) {
                this._definedSize && (t < this._width && (t = this._width), e < this._height && (e = this._height)), this.bounds.width = t, this.bounds.height = e, this.game.camera.setBoundsToWorld(), this.game.physics.setBoundsToWorld()
            }, n.World.prototype.shutdown = function() {
                this.destroy(!0, !0)
            }, n.World.prototype.wrap = function(t, e, i, s, n) {
                void 0 === e && (e = 0), void 0 === i && (i = !1), void 0 === s && (s = !0), void 0 === n && (n = !0), i ? (t.getBounds(), s && (t.x + t._currentBounds.width < this.bounds.x ? t.x = this.bounds.right : t.x > this.bounds.right && (t.x = this.bounds.left)), n && (t.y + t._currentBounds.height < this.bounds.top ? t.y = this.bounds.bottom : t.y > this.bounds.bottom && (t.y = this.bounds.top))) : (s && t.x + e < this.bounds.x ? t.x = this.bounds.right + e : s && t.x - e > this.bounds.right && (t.x = this.bounds.left - e), n && t.y + e < this.bounds.top ? t.y = this.bounds.bottom + e : n && t.y - e > this.bounds.bottom && (t.y = this.bounds.top - e))
            }, Object.defineProperty(n.World.prototype, "width", {
                get: function() {
                    return this.bounds.width
                },
                set: function(t) {
                    t < this.game.width && (t = this.game.width), this.bounds.width = t, this._width = t, this._definedSize = !0
                }
            }), Object.defineProperty(n.World.prototype, "height", {
                get: function() {
                    return this.bounds.height
                },
                set: function(t) {
                    t < this.game.height && (t = this.game.height), this.bounds.height = t, this._height = t, this._definedSize = !0
                }
            }), Object.defineProperty(n.World.prototype, "centerX", {
                get: function() {
                    return this.bounds.halfWidth + this.bounds.x
                }
            }), Object.defineProperty(n.World.prototype, "centerY", {
                get: function() {
                    return this.bounds.halfHeight + this.bounds.y
                }
            }), Object.defineProperty(n.World.prototype, "randomX", {
                get: function() {
                    return this.bounds.x < 0 ? this.game.rnd.between(this.bounds.x, this.bounds.width - Math.abs(this.bounds.x)) : this.game.rnd.between(this.bounds.x, this.bounds.width)
                }
            }), Object.defineProperty(n.World.prototype, "randomY", {
                get: function() {
                    return this.bounds.y < 0 ? this.game.rnd.between(this.bounds.y, this.bounds.height - Math.abs(this.bounds.y)) : this.game.rnd.between(this.bounds.y, this.bounds.height)
                }
            }), n.Game = function(t, e, i, s, o, r, a, h) {
                return this.id = n.GAMES.push(this) - 1, this.config = null, this.physicsConfig = h, this.parent = "", this.width = 800, this.height = 600, this.resolution = 1, this._width = 800, this._height = 600, this.transparent = !1, this.antialias = !0, this.multiTexture = !1, this.preserveDrawingBuffer = !1, this.clearBeforeRender = !0, this.renderer = null, this.renderType = n.AUTO, this.state = null, this.isBooted = !1, this.isRunning = !1, this.raf = null, this.add = null, this.make = null, this.cache = null, this.input = null, this.load = null, this.math = null, this.net = null, this.scale = null, this.sound = null, this.stage = null, this.time = null, this.tweens = null, this.world = null, this.physics = null, this.plugins = null, this.rnd = null, this.device = n.Device, this.camera = null, this.canvas = null, this.context = null, this.debug = null, this.particles = null, this.create = null, this.lockRender = !1, this.stepping = !1, this.pendingStep = !1, this.stepCount = 0, this.onPause = null, this.onResume = null, this.onBlur = null, this.onFocus = null, this._paused = !1, this._codePaused = !1, this.currentUpdateID = 0, this.updatesThisFrame = 1, this._deltaTime = 0, this._lastCount = 0, this._spiraling = 0, this._kickstart = !0, this.fpsProblemNotifier = new n.Signal, this.forceSingleUpdate = !0, this._nextFpsNotification = 0, 1 === arguments.length && "object" == typeof arguments[0] ? this.parseConfig(arguments[0]) : (this.config = {
                    enableDebug: !0
                }, void 0 !== t && (this._width = t), void 0 !== e && (this._height = e), void 0 !== i && (this.renderType = i), void 0 !== s && (this.parent = s), void 0 !== r && (this.transparent = r), void 0 !== a && (this.antialias = a), this.rnd = new n.RandomDataGenerator([(Date.now() * Math.random()).toString()]), this.state = new n.StateManager(this, o)), this.device.whenReady(this.boot, this), this
            }, n.Game.prototype = {
                parseConfig: function(t) {
                    this.config = t, void 0 === t.enableDebug && (this.config.enableDebug = !0), t.width && (this._width = t.width), t.height && (this._height = t.height), t.renderer && (this.renderType = t.renderer), t.parent && (this.parent = t.parent), void 0 !== t.transparent && (this.transparent = t.transparent), void 0 !== t.antialias && (this.antialias = t.antialias), void 0 !== t.multiTexture && (this.multiTexture = t.multiTexture), t.resolution && (this.resolution = t.resolution), void 0 !== t.preserveDrawingBuffer && (this.preserveDrawingBuffer = t.preserveDrawingBuffer), t.physicsConfig && (this.physicsConfig = t.physicsConfig);
                    var e = [(Date.now() * Math.random()).toString()];
                    t.seed && (e = t.seed), this.rnd = new n.RandomDataGenerator(e);
                    var i = null;
                    t.state && (i = t.state), this.state = new n.StateManager(this, i)
                },
                boot: function() {
                    this.isBooted || (this.onPause = new n.Signal, this.onResume = new n.Signal, this.onBlur = new n.Signal, this.onFocus = new n.Signal, this.isBooted = !0, PIXI.game = this, this.math = n.Math, this.scale = new n.ScaleManager(this, this._width, this._height), this.stage = new n.Stage(this), this.setUpRenderer(), this.world = new n.World(this), this.add = new n.GameObjectFactory(this), this.make = new n.GameObjectCreator(this), this.cache = new n.Cache(this), this.load = new n.Loader(this), this.time = new n.Time(this), this.tweens = new n.TweenManager(this), this.input = new n.Input(this), this.sound = new n.SoundManager(this), this.physics = new n.Physics(this, this.physicsConfig), this.particles = new n.Particles(this), this.create = new n.Create(this), this.plugins = new n.PluginManager(this), this.net = new n.Net(this), this.time.boot(), this.stage.boot(), this.world.boot(), this.scale.boot(), this.input.boot(), this.sound.boot(), this.state.boot(), this.config.enableDebug ? (this.debug = new n.Utils.Debug(this), this.debug.boot()) : this.debug = {
                        preUpdate: function() {},
                        update: function() {},
                        reset: function() {}
                    }, this.showDebugHeader(), this.isRunning = !0, this.config && this.config.forceSetTimeOut ? this.raf = new n.RequestAnimationFrame(this, this.config.forceSetTimeOut) : this.raf = new n.RequestAnimationFrame(this, !1), this._kickstart = !0, window.focus && (!window.PhaserGlobal || window.PhaserGlobal && !window.PhaserGlobal.stopFocus) && window.focus(), this.raf.start())
                },
                showDebugHeader: function() {
                    if (!window.PhaserGlobal || !window.PhaserGlobal.hideBanner) {
                        var t = n.VERSION,
                            e = "Canvas",
                            i = "HTML Audio",
                            s = 1;
                        if (this.renderType === n.WEBGL ? (e = "WebGL", s++) : this.renderType === n.HEADLESS && (e = "Headless"), this.device.webAudio && (i = "WebAudio", s++), this.device.chrome) {
                            for (var o = ["%c %c %c Phaser CE v" + t + " | Pixi.js | " + e + " | " + i + "  %c %c %c http://phaser.io %c%c%c", "background: #fb8cb3", "background: #d44a52", "color: #ffffff; background: #871905;", "background: #d44a52", "background: #fb8cb3", "background: #ffffff"], r = 0; r < 3; r++) r < s ? o.push("color: #ff2424; background: #fff") : o.push("color: #959595; background: #fff");
                            console.log.apply(console, o)
                        } else window.console && console.log("Phaser v" + t + " | Pixi.js | " + e + " | " + i + " | http://phaser.io")
                    }
                },
                setUpRenderer: function() {
                    if (this.config.canvas ? this.canvas = this.config.canvas : this.canvas = n.Canvas.create(this, this.width, this.height, this.config.canvasID, !0), this.config.canvasStyle ? this.canvas.style = this.config.canvasStyle : this.canvas.style["-webkit-full-screen"] = "width: 100%; height: 100%", this.renderType === n.HEADLESS || this.renderType === n.CANVAS || this.renderType === n.AUTO && !this.device.webGL) {
                        if (!this.device.canvas) throw new Error("Phaser.Game - Cannot create Canvas or WebGL context, aborting.");
                        this.renderType = n.CANVAS, this.renderer = new PIXI.CanvasRenderer(this), this.context = this.renderer.context
                    } else(this.multiTexture || this.renderType === n.WEBGL_MULTI) && PIXI.enableMultiTexture(), this.renderType = n.WEBGL, this.renderer = new PIXI.WebGLRenderer(this), this.context = null, this.canvas.addEventListener("webglcontextlost", this.contextLost.bind(this), !1), this.canvas.addEventListener("webglcontextrestored", this.contextRestored.bind(this), !1);
                    this.device.cocoonJS && (this.canvas.screencanvas = this.renderType === n.CANVAS), this.renderType !== n.HEADLESS && (this.stage.smoothed = this.antialias, n.Canvas.addToDOM(this.canvas, this.parent, !1), n.Canvas.setTouchAction(this.canvas))
                },
                contextLost: function(t) {
                    t.preventDefault(), this.renderer.contextLost = !0
                },
                contextRestored: function() {
                    this.renderer.initContext(), this.cache.clearGLTextures(), this.renderer.contextLost = !1
                },
                update: function(t) {
                    if (this.time.update(t), this._kickstart) return this.updateLogic(this.time.desiredFpsMult), this.updateRender(this.time.slowMotion * this.time.desiredFps), void(this._kickstart = !1);
                    if (this._spiraling > 1 && !this.forceSingleUpdate) this.time.time > this._nextFpsNotification && (this._nextFpsNotification = this.time.time + 1e4, this.fpsProblemNotifier.dispatch()), this._deltaTime = 0, this._spiraling = 0, this.updateRender(this.time.slowMotion * this.time.desiredFps);
                    else {
                        var e = 1e3 * this.time.slowMotion / this.time.desiredFps;
                        this._deltaTime += Math.max(Math.min(3 * e, this.time.elapsed), 0);
                        var i = 0;
                        for (this.updatesThisFrame = Math.floor(this._deltaTime / e), this.forceSingleUpdate && (this.updatesThisFrame = Math.min(1, this.updatesThisFrame)); this._deltaTime >= e && (this._deltaTime -= e, this.currentUpdateID = i, this.updateLogic(this.time.desiredFpsMult), i++, !this.forceSingleUpdate || 1 !== i);) this.time.refresh();
                        i > this._lastCount ? this._spiraling++ : i < this._lastCount && (this._spiraling = 0), this._lastCount = i, this.updateRender(this._deltaTime / e)
                    }
                },
                updateLogic: function(t) {
                    this._paused || this.pendingStep ? (this.scale.pauseUpdate(), this.state.pauseUpdate(), this.debug.preUpdate()) : (this.stepping && (this.pendingStep = !0), this.scale.preUpdate(), this.debug.preUpdate(), this.camera.preUpdate(), this.physics.preUpdate(), this.state.preUpdate(t), this.plugins.preUpdate(t), this.stage.preUpdate(), this.state.update(), this.stage.update(), this.tweens.update(), this.sound.update(), this.input.update(), this.physics.update(), this.particles.update(), this.plugins.update(), this.stage.postUpdate(), this.plugins.postUpdate()), this.stage.updateTransform()
                },
                updateRender: function(t) {
                    this.lockRender || (this.state.preRender(t), this.renderType !== n.HEADLESS && (this.renderer.render(this.stage), this.plugins.render(t), this.state.render(t)), this.plugins.postRender(t))
                },
                enableStep: function() {
                    this.stepping = !0, this.pendingStep = !1, this.stepCount = 0
                },
                disableStep: function() {
                    this.stepping = !1, this.pendingStep = !1
                },
                step: function() {
                    this.pendingStep = !1, this.stepCount++
                },
                destroy: function() {
                    this.raf.stop(), this.state.destroy(), this.sound.destroy(), this.scale.destroy(), this.stage.destroy(), this.input.destroy(), this.physics.destroy(), this.plugins.destroy(), this.state = null, this.sound = null, this.scale = null, this.stage = null, this.input = null, this.physics = null, this.plugins = null, this.cache = null, this.load = null, this.time = null, this.world = null, this.isBooted = !1, this.renderer.destroy(!1), n.Canvas.removeFromDOM(this.canvas), PIXI.defaultRenderer = null, n.GAMES[this.id] = null
                },
                gamePaused: function(t) {
                    this._paused || (this._paused = !0, this.time.gamePaused(), this.sound.muteOnPause && this.sound.setMute(), this.onPause.dispatch(t), this.device.cordova && this.device.iOS && (this.lockRender = !0))
                },
                gameResumed: function(t) {
                    this._paused && !this._codePaused && (this._paused = !1, this.time.gameResumed(), this.input.reset(), this.sound.muteOnPause && this.sound.unsetMute(), this.onResume.dispatch(t), this.device.cordova && this.device.iOS && (this.lockRender = !1))
                },
                focusLoss: function(t) {
                    this.onBlur.dispatch(t), this.stage.disableVisibilityChange || this.gamePaused(t)
                },
                focusGain: function(t) {
                    this.onFocus.dispatch(t), this.stage.disableVisibilityChange || this.gameResumed(t)
                }
            }, n.Game.prototype.constructor = n.Game, Object.defineProperty(n.Game.prototype, "paused", {
                get: function() {
                    return this._paused
                },
                set: function(t) {
                    !0 === t ? (!1 === this._paused && (this._paused = !0, this.sound.setMute(), this.time.gamePaused(), this.onPause.dispatch(this)), this._codePaused = !0) : (this._paused && (this._paused = !1, this.input.reset(), this.sound.unsetMute(), this.time.gameResumed(), this.onResume.dispatch(this)), this._codePaused = !1)
                }
            }), n.Input = function(t) {
                this.game = t, this.hitCanvas = null, this.hitContext = null, this.moveCallbacks = [], this.customCandidateHandler = null, this.customCandidateHandlerContext = null, this.pollRate = 0, this.enabled = !0, this.multiInputOverride = n.Input.MOUSE_TOUCH_COMBINE, this.position = null, this.speed = null, this.circle = null, this.scale = null, this.maxPointers = -1, this.tapRate = 200, this.doubleTapRate = 300, this.holdRate = 2e3, this.justPressedRate = 200, this.justReleasedRate = 200, this.recordPointerHistory = !1, this.recordRate = 100, this.recordLimit = 100, this.pointer1 = null, this.pointer2 = null, this.pointer3 = null, this.pointer4 = null, this.pointer5 = null, this.pointer6 = null, this.pointer7 = null, this.pointer8 = null, this.pointer9 = null, this.pointer10 = null, this.pointers = [], this.activePointer = null, this.mousePointer = null, this.mouse = null, this.keyboard = null, this.touch = null, this.mspointer = null, this.gamepad = null, this.resetLocked = !1, this.onDown = null, this.onUp = null, this.onTap = null, this.onHold = null, this.minPriorityID = 0, this.interactiveItems = new n.ArraySet, this._localPoint = new n.Point, this._pollCounter = 0, this._oldPosition = null, this._x = 0, this._y = 0
            }, n.Input.MOUSE_OVERRIDES_TOUCH = 0, n.Input.TOUCH_OVERRIDES_MOUSE = 1, n.Input.MOUSE_TOUCH_COMBINE = 2, n.Input.MAX_POINTERS = 10, n.Input.prototype = {
                boot: function() {
                    this.mousePointer = new n.Pointer(this.game, 0, n.PointerMode.CURSOR), this.addPointer(), this.addPointer(), this.mouse = new n.Mouse(this.game), this.touch = new n.Touch(this.game), this.mspointer = new n.MSPointer(this.game), n.Keyboard && (this.keyboard = new n.Keyboard(this.game)), n.Gamepad && (this.gamepad = new n.Gamepad(this.game)), this.onDown = new n.Signal, this.onUp = new n.Signal, this.onTap = new n.Signal, this.onHold = new n.Signal, this.scale = new n.Point(1, 1), this.speed = new n.Point, this.position = new n.Point, this._oldPosition = new n.Point, this.circle = new n.Circle(0, 0, 44), this.activePointer = this.mousePointer, this.hitCanvas = n.CanvasPool.create(this, 1, 1), this.hitContext = this.hitCanvas.getContext("2d"), this.mouse.start(), this.touch.start(), this.mspointer.start(), this.mousePointer.active = !0, this.keyboard && this.keyboard.start();
                    var t = this;
                    this._onClickTrampoline = function(e) {
                        t.onClickTrampoline(e)
                    }, this.game.canvas.addEventListener("click", this._onClickTrampoline, !1)
                },
                destroy: function() {
                    this.mouse.stop(), this.touch.stop(), this.mspointer.stop(), this.keyboard && this.keyboard.stop(), this.gamepad && this.gamepad.stop(), this.moveCallbacks = [], n.CanvasPool.remove(this), this.game.canvas.removeEventListener("click", this._onClickTrampoline)
                },
                setInteractiveCandidateHandler: function(t, e) {
                    this.customCandidateHandler = t, this.customCandidateHandlerContext = e
                },
                addMoveCallback: function(t, e) {
                    this.moveCallbacks.push({
                        callback: t,
                        context: e
                    })
                },
                deleteMoveCallback: function(t, e) {
                    for (var i = this.moveCallbacks.length; i--;)
                        if (this.moveCallbacks[i].callback === t && this.moveCallbacks[i].context === e) return void this.moveCallbacks.splice(i, 1)
                },
                addPointer: function() {
                    if (this.pointers.length >= n.Input.MAX_POINTERS) return console.warn("Phaser.Input.addPointer: Maximum limit of " + n.Input.MAX_POINTERS + " pointers reached."), null;
                    var t = this.pointers.length + 1,
                        e = new n.Pointer(this.game, t, n.PointerMode.TOUCH);
                    return this.pointers.push(e), this["pointer" + t] = e, e
                },
                update: function() {
                    if (this.keyboard && this.keyboard.update(), this.pollRate > 0 && this._pollCounter < this.pollRate) this._pollCounter++;
                    else {
                        this.speed.x = this.position.x - this._oldPosition.x, this.speed.y = this.position.y - this._oldPosition.y, this._oldPosition.copyFrom(this.position), this.mousePointer.update(), this.gamepad && this.gamepad.active && this.gamepad.update();
                        for (var t = 0; t < this.pointers.length; t++) this.pointers[t].update();
                        this._pollCounter = 0
                    }
                },
                reset: function(t) {
                    if (this.game.isBooted && !this.resetLocked) {
                        void 0 === t && (t = !1), this.mousePointer.reset(), this.keyboard && this.keyboard.reset(t), this.gamepad && this.gamepad.reset();
                        for (var e = 0; e < this.pointers.length; e++) this.pointers[e].reset();
                        "none" !== this.game.canvas.style.cursor && (this.game.canvas.style.cursor = "inherit"), t && (this.onDown.dispose(), this.onUp.dispose(), this.onTap.dispose(), this.onHold.dispose(), this.onDown = new n.Signal, this.onUp = new n.Signal, this.onTap = new n.Signal, this.onHold = new n.Signal, this.moveCallbacks = []), this._pollCounter = 0
                    }
                },
                resetSpeed: function(t, e) {
                    this._oldPosition.setTo(t, e), this.speed.setTo(0, 0)
                },
                startPointer: function(t) {
                    if (this.maxPointers >= 0 && this.countActivePointers(this.maxPointers) >= this.maxPointers) return null;
                    if (!this.pointer1.active) return this.pointer1.start(t);
                    if (!this.pointer2.active) return this.pointer2.start(t);
                    for (var e = 2; e < this.pointers.length; e++) {
                        var i = this.pointers[e];
                        if (!i.active) return i.start(t)
                    }
                    return null
                },
                updatePointer: function(t) {
                    if (this.pointer1.active && this.pointer1.identifier === t.identifier) return this.pointer1.move(t);
                    if (this.pointer2.active && this.pointer2.identifier === t.identifier) return this.pointer2.move(t);
                    for (var e = 2; e < this.pointers.length; e++) {
                        var i = this.pointers[e];
                        if (i.active && i.identifier === t.identifier) return i.move(t)
                    }
                    return null
                },
                stopPointer: function(t) {
                    if (this.pointer1.active && this.pointer1.identifier === t.identifier) return this.pointer1.stop(t);
                    if (this.pointer2.active && this.pointer2.identifier === t.identifier) return this.pointer2.stop(t);
                    for (var e = 2; e < this.pointers.length; e++) {
                        var i = this.pointers[e];
                        if (i.active && i.identifier === t.identifier) return i.stop(t)
                    }
                    return null
                },
                countActivePointers: function(t) {
                    void 0 === t && (t = this.pointers.length);
                    for (var e = t, i = 0; i < this.pointers.length && e > 0; i++) this.pointers[i].active && e--;
                    return t - e
                },
                getPointer: function(t) {
                    void 0 === t && (t = !1);
                    for (var e = 0; e < this.pointers.length; e++) {
                        var i = this.pointers[e];
                        if (i.active === t) return i
                    }
                    return null
                },
                getPointerFromIdentifier: function(t) {
                    for (var e = 0; e < this.pointers.length; e++) {
                        var i = this.pointers[e];
                        if (i.identifier === t) return i
                    }
                    return null
                },
                getPointerFromId: function(t) {
                    for (var e = 0; e < this.pointers.length; e++) {
                        var i = this.pointers[e];
                        if (i.pointerId === t) return i
                    }
                    return null
                },
                getLocalPosition: function(t, e, i) {
                    void 0 === i && (i = new n.Point);
                    var s = t.worldTransform,
                        o = 1 / (s.a * s.d + s.c * -s.b);
                    return i.setTo(s.d * o * e.x + -s.c * o * e.y + (s.ty * s.c - s.tx * s.d) * o, s.a * o * e.y + -s.b * o * e.x + (-s.ty * s.a + s.tx * s.b) * o)
                },
                hitTest: function(t, e, i) {
                    if (!t.worldVisible) return !1;
                    if (this.getLocalPosition(t, e, this._localPoint), i.copyFrom(this._localPoint), t.hitArea && t.hitArea.contains) return t.hitArea.contains(this._localPoint.x, this._localPoint.y);
                    if (t instanceof n.TileSprite) {
                        var s = t.width,
                            o = t.height,
                            r = -s * t.anchor.x;
                        if (this._localPoint.x >= r && this._localPoint.x < r + s) {
                            var a = -o * t.anchor.y;
                            if (this._localPoint.y >= a && this._localPoint.y < a + o) return !0
                        }
                    } else if (t instanceof PIXI.Sprite) {
                        s = t.texture.frame.width, o = t.texture.frame.height, r = -s * t.anchor.x;
                        if (this._localPoint.x >= r && this._localPoint.x < r + s) {
                            a = -o * t.anchor.y;
                            if (this._localPoint.y >= a && this._localPoint.y < a + o) return !0
                        }
                    } else if (t instanceof n.Graphics)
                        for (var h = 0; h < t.graphicsData.length; h++) {
                            var l = t.graphicsData[h];
                            if (l.fill && l.shape && l.shape.contains(this._localPoint.x, this._localPoint.y)) return !0
                        }
                    for (h = 0; h < t.children.length; h++)
                        if (this.hitTest(t.children[h], e, i)) return !0;
                    return !1
                },
                onClickTrampoline: function() {
                    this.activePointer.processClickTrampolines()
                }
            }, n.Input.prototype.constructor = n.Input, Object.defineProperty(n.Input.prototype, "x", {
                get: function() {
                    return this._x
                },
                set: function(t) {
                    this._x = Math.floor(t)
                }
            }), Object.defineProperty(n.Input.prototype, "y", {
                get: function() {
                    return this._y
                },
                set: function(t) {
                    this._y = Math.floor(t)
                }
            }), Object.defineProperty(n.Input.prototype, "pollLocked", {
                get: function() {
                    return this.pollRate > 0 && this._pollCounter < this.pollRate
                }
            }), Object.defineProperty(n.Input.prototype, "totalInactivePointers", {
                get: function() {
                    return this.pointers.length - this.countActivePointers()
                }
            }), Object.defineProperty(n.Input.prototype, "totalActivePointers", {
                get: function() {
                    return this.countActivePointers()
                }
            }), Object.defineProperty(n.Input.prototype, "worldX", {
                get: function() {
                    return this.game.camera.view.x + this.x
                }
            }), Object.defineProperty(n.Input.prototype, "worldY", {
                get: function() {
                    return this.game.camera.view.y + this.y
                }
            }), n.Mouse = function(t) {
                this.game = t, this.input = t.input, this.callbackContext = this.game, this.mouseDownCallback = null, this.mouseUpCallback = null, this.mouseOutCallback = null, this.mouseOverCallback = null, this.mouseWheelCallback = null, this.capture = !1, this.button = -1, this.wheelDelta = 0, this.enabled = !0, this.locked = !1, this.stopOnGameOut = !1, this.pointerLock = new n.Signal, this.event = null, this._onMouseDown = null, this._onMouseMove = null, this._onMouseUp = null, this._onMouseOut = null, this._onMouseOver = null, this._onMouseWheel = null, this._wheelEvent = null
            }, n.Mouse.NO_BUTTON = -1, n.Mouse.LEFT_BUTTON = 0, n.Mouse.MIDDLE_BUTTON = 1, n.Mouse.RIGHT_BUTTON = 2, n.Mouse.BACK_BUTTON = 3, n.Mouse.FORWARD_BUTTON = 4, n.Mouse.WHEEL_UP = 1, n.Mouse.WHEEL_DOWN = -1, n.Mouse.prototype = {
                start: function() {
                    if ((!this.game.device.android || !1 !== this.game.device.chrome) && null === this._onMouseDown) {
                        var t = this;
                        this._onMouseDown = function(e) {
                            return t.onMouseDown(e)
                        }, this._onMouseMove = function(e) {
                            return t.onMouseMove(e)
                        }, this._onMouseUp = function(e) {
                            return t.onMouseUp(e)
                        }, this._onMouseUpGlobal = function(e) {
                            return t.onMouseUpGlobal(e)
                        }, this._onMouseOutGlobal = function(e) {
                            return t.onMouseOutGlobal(e)
                        }, this._onMouseOut = function(e) {
                            return t.onMouseOut(e)
                        }, this._onMouseOver = function(e) {
                            return t.onMouseOver(e)
                        }, this._onMouseWheel = function(e) {
                            return t.onMouseWheel(e)
                        };
                        var e = this.game.canvas;
                        e.addEventListener("mousedown", this._onMouseDown, !0), e.addEventListener("mousemove", this._onMouseMove, !0), e.addEventListener("mouseup", this._onMouseUp, !0), this.game.device.cocoonJS || (window.addEventListener("mouseup", this._onMouseUpGlobal, !0), window.addEventListener("mouseout", this._onMouseOutGlobal, !0), e.addEventListener("mouseover", this._onMouseOver, !0), e.addEventListener("mouseout", this._onMouseOut, !0));
                        var s = this.game.device.wheelEvent;
                        s && (e.addEventListener(s, this._onMouseWheel, !0), "mousewheel" === s ? this._wheelEvent = new i(-.025, 1) : "DOMMouseScroll" === s && (this._wheelEvent = new i(1, 1)))
                    }
                },
                onMouseDown: function(t) {
                    this.event = t, this.capture && t.preventDefault(), this.mouseDownCallback && this.mouseDownCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && (t.identifier = 0, this.input.mousePointer.start(t))
                },
                onMouseMove: function(t) {
                    this.event = t, this.capture && t.preventDefault(), this.mouseMoveCallback && this.mouseMoveCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && (t.identifier = 0, this.input.mousePointer.move(t))
                },
                onMouseUp: function(t) {
                    this.event = t, this.capture && t.preventDefault(), this.mouseUpCallback && this.mouseUpCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && (t.identifier = 0, this.input.mousePointer.stop(t))
                },
                onMouseUpGlobal: function(t) {
                    this.input.mousePointer.withinGame || (this.mouseUpCallback && this.mouseUpCallback.call(this.callbackContext, t), t.identifier = 0, this.input.mousePointer.stop(t))
                },
                onMouseOutGlobal: function(t) {
                    this.event = t, this.capture && t.preventDefault(), this.input.mousePointer.withinGame = !1, this.input.enabled && this.enabled && (this.input.mousePointer.stop(t), this.input.mousePointer.leftButton.stop(t), this.input.mousePointer.rightButton.stop(t))
                },
                onMouseOut: function(t) {
                    this.event = t, this.capture && t.preventDefault(), this.input.mousePointer.withinGame = !1, this.mouseOutCallback && this.mouseOutCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && this.stopOnGameOut && (t.identifier = 0, this.input.mousePointer.stop(t))
                },
                onMouseOver: function(t) {
                    this.event = t, this.capture && t.preventDefault(), this.input.mousePointer.withinGame = !0, this.mouseOverCallback && this.mouseOverCallback.call(this.callbackContext, t)
                },
                onMouseWheel: function(t) {
                    this._wheelEvent && (t = this._wheelEvent.bindEvent(t)), this.event = t, this.capture && t.preventDefault(), this.wheelDelta = n.Math.clamp(-t.deltaY, -1, 1), this.mouseWheelCallback && this.mouseWheelCallback.call(this.callbackContext, t)
                },
                requestPointerLock: function() {
                    if (this.game.device.pointerLock) {
                        var t = this.game.canvas;
                        t.requestPointerLock = t.requestPointerLock || t.mozRequestPointerLock || t.webkitRequestPointerLock, t.requestPointerLock();
                        var e = this;
                        this._pointerLockChange = function(t) {
                            return e.pointerLockChange(t)
                        }, document.addEventListener("pointerlockchange", this._pointerLockChange, !0), document.addEventListener("mozpointerlockchange", this._pointerLockChange, !0), document.addEventListener("webkitpointerlockchange", this._pointerLockChange, !0)
                    }
                },
                pointerLockChange: function(t) {
                    var e = this.game.canvas;
                    document.pointerLockElement === e || document.mozPointerLockElement === e || document.webkitPointerLockElement === e ? (this.locked = !0, this.pointerLock.dispatch(!0, t)) : (this.locked = !1, this.pointerLock.dispatch(!1, t))
                },
                releasePointerLock: function() {
                    document.exitPointerLock = document.exitPointerLock || document.mozExitPointerLock || document.webkitExitPointerLock, document.exitPointerLock(), document.removeEventListener("pointerlockchange", this._pointerLockChange, !0), document.removeEventListener("mozpointerlockchange", this._pointerLockChange, !0), document.removeEventListener("webkitpointerlockchange", this._pointerLockChange, !0)
                },
                stop: function() {
                    var t = this.game.canvas;
                    t.removeEventListener("mousedown", this._onMouseDown, !0), t.removeEventListener("mousemove", this._onMouseMove, !0), t.removeEventListener("mouseup", this._onMouseUp, !0), t.removeEventListener("mouseover", this._onMouseOver, !0), t.removeEventListener("mouseout", this._onMouseOut, !0);
                    var e = this.game.device.wheelEvent;
                    e && t.removeEventListener(e, this._onMouseWheel, !0), window.removeEventListener("mouseup", this._onMouseUpGlobal, !0), window.removeEventListener("mouseout", this._onMouseOutGlobal, !0), document.removeEventListener("pointerlockchange", this._pointerLockChange, !0), document.removeEventListener("mozpointerlockchange", this._pointerLockChange, !0), document.removeEventListener("webkitpointerlockchange", this._pointerLockChange, !0)
                }
            }, n.Mouse.prototype.constructor = n.Mouse, i.prototype = {}, i.prototype.constructor = i, i.prototype.bindEvent = function(t) {
                if (!i._stubsGenerated && t) {
                    var e = function(t) {
                        return function() {
                            var e = this.originalEvent[t];
                            return "function" != typeof e ? e : e.bind(this.originalEvent)
                        }
                    };
                    for (var s in t) s in i.prototype || Object.defineProperty(i.prototype, s, {
                        get: e(s)
                    });
                    i._stubsGenerated = !0
                }
                return this.originalEvent = t, this
            }, Object.defineProperties(i.prototype, {
                type: {
                    value: "wheel"
                },
                deltaMode: {
                    get: function() {
                        return this._deltaMode
                    }
                },
                deltaY: {
                    get: function() {
                        return this._scaleFactor * (this.originalEvent.wheelDelta || this.originalEvent.detail) || 0
                    }
                },
                deltaX: {
                    get: function() {
                        return this._scaleFactor * this.originalEvent.wheelDeltaX || 0
                    }
                },
                deltaZ: {
                    value: 0
                }
            }), n.MSPointer = function(t) {
                this.game = t, this.input = t.input, this.callbackContext = this.game, this.pointerDownCallback = null, this.pointerMoveCallback = null, this.pointerUpCallback = null, this.capture = !0, this.button = -1, this.event = null, this.enabled = !0, this._onMSPointerDown = null, this._onMSPointerMove = null, this._onMSPointerUp = null, this._onMSPointerUpGlobal = null, this._onMSPointerOut = null, this._onMSPointerOver = null
            }, n.MSPointer.prototype = {
                start: function() {
                    if (null === this._onMSPointerDown) {
                        var t = this;
                        if (this.game.device.mspointer) {
                            this._onMSPointerDown = function(e) {
                                return t.onPointerDown(e)
                            }, this._onMSPointerMove = function(e) {
                                return t.onPointerMove(e)
                            }, this._onMSPointerUp = function(e) {
                                return t.onPointerUp(e)
                            }, this._onMSPointerUpGlobal = function(e) {
                                return t.onPointerUpGlobal(e)
                            }, this._onMSPointerOut = function(e) {
                                return t.onPointerOut(e)
                            }, this._onMSPointerOver = function(e) {
                                return t.onPointerOver(e)
                            };
                            var e = this.game.canvas;
                            e.addEventListener("MSPointerDown", this._onMSPointerDown, !1), e.addEventListener("MSPointerMove", this._onMSPointerMove, !1), e.addEventListener("MSPointerUp", this._onMSPointerUp, !1), e.addEventListener("pointerdown", this._onMSPointerDown, !1), e.addEventListener("pointermove", this._onMSPointerMove, !1), e.addEventListener("pointerup", this._onMSPointerUp, !1), e.style["-ms-content-zooming"] = "none", e.style["-ms-touch-action"] = "none", this.game.device.cocoonJS || (window.addEventListener("MSPointerUp", this._onMSPointerUpGlobal, !0), e.addEventListener("MSPointerOver", this._onMSPointerOver, !0), e.addEventListener("MSPointerOut", this._onMSPointerOut, !0), window.addEventListener("pointerup", this._onMSPointerUpGlobal, !0), e.addEventListener("pointerover", this._onMSPointerOver, !0), e.addEventListener("pointerout", this._onMSPointerOut, !0))
                        }
                    }
                },
                onPointerDown: function(t) {
                    this.event = t, this.capture && t.preventDefault(), this.pointerDownCallback && this.pointerDownCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && (t.identifier = t.pointerId, "mouse" === t.pointerType || 4 === t.pointerType ? this.input.mousePointer.start(t) : this.input.startPointer(t))
                },
                onPointerMove: function(t) {
                    this.event = t, this.capture && t.preventDefault(), this.pointerMoveCallback && this.pointerMoveCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && (t.identifier = t.pointerId, "mouse" === t.pointerType || 4 === t.pointerType ? this.input.mousePointer.move(t) : this.input.updatePointer(t))
                },
                onPointerUp: function(t) {
                    this.event = t, this.capture && t.preventDefault(), this.pointerUpCallback && this.pointerUpCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && (t.identifier = t.pointerId, "mouse" === t.pointerType || 4 === t.pointerType ? this.input.mousePointer.stop(t) : this.input.stopPointer(t))
                },
                onPointerUpGlobal: function(t) {
                    if ("mouse" !== t.pointerType && 4 !== t.pointerType || this.input.mousePointer.withinGame) {
                        var e = this.input.getPointerFromIdentifier(t.identifier);
                        e && e.withinGame && this.onPointerUp(t)
                    } else this.onPointerUp(t)
                },
                onPointerOut: function(t) {
                    if (this.event = t, this.capture && t.preventDefault(), "mouse" === t.pointerType || 4 === t.pointerType) this.input.mousePointer.withinGame = !1;
                    else {
                        var e = this.input.getPointerFromIdentifier(t.identifier);
                        e && (e.withinGame = !1)
                    }
                    this.input.mouse.mouseOutCallback && this.input.mouse.mouseOutCallback.call(this.input.mouse.callbackContext, t), this.input.enabled && this.enabled && this.input.mouse.stopOnGameOut && (t.identifier = 0, e ? e.stop(t) : this.input.mousePointer.stop(t))
                },
                onPointerOver: function(t) {
                    if (this.event = t, this.capture && t.preventDefault(), "mouse" === t.pointerType || 4 === t.pointerType) this.input.mousePointer.withinGame = !0;
                    else {
                        var e = this.input.getPointerFromIdentifier(t.identifier);
                        e && (e.withinGame = !0)
                    }
                    this.input.mouse.mouseOverCallback && this.input.mouse.mouseOverCallback.call(this.input.mouse.callbackContext, t)
                },
                stop: function() {
                    var t = this.game.canvas;
                    t.removeEventListener("MSPointerDown", this._onMSPointerDown, !1), t.removeEventListener("MSPointerMove", this._onMSPointerMove, !1), t.removeEventListener("MSPointerUp", this._onMSPointerUp, !1), t.removeEventListener("pointerdown", this._onMSPointerDown, !1), t.removeEventListener("pointermove", this._onMSPointerMove, !1), t.removeEventListener("pointerup", this._onMSPointerUp, !1), window.removeEventListener("MSPointerUp", this._onMSPointerUpGlobal, !0), t.removeEventListener("MSPointerOver", this._onMSPointerOver, !0), t.removeEventListener("MSPointerOut", this._onMSPointerOut, !0), window.removeEventListener("pointerup", this._onMSPointerUpGlobal, !0), t.removeEventListener("pointerover", this._onMSPointerOver, !0), t.removeEventListener("pointerout", this._onMSPointerOut, !0)
                }
            }, n.MSPointer.prototype.constructor = n.MSPointer, n.DeviceButton = function(t, e) {
                this.parent = t, this.game = t.game, this.event = null, this.isDown = !1, this.isUp = !0, this.timeDown = 0, this.timeUp = 0, this.repeats = 0, this.altKey = !1, this.shiftKey = !1, this.ctrlKey = !1, this.value = 0, this.buttonCode = e, this.onDown = new n.Signal, this.onUp = new n.Signal, this.onFloat = new n.Signal
            }, n.DeviceButton.prototype = {
                start: function(t, e) {
                    this.isDown || (this.isDown = !0, this.isUp = !1, this.timeDown = this.game.time.time, this.repeats = 0, this.event = t, this.value = e, t && (this.altKey = t.altKey, this.shiftKey = t.shiftKey, this.ctrlKey = t.ctrlKey), this.onDown.dispatch(this, e))
                },
                stop: function(t, e) {
                    this.isUp || (this.isDown = !1, this.isUp = !0, this.timeUp = this.game.time.time, this.event = t, this.value = e, t && (this.altKey = t.altKey, this.shiftKey = t.shiftKey, this.ctrlKey = t.ctrlKey), this.onUp.dispatch(this, e))
                },
                padFloat: function(t) {
                    this.isDown = !1, this.isUp = !1, this.value = t, this.onFloat.dispatch(this, t)
                },
                justPressed: function(t) {
                    return t = t || 250, this.isDown && this.timeDown + t > this.game.time.time
                },
                justReleased: function(t) {
                    return t = t || 250, this.isUp && this.timeUp + t > this.game.time.time
                },
                reset: function() {
                    this.isDown = !1, this.isUp = !0, this.timeDown = this.game.time.time, this.repeats = 0, this.altKey = !1, this.shiftKey = !1, this.ctrlKey = !1
                },
                destroy: function() {
                    this.onDown.dispose(), this.onUp.dispose(), this.onFloat.dispose(), this.parent = null, this.game = null
                }
            }, n.DeviceButton.prototype.constructor = n.DeviceButton, Object.defineProperty(n.DeviceButton.prototype, "duration", {
                get: function() {
                    return this.isUp ? -1 : this.game.time.time - this.timeDown
                }
            }), n.Pointer = function(t, e, i) {
                this.game = t, this.id = e, this.type = n.POINTER, this.exists = !0, this.identifier = 0, this.pointerId = null, this.pointerMode = i || n.PointerMode.CURSOR | n.PointerMode.CONTACT, this.target = null, this.button = null, this.leftButton = new n.DeviceButton(this, n.Pointer.LEFT_BUTTON), this.middleButton = new n.DeviceButton(this, n.Pointer.MIDDLE_BUTTON), this.rightButton = new n.DeviceButton(this, n.Pointer.RIGHT_BUTTON), this.backButton = new n.DeviceButton(this, n.Pointer.BACK_BUTTON), this.forwardButton = new n.DeviceButton(this, n.Pointer.FORWARD_BUTTON), this.eraserButton = new n.DeviceButton(this, n.Pointer.ERASER_BUTTON), this._holdSent = !1, this._history = [], this._nextDrop = 0, this._stateReset = !1, this.withinGame = !1, this.clientX = -1, this.clientY = -1, this.pageX = -1, this.pageY = -1, this.screenX = -1, this.screenY = -1, this.rawMovementX = 0, this.rawMovementY = 0, this.movementX = 0, this.movementY = 0, this.x = -1, this.y = -1, this.isMouse = 0 === e, this.isDown = !1, this.isUp = !0, this.timeDown = 0, this.timeUp = 0, this.previousTapTime = 0, this.totalTouches = 0, this.msSinceLastClick = Number.MAX_VALUE, this.targetObject = null, this.interactiveCandidates = [], this.active = !1, this.dirty = !1, this.position = new n.Point, this.positionDown = new n.Point, this.positionUp = new n.Point, this.circle = new n.Circle(0, 0, 44), this._clickTrampolines = null, this._trampolineTargetObject = null
            }, n.Pointer.NO_BUTTON = 0, n.Pointer.LEFT_BUTTON = 1, n.Pointer.RIGHT_BUTTON = 2, n.Pointer.MIDDLE_BUTTON = 4, n.Pointer.BACK_BUTTON = 8, n.Pointer.FORWARD_BUTTON = 16, n.Pointer.ERASER_BUTTON = 32, n.Pointer.prototype = {
                resetButtons: function() {
                    this.isDown = !1, this.isUp = !0, this.isMouse && (this.leftButton.reset(), this.middleButton.reset(), this.rightButton.reset(), this.backButton.reset(), this.forwardButton.reset(), this.eraserButton.reset())
                },
                processButtonsDown: function(t, e) {
                    n.Pointer.LEFT_BUTTON & t && this.leftButton.start(e), n.Pointer.RIGHT_BUTTON & t && this.rightButton.start(e), n.Pointer.MIDDLE_BUTTON & t && this.middleButton.start(e), n.Pointer.BACK_BUTTON & t && this.backButton.start(e), n.Pointer.FORWARD_BUTTON & t && this.forwardButton.start(e), n.Pointer.ERASER_BUTTON & t && this.eraserButton.start(e)
                },
                processButtonsUp: function(t, e) {
                    t === n.Mouse.LEFT_BUTTON && this.leftButton.stop(e), t === n.Mouse.RIGHT_BUTTON && this.rightButton.stop(e), t === n.Mouse.MIDDLE_BUTTON && this.middleButton.stop(e), t === n.Mouse.BACK_BUTTON && this.backButton.stop(e), t === n.Mouse.FORWARD_BUTTON && this.forwardButton.stop(e), 5 === t && this.eraserButton.stop(e)
                },
                updateButtons: function(t) {
                    this.button = t.button;
                    var e = "down" === t.type.toLowerCase().substr(-4);
                    void 0 !== t.buttons ? e ? this.processButtonsDown(t.buttons, t) : this.processButtonsUp(t.button, t) : e ? this.leftButton.start(t) : (this.leftButton.stop(t), this.rightButton.stop(t)), 1 === t.buttons && t.ctrlKey && this.leftButton.isDown && (this.leftButton.stop(t), this.rightButton.start(t)), this.isUp = !0, this.isDown = !1, (this.leftButton.isDown || this.rightButton.isDown || this.middleButton.isDown || this.backButton.isDown || this.forwardButton.isDown || this.eraserButton.isDown) && (this.isUp = !1, this.isDown = !0)
                },
                start: function(t) {
                    var e = this.game.input;
                    return t.pointerId && (this.pointerId = t.pointerId), this.identifier = t.identifier, this.target = t.target, this.isMouse ? this.updateButtons(t) : (this.isDown = !0, this.isUp = !1), this.active = !0, this.withinGame = !0, this.dirty = !1, this._history = [], this._clickTrampolines = null, this._trampolineTargetObject = null, this.msSinceLastClick = this.game.time.time - this.timeDown, this.timeDown = this.game.time.time, this._holdSent = !1, this.move(t, !0), this.positionDown.setTo(this.x, this.y), (e.multiInputOverride === n.Input.MOUSE_OVERRIDES_TOUCH || e.multiInputOverride === n.Input.MOUSE_TOUCH_COMBINE || e.multiInputOverride === n.Input.TOUCH_OVERRIDES_MOUSE && 0 === e.totalActivePointers) && (e.x = this.x, e.y = this.y, e.position.setTo(this.x, this.y), e.onDown.dispatch(this, t), e.resetSpeed(this.x, this.y)), this._stateReset = !1, this.totalTouches++, null !== this.targetObject && this.targetObject._touchedHandler(this), this
                },
                update: function() {
                    var t = this.game.input;
                    this.active && (this.dirty && (t.interactiveItems.total > 0 && this.processInteractiveObjects(!1), this.dirty = !1), !1 === this._holdSent && this.duration >= t.holdRate && ((t.multiInputOverride === n.Input.MOUSE_OVERRIDES_TOUCH || t.multiInputOverride === n.Input.MOUSE_TOUCH_COMBINE || t.multiInputOverride === n.Input.TOUCH_OVERRIDES_MOUSE && 0 === t.totalActivePointers) && t.onHold.dispatch(this), this._holdSent = !0), t.recordPointerHistory && this.game.time.time >= this._nextDrop && (this._nextDrop = this.game.time.time + t.recordRate, this._history.push({
                        x: this.position.x,
                        y: this.position.y
                    }), this._history.length > t.recordLimit && this._history.shift()))
                },
                move: function(t, e) {
                    var i = this.game.input;
                    if (!i.pollLocked) {
                        if (void 0 === e && (e = !1), void 0 !== t.button && (this.button = t.button), e && this.isMouse && this.updateButtons(t), this.clientX = t.clientX, this.clientY = t.clientY, this.pageX = t.pageX, this.pageY = t.pageY, this.screenX = t.screenX, this.screenY = t.screenY, this.isMouse && i.mouse.locked && !e && (this.rawMovementX = t.movementX || t.mozMovementX || t.webkitMovementX || 0, this.rawMovementY = t.movementY || t.mozMovementY || t.webkitMovementY || 0, this.movementX += this.rawMovementX, this.movementY += this.rawMovementY), this.x = (this.pageX - this.game.scale.offset.x) * i.scale.x, this.y = (this.pageY - this.game.scale.offset.y) * i.scale.y, this.position.setTo(this.x, this.y), this.circle.x = this.x, this.circle.y = this.y, (i.multiInputOverride === n.Input.MOUSE_OVERRIDES_TOUCH || i.multiInputOverride === n.Input.MOUSE_TOUCH_COMBINE || i.multiInputOverride === n.Input.TOUCH_OVERRIDES_MOUSE && 0 === i.totalActivePointers) && (i.activePointer = this, i.x = this.x, i.y = this.y, i.position.setTo(i.x, i.y), i.circle.x = i.x, i.circle.y = i.y), this.withinGame = this.game.scale.bounds.contains(this.pageX, this.pageY), this.game.paused) return this;
                        for (var s = i.moveCallbacks.length; s--;) i.moveCallbacks[s].callback.call(i.moveCallbacks[s].context, this, this.x, this.y, e);
                        return null !== this.targetObject && !0 === this.targetObject.isDragged ? !1 === this.targetObject.update(this) && (this.targetObject = null) : i.interactiveItems.total > 0 && this.processInteractiveObjects(e), this
                    }
                },
                processInteractiveObjects: function(t) {
                    var e = 0,
                        i = -1,
                        s = null,
                        n = this.game.input.interactiveItems.first;
                    for (this.interactiveCandidates = []; n;) n.checked = !1, n.validForInput(i, e, !1) && (n.checked = !0, (t && n.checkPointerDown(this, !0) || !t && n.checkPointerOver(this, !0)) && (e = n.sprite.renderOrderID, i = n.priorityID, s = n, this.interactiveCandidates.push(n))), n = this.game.input.interactiveItems.next;
                    for (n = this.game.input.interactiveItems.first; n;) !n.checked && n.validForInput(i, e, !0) && (t && n.checkPointerDown(this, !1) || !t && n.checkPointerOver(this, !1)) && (e = n.sprite.renderOrderID, i = n.priorityID, s = n, this.interactiveCandidates.push(n)), n = this.game.input.interactiveItems.next;
                    return this.game.input.customCandidateHandler && (s = this.game.input.customCandidateHandler.call(this.game.input.customCandidateHandlerContext, this, this.interactiveCandidates, s)), this.swapTarget(s, !1), null !== this.targetObject
                },
                swapTarget: function(t, e) {
                    void 0 === e && (e = !1), null === t ? this.targetObject && (this.targetObject._pointerOutHandler(this, e), this.targetObject = null) : null === this.targetObject ? (this.targetObject = t, t._pointerOverHandler(this, e)) : this.targetObject === t ? !1 === t.update(this) && (this.targetObject = null) : (this.targetObject._pointerOutHandler(this, e), this.targetObject = t, this.targetObject._pointerOverHandler(this, e))
                },
                leave: function(t) {
                    this.withinGame = !1, this.move(t, !1)
                },
                stop: function(t) {
                    var e = this.game.input;
                    return this._stateReset && this.withinGame ? void t.preventDefault() : (this.timeUp = this.game.time.time, (e.multiInputOverride === n.Input.MOUSE_OVERRIDES_TOUCH || e.multiInputOverride === n.Input.MOUSE_TOUCH_COMBINE || e.multiInputOverride === n.Input.TOUCH_OVERRIDES_MOUSE && 0 === e.totalActivePointers) && (e.onUp.dispatch(this, t), this.duration >= 0 && this.duration <= e.tapRate && (this.timeUp - this.previousTapTime < e.doubleTapRate ? e.onTap.dispatch(this, !0) : e.onTap.dispatch(this, !1), this.previousTapTime = this.timeUp)), this.isMouse ? this.updateButtons(t) : (this.isDown = !1, this.isUp = !0), this.id > 0 && (this.active = !1), this.withinGame = this.game.scale.bounds.contains(t.pageX, t.pageY), this.pointerId = null, this.identifier = null, this.positionUp.setTo(this.x, this.y), !1 === this.isMouse && e.currentPointers--, e.interactiveItems.callAll("_releasedHandler", this), this._clickTrampolines && (this._trampolineTargetObject = this.targetObject), this.targetObject = null, this)
                },
                justPressed: function(t) {
                    return t = t || this.game.input.justPressedRate, !0 === this.isDown && this.timeDown + t > this.game.time.time
                },
                justReleased: function(t) {
                    return t = t || this.game.input.justReleasedRate, this.isUp && this.timeUp + t > this.game.time.time
                },
                addClickTrampoline: function(t, e, i, s) {
                    if (this.isDown) {
                        for (var n = this._clickTrampolines = this._clickTrampolines || [], o = 0; o < n.length; o++)
                            if (n[o].name === t) {
                                n.splice(o, 1);
                                break
                            } n.push({
                            name: t,
                            targetObject: this.targetObject,
                            callback: e,
                            callbackContext: i,
                            callbackArgs: s
                        })
                    }
                },
                processClickTrampolines: function() {
                    var t = this._clickTrampolines;
                    if (t) {
                        for (var e = 0; e < t.length; e++) {
                            var i = t[e];
                            i.targetObject === this._trampolineTargetObject && i.callback.apply(i.callbackContext, i.callbackArgs)
                        }
                        this._clickTrampolines = null, this._trampolineTargetObject = null
                    }
                },
                reset: function() {
                    !1 === this.isMouse && (this.active = !1), this.pointerId = null, this.identifier = null, this.dirty = !1, this.totalTouches = 0, this._holdSent = !1, this._history.length = 0, this._stateReset = !0, this.resetButtons(), this.targetObject && this.targetObject._releasedHandler(this), this.targetObject = null
                },
                resetMovement: function() {
                    this.movementX = 0, this.movementY = 0
                }
            }, n.Pointer.prototype.constructor = n.Pointer, Object.defineProperty(n.Pointer.prototype, "duration", {
                get: function() {
                    return this.isUp ? -1 : this.game.time.time - this.timeDown
                }
            }), Object.defineProperty(n.Pointer.prototype, "worldX", {
                get: function() {
                    return this.game.world.camera.x + this.x
                }
            }), Object.defineProperty(n.Pointer.prototype, "worldY", {
                get: function() {
                    return this.game.world.camera.y + this.y
                }
            }), n.PointerMode = {
                CURSOR: 1,
                CONTACT: 2
            }, n.Touch = function(t) {
                this.game = t, this.enabled = !0, this.touchLockCallbacks = [], this.callbackContext = this.game, this.touchStartCallback = null, this.touchMoveCallback = null, this.touchEndCallback = null, this.touchEnterCallback = null, this.touchLeaveCallback = null, this.touchCancelCallback = null, this.preventDefault = !0, this.event = null, this._onTouchStart = null, this._onTouchMove = null, this._onTouchEnd = null, this._onTouchEnter = null, this._onTouchLeave = null, this._onTouchCancel = null, this._onTouchMove = null
            }, n.Touch.prototype = {
                start: function() {
                    if (null === this._onTouchStart) {
                        var t = this;
                        this.game.device.touch && (this._onTouchStart = function(e) {
                            return t.onTouchStart(e)
                        }, this._onTouchMove = function(e) {
                            return t.onTouchMove(e)
                        }, this._onTouchEnd = function(e) {
                            return t.onTouchEnd(e)
                        }, this._onTouchEnter = function(e) {
                            return t.onTouchEnter(e)
                        }, this._onTouchLeave = function(e) {
                            return t.onTouchLeave(e)
                        }, this._onTouchCancel = function(e) {
                            return t.onTouchCancel(e)
                        }, this.game.canvas.addEventListener("touchstart", this._onTouchStart, !1), this.game.canvas.addEventListener("touchmove", this._onTouchMove, !1), this.game.canvas.addEventListener("touchend", this._onTouchEnd, !1), this.game.canvas.addEventListener("touchcancel", this._onTouchCancel, !1), this.game.device.cocoonJS || (this.game.canvas.addEventListener("touchenter", this._onTouchEnter, !1), this.game.canvas.addEventListener("touchleave", this._onTouchLeave, !1)))
                    }
                },
                consumeDocumentTouches: function() {
                    this._documentTouchMove = function(t) {
                        t.preventDefault()
                    }, document.addEventListener("touchmove", this._documentTouchMove, !1)
                },
                addTouchLockCallback: function(t, e, i) {
                    void 0 === i && (i = !1), this.touchLockCallbacks.push({
                        callback: t,
                        context: e,
                        onEnd: i
                    })
                },
                removeTouchLockCallback: function(t, e) {
                    for (var i = this.touchLockCallbacks.length; i--;)
                        if (this.touchLockCallbacks[i].callback === t && this.touchLockCallbacks[i].context === e) return this.touchLockCallbacks.splice(i, 1), !0;
                    return !1
                },
                onTouchStart: function(t) {
                    for (var e = this.touchLockCallbacks.length; e--;) {
                        var i = this.touchLockCallbacks[e];
                        !i.onEnd && i.callback.call(i.context, this, t) && this.touchLockCallbacks.splice(e, 1)
                    }
                    if (this.event = t, this.game.input.enabled && this.enabled) {
                        this.touchStartCallback && this.touchStartCallback.call(this.callbackContext, t), this.preventDefault && t.preventDefault();
                        for (e = 0; e < t.changedTouches.length; e++) this.game.input.startPointer(t.changedTouches[e])
                    }
                },
                onTouchCancel: function(t) {
                    if (this.event = t, this.touchCancelCallback && this.touchCancelCallback.call(this.callbackContext, t), this.game.input.enabled && this.enabled) {
                        this.preventDefault && t.preventDefault();
                        for (var e = 0; e < t.changedTouches.length; e++) this.game.input.stopPointer(t.changedTouches[e])
                    }
                },
                onTouchEnter: function(t) {
                    this.event = t, this.touchEnterCallback && this.touchEnterCallback.call(this.callbackContext, t), this.game.input.enabled && this.enabled && this.preventDefault && t.preventDefault()
                },
                onTouchLeave: function(t) {
                    this.event = t, this.touchLeaveCallback && this.touchLeaveCallback.call(this.callbackContext, t), this.preventDefault && t.preventDefault()
                },
                onTouchMove: function(t) {
                    this.event = t, this.touchMoveCallback && this.touchMoveCallback.call(this.callbackContext, t), this.preventDefault && t.preventDefault();
                    for (var e = 0; e < t.changedTouches.length; e++) this.game.input.updatePointer(t.changedTouches[e])
                },
                onTouchEnd: function(t) {
                    for (var e = this.touchLockCallbacks.length; e--;) {
                        var i = this.touchLockCallbacks[e];
                        i.onEnd && i.callback.call(i.context, this, t) && this.touchLockCallbacks.splice(e, 1)
                    }
                    this.event = t, this.touchEndCallback && this.touchEndCallback.call(this.callbackContext, t), this.preventDefault && t.preventDefault();
                    for (e = 0; e < t.changedTouches.length; e++) this.game.input.stopPointer(t.changedTouches[e])
                },
                stop: function() {
                    this.game.device.touch && (this.game.canvas.removeEventListener("touchstart", this._onTouchStart), this.game.canvas.removeEventListener("touchmove", this._onTouchMove), this.game.canvas.removeEventListener("touchend", this._onTouchEnd), this.game.canvas.removeEventListener("touchenter", this._onTouchEnter), this.game.canvas.removeEventListener("touchleave", this._onTouchLeave), this.game.canvas.removeEventListener("touchcancel", this._onTouchCancel))
                }
            }, n.Touch.prototype.constructor = n.Touch, n.InputHandler = function(t) {
                this.sprite = t, this.game = t.game, this.enabled = !1, this.checked = !1, this.priorityID = 0, this.useHandCursor = !1, this._setHandCursor = !1, this.isDragged = !1, this.allowHorizontalDrag = !0, this.allowVerticalDrag = !0, this.bringToTop = !1, this.snapOffset = null, this.snapOnDrag = !1, this.snapOnRelease = !1, this.snapX = 0, this.snapY = 0, this.snapOffsetX = 0, this.snapOffsetY = 0, this.pixelPerfectOver = !1, this.pixelPerfectClick = !1, this.pixelPerfectAlpha = 255, this.draggable = !1, this.boundsRect = null, this.boundsSprite = null, this.scaleLayer = !1, this.dragOffset = new n.Point, this.dragFromCenter = !1, this.dragStopBlocksInputUp = !1, this.dragStartPoint = new n.Point, this.dragDistanceThreshold = 0, this.dragTimeThreshold = 0, this.downPoint = new n.Point, this.snapPoint = new n.Point, this._dragPoint = new n.Point, this._dragPhase = !1, this._pendingDrag = !1, this._dragTimePass = !1, this._dragDistancePass = !1, this._wasEnabled = !1, this._tempPoint = new n.Point, this._pointerData = [], this._pointerData.push({
                    id: 0,
                    x: 0,
                    y: 0,
                    camX: 0,
                    camY: 0,
                    isDown: !1,
                    isUp: !1,
                    isOver: !1,
                    isOut: !1,
                    timeOver: 0,
                    timeOut: 0,
                    timeDown: 0,
                    timeUp: 0,
                    downDuration: 0,
                    isDragged: !1
                })
            }, n.InputHandler.prototype = {
                start: function(t, e) {
                    if (t = t || 0, void 0 === e && (e = !1), !1 === this.enabled) {
                        this.game.input.interactiveItems.add(this), this.useHandCursor = e, this.priorityID = t;
                        for (var i = 0; i < 10; i++) this._pointerData[i] = {
                            id: i,
                            x: 0,
                            y: 0,
                            isDown: !1,
                            isUp: !1,
                            isOver: !1,
                            isOut: !1,
                            timeOver: 0,
                            timeOut: 0,
                            timeDown: 0,
                            timeUp: 0,
                            downDuration: 0,
                            isDragged: !1
                        };
                        this.snapOffset = new n.Point, this.enabled = !0, this._wasEnabled = !0
                    }
                    return this.sprite.events.onAddedToGroup.add(this.addedToGroup, this), this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup, this), this.sprite
                },
                addedToGroup: function() {
                    this._dragPhase || this._wasEnabled && !this.enabled && this.start()
                },
                removedFromGroup: function() {
                    this._dragPhase || (this.enabled ? (this._wasEnabled = !0, this.stop()) : this._wasEnabled = !1)
                },
                reset: function() {
                    this.enabled = !1;
                    for (var t = 0; t < 10; t++) this._pointerData[t] = {
                        id: t,
                        x: 0,
                        y: 0,
                        isDown: !1,
                        isUp: !1,
                        isOver: !1,
                        isOut: !1,
                        timeOver: 0,
                        timeOut: 0,
                        timeDown: 0,
                        timeUp: 0,
                        downDuration: 0,
                        isDragged: !1
                    }
                },
                stop: function() {
                    !1 !== this.enabled && (this.enabled = !1, this.game.input.interactiveItems.remove(this))
                },
                destroy: function() {
                    this.sprite && (this._setHandCursor && (this.game.canvas.style.cursor = "default", this._setHandCursor = !1), this.enabled = !1, this.game.input.interactiveItems.remove(this), this._pointerData.length = 0, this.boundsRect = null, this.boundsSprite = null, this.sprite = null)
                },
                validForInput: function(t, e, i) {
                    return void 0 === i && (i = !0), !(!this.enabled || 0 === this.sprite.scale.x || 0 === this.sprite.scale.y || this.priorityID < this.game.input.minPriorityID || this.sprite.parent && this.sprite.parent.ignoreChildInput || !i && (this.pixelPerfectClick || this.pixelPerfectOver) || !(this.priorityID > t || this.priorityID === t && this.sprite.renderOrderID > e))
                },
                isPixelPerfect: function() {
                    return this.pixelPerfectClick || this.pixelPerfectOver
                },
                pointerX: function(t) {
                    return t = t || 0, this._pointerData[t].x
                },
                pointerY: function(t) {
                    return t = t || 0, this._pointerData[t].y
                },
                pointerDown: function(t) {
                    return t = t || 0, this._pointerData[t].isDown
                },
                pointerUp: function(t) {
                    return t = t || 0, this._pointerData[t].isUp
                },
                pointerTimeDown: function(t) {
                    return t = t || 0, this._pointerData[t].timeDown
                },
                pointerTimeUp: function(t) {
                    return t = t || 0, this._pointerData[t].timeUp
                },
                pointerOver: function(t) {
                    if (!this.enabled) return !1;
                    if (void 0 === t) {
                        for (var e = 0; e < 10; e++)
                            if (this._pointerData[e].isOver) return !0;
                        return !1
                    }
                    return this._pointerData[t].isOver
                },
                pointerOut: function(t) {
                    if (!this.enabled) return !1;
                    if (void 0 !== t) return this._pointerData[t].isOut;
                    for (var e = 0; e < 10; e++)
                        if (this._pointerData[e].isOut) return !0
                },
                pointerTimeOver: function(t) {
                    return t = t || 0, this._pointerData[t].timeOver
                },
                pointerTimeOut: function(t) {
                    return t = t || 0, this._pointerData[t].timeOut
                },
                pointerDragged: function(t) {
                    return t = t || 0, this._pointerData[t].isDragged
                },
                checkPointerDown: function(t, e) {
                    return !!(t.isDown && this.enabled && this.sprite && this.sprite.parent && this.sprite.visible && this.sprite.parent.visible && 0 !== this.sprite.worldScale.x && 0 !== this.sprite.worldScale.y) && !!this.game.input.hitTest(this.sprite, t, this._tempPoint) && (void 0 === e && (e = !1), !(!e && this.pixelPerfectClick) || this.checkPixel(this._tempPoint.x, this._tempPoint.y))
                },
                checkPointerOver: function(t, e) {
                    return !!(this.enabled && this.sprite && this.sprite.parent && this.sprite.visible && this.sprite.parent.visible && 0 !== this.sprite.worldScale.x && 0 !== this.sprite.worldScale.y) && !!this.game.input.hitTest(this.sprite, t, this._tempPoint) && (void 0 === e && (e = !1), !(!e && this.pixelPerfectOver) || this.checkPixel(this._tempPoint.x, this._tempPoint.y))
                },
                checkPixel: function(t, e, i) {
                    if (this.sprite.texture.baseTexture.source) {
                        if (null === t && null === e) {
                            this.game.input.getLocalPosition(this.sprite, i, this._tempPoint);
                            t = this._tempPoint.x, e = this._tempPoint.y
                        }
                        if (0 !== this.sprite.anchor.x && (t -= -this.sprite.texture.frame.width * this.sprite.anchor.x), 0 !== this.sprite.anchor.y && (e -= -this.sprite.texture.frame.height * this.sprite.anchor.y), t += this.sprite.texture.frame.x, e += this.sprite.texture.frame.y, this.sprite.texture.trim && (t -= this.sprite.texture.trim.x, e -= this.sprite.texture.trim.y, t < this.sprite.texture.crop.x || t > this.sprite.texture.crop.right || e < this.sprite.texture.crop.y || e > this.sprite.texture.crop.bottom)) return this._dx = t, this._dy = e, !1;
                        if (this._dx = t, this._dy = e, this.game.input.hitContext.clearRect(0, 0, 1, 1), this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source, t, e, 1, 1, 0, 0, 1, 1), this.game.input.hitContext.getImageData(0, 0, 1, 1).data[3] >= this.pixelPerfectAlpha) return !0
                    }
                    return !1
                },
                update: function(t) {
                    if (null !== this.sprite && void 0 !== this.sprite.parent) return this.enabled && this.sprite.visible && this.sprite.parent.visible ? this._pendingDrag ? (this._dragDistancePass || (this._dragDistancePass = n.Math.distance(t.x, t.y, this.downPoint.x, this.downPoint.y) >= this.dragDistanceThreshold), this._dragDistancePass && this._dragTimePass && this.startDrag(t), !0) : this.draggable && this._draggedPointerID === t.id ? this.updateDrag(t, !1) : this._pointerData[t.id].isOver ? this.checkPointerOver(t) ? (this._pointerData[t.id].x = t.x - this.sprite.x, this._pointerData[t.id].y = t.y - this.sprite.y, !0) : (this._pointerOutHandler(t), !1) : void 0 : (this._pointerOutHandler(t), !1)
                },
                _pointerOverHandler: function(t, e) {
                    if (null !== this.sprite) {
                        var i = this._pointerData[t.id];
                        if (!1 === i.isOver || t.dirty) {
                            var s = !1 === i.isOver;
                            i.isOver = !0, i.isOut = !1, i.timeOver = this.game.time.time, i.x = t.x - this.sprite.x, i.y = t.y - this.sprite.y, this.useHandCursor && !1 === i.isDragged && (this.game.canvas.style.cursor = "pointer", this._setHandCursor = !0), !e && s && this.sprite && this.sprite.events && this.sprite.events.onInputOver$dispatch(this.sprite, t), this.sprite.parent && this.sprite.parent.type === n.GROUP && this.sprite.parent.onChildInputOver.dispatch(this.sprite, t)
                        }
                    }
                },
                _pointerOutHandler: function(t, e) {
                    if (null !== this.sprite) {
                        var i = this._pointerData[t.id];
                        i.isOver = !1, i.isOut = !0, i.timeOut = this.game.time.time, this.useHandCursor && !1 === i.isDragged && (this.game.canvas.style.cursor = "default", this._setHandCursor = !1), !e && this.sprite && this.sprite.events && (this.sprite.events.onInputOut$dispatch(this.sprite, t), this.sprite && this.sprite.parent && this.sprite.parent.type === n.GROUP && this.sprite.parent.onChildInputOut.dispatch(this.sprite, t))
                    }
                },
                _touchedHandler: function(t) {
                    if (null !== this.sprite) {
                        var e = this._pointerData[t.id];
                        if (!e.isDown && e.isOver) {
                            if (this.pixelPerfectClick && !this.checkPixel(null, null, t)) return;
                            if (e.isDown = !0, e.isUp = !1, e.timeDown = this.game.time.time, this.downPoint.set(t.x, t.y), t.dirty = !0, this.sprite && this.sprite.events && (this.sprite.events.onInputDown$dispatch(this.sprite, t), this.sprite && this.sprite.parent && this.sprite.parent.type === n.GROUP && this.sprite.parent.onChildInputDown.dispatch(this.sprite, t), null === this.sprite)) return;
                            this.draggable && !1 === this.isDragged && (0 === this.dragTimeThreshold && 0 === this.dragDistanceThreshold ? this.startDrag(t) : (this._pendingDrag = !0, this._dragDistancePass = 0 === this.dragDistanceThreshold, this.dragTimeThreshold > 0 ? (this._dragTimePass = !1, this.game.time.events.add(this.dragTimeThreshold, this.dragTimeElapsed, this, t)) : this._dragTimePass = !0)), this.bringToTop && this.sprite.bringToTop()
                        }
                    }
                },
                dragTimeElapsed: function(t) {
                    this._dragTimePass = !0, this._pendingDrag && this.sprite && this._dragDistancePass && this.startDrag(t)
                },
                _releasedHandler: function(t) {
                    if (null !== this.sprite) {
                        var e = this._pointerData[t.id];
                        if (e.isDown && t.isUp) {
                            e.isDown = !1, e.isUp = !0, e.timeUp = this.game.time.time, e.downDuration = e.timeUp - e.timeDown;
                            var i = this.checkPointerOver(t);
                            this.sprite && this.sprite.events && (this.dragStopBlocksInputUp && (!this.dragStopBlocksInputUp || this.draggable && this.isDragged && this._draggedPointerID === t.id) || this.sprite.events.onInputUp$dispatch(this.sprite, t, i), this.sprite && this.sprite.parent && this.sprite.parent.type === n.GROUP && this.sprite.parent.onChildInputUp.dispatch(this.sprite, t, i), i && (i = this.checkPointerOver(t))), e.isOver = i, !i && this.useHandCursor && (this.game.canvas.style.cursor = "default", this._setHandCursor = !1), t.dirty = !0, this._pendingDrag = !1, this.draggable && this.isDragged && this._draggedPointerID === t.id && this.stopDrag(t)
                        }
                    }
                },
                updateDrag: function(t, e) {
                    if (void 0 === e && (e = !1), t.isUp) return this.stopDrag(t), !1;
                    var i = this.globalToLocalX(t.x) + this._dragPoint.x + this.dragOffset.x,
                        s = this.globalToLocalY(t.y) + this._dragPoint.y + this.dragOffset.y;
                    if (this.sprite.fixedToCamera) this.allowHorizontalDrag && (this.sprite.cameraOffset.x = i), this.allowVerticalDrag && (this.sprite.cameraOffset.y = s), this.boundsRect && this.checkBoundsRect(), this.boundsSprite && this.checkBoundsSprite(), this.snapOnDrag && (this.sprite.cameraOffset.x = Math.round((this.sprite.cameraOffset.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, this.sprite.cameraOffset.y = Math.round((this.sprite.cameraOffset.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY, this.snapPoint.set(this.sprite.cameraOffset.x, this.sprite.cameraOffset.y));
                    else {
                        var n = this.game.camera.x - this._pointerData[t.id].camX,
                            o = this.game.camera.y - this._pointerData[t.id].camY;
                        this.allowHorizontalDrag && (this.sprite.x = i + n), this.allowVerticalDrag && (this.sprite.y = s + o), this.boundsRect && this.checkBoundsRect(), this.boundsSprite && this.checkBoundsSprite(), this.snapOnDrag && (this.sprite.x = Math.round((this.sprite.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, this.sprite.y = Math.round((this.sprite.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY, this.snapPoint.set(this.sprite.x, this.sprite.y))
                    }
                    return this.sprite.events.onDragUpdate.dispatch(this.sprite, t, i, s, this.snapPoint, e), !0
                },
                justOver: function(t, e) {
                    return t = t || 0, e = e || 500, this._pointerData[t].isOver && this.overDuration(t) < e
                },
                justOut: function(t, e) {
                    return t = t || 0, e = e || 500, this._pointerData[t].isOut && this.game.time.time - this._pointerData[t].timeOut < e
                },
                justPressed: function(t, e) {
                    return t = t || 0, e = e || 500, this._pointerData[t].isDown && this.downDuration(t) < e
                },
                justReleased: function(t, e) {
                    return t = t || 0, e = e || 500, this._pointerData[t].isUp && this.game.time.time - this._pointerData[t].timeUp < e
                },
                overDuration: function(t) {
                    return t = t || 0, this._pointerData[t].isOver ? this.game.time.time - this._pointerData[t].timeOver : -1
                },
                downDuration: function(t) {
                    return t = t || 0, this._pointerData[t].isDown ? this.game.time.time - this._pointerData[t].timeDown : -1
                },
                enableDrag: function(t, e, i, s, o, r) {
                    void 0 === t && (t = !1), void 0 === e && (e = !1), void 0 === i && (i = !1), void 0 === s && (s = 255), void 0 === o && (o = null), void 0 === r && (r = null), this._dragPoint = new n.Point, this.draggable = !0, this.bringToTop = e, this.dragOffset = new n.Point, this.dragFromCenter = t, this.pixelPerfectClick = i, this.pixelPerfectAlpha = s, o && (this.boundsRect = o), r && (this.boundsSprite = r)
                },
                disableDrag: function() {
                    if (this._pointerData)
                        for (var t = 0; t < 10; t++) this._pointerData[t].isDragged = !1;
                    this.draggable = !1, this.isDragged = !1, this._draggedPointerID = -1, this._pendingDrag = !1
                },
                startDrag: function(t) {
                    var e = this.sprite.x,
                        i = this.sprite.y;
                    if (this.isDragged = !0, this._draggedPointerID = t.id, this._pointerData[t.id].camX = this.game.camera.x, this._pointerData[t.id].camY = this.game.camera.y, this._pointerData[t.id].isDragged = !0, this.sprite.fixedToCamera) {
                        if (this.dragFromCenter) {
                            var s = this.sprite.getBounds();
                            this.sprite.cameraOffset.x = this.globalToLocalX(t.x) + (this.sprite.cameraOffset.x - s.centerX), this.sprite.cameraOffset.y = this.globalToLocalY(t.y) + (this.sprite.cameraOffset.y - s.centerY)
                        }
                        this._dragPoint.setTo(this.sprite.cameraOffset.x - t.x, this.sprite.cameraOffset.y - t.y)
                    } else {
                        if (this.dragFromCenter) {
                            s = this.sprite.getBounds();
                            this.sprite.x = this.globalToLocalX(t.x) + (this.sprite.x - s.centerX), this.sprite.y = this.globalToLocalY(t.y) + (this.sprite.y - s.centerY)
                        }
                        this._dragPoint.setTo(this.sprite.x - this.globalToLocalX(t.x), this.sprite.y - this.globalToLocalY(t.y))
                    }
                    this.updateDrag(t, !0), this.bringToTop && (this._dragPhase = !0, this.sprite.bringToTop()), this.dragStartPoint.set(e, i), this.sprite.events.onDragStart$dispatch(this.sprite, t, e, i), this._pendingDrag = !1
                },
                globalToLocalX: function(t) {
                    return this.scaleLayer && (t -= this.game.scale.grid.boundsFluid.x, t *= this.game.scale.grid.scaleFluidInversed.x), t
                },
                globalToLocalY: function(t) {
                    return this.scaleLayer && (t -= this.game.scale.grid.boundsFluid.y, t *= this.game.scale.grid.scaleFluidInversed.y), t
                },
                stopDrag: function(t) {
                    this.isDragged = !1, this._draggedPointerID = -1, this._pointerData[t.id].isDragged = !1, this._dragPhase = !1, this._pendingDrag = !1, this.snapOnRelease && (this.sprite.fixedToCamera ? (this.sprite.cameraOffset.x = Math.round((this.sprite.cameraOffset.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, this.sprite.cameraOffset.y = Math.round((this.sprite.cameraOffset.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY) : (this.sprite.x = Math.round((this.sprite.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, this.sprite.y = Math.round((this.sprite.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY)), this.sprite.events.onDragStop$dispatch(this.sprite, t), !1 === this.checkPointerOver(t) && this._pointerOutHandler(t)
                },
                setDragLock: function(t, e) {
                    void 0 === t && (t = !0), void 0 === e && (e = !0), this.allowHorizontalDrag = t, this.allowVerticalDrag = e
                },
                enableSnap: function(t, e, i, s, n, o) {
                    void 0 === i && (i = !0), void 0 === s && (s = !1), void 0 === n && (n = 0), void 0 === o && (o = 0), this.snapX = t, this.snapY = e, this.snapOffsetX = n, this.snapOffsetY = o, this.snapOnDrag = i, this.snapOnRelease = s
                },
                disableSnap: function() {
                    this.snapOnDrag = !1, this.snapOnRelease = !1
                },
                checkBoundsRect: function() {
                    this.sprite.fixedToCamera ? (this.sprite.cameraOffset.x < this.boundsRect.left ? this.sprite.cameraOffset.x = this.boundsRect.left : this.sprite.cameraOffset.x + this.sprite.width > this.boundsRect.right && (this.sprite.cameraOffset.x = this.boundsRect.right - this.sprite.width), this.sprite.cameraOffset.y < this.boundsRect.top ? this.sprite.cameraOffset.y = this.boundsRect.top : this.sprite.cameraOffset.y + this.sprite.height > this.boundsRect.bottom && (this.sprite.cameraOffset.y = this.boundsRect.bottom - this.sprite.height)) : (this.sprite.left < this.boundsRect.left ? this.sprite.x = this.boundsRect.x + this.sprite.offsetX : this.sprite.right > this.boundsRect.right && (this.sprite.x = this.boundsRect.right - (this.sprite.width - this.sprite.offsetX)), this.sprite.top < this.boundsRect.top ? this.sprite.y = this.boundsRect.top + this.sprite.offsetY : this.sprite.bottom > this.boundsRect.bottom && (this.sprite.y = this.boundsRect.bottom - (this.sprite.height - this.sprite.offsetY)))
                },
                checkBoundsSprite: function() {
                    this.sprite.fixedToCamera && this.boundsSprite.fixedToCamera ? (this.sprite.cameraOffset.x < this.boundsSprite.cameraOffset.x ? this.sprite.cameraOffset.x = this.boundsSprite.cameraOffset.x : this.sprite.cameraOffset.x + this.sprite.width > this.boundsSprite.cameraOffset.x + this.boundsSprite.width && (this.sprite.cameraOffset.x = this.boundsSprite.cameraOffset.x + this.boundsSprite.width - this.sprite.width), this.sprite.cameraOffset.y < this.boundsSprite.cameraOffset.y ? this.sprite.cameraOffset.y = this.boundsSprite.cameraOffset.y : this.sprite.cameraOffset.y + this.sprite.height > this.boundsSprite.cameraOffset.y + this.boundsSprite.height && (this.sprite.cameraOffset.y = this.boundsSprite.cameraOffset.y + this.boundsSprite.height - this.sprite.height)) : (this.sprite.left < this.boundsSprite.left ? this.sprite.x = this.boundsSprite.left + this.sprite.offsetX : this.sprite.right > this.boundsSprite.right && (this.sprite.x = this.boundsSprite.right - (this.sprite.width - this.sprite.offsetX)), this.sprite.top < this.boundsSprite.top ? this.sprite.y = this.boundsSprite.top + this.sprite.offsetY : this.sprite.bottom > this.boundsSprite.bottom && (this.sprite.y = this.boundsSprite.bottom - (this.sprite.height - this.sprite.offsetY)))
                }
            }, n.InputHandler.prototype.constructor = n.InputHandler, n.Gamepad = function(t) {
                this.game = t, this._gamepadIndexMap = {}, this._rawPads = [], this._active = !1, this.enabled = !0, this._gamepadSupportAvailable = !!navigator.webkitGetGamepads || !!navigator.webkitGamepads || -1 !== navigator.userAgent.indexOf("Firefox/") || !!navigator.getGamepads, this._prevRawGamepadTypes = [], this._prevTimestamps = [], this.callbackContext = this, this.onConnectCallback = null, this.onDisconnectCallback = null, this.onDownCallback = null, this.onUpCallback = null, this.onAxisCallback = null, this.onFloatCallback = null, this._ongamepadconnected = null, this._gamepaddisconnected = null, this._gamepads = [new n.SinglePad(t, this), new n.SinglePad(t, this), new n.SinglePad(t, this), new n.SinglePad(t, this)]
            }, n.Gamepad.prototype = {
                addCallbacks: function(t, e) {
                    void 0 !== e && (this.onConnectCallback = "function" == typeof e.onConnect ? e.onConnect : this.onConnectCallback, this.onDisconnectCallback = "function" == typeof e.onDisconnect ? e.onDisconnect : this.onDisconnectCallback, this.onDownCallback = "function" == typeof e.onDown ? e.onDown : this.onDownCallback, this.onUpCallback = "function" == typeof e.onUp ? e.onUp : this.onUpCallback, this.onAxisCallback = "function" == typeof e.onAxis ? e.onAxis : this.onAxisCallback, this.onFloatCallback = "function" == typeof e.onFloat ? e.onFloat : this.onFloatCallback, this.callbackContext = t)
                },
                start: function() {
                    if (!this._active) {
                        this._active = !0;
                        var t = this;
                        this._onGamepadConnected = function(e) {
                            return t.onGamepadConnected(e)
                        }, this._onGamepadDisconnected = function(e) {
                            return t.onGamepadDisconnected(e)
                        }, window.addEventListener("gamepadconnected", this._onGamepadConnected, !1), window.addEventListener("gamepaddisconnected", this._onGamepadDisconnected, !1)
                    }
                },
                onGamepadConnected: function(t) {
                    var e = t.gamepad;
                    this._rawPads.push(e), this._gamepads[e.index].connect(e)
                },
                onGamepadDisconnected: function(t) {
                    var e = t.gamepad;
                    for (var i in this._rawPads) this._rawPads[i].index === e.index && this._rawPads.splice(i, 1);
                    this._gamepads[e.index].disconnect()
                },
                update: function() {
                    this._pollGamepads(), this.pad1.pollStatus(), this.pad2.pollStatus(), this.pad3.pollStatus(), this.pad4.pollStatus()
                },
                _pollGamepads: function() {
                    if (this._active) {
                        if (navigator.getGamepads) var t = navigator.getGamepads();
                        else if (navigator.webkitGetGamepads) t = navigator.webkitGetGamepads();
                        else if (navigator.webkitGamepads) t = navigator.webkitGamepads();
                        if (t) {
                            this._rawPads = [];
                            for (var e = !1, i = 0; i < t.length && (typeof t[i] !== this._prevRawGamepadTypes[i] && (e = !0, this._prevRawGamepadTypes[i] = typeof t[i]), t[i] && this._rawPads.push(t[i]), 3 !== i); i++);
                            for (var s = 0; s < this._gamepads.length; s++) this._gamepads[s]._rawPad = this._rawPads[s];
                            if (e) {
                                for (var n, o = {
                                        rawIndices: {},
                                        padIndices: {}
                                    }, r = 0; r < this._gamepads.length; r++)
                                    if ((n = this._gamepads[r]).connected)
                                        for (var a = 0; a < this._rawPads.length; a++) this._rawPads[a].index === n.index && (o.rawIndices[n.index] = !0, o.padIndices[r] = !0);
                                for (var h = 0; h < this._gamepads.length; h++)
                                    if (n = this._gamepads[h], !o.padIndices[h]) {
                                        this._rawPads.length < 1 && n.disconnect();
                                        for (var l = 0; l < this._rawPads.length && !o.padIndices[h]; l++) {
                                            var c = this._rawPads[l];
                                            if (c) {
                                                if (o.rawIndices[c.index]) {
                                                    n.disconnect();
                                                    continue
                                                }
                                                n.connect(c), o.rawIndices[c.index] = !0, o.padIndices[h] = !0
                                            } else n.disconnect()
                                        }
                                    }
                            }
                        }
                    }
                },
                setDeadZones: function(t) {
                    for (var e = 0; e < this._gamepads.length; e++) this._gamepads[e].deadZone = t
                },
                stop: function() {
                    this._active = !1, window.removeEventListener("gamepadconnected", this._onGamepadConnected), window.removeEventListener("gamepaddisconnected", this._onGamepadDisconnected)
                },
                reset: function() {
                    this.update();
                    for (var t = 0; t < this._gamepads.length; t++) this._gamepads[t].reset()
                },
                justPressed: function(t, e) {
                    for (var i = 0; i < this._gamepads.length; i++)
                        if (!0 === this._gamepads[i].justPressed(t, e)) return !0;
                    return !1
                },
                justReleased: function(t, e) {
                    for (var i = 0; i < this._gamepads.length; i++)
                        if (!0 === this._gamepads[i].justReleased(t, e)) return !0;
                    return !1
                },
                isDown: function(t) {
                    for (var e = 0; e < this._gamepads.length; e++)
                        if (!0 === this._gamepads[e].isDown(t)) return !0;
                    return !1
                },
                destroy: function() {
                    this.stop();
                    for (var t = 0; t < this._gamepads.length; t++) this._gamepads[t].destroy()
                }
            }, n.Gamepad.prototype.constructor = n.Gamepad, Object.defineProperty(n.Gamepad.prototype, "active", {
                get: function() {
                    return this._active
                }
            }), Object.defineProperty(n.Gamepad.prototype, "supported", {
                get: function() {
                    return this._gamepadSupportAvailable
                }
            }), Object.defineProperty(n.Gamepad.prototype, "padsConnected", {
                get: function() {
                    return this._rawPads.length
                }
            }), Object.defineProperty(n.Gamepad.prototype, "pad1", {
                get: function() {
                    return this._gamepads[0]
                }
            }), Object.defineProperty(n.Gamepad.prototype, "pad2", {
                get: function() {
                    return this._gamepads[1]
                }
            }), Object.defineProperty(n.Gamepad.prototype, "pad3", {
                get: function() {
                    return this._gamepads[2]
                }
            }), Object.defineProperty(n.Gamepad.prototype, "pad4", {
                get: function() {
                    return this._gamepads[3]
                }
            }), n.Gamepad.BUTTON_0 = 0, n.Gamepad.BUTTON_1 = 1, n.Gamepad.BUTTON_2 = 2, n.Gamepad.BUTTON_3 = 3, n.Gamepad.BUTTON_4 = 4, n.Gamepad.BUTTON_5 = 5, n.Gamepad.BUTTON_6 = 6, n.Gamepad.BUTTON_7 = 7, n.Gamepad.BUTTON_8 = 8, n.Gamepad.BUTTON_9 = 9, n.Gamepad.BUTTON_10 = 10, n.Gamepad.BUTTON_11 = 11, n.Gamepad.BUTTON_12 = 12, n.Gamepad.BUTTON_13 = 13, n.Gamepad.BUTTON_14 = 14, n.Gamepad.BUTTON_15 = 15, n.Gamepad.AXIS_0 = 0, n.Gamepad.AXIS_1 = 1, n.Gamepad.AXIS_2 = 2, n.Gamepad.AXIS_3 = 3, n.Gamepad.AXIS_4 = 4, n.Gamepad.AXIS_5 = 5, n.Gamepad.AXIS_6 = 6, n.Gamepad.AXIS_7 = 7, n.Gamepad.AXIS_8 = 8, n.Gamepad.AXIS_9 = 9, n.Gamepad.XBOX360_A = 0, n.Gamepad.XBOX360_B = 1, n.Gamepad.XBOX360_X = 2, n.Gamepad.XBOX360_Y = 3, n.Gamepad.XBOX360_LEFT_BUMPER = 4, n.Gamepad.XBOX360_RIGHT_BUMPER = 5, n.Gamepad.XBOX360_LEFT_TRIGGER = 6, n.Gamepad.XBOX360_RIGHT_TRIGGER = 7, n.Gamepad.XBOX360_BACK = 8, n.Gamepad.XBOX360_START = 9, n.Gamepad.XBOX360_STICK_LEFT_BUTTON = 10, n.Gamepad.XBOX360_STICK_RIGHT_BUTTON = 11, n.Gamepad.XBOX360_DPAD_LEFT = 14, n.Gamepad.XBOX360_DPAD_RIGHT = 15, n.Gamepad.XBOX360_DPAD_UP = 12, n.Gamepad.XBOX360_DPAD_DOWN = 13, n.Gamepad.XBOX360_STICK_LEFT_X = 0, n.Gamepad.XBOX360_STICK_LEFT_Y = 1, n.Gamepad.XBOX360_STICK_RIGHT_X = 2, n.Gamepad.XBOX360_STICK_RIGHT_Y = 3, n.Gamepad.PS3XC_X = 0, n.Gamepad.PS3XC_CIRCLE = 1, n.Gamepad.PS3XC_SQUARE = 2, n.Gamepad.PS3XC_TRIANGLE = 3, n.Gamepad.PS3XC_L1 = 4, n.Gamepad.PS3XC_R1 = 5, n.Gamepad.PS3XC_L2 = 6, n.Gamepad.PS3XC_R2 = 7, n.Gamepad.PS3XC_SELECT = 8, n.Gamepad.PS3XC_START = 9, n.Gamepad.PS3XC_STICK_LEFT_BUTTON = 10, n.Gamepad.PS3XC_STICK_RIGHT_BUTTON = 11, n.Gamepad.PS3XC_DPAD_UP = 12, n.Gamepad.PS3XC_DPAD_DOWN = 13, n.Gamepad.PS3XC_DPAD_LEFT = 14, n.Gamepad.PS3XC_DPAD_RIGHT = 15, n.Gamepad.PS3XC_STICK_LEFT_X = 0, n.Gamepad.PS3XC_STICK_LEFT_Y = 1, n.Gamepad.PS3XC_STICK_RIGHT_X = 2, n.Gamepad.PS3XC_STICK_RIGHT_Y = 3, n.SinglePad = function(t, e) {
                this.game = t, this.index = null, this.connected = !1, this.callbackContext = this, this.onConnectCallback = null, this.onDisconnectCallback = null, this.onDownCallback = null, this.onUpCallback = null, this.onAxisCallback = null, this.onFloatCallback = null, this.deadZone = .26, this._padParent = e, this._rawPad = null, this._prevTimestamp = null, this._buttons = [], this._buttonsLen = 0, this._axes = [], this._axesLen = 0
            }, n.SinglePad.prototype = {
                addCallbacks: function(t, e) {
                    void 0 !== e && (this.onConnectCallback = "function" == typeof e.onConnect ? e.onConnect : this.onConnectCallback, this.onDisconnectCallback = "function" == typeof e.onDisconnect ? e.onDisconnect : this.onDisconnectCallback, this.onDownCallback = "function" == typeof e.onDown ? e.onDown : this.onDownCallback, this.onUpCallback = "function" == typeof e.onUp ? e.onUp : this.onUpCallback, this.onAxisCallback = "function" == typeof e.onAxis ? e.onAxis : this.onAxisCallback, this.onFloatCallback = "function" == typeof e.onFloat ? e.onFloat : this.onFloatCallback, this.callbackContext = t)
                },
                getButton: function(t) {
                    return this._buttons[t] ? this._buttons[t] : null
                },
                pollStatus: function() {
                    if (this.connected && this.game.input.enabled && this.game.input.gamepad.enabled && (!this._rawPad.timestamp || this._rawPad.timestamp !== this._prevTimestamp)) {
                        for (var t = 0; t < this._buttonsLen; t++) {
                            var e = isNaN(this._rawPad.buttons[t]) ? this._rawPad.buttons[t].value : this._rawPad.buttons[t];
                            e !== this._buttons[t].value && (1 === e ? this.processButtonDown(t, e) : 0 === e ? this.processButtonUp(t, e) : this.processButtonFloat(t, e))
                        }
                        for (var i = 0; i < this._axesLen; i++) {
                            var s = this._rawPad.axes[i];
                            s > 0 && s > this.deadZone || s < 0 && s < -this.deadZone ? this.processAxisChange(i, s) : this.processAxisChange(i, 0)
                        }
                        this._prevTimestamp = this._rawPad.timestamp
                    }
                },
                connect: function(t) {
                    var e = !this.connected;
                    this.connected = !0, this.index = t.index, this._rawPad = t, this._buttons = [], this._buttonsLen = t.buttons.length, this._axes = [], this._axesLen = t.axes.length;
                    for (var i = 0; i < this._axesLen; i++) this._axes[i] = t.axes[i];
                    for (var s in t.buttons) s = parseInt(s, 10), this._buttons[s] = new n.DeviceButton(this, s);
                    e && this._padParent.onConnectCallback && this._padParent.onConnectCallback.call(this._padParent.callbackContext, this.index), e && this.onConnectCallback && this.onConnectCallback.call(this.callbackContext)
                },
                disconnect: function() {
                    var t = this.connected,
                        e = this.index;
                    this.connected = !1, this.index = null, this._rawPad = void 0;
                    for (var i = 0; i < this._buttonsLen; i++) this._buttons[i].destroy();
                    this._buttons = [], this._buttonsLen = 0, this._axes = [], this._axesLen = 0, t && this._padParent.onDisconnectCallback && this._padParent.onDisconnectCallback.call(this._padParent.callbackContext, e), t && this.onDisconnectCallback && this.onDisconnectCallback.call(this.callbackContext)
                },
                destroy: function() {
                    this._rawPad = void 0;
                    for (var t = 0; t < this._buttonsLen; t++) this._buttons[t].destroy();
                    this._buttons = [], this._buttonsLen = 0, this._axes = [], this._axesLen = 0, this.onConnectCallback = null, this.onDisconnectCallback = null, this.onDownCallback = null, this.onUpCallback = null, this.onAxisCallback = null, this.onFloatCallback = null
                },
                processAxisChange: function(t, e) {
                    this._axes[t] !== e && (this._axes[t] = e, this._padParent.onAxisCallback && this._padParent.onAxisCallback.call(this._padParent.callbackContext, this, t, e), this.onAxisCallback && this.onAxisCallback.call(this.callbackContext, this, t, e))
                },
                processButtonDown: function(t, e) {
                    this._buttons[t] && this._buttons[t].start(null, e), this._padParent.onDownCallback && this._padParent.onDownCallback.call(this._padParent.callbackContext, t, e, this.index), this.onDownCallback && this.onDownCallback.call(this.callbackContext, t, e)
                },
                processButtonUp: function(t, e) {
                    this._padParent.onUpCallback && this._padParent.onUpCallback.call(this._padParent.callbackContext, t, e, this.index), this.onUpCallback && this.onUpCallback.call(this.callbackContext, t, e), this._buttons[t] && this._buttons[t].stop(null, e)
                },
                processButtonFloat: function(t, e) {
                    this._padParent.onFloatCallback && this._padParent.onFloatCallback.call(this._padParent.callbackContext, t, e, this.index), this.onFloatCallback && this.onFloatCallback.call(this.callbackContext, t, e), this._buttons[t] && this._buttons[t].padFloat(e)
                },
                axis: function(t) {
                    return !!this._axes[t] && this._axes[t]
                },
                isDown: function(t) {
                    return !!this._buttons[t] && this._buttons[t].isDown
                },
                isUp: function(t) {
                    return !!this._buttons[t] && this._buttons[t].isUp
                },
                justReleased: function(t, e) {
                    if (this._buttons[t]) return this._buttons[t].justReleased(e)
                },
                justPressed: function(t, e) {
                    if (this._buttons[t]) return this._buttons[t].justPressed(e)
                },
                buttonValue: function(t) {
                    return this._buttons[t] ? this._buttons[t].value : null
                },
                reset: function() {
                    for (var t = 0; t < this._axes.length; t++) this._axes[t] = 0
                }
            }, n.SinglePad.prototype.constructor = n.SinglePad, n.Key = function(t, e) {
                this.game = t, this._enabled = !0, this.event = null, this.isDown = !1, this.isUp = !0, this.altKey = !1, this.ctrlKey = !1, this.shiftKey = !1, this.timeDown = 0, this.duration = 0, this.timeUp = -2500, this.durationUp = -2500, this.repeats = 0, this.keyCode = e, this.onDown = new n.Signal, this.onHoldCallback = null, this.onHoldContext = null, this.onUp = new n.Signal, this._justDown = !1, this._justUp = !1
            }, n.Key.prototype = {
                update: function() {
                    this._enabled && (this.isDown ? (this.duration = this.game.time.time - this.timeDown, this.repeats++, this.onHoldCallback && this.onHoldCallback.call(this.onHoldContext, this)) : this.durationUp = this.game.time.time - this.timeUp)
                },
                processKeyDown: function(t) {
                    this._enabled && (this.event = t, this.isDown || (this.altKey = t.altKey, this.ctrlKey = t.ctrlKey, this.shiftKey = t.shiftKey, this.isDown = !0, this.isUp = !1, this.timeDown = this.game.time.time, this.duration = 0, this.durationUp = this.game.time.time - this.timeUp, this.repeats = 0, this._justDown = !0, this.onDown.dispatch(this)))
                },
                processKeyUp: function(t) {
                    this._enabled && (this.event = t, this.isUp || (this.isDown = !1, this.isUp = !0, this.timeUp = this.game.time.time, this.duration = this.game.time.time - this.timeDown, this.durationUp = 0, this._justUp = !0, this.onUp.dispatch(this)))
                },
                reset: function(t) {
                    void 0 === t && (t = !0), this.isDown = !1, this.isUp = !0, this.timeUp = this.game.time.time, this.duration = 0, this.durationUp = -2500, this._enabled = !0, this._justDown = !1, this._justUp = !1, t && (this.onDown.removeAll(), this.onUp.removeAll(), this.onHoldCallback = null, this.onHoldContext = null)
                },
                downDuration: function(t) {
                    return void 0 === t && (t = 50), this.isDown && this.duration < t
                },
                upDuration: function(t) {
                    return void 0 === t && (t = 50), !this.isDown && this.game.time.time - this.timeUp < t
                },
                justPressed: function() {
                    return this.isDown && 0 === this.duration
                },
                justReleased: function() {
                    return !this.isDown && 0 === this.durationUp
                }
            }, Object.defineProperty(n.Key.prototype, "justDown", {
                get: function() {
                    var t = this._justDown;
                    return this._justDown = !1, t
                }
            }), Object.defineProperty(n.Key.prototype, "justUp", {
                get: function() {
                    var t = this._justUp;
                    return this._justUp = !1, t
                }
            }), Object.defineProperty(n.Key.prototype, "enabled", {
                get: function() {
                    return this._enabled
                },
                set: function(t) {
                    (t = !!t) !== this._enabled && (t || this.reset(!1), this._enabled = t)
                }
            }), n.Key.prototype.constructor = n.Key, n.Keyboard = function(t) {
                this.game = t, this.enabled = !0, this.event = null, this.pressEvent = null, this.callbackContext = this, this.onDownCallback = null, this.onPressCallback = null, this.onUpCallback = null, this._keys = [], this._capture = [], this._onKeyDown = null, this._onKeyPress = null, this._onKeyUp = null, this._i = 0, this._k = 0
            }, n.Keyboard.prototype = {
                addCallbacks: function(t, e, i, s) {
                    this.callbackContext = t, null != e && (this.onDownCallback = e), null != i && (this.onUpCallback = i), null != s && (this.onPressCallback = s)
                },
                addKey: function(t) {
                    return this._keys[t] || (this._keys[t] = new n.Key(this.game, t), this.addKeyCapture(t)), this._keys[t]
                },
                addKeys: function(t) {
                    var e = {};
                    for (var i in t) e[i] = this.addKey(t[i]);
                    return e
                },
                removeKey: function(t) {
                    this._keys[t] && (this._keys[t] = null, this.removeKeyCapture(t))
                },
                createCursorKeys: function() {
                    return this.addKeys({
                        up: n.KeyCode.UP,
                        down: n.KeyCode.DOWN,
                        left: n.KeyCode.LEFT,
                        right: n.KeyCode.RIGHT
                    })
                },
                start: function() {
                    if (!this.game.device.cocoonJS && null === this._onKeyDown) {
                        var t = this;
                        this._onKeyDown = function(e) {
                            return t.processKeyDown(e)
                        }, this._onKeyUp = function(e) {
                            return t.processKeyUp(e)
                        }, this._onKeyPress = function(e) {
                            return t.processKeyPress(e)
                        }, window.addEventListener("keydown", this._onKeyDown, !1), window.addEventListener("keyup", this._onKeyUp, !1), window.addEventListener("keypress", this._onKeyPress, !1)
                    }
                },
                stop: function() {
                    window.removeEventListener("keydown", this._onKeyDown), window.removeEventListener("keyup", this._onKeyUp), window.removeEventListener("keypress", this._onKeyPress), this._onKeyDown = null, this._onKeyUp = null, this._onKeyPress = null
                },
                destroy: function() {
                    this.stop(), this.clearCaptures(), this._keys.length = 0, this._i = 0
                },
                addKeyCapture: function(t) {
                    if ("object" == typeof t)
                        for (var e in t) this._capture[t[e]] = !0;
                    else this._capture[t] = !0
                },
                removeKeyCapture: function(t) {
                    delete this._capture[t]
                },
                clearCaptures: function() {
                    this._capture = {}
                },
                update: function() {
                    for (this._i = this._keys.length; this._i--;) this._keys[this._i] && this._keys[this._i].update()
                },
                processKeyDown: function(t) {
                    if (this.event = t, this.game.input.enabled && this.enabled) {
                        var e = t.keyCode;
                        this._capture[e] && t.preventDefault(), this._keys[e] || (this._keys[e] = new n.Key(this.game, e)), this._keys[e].processKeyDown(t), this._k = e, this.onDownCallback && this.onDownCallback.call(this.callbackContext, t)
                    }
                },
                processKeyPress: function(t) {
                    this.pressEvent = t, this.game.input.enabled && this.enabled && this.onPressCallback && this.onPressCallback.call(this.callbackContext, String.fromCharCode(t.charCode), t)
                },
                processKeyUp: function(t) {
                    if (this.event = t, this.game.input.enabled && this.enabled) {
                        var e = t.keyCode;
                        this._capture[e] && t.preventDefault(), this._keys[e] || (this._keys[e] = new n.Key(this.game, e)), this._keys[e].processKeyUp(t), this.onUpCallback && this.onUpCallback.call(this.callbackContext, t)
                    }
                },
                reset: function(t) {
                    void 0 === t && (t = !0), this.event = null;
                    for (var e = this._keys.length; e--;) this._keys[e] && this._keys[e].reset(t)
                },
                downDuration: function(t, e) {
                    return this._keys[t] ? this._keys[t].downDuration(e) : null
                },
                upDuration: function(t, e) {
                    return this._keys[t] ? this._keys[t].upDuration(e) : null
                },
                justPressed: function(t) {
                    return this._keys[t] ? this._keys[t].justPressed() : null
                },
                justReleased: function(t) {
                    return this._keys[t] ? this._keys[t].justReleased() : null
                },
                isDown: function(t) {
                    return this._keys[t] ? this._keys[t].isDown : null
                }
            }, Object.defineProperty(n.Keyboard.prototype, "lastChar", {
                get: function() {
                    return 32 === this.event.charCode ? "" : String.fromCharCode(this.pressEvent.charCode)
                }
            }), Object.defineProperty(n.Keyboard.prototype, "lastKey", {
                get: function() {
                    return this._keys[this._k]
                }
            }), n.Keyboard.prototype.constructor = n.Keyboard, n.KeyCode = {
                A: "A".charCodeAt(0),
                B: "B".charCodeAt(0),
                C: "C".charCodeAt(0),
                D: "D".charCodeAt(0),
                E: "E".charCodeAt(0),
                F: "F".charCodeAt(0),
                G: "G".charCodeAt(0),
                H: "H".charCodeAt(0),
                I: "I".charCodeAt(0),
                J: "J".charCodeAt(0),
                K: "K".charCodeAt(0),
                L: "L".charCodeAt(0),
                M: "M".charCodeAt(0),
                N: "N".charCodeAt(0),
                O: "O".charCodeAt(0),
                P: "P".charCodeAt(0),
                Q: "Q".charCodeAt(0),
                R: "R".charCodeAt(0),
                S: "S".charCodeAt(0),
                T: "T".charCodeAt(0),
                U: "U".charCodeAt(0),
                V: "V".charCodeAt(0),
                W: "W".charCodeAt(0),
                X: "X".charCodeAt(0),
                Y: "Y".charCodeAt(0),
                Z: "Z".charCodeAt(0),
                ZERO: "0".charCodeAt(0),
                ONE: "1".charCodeAt(0),
                TWO: "2".charCodeAt(0),
                THREE: "3".charCodeAt(0),
                FOUR: "4".charCodeAt(0),
                FIVE: "5".charCodeAt(0),
                SIX: "6".charCodeAt(0),
                SEVEN: "7".charCodeAt(0),
                EIGHT: "8".charCodeAt(0),
                NINE: "9".charCodeAt(0),
                NUMPAD_0: 96,
                NUMPAD_1: 97,
                NUMPAD_2: 98,
                NUMPAD_3: 99,
                NUMPAD_4: 100,
                NUMPAD_5: 101,
                NUMPAD_6: 102,
                NUMPAD_7: 103,
                NUMPAD_8: 104,
                NUMPAD_9: 105,
                NUMPAD_MULTIPLY: 106,
                NUMPAD_ADD: 107,
                NUMPAD_ENTER: 108,
                NUMPAD_SUBTRACT: 109,
                NUMPAD_DECIMAL: 110,
                NUMPAD_DIVIDE: 111,
                F1: 112,
                F2: 113,
                F3: 114,
                F4: 115,
                F5: 116,
                F6: 117,
                F7: 118,
                F8: 119,
                F9: 120,
                F10: 121,
                F11: 122,
                F12: 123,
                F13: 124,
                F14: 125,
                F15: 126,
                COLON: 186,
                EQUALS: 187,
                COMMA: 188,
                UNDERSCORE: 189,
                PERIOD: 190,
                QUESTION_MARK: 191,
                TILDE: 192,
                OPEN_BRACKET: 219,
                BACKWARD_SLASH: 220,
                CLOSED_BRACKET: 221,
                QUOTES: 222,
                BACKSPACE: 8,
                TAB: 9,
                CLEAR: 12,
                ENTER: 13,
                SHIFT: 16,
                CONTROL: 17,
                ALT: 18,
                CAPS_LOCK: 20,
                ESC: 27,
                SPACEBAR: 32,
                PAGE_UP: 33,
                PAGE_DOWN: 34,
                END: 35,
                HOME: 36,
                LEFT: 37,
                UP: 38,
                RIGHT: 39,
                DOWN: 40,
                PLUS: 43,
                MINUS: 44,
                INSERT: 45,
                DELETE: 46,
                HELP: 47,
                NUM_LOCK: 144
            }, n.KeyCode) n.KeyCode.hasOwnProperty(r) && !r.match(/[a-z]/) && (n.Keyboard[r] = n.KeyCode[r]);
        for (var a in n.Component = function() {}, n.Component.Angle = function() {}, n.Component.Angle.prototype = {
                angle: {
                    get: function() {
                        return n.Math.wrapAngle(n.Math.radToDeg(this.rotation))
                    },
                    set: function(t) {
                        this.rotation = n.Math.degToRad(n.Math.wrapAngle(t))
                    }
                }
            }, n.Component.Animation = function() {}, n.Component.Animation.prototype = {
                play: function(t, e, i, s) {
                    if (this.animations) return this.animations.play(t, e, i, s)
                }
            }, n.Component.AutoCull = function() {}, n.Component.AutoCull.prototype = {
                autoCull: !1,
                inCamera: {
                    get: function() {
                        return this.autoCull || this.checkWorldBounds || (this._bounds.copyFrom(this.getBounds()), this._bounds.x += this.game.camera.view.x, this._bounds.y += this.game.camera.view.y), this.game.world.camera.view.intersects(this._bounds)
                    }
                }
            }, n.Component.Bounds = function() {}, n.Component.Bounds.prototype = {
                offsetX: {
                    get: function() {
                        return this.anchor.x * this.width
                    }
                },
                offsetY: {
                    get: function() {
                        return this.anchor.y * this.height
                    }
                },
                centerX: {
                    get: function() {
                        return this.x - this.offsetX + .5 * this.width
                    },
                    set: function(t) {
                        this.x = t + this.offsetX - .5 * this.width
                    }
                },
                centerY: {
                    get: function() {
                        return this.y - this.offsetY + .5 * this.height
                    },
                    set: function(t) {
                        this.y = t + this.offsetY - .5 * this.height
                    }
                },
                left: {
                    get: function() {
                        return this.x - this.offsetX
                    },
                    set: function(t) {
                        this.x = t + this.offsetX
                    }
                },
                right: {
                    get: function() {
                        return this.x + this.width - this.offsetX
                    },
                    set: function(t) {
                        this.x = t - this.width + this.offsetX
                    }
                },
                top: {
                    get: function() {
                        return this.y - this.offsetY
                    },
                    set: function(t) {
                        this.y = t + this.offsetY
                    }
                },
                bottom: {
                    get: function() {
                        return this.y + this.height - this.offsetY
                    },
                    set: function(t) {
                        this.y = t - this.height + this.offsetY
                    }
                },
                alignIn: function(t, e, i, s) {
                    switch (void 0 === i && (i = 0), void 0 === s && (s = 0), e) {
                        default:
                        case n.TOP_LEFT:
                            this.left = t.left - i, this.top = t.top - s;
                            break;
                        case n.TOP_CENTER:
                            this.centerX = t.centerX + i, this.top = t.top - s;
                            break;
                        case n.TOP_RIGHT:
                            this.right = t.right + i, this.top = t.top - s;
                            break;
                        case n.LEFT_CENTER:
                            this.left = t.left - i, this.centerY = t.centerY + s;
                            break;
                        case n.CENTER:
                            this.centerX = t.centerX + i, this.centerY = t.centerY + s;
                            break;
                        case n.RIGHT_CENTER:
                            this.right = t.right + i, this.centerY = t.centerY + s;
                            break;
                        case n.BOTTOM_LEFT:
                            this.left = t.left - i, this.bottom = t.bottom + s;
                            break;
                        case n.BOTTOM_CENTER:
                            this.centerX = t.centerX + i, this.bottom = t.bottom + s;
                            break;
                        case n.BOTTOM_RIGHT:
                            this.right = t.right + i, this.bottom = t.bottom + s
                    }
                    return this
                },
                alignTo: function(t, e, i, s) {
                    switch (void 0 === i && (i = 0), void 0 === s && (s = 0), e) {
                        default:
                        case n.TOP_LEFT:
                            this.left = t.left - i, this.bottom = t.top - s;
                            break;
                        case n.TOP_CENTER:
                            this.centerX = t.centerX + i, this.bottom = t.top - s;
                            break;
                        case n.TOP_RIGHT:
                            this.right = t.right + i, this.bottom = t.top - s;
                            break;
                        case n.LEFT_TOP:
                            this.right = t.left - i, this.top = t.top - s;
                            break;
                        case n.LEFT_CENTER:
                            this.right = t.left - i, this.centerY = t.centerY + s;
                            break;
                        case n.LEFT_BOTTOM:
                            this.right = t.left - i, this.bottom = t.bottom + s;
                            break;
                        case n.RIGHT_TOP:
                            this.left = t.right + i, this.top = t.top - s;
                            break;
                        case n.RIGHT_CENTER:
                            this.left = t.right + i, this.centerY = t.centerY + s;
                            break;
                        case n.RIGHT_BOTTOM:
                            this.left = t.right + i, this.bottom = t.bottom + s;
                            break;
                        case n.BOTTOM_LEFT:
                            this.left = t.left - i, this.top = t.bottom + s;
                            break;
                        case n.BOTTOM_CENTER:
                            this.centerX = t.centerX + i, this.top = t.bottom + s;
                            break;
                        case n.BOTTOM_RIGHT:
                            this.right = t.right + i, this.top = t.bottom + s
                    }
                    return this
                }
            }, n.Group.prototype.alignIn = n.Component.Bounds.prototype.alignIn, n.Group.prototype.alignTo = n.Component.Bounds.prototype.alignTo, n.Component.BringToTop = function() {}, n.Component.BringToTop.prototype.bringToTop = function() {
                return this.parent && this.parent.bringToTop(this), this
            }, n.Component.BringToTop.prototype.sendToBack = function() {
                return this.parent && this.parent.sendToBack(this), this
            }, n.Component.BringToTop.prototype.moveUp = function() {
                return this.parent && this.parent.moveUp(this), this
            }, n.Component.BringToTop.prototype.moveDown = function() {
                return this.parent && this.parent.moveDown(this), this
            }, n.Component.Core = function() {}, n.Component.Core.install = function(t) {
                n.Utils.mixinPrototype(this, n.Component.Core.prototype), this.components = {};
                for (var e = 0; e < t.length; e++) {
                    var i = t[e],
                        s = !1;
                    "Destroy" === i && (s = !0), n.Utils.mixinPrototype(this, n.Component[i].prototype, s), this.components[i] = !0
                }
            }, n.Component.Core.init = function(t, e, i, s, o) {
                this.game = t, this.key = s, this.data = {}, this.position.set(e, i), this.world = new n.Point(e, i), this.previousPosition = new n.Point(e, i), this.events = new n.Events(this), this._bounds = new n.Rectangle, this.components.PhysicsBody && (this.body = this.body), this.components.Animation && (this.animations = new n.AnimationManager(this)), this.components.LoadTexture && null !== s && this.loadTexture(s, o), this.components.FixedToCamera && (this.cameraOffset = new n.Point(e, i))
            }, n.Component.Core.preUpdate = function() {
                if (!this.pendingDestroy) {
                    if (this.previousPosition.set(this.world.x, this.world.y), this.previousRotation = this.rotation, !this.exists || !this.parent.exists) return this.renderOrderID = -1, !1;
                    this.world.setTo(this.game.camera.x + this.worldTransform.tx, this.game.camera.y + this.worldTransform.ty), this.visible && (this.renderOrderID = this.game.stage.currentRenderOrderID++), this.animations && this.animations.update(), this.body && this.body.preUpdate();
                    for (var t = 0; t < this.children.length; t++) this.children[t].preUpdate();
                    return !0
                }
                this.destroy()
            }, n.Component.Core.prototype = {
                game: null,
                name: "",
                data: {},
                components: {},
                z: 0,
                events: void 0,
                animations: void 0,
                key: "",
                world: null,
                debug: !1,
                previousPosition: null,
                previousRotation: 0,
                renderOrderID: 0,
                fresh: !0,
                pendingDestroy: !1,
                _bounds: null,
                _exists: !0,
                exists: {
                    get: function() {
                        return this._exists
                    },
                    set: function(t) {
                        t ? (this._exists = !0, this.body && this.body.type === n.Physics.P2JS && this.body.addToWorld(), this.visible = !0) : (this._exists = !1, this.body && this.body.type === n.Physics.P2JS && this.body.removeFromWorld(), this.visible = !1)
                    }
                },
                update: function() {},
                postUpdate: function() {
                    this.customRender && this.key.render(), this.components.PhysicsBody && n.Component.PhysicsBody.postUpdate.call(this), this.components.FixedToCamera && n.Component.FixedToCamera.postUpdate.call(this);
                    for (var t = 0; t < this.children.length; t++) this.children[t].postUpdate()
                }
            }, n.Component.Crop = function() {}, n.Component.Crop.prototype = {
                cropRect: null,
                _crop: null,
                crop: function(t, e) {
                    void 0 === e && (e = !1), t ? (e && null !== this.cropRect ? this.cropRect.setTo(t.x, t.y, t.width, t.height) : e && null === this.cropRect ? this.cropRect = new n.Rectangle(t.x, t.y, t.width, t.height) : this.cropRect = t, this.updateCrop()) : (this._crop = null, this.cropRect = null, this.resetFrame())
                },
                updateCrop: function() {
                    if (this.cropRect) {
                        var t = this.texture.crop.x,
                            e = this.texture.crop.y,
                            i = this.texture.crop.width,
                            s = this.texture.crop.height;
                        this._crop = n.Rectangle.clone(this.cropRect, this._crop), this._crop.x += this._frame.x, this._crop.y += this._frame.y;
                        var o = Math.max(this._frame.x, this._crop.x),
                            r = Math.max(this._frame.y, this._crop.y),
                            a = Math.min(this._frame.right, this._crop.right) - o,
                            h = Math.min(this._frame.bottom, this._crop.bottom) - r;
                        this.texture.crop.x = o, this.texture.crop.y = r, this.texture.crop.width = a, this.texture.crop.height = h, this.texture.frame.width = Math.min(a, this.cropRect.width), this.texture.frame.height = Math.min(h, this.cropRect.height), this.texture.width = this.texture.frame.width, this.texture.height = this.texture.frame.height, this.texture._updateUvs(), 16777215 === this.tint || t === o && e === r && i === a && s === h || (this.texture.requiresReTint = !0)
                    }
                }
            }, n.Component.Delta = function() {}, n.Component.Delta.prototype = {
                deltaX: {
                    get: function() {
                        return this.world.x - this.previousPosition.x
                    }
                },
                deltaY: {
                    get: function() {
                        return this.world.y - this.previousPosition.y
                    }
                },
                deltaZ: {
                    get: function() {
                        return this.rotation - this.previousRotation
                    }
                }
            }, n.Component.Destroy = function() {}, n.Component.Destroy.prototype = {
                destroyPhase: !1,
                destroy: function(t, e) {
                    if (null !== this.game && !this.destroyPhase) {
                        void 0 === t && (t = !0), void 0 === e && (e = !1), this.destroyPhase = !0, this.events && this.events.onDestroy$dispatch(this), this.parent && (this.parent instanceof n.Group ? this.parent.remove(this) : this.parent.removeChild(this)), this.input && this.input.destroy(), this.animations && this.animations.destroy(), this.body && this.body.destroy(), this.events && this.events.destroy(), this.game.tweens.removeFrom(this);
                        var i = this.children.length;
                        if (t)
                            for (; i--;) this.children[i].destroy(t);
                        else
                            for (; i--;) this.removeChild(this.children[i]);
                        this._crop && (this._crop = null, this.cropRect = null), this._frame && (this._frame = null), n.Video && this.key instanceof n.Video && this.key.onChangeSource.remove(this.resizeFrame, this), n.BitmapText && this._glyphs && (this._glyphs = []), this.alive = !1, this.exists = !1, this.visible = !1, this.filters = null, this.mask = null, this.game = null, this.data = {}, this.renderable = !1, this.transformCallback && (this.transformCallback = null, this.transformCallbackContext = null), this.hitArea = null, this.parent = null, this.stage = null, this.worldTransform = null, this.filterArea = null, this._bounds = null, this._currentBounds = null, this._mask = null, this._destroyCachedSprite(), e && this.texture.destroy(!0), this.destroyPhase = !1, this.pendingDestroy = !1
                    }
                }
            }, n.Events = function(t) {
                this.parent = t
            }, n.Events.prototype = {
                destroy: function() {
                    this._parent = null, this._onDestroy && this._onDestroy.dispose(), this._onAddedToGroup && this._onAddedToGroup.dispose(), this._onRemovedFromGroup && this._onRemovedFromGroup.dispose(), this._onRemovedFromWorld && this._onRemovedFromWorld.dispose(), this._onKilled && this._onKilled.dispose(), this._onRevived && this._onRevived.dispose(), this._onEnterBounds && this._onEnterBounds.dispose(), this._onOutOfBounds && this._onOutOfBounds.dispose(), this._onInputOver && this._onInputOver.dispose(), this._onInputOut && this._onInputOut.dispose(), this._onInputDown && this._onInputDown.dispose(), this._onInputUp && this._onInputUp.dispose(), this._onDragStart && this._onDragStart.dispose(), this._onDragUpdate && this._onDragUpdate.dispose(), this._onDragStop && this._onDragStop.dispose(), this._onAnimationStart && this._onAnimationStart.dispose(), this._onAnimationComplete && this._onAnimationComplete.dispose(), this._onAnimationLoop && this._onAnimationLoop.dispose()
                },
                onAddedToGroup: null,
                onRemovedFromGroup: null,
                onRemovedFromWorld: null,
                onDestroy: null,
                onKilled: null,
                onRevived: null,
                onOutOfBounds: null,
                onEnterBounds: null,
                onInputOver: null,
                onInputOut: null,
                onInputDown: null,
                onInputUp: null,
                onDragStart: null,
                onDragUpdate: null,
                onDragStop: null,
                onAnimationStart: null,
                onAnimationComplete: null,
                onAnimationLoop: null
            }, n.Events.prototype.constructor = n.Events, n.Events.prototype) n.Events.prototype.hasOwnProperty(a) && 0 === a.indexOf("on") && null === n.Events.prototype[a] && function(t, e) {
            "use strict";
            Object.defineProperty(n.Events.prototype, t, {
                get: function() {
                    return this[e] || (this[e] = new n.Signal)
                }
            }), n.Events.prototype[t + "$dispatch"] = function() {
                return this[e] ? this[e].dispatch.apply(this[e], arguments) : null
            }
        }(a, "_" + a);
        n.Component.FixedToCamera = function() {}, n.Component.FixedToCamera.postUpdate = function() {
            this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y)
        }, n.Component.FixedToCamera.prototype = {
            _fixedToCamera: !1,
            fixedToCamera: {
                get: function() {
                    return this._fixedToCamera
                },
                set: function(t) {
                    t ? (this._fixedToCamera = !0, this.cameraOffset.set(this.x, this.y)) : this._fixedToCamera = !1
                }
            },
            cameraOffset: new n.Point
        }, n.Component.Health = function() {}, n.Component.Health.prototype = {
            health: 1,
            maxHealth: 100,
            damage: function(t) {
                return this.alive && (this.health -= t, this.health <= 0 && this.kill()), this
            },
            setHealth: function(t) {
                return this.health = t, this.health > this.maxHealth && (this.health = this.maxHealth), this
            },
            heal: function(t) {
                return this.alive && (this.health += t, this.health > this.maxHealth && (this.health = this.maxHealth)), this
            }
        }, n.Component.InCamera = function() {}, n.Component.InCamera.prototype = {
            inCamera: {
                get: function() {
                    return this.game.world.camera.view.intersects(this._bounds)
                }
            }
        }, n.Component.InputEnabled = function() {}, n.Component.InputEnabled.prototype = {
            input: null,
            inputEnabled: {
                get: function() {
                    return this.input && this.input.enabled
                },
                set: function(t) {
                    t ? null === this.input ? (this.input = new n.InputHandler(this), this.input.start()) : this.input && !this.input.enabled && this.input.start() : this.input && this.input.enabled && this.input.stop()
                }
            }
        }, n.Component.InWorld = function() {}, n.Component.InWorld.preUpdate = function() {
            if (this.autoCull || this.checkWorldBounds) {
                if (this._bounds.copyFrom(this.getBounds()), this._bounds.x += this.game.camera.view.x, this._bounds.y += this.game.camera.view.y, this.autoCull)
                    if (this.game.world.camera.view.intersects(this._bounds)) this.renderable = !0, this.game.world.camera.totalInView++;
                    else if (this.renderable = !1, this.outOfCameraBoundsKill) return this.kill(), !1;
                if (this.checkWorldBounds)
                    if (this._outOfBoundsFired && this.game.world.bounds.intersects(this._bounds)) this._outOfBoundsFired = !1, this.events.onEnterBounds$dispatch(this);
                    else if (!this._outOfBoundsFired && !this.game.world.bounds.intersects(this._bounds) && (this._outOfBoundsFired = !0, this.events.onOutOfBounds$dispatch(this), this.outOfBoundsKill)) return this.kill(), !1
            }
            return !0
        }, n.Component.InWorld.prototype = {
            checkWorldBounds: !1,
            outOfBoundsKill: !1,
            outOfCameraBoundsKill: !1,
            _outOfBoundsFired: !1,
            inWorld: {
                get: function() {
                    return this.game.world.bounds.intersects(this.getBounds())
                }
            }
        }, n.Component.LifeSpan = function() {}, n.Component.LifeSpan.preUpdate = function() {
            return !(this.lifespan > 0 && (this.lifespan -= this.game.time.physicsElapsedMS, this.lifespan <= 0) && (this.kill(), 1))
        }, n.Component.LifeSpan.prototype = {
            alive: !0,
            lifespan: 0,
            revive: function(t) {
                return void 0 === t && (t = 100), this.alive = !0, this.exists = !0, this.visible = !0, "function" == typeof this.setHealth && this.setHealth(t), this.events && this.events.onRevived$dispatch(this), this
            },
            kill: function() {
                return this.alive = !1, this.exists = !1, this.visible = !1, this.events && this.events.onKilled$dispatch(this), this
            }
        }, n.Component.LoadTexture = function() {}, n.Component.LoadTexture.prototype = {
            customRender: !1,
            _frame: null,
            loadTexture: function(t, e, i) {
                t === n.PENDING_ATLAS ? (t = e, e = 0) : e = e || 0, (i || void 0 === i) && this.animations && this.animations.stop(), this.key = t, this.customRender = !1;
                var s = this.game.cache,
                    o = !0,
                    r = !this.texture.baseTexture.scaleMode;
                if (n.RenderTexture && t instanceof n.RenderTexture) this.key = t.key, this.setTexture(t);
                else if (n.BitmapData && t instanceof n.BitmapData) this.customRender = !0, this.setTexture(t.texture), o = s.hasFrameData(t.key, n.Cache.BITMAPDATA) ? !this.animations.loadFrameData(s.getFrameData(t.key, n.Cache.BITMAPDATA), e) : !this.animations.loadFrameData(t.frameData, 0);
                else if (n.Video && t instanceof n.Video) {
                    this.customRender = !0;
                    var a = t.texture.valid;
                    this.setTexture(t.texture), this.setFrame(t.texture.frame.clone()), t.onChangeSource.add(this.resizeFrame, this), this.texture.valid = a
                } else if (n.Tilemap && t instanceof n.TilemapLayer) this.setTexture(PIXI.Texture.fromCanvas(t.canvas));
                else if (t instanceof PIXI.Texture) this.setTexture(t);
                else {
                    var h = s.getImage(t, !0);
                    this.key = h.key, this.setTexture(new PIXI.Texture(h.base)), this.texture.baseTexture.skipRender = "__default" === t, o = !this.animations.loadFrameData(h.frameData, e)
                }
                o && (this._frame = n.Rectangle.clone(this.texture.frame)), r || (this.texture.baseTexture.scaleMode = 1)
            },
            setFrame: function(t) {
                this._frame = t, this.texture.frame.x = t.x, this.texture.frame.y = t.y, this.texture.frame.width = t.width, this.texture.frame.height = t.height, this.texture.crop.x = t.x, this.texture.crop.y = t.y, this.texture.crop.width = t.width, this.texture.crop.height = t.height, t.trimmed ? (this.texture.trim ? (this.texture.trim.x = t.spriteSourceSizeX, this.texture.trim.y = t.spriteSourceSizeY, this.texture.trim.width = t.sourceSizeW, this.texture.trim.height = t.sourceSizeH) : this.texture.trim = {
                    x: t.spriteSourceSizeX,
                    y: t.spriteSourceSizeY,
                    width: t.sourceSizeW,
                    height: t.sourceSizeH
                }, this.texture.width = t.sourceSizeW, this.texture.height = t.sourceSizeH, this.texture.frame.width = t.sourceSizeW, this.texture.frame.height = t.sourceSizeH) : !t.trimmed && this.texture.trim && (this.texture.trim = null), t.rotated && (this.texture.rotated = !0), this.cropRect && this.updateCrop(), this.texture.requiresReTint = !0, this.texture._updateUvs(), this.tilingTexture && (this.refreshTexture = !0)
            },
            resizeFrame: function(t, e, i) {
                this.texture.frame.resize(e, i), this.texture.setFrame(this.texture.frame)
            },
            resetFrame: function() {
                this._frame && this.setFrame(this._frame)
            },
            frame: {
                get: function() {
                    return this.animations.frame
                },
                set: function(t) {
                    this.animations.frame = t
                }
            },
            frameName: {
                get: function() {
                    return this.animations.frameName
                },
                set: function(t) {
                    this.animations.frameName = t
                }
            }
        }, n.Component.Overlap = function() {}, n.Component.Overlap.prototype = {
            overlap: function(t) {
                return n.Rectangle.intersects(this.getBounds(), t.getBounds())
            }
        }, n.Component.PhysicsBody = function() {}, n.Component.PhysicsBody.preUpdate = function() {
            return this.fresh && this.exists ? (this.world.setTo(this.parent.position.x + this.position.x, this.parent.position.y + this.position.y), this.worldTransform.tx = this.world.x, this.worldTransform.ty = this.world.y, this.previousPosition.set(this.world.x, this.world.y), this.previousRotation = this.rotation, this.body && this.body.preUpdate(), this.fresh = !1, !1) : (this.previousPosition.set(this.world.x, this.world.y), this.previousRotation = this.rotation, !(!this._exists || !this.parent.exists) || (this.renderOrderID = -1, !1))
        }, n.Component.PhysicsBody.postUpdate = function() {
            this.exists && this.body && this.body.postUpdate()
        }, n.Component.PhysicsBody.prototype = {
            body: null,
            x: {
                get: function() {
                    return this.position.x
                },
                set: function(t) {
                    this.position.x = t, this.body && !this.body.dirty && (this.body._reset = !0)
                }
            },
            y: {
                get: function() {
                    return this.position.y
                },
                set: function(t) {
                    this.position.y = t, this.body && !this.body.dirty && (this.body._reset = !0)
                }
            }
        }, n.Component.Reset = function() {}, n.Component.Reset.prototype.reset = function(t, e, i) {
            return void 0 === i && (i = 1), this.world.set(t, e), this.position.set(t, e), this.fresh = !0, this.exists = !0, this.visible = !0, this.renderable = !0, this.components.InWorld && (this._outOfBoundsFired = !1), this.components.LifeSpan && (this.alive = !0, this.health = i), this.components.PhysicsBody && this.body && this.body.reset(t, e, !1, !1), this
        }, n.Component.ScaleMinMax = function() {}, n.Component.ScaleMinMax.prototype = {
            transformCallback: null,
            transformCallbackContext: this,
            scaleMin: null,
            scaleMax: null,
            checkTransform: function(t) {
                this.scaleMin && (t.a < this.scaleMin.x && (t.a = this.scaleMin.x), t.d < this.scaleMin.y && (t.d = this.scaleMin.y)), this.scaleMax && (t.a > this.scaleMax.x && (t.a = this.scaleMax.x), t.d > this.scaleMax.y && (t.d = this.scaleMax.y))
            },
            setScaleMinMax: function(t, e, i, s) {
                void 0 === e ? e = i = s = t : void 0 === i && (i = s = e, e = t), null === t ? this.scaleMin = null : this.scaleMin ? this.scaleMin.set(t, e) : this.scaleMin = new n.Point(t, e), null === i ? this.scaleMax = null : this.scaleMax ? this.scaleMax.set(i, s) : this.scaleMax = new n.Point(i, s), null === this.scaleMin ? this.transformCallback = null : (this.transformCallback = this.checkTransform, this.transformCallbackContext = this)
            }
        }, n.Component.Smoothed = function() {}, n.Component.Smoothed.prototype = {
            smoothed: {
                get: function() {
                    return !this.texture.baseTexture.scaleMode
                },
                set: function(t) {
                    t ? this.texture && (this.texture.baseTexture.scaleMode = 0) : this.texture && (this.texture.baseTexture.scaleMode = 1)
                }
            }
        }, n.GameObjectFactory = function(t) {
            this.game = t, this.world = this.game.world
        }, n.GameObjectFactory.prototype = {
            existing: function(t) {
                return this.world.add(t)
            },
            weapon: function(t, e, i, s) {
                var o = this.game.plugins.add(n.Weapon);
                return o.createBullets(t, e, i, s), o
            },
            image: function(t, e, i, s, o) {
                return void 0 === o && (o = this.world), o.add(new n.Image(this.game, t, e, i, s))
            },
            sprite: function(t, e, i, s, n) {
                return void 0 === n && (n = this.world), n.create(t, e, i, s)
            },
            creature: function(t, e, i, s, o) {
                void 0 === o && (o = this.world);
                var r = new n.Creature(this.game, t, e, i, s);
                return o.add(r), r
            },
            tween: function(t) {
                return this.game.tweens.create(t)
            },
            group: function(t, e, i, s, o) {
                return new n.Group(this.game, t, e, i, s, o)
            },
            physicsGroup: function(t, e, i, s) {
                return new n.Group(this.game, e, i, s, !0, t)
            },
            spriteBatch: function(t, e, i) {
                return void 0 === t && (t = null), void 0 === e && (e = "group"), void 0 === i && (i = !1), new n.SpriteBatch(this.game, t, e, i)
            },
            audio: function(t, e, i, s) {
                return this.game.sound.add(t, e, i, s)
            },
            sound: function(t, e, i, s) {
                return this.game.sound.add(t, e, i, s)
            },
            audioSprite: function(t) {
                return this.game.sound.addSprite(t)
            },
            tileSprite: function(t, e, i, s, o, r, a) {
                return void 0 === a && (a = this.world), a.add(new n.TileSprite(this.game, t, e, i, s, o, r))
            },
            rope: function(t, e, i, s, o, r) {
                return void 0 === r && (r = this.world), r.add(new n.Rope(this.game, t, e, i, s, o))
            },
            text: function(t, e, i, s, o) {
                return void 0 === o && (o = this.world), o.add(new n.Text(this.game, t, e, i, s))
            },
            button: function(t, e, i, s, o, r, a, h, l, c) {
                return void 0 === c && (c = this.world), c.add(new n.Button(this.game, t, e, i, s, o, r, a, h, l))
            },
            graphics: function(t, e, i) {
                return void 0 === i && (i = this.world), i.add(new n.Graphics(this.game, t, e))
            },
            emitter: function(t, e, i) {
                return this.game.particles.add(new n.Particles.Arcade.Emitter(this.game, t, e, i))
            },
            retroFont: function(t, e, i, s, o, r, a, h, l) {
                return new n.RetroFont(this.game, t, e, i, s, o, r, a, h, l)
            },
            bitmapText: function(t, e, i, s, o, r) {
                return void 0 === r && (r = this.world), r.add(new n.BitmapText(this.game, t, e, i, s, o))
            },
            tilemap: function(t, e, i, s, o) {
                return new n.Tilemap(this.game, t, e, i, s, o)
            },
            renderTexture: function(t, e, i, s) {
                void 0 !== i && "" !== i || (i = this.game.rnd.uuid()), void 0 === s && (s = !1);
                var o = new n.RenderTexture(this.game, t, e, i);
                return s && this.game.cache.addRenderTexture(i, o), o
            },
            video: function(t, e) {
                return new n.Video(this.game, t, e)
            },
            bitmapData: function(t, e, i, s) {
                void 0 === s && (s = !1), void 0 !== i && "" !== i || (i = this.game.rnd.uuid());
                var o = new n.BitmapData(this.game, i, t, e);
                return s && this.game.cache.addBitmapData(i, o), o
            },
            filter: function(t) {
                var e = Array.prototype.slice.call(arguments, 1);
                return (t = new n.Filter[t](this.game)).init.apply(t, e), t
            },
            plugin: function(t) {
                return this.game.plugins.add(t)
            }
        }, n.GameObjectFactory.prototype.constructor = n.GameObjectFactory, n.GameObjectCreator = function(t) {
            this.game = t, this.world = this.game.world
        }, n.GameObjectCreator.prototype = {
            image: function(t, e, i, s) {
                return new n.Image(this.game, t, e, i, s)
            },
            sprite: function(t, e, i, s) {
                return new n.Sprite(this.game, t, e, i, s)
            },
            tween: function(t) {
                return new n.Tween(t, this.game, this.game.tweens)
            },
            group: function(t, e, i, s, o) {
                return new n.Group(this.game, t, e, i, s, o)
            },
            spriteBatch: function(t, e, i) {
                return void 0 === e && (e = "group"), void 0 === i && (i = !1), new n.SpriteBatch(this.game, t, e, i)
            },
            audio: function(t, e, i, s) {
                return this.game.sound.add(t, e, i, s)
            },
            audioSprite: function(t) {
                return this.game.sound.addSprite(t)
            },
            sound: function(t, e, i, s) {
                return this.game.sound.add(t, e, i, s)
            },
            tileSprite: function(t, e, i, s, o, r) {
                return new n.TileSprite(this.game, t, e, i, s, o, r)
            },
            rope: function(t, e, i, s, o) {
                return new n.Rope(this.game, t, e, i, s, o)
            },
            text: function(t, e, i, s) {
                return new n.Text(this.game, t, e, i, s)
            },
            button: function(t, e, i, s, o, r, a, h, l) {
                return new n.Button(this.game, t, e, i, s, o, r, a, h, l)
            },
            graphics: function(t, e) {
                return new n.Graphics(this.game, t, e)
            },
            emitter: function(t, e, i) {
                return new n.Particles.Arcade.Emitter(this.game, t, e, i)
            },
            retroFont: function(t, e, i, s, o, r, a, h, l) {
                return new n.RetroFont(this.game, t, e, i, s, o, r, a, h, l)
            },
            bitmapText: function(t, e, i, s, o, r) {
                return new n.BitmapText(this.game, t, e, i, s, o, r)
            },
            tilemap: function(t, e, i, s, o) {
                return new n.Tilemap(this.game, t, e, i, s, o)
            },
            renderTexture: function(t, e, i, s) {
                void 0 !== i && "" !== i || (i = this.game.rnd.uuid()), void 0 === s && (s = !1);
                var o = new n.RenderTexture(this.game, t, e, i);
                return s && this.game.cache.addRenderTexture(i, o), o
            },
            bitmapData: function(t, e, i, s) {
                void 0 === s && (s = !1), void 0 !== i && "" !== i || (i = this.game.rnd.uuid());
                var o = new n.BitmapData(this.game, i, t, e);
                return s && this.game.cache.addBitmapData(i, o), o
            },
            filter: function(t) {
                var e = Array.prototype.slice.call(arguments, 1);
                return (t = new n.Filter[t](this.game)).init.apply(t, e), t
            }
        }, n.GameObjectCreator.prototype.constructor = n.GameObjectCreator, n.Sprite = function(t, e, i, s, o) {
            e = e || 0, i = i || 0, s = s || null, o = o || null, this.type = n.SPRITE, this.physicsType = n.SPRITE, PIXI.Sprite.call(this, n.Cache.DEFAULT), n.Component.Core.init.call(this, t, e, i, s, o)
        }, n.Sprite.prototype = Object.create(PIXI.Sprite.prototype), n.Sprite.prototype.constructor = n.Sprite, n.Component.Core.install.call(n.Sprite.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Delta", "Destroy", "FixedToCamera", "Health", "InCamera", "InputEnabled", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "ScaleMinMax", "Smoothed"]), n.Sprite.prototype.preUpdatePhysics = n.Component.PhysicsBody.preUpdate, n.Sprite.prototype.preUpdateLifeSpan = n.Component.LifeSpan.preUpdate, n.Sprite.prototype.preUpdateInWorld = n.Component.InWorld.preUpdate, n.Sprite.prototype.preUpdateCore = n.Component.Core.preUpdate, n.Sprite.prototype.preUpdate = function() {
            return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore()
        }, n.Image = function(t, e, i, s, o) {
            e = e || 0, i = i || 0, s = s || null, o = o || null, this.type = n.IMAGE, PIXI.Sprite.call(this, n.Cache.DEFAULT), n.Component.Core.init.call(this, t, e, i, s, o)
        }, n.Image.prototype = Object.create(PIXI.Sprite.prototype), n.Image.prototype.constructor = n.Image, n.Component.Core.install.call(n.Image.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Destroy", "FixedToCamera", "InputEnabled", "LifeSpan", "LoadTexture", "Overlap", "Reset", "ScaleMinMax", "Smoothed"]), n.Image.prototype.preUpdateInWorld = n.Component.InWorld.preUpdate, n.Image.prototype.preUpdateCore = n.Component.Core.preUpdate, n.Image.prototype.preUpdate = function() {
            return !!this.preUpdateInWorld() && this.preUpdateCore()
        }, n.Button = function(t, e, i, s, o, r, a, h, l, c) {
            e = e || 0, i = i || 0, s = s || null, o = o || null, r = r || this, n.Image.call(this, t, e, i, s, h), this.type = n.BUTTON, this.physicsType = n.SPRITE, this._onOverFrame = null, this._onOutFrame = null, this._onDownFrame = null, this._onUpFrame = null, this.onOverSound = null, this.onOutSound = null, this.onDownSound = null, this.onUpSound = null, this.onOverSoundMarker = "", this.onOutSoundMarker = "", this.onDownSoundMarker = "", this.onUpSoundMarker = "", this.onInputOver = new n.Signal, this.onInputOut = new n.Signal, this.onInputDown = new n.Signal, this.onInputUp = new n.Signal, this.onOverMouseOnly = !0, this.justReleasedPreventsOver = n.PointerMode.TOUCH, this.freezeFrames = !1, this.forceOut = !1, this.inputEnabled = !0, this.input.start(0, !0), this.input.useHandCursor = !0, this.setFrames(a, h, l, c), null !== o && this.onInputUp.add(o, r), this.events.onInputOver.add(this.onInputOverHandler, this), this.events.onInputOut.add(this.onInputOutHandler, this), this.events.onInputDown.add(this.onInputDownHandler, this), this.events.onInputUp.add(this.onInputUpHandler, this), this.events.onRemovedFromWorld.add(this.removedFromWorld, this)
        }, n.Button.prototype = Object.create(n.Image.prototype), n.Button.prototype.constructor = n.Button;
        var h = "Over",
            l = "Out",
            c = "Down",
            u = "Up";
        return n.Button.prototype.clearFrames = function() {
            this.setFrames(null, null, null, null)
        }, n.Button.prototype.removedFromWorld = function() {
            this.inputEnabled = !1
        }, n.Button.prototype.setStateFrame = function(t, e, i) {
            var s = "_on" + t + "Frame";
            null !== e ? (this[s] = e, i && this.changeStateFrame(t)) : this[s] = null
        }, n.Button.prototype.changeStateFrame = function(t) {
            if (this.freezeFrames) return !1;
            var e = this["_on" + t + "Frame"];
            return "string" == typeof e ? (this.frameName = e, !0) : "number" == typeof e && (this.frame = e, !0)
        }, n.Button.prototype.setFrames = function(t, e, i, s) {
            this.setStateFrame(h, t, this.input.pointerOver()), this.setStateFrame(l, e, !this.input.pointerOver()), this.setStateFrame(c, i, this.input.pointerDown()), this.setStateFrame(u, s, this.input.pointerUp())
        }, n.Button.prototype.setStateSound = function(t, e, i) {
            var s = "on" + t + "Sound",
                o = "on" + t + "SoundMarker";
            e instanceof n.Sound || e instanceof n.AudioSprite ? (this[s] = e, this[o] = "string" == typeof i ? i : "") : (this[s] = null, this[o] = "")
        }, n.Button.prototype.playStateSound = function(t) {
            var e = this["on" + t + "Sound"];
            if (e) {
                var i = this["on" + t + "SoundMarker"];
                return e.play(i), !0
            }
            return !1
        }, n.Button.prototype.setSounds = function(t, e, i, s, n, o, r, a) {
            this.setStateSound(h, t, e), this.setStateSound(l, n, o), this.setStateSound(c, i, s), this.setStateSound(u, r, a)
        }, n.Button.prototype.setOverSound = function(t, e) {
            this.setStateSound(h, t, e)
        }, n.Button.prototype.setOutSound = function(t, e) {
            this.setStateSound(l, t, e)
        }, n.Button.prototype.setDownSound = function(t, e) {
            this.setStateSound(c, t, e)
        }, n.Button.prototype.setUpSound = function(t, e) {
            this.setStateSound(u, t, e)
        }, n.Button.prototype.onInputOverHandler = function(t, e) {
            e.justReleased() && (this.justReleasedPreventsOver & e.pointerMode) === e.pointerMode || (this.changeStateFrame(h), this.onOverMouseOnly && !e.isMouse || (this.playStateSound(h), this.onInputOver && this.onInputOver.dispatch(this, e)))
        }, n.Button.prototype.onInputOutHandler = function(t, e) {
            this.changeStateFrame(l), this.playStateSound(l), this.onInputOut && this.onInputOut.dispatch(this, e)
        }, n.Button.prototype.onInputDownHandler = function(t, e) {
            this.changeStateFrame(c), this.playStateSound(c), this.onInputDown && this.onInputDown.dispatch(this, e)
        }, n.Button.prototype.onInputUpHandler = function(t, e, i) {
            if (this.playStateSound(u), this.onInputUp && this.onInputUp.dispatch(this, e, i), !this.freezeFrames)
                if (!0 === this.forceOut || (this.forceOut & e.pointerMode) === e.pointerMode) this.changeStateFrame(l);
                else {
                    this.changeStateFrame(u) || (i ? this.changeStateFrame(h) : this.changeStateFrame(l))
                }
        }, n.SpriteBatch = function(t, e, i, s) {
            null != e || (e = t.world), n.Group.call(this, t, e, i, s), this.type = n.SPRITEBATCH, this.fastSpriteBatch = null, this.ready = !1
        }, n.SpriteBatch.prototype = Object.create(n.Group.prototype), n.SpriteBatch.prototype.constructor = n.SpriteBatch, n.SpriteBatch.prototype._renderWebGL = function(t) {
            !this.visible || this.alpha <= 0 || !this.children.length || (this.ready || (this.fastSpriteBatch = new PIXI.WebGLFastSpriteBatch(t.gl), this.ready = !0), this.fastSpriteBatch.gl !== t.gl && this.fastSpriteBatch.setContext(t.gl), t.spriteBatch.stop(), t.shaderManager.setShader(t.shaderManager.fastShader), this.fastSpriteBatch.begin(this, t), this.fastSpriteBatch.render(this), t.spriteBatch.start())
        }, n.SpriteBatch.prototype._renderCanvas = function(t) {
            if (this.visible && !(this.alpha <= 0) && this.children.length) {
                var e = t.context;
                e.globalAlpha = this.worldAlpha, this.displayObjectUpdateTransform();
                for (var i = this.worldTransform, s = !0, n = 0; n < this.children.length; n++) {
                    var o = this.children[n];
                    if (o.visible) {
                        var r = o.texture,
                            a = r.frame;
                        if (e.globalAlpha = this.worldAlpha * o.alpha, o.rotation % (2 * Math.PI) == 0) s && (e.setTransform(i.a, i.b, i.c, i.d, i.tx, i.ty), s = !1), e.drawImage(r.baseTexture.source, a.x, a.y, a.width, a.height, o.anchor.x * (-a.width * o.scale.x) + o.position.x + .5 + t.shakeX | 0, o.anchor.y * (-a.height * o.scale.y) + o.position.y + .5 + t.shakeY | 0, a.width * o.scale.x, a.height * o.scale.y);
                        else {
                            s || (s = !0), o.displayObjectUpdateTransform();
                            var h = o.worldTransform,
                                l = h.tx * t.resolution + t.shakeX,
                                c = h.ty * t.resolution + t.shakeY;
                            t.roundPixels ? e.setTransform(h.a, h.b, h.c, h.d, 0 | l, 0 | c) : e.setTransform(h.a, h.b, h.c, h.d, l, c), e.drawImage(r.baseTexture.source, a.x, a.y, a.width, a.height, o.anchor.x * -a.width + .5 | 0, o.anchor.y * -a.height + .5 | 0, a.width, a.height)
                        }
                    }
                }
            }
        }, n.BitmapData = function(t, e, i, s, o) {
            void 0 !== i && 0 !== i || (i = 256), void 0 !== s && 0 !== s || (s = 256), void 0 === o && (o = !1), this.game = t, this.key = e, this.width = i, this.height = s, this.canvas = n.Canvas.create(this, i, s, null, o), this.context = this.canvas.getContext("2d", {
                alpha: !0
            }), this.ctx = this.context, this.smoothProperty = t.renderType === n.CANVAS ? t.renderer.renderSession.smoothProperty : n.Canvas.getSmoothingPrefix(this.context), this.imageData = this.context.getImageData(0, 0, i, s), this.data = null, this.imageData && (this.data = this.imageData.data), this.pixels = null, this.data && (this.imageData.data.buffer ? (this.buffer = this.imageData.data.buffer, this.pixels = new Uint32Array(this.buffer)) : window.ArrayBuffer ? (this.buffer = new ArrayBuffer(this.imageData.data.length), this.pixels = new Uint32Array(this.buffer)) : this.pixels = this.imageData.data), this.baseTexture = new PIXI.BaseTexture(this.canvas, null, this.game.resolution), this.texture = new PIXI.Texture(this.baseTexture), this.frameData = new n.FrameData, this.textureFrame = this.frameData.addFrame(new n.Frame(0, 0, 0, i, s, "bitmapData")), this.texture.frame = this.textureFrame, this.type = n.BITMAPDATA, this.disableTextureUpload = !1, this.dirty = !1, this.cls = this.clear, this._image = null, this._pos = new n.Point, this._size = new n.Point, this._scale = new n.Point, this._rotate = 0, this._alpha = {
                prev: 1,
                current: 1
            }, this._anchor = new n.Point, this._tempR = 0, this._tempG = 0, this._tempB = 0, this._circle = new n.Circle, this._swapCanvas = void 0
        }, n.BitmapData.prototype = {
            move: function(t, e, i) {
                return 0 !== t && this.moveH(t, i), 0 !== e && this.moveV(e, i), this
            },
            moveH: function(t, e) {
                void 0 === e && (e = !0), void 0 === this._swapCanvas && (this._swapCanvas = n.CanvasPool.create(this, this.width, this.height));
                var i = this._swapCanvas.getContext("2d"),
                    s = this.height,
                    o = this.canvas;
                if (i.clearRect(0, 0, this.width, this.height), t < 0) {
                    t = Math.abs(t);
                    var r = this.width - t;
                    e && i.drawImage(o, 0, 0, t, s, r, 0, t, s), i.drawImage(o, t, 0, r, s, 0, 0, r, s)
                } else {
                    r = this.width - t;
                    e && i.drawImage(o, r, 0, t, s, 0, 0, t, s), i.drawImage(o, 0, 0, r, s, t, 0, r, s)
                }
                return this.clear(), this.copy(this._swapCanvas)
            },
            moveV: function(t, e) {
                void 0 === e && (e = !0), void 0 === this._swapCanvas && (this._swapCanvas = n.CanvasPool.create(this, this.width, this.height));
                var i = this._swapCanvas.getContext("2d"),
                    s = this.width,
                    o = this.canvas;
                if (i.clearRect(0, 0, this.width, this.height), t < 0) {
                    t = Math.abs(t);
                    var r = this.height - t;
                    e && i.drawImage(o, 0, 0, s, t, 0, r, s, t), i.drawImage(o, 0, t, s, r, 0, 0, s, r)
                } else {
                    r = this.height - t;
                    e && i.drawImage(o, 0, r, s, t, 0, 0, s, t), i.drawImage(o, 0, 0, s, r, 0, t, s, r)
                }
                return this.clear(), this.copy(this._swapCanvas)
            },
            add: function(t) {
                if (Array.isArray(t))
                    for (var e = 0; e < t.length; e++) t[e].loadTexture && t[e].loadTexture(this);
                else t.loadTexture(this);
                return this
            },
            load: function(t) {
                if ("string" == typeof t && (t = this.game.cache.getImage(t)), t) return this.resize(t.width, t.height), this.cls(), this.draw(t), this.update(), this
            },
            clear: function(t, e, i, s) {
                return void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = this.width), void 0 === s && (s = this.height), this.context.clearRect(t, e, i, s), this.dirty = !0, this
            },
            fill: function(t, e, i, s) {
                return void 0 === s && (s = 1), this.context.fillStyle = "rgba(" + t + "," + e + "," + i + "," + s + ")", this.context.fillRect(0, 0, this.width, this.height), this.dirty = !0, this
            },
            generateTexture: function(t) {
                var e = new Image;
                e.src = this.canvas.toDataURL("image/png");
                var i = this.game.cache.addImage(t, "", e);
                return new PIXI.Texture(i.base)
            },
            resize: function(t, e) {
                return t === this.width && e === this.height || (this.width = t, this.height = e, this.canvas.width = t, this.canvas.height = e, void 0 !== this._swapCanvas && (this._swapCanvas.width = t, this._swapCanvas.height = e), this.baseTexture.width = t, this.baseTexture.height = e, this.textureFrame.width = t, this.textureFrame.height = e, this.texture.width = t, this.texture.height = e, this.texture.crop.width = t, this.texture.crop.height = e, this.update(), this.dirty = !0), this
            },
            update: function(t, e, i, s) {
                return void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = Math.max(1, this.width)), void 0 === s && (s = Math.max(1, this.height)), this.imageData = this.context.getImageData(t, e, i, s), this.data = this.imageData.data, this.imageData.data.buffer ? (this.buffer = this.imageData.data.buffer, this.pixels = new Uint32Array(this.buffer)) : window.ArrayBuffer ? (this.buffer = new ArrayBuffer(this.imageData.data.length), this.pixels = new Uint32Array(this.buffer)) : this.pixels = this.imageData.data, this
            },
            processPixelRGB: function(t, e, i, s, o, r) {
                void 0 === i && (i = 0), void 0 === s && (s = 0), void 0 === o && (o = this.width), void 0 === r && (r = this.height);
                for (var a = i + o, h = s + r, l = n.Color.createColor(), c = {
                        r: 0,
                        g: 0,
                        b: 0,
                        a: 0
                    }, u = !1, d = s; d < h; d++)
                    for (var p = i; p < a; p++) n.Color.unpackPixel(this.getPixel32(p, d), l), !1 !== (c = t.call(e, l, p, d)) && null != c && (this.setPixel32(p, d, c.r, c.g, c.b, c.a, !1), u = !0);
                return u && (this.context.putImageData(this.imageData, 0, 0), this.dirty = !0), this
            },
            processPixel: function(t, e, i, s, n, o) {
                void 0 === i && (i = 0), void 0 === s && (s = 0), void 0 === n && (n = this.width), void 0 === o && (o = this.height);
                for (var r = i + n, a = s + o, h = 0, l = 0, c = !1, u = s; u < a; u++)
                    for (var d = i; d < r; d++) h = this.getPixel32(d, u), (l = t.call(e, h, d, u)) !== h && (this.pixels[u * this.width + d] = l, c = !0);
                return c && (this.context.putImageData(this.imageData, 0, 0), this.dirty = !0), this
            },
            replaceRGB: function(t, e, i, s, o, r, a, h, l) {
                var c = 0,
                    u = 0,
                    d = this.width,
                    p = this.height,
                    f = n.Color.packPixel(t, e, i, s);
                void 0 !== l && l instanceof n.Rectangle && (c = l.x, u = l.y, d = l.width, p = l.height);
                for (var m = 0; m < p; m++)
                    for (var g = 0; g < d; g++) this.getPixel32(c + g, u + m) === f && this.setPixel32(c + g, u + m, o, r, a, h, !1);
                return this.context.putImageData(this.imageData, 0, 0), this.dirty = !0, this
            },
            setHSL: function(t, e, i, s) {
                var o = t || 0 === t,
                    r = e || 0 === e,
                    a = i || 0 === i;
                if (o || r || a) {
                    void 0 === s && (s = new n.Rectangle(0, 0, this.width, this.height));
                    for (var h = n.Color.createColor(), l = s.y; l < s.bottom; l++)
                        for (var c = s.x; c < s.right; c++) n.Color.unpackPixel(this.getPixel32(c, l), h, !0), o && (h.h = t), r && (h.s = e), a && (h.l = i), n.Color.HSLtoRGB(h.h, h.s, h.l, h), this.setPixel32(c, l, h.r, h.g, h.b, h.a, !1);
                    return this.context.putImageData(this.imageData, 0, 0), this.dirty = !0, this
                }
            },
            shiftHSL: function(t, e, i, s) {
                if (null != t || (t = !1), null != e || (e = !1), null != i || (i = !1), t || e || i) {
                    void 0 === s && (s = new n.Rectangle(0, 0, this.width, this.height));
                    for (var o = n.Color.createColor(), r = s.y; r < s.bottom; r++)
                        for (var a = s.x; a < s.right; a++) n.Color.unpackPixel(this.getPixel32(a, r), o, !0), t && (o.h = this.game.math.wrap(o.h + t, 0, 1)), e && (o.s = this.game.math.clamp(o.s + e, 0, 1)), i && (o.l = this.game.math.clamp(o.l + i, 0, 1)), n.Color.HSLtoRGB(o.h, o.s, o.l, o), this.setPixel32(a, r, o.r, o.g, o.b, o.a, !1);
                    return this.context.putImageData(this.imageData, 0, 0), this.dirty = !0, this
                }
            },
            setPixel32: function(t, e, i, s, o, r, a) {
                return void 0 === a && (a = !0), t >= 0 && t <= this.width && e >= 0 && e <= this.height && (n.Device.LITTLE_ENDIAN ? this.pixels[e * this.width + t] = r << 24 | o << 16 | s << 8 | i : this.pixels[e * this.width + t] = i << 24 | s << 16 | o << 8 | r, a && (this.context.putImageData(this.imageData, 0, 0), this.dirty = !0)), this
            },
            setPixel: function(t, e, i, s, n, o) {
                return this.setPixel32(t, e, i, s, n, 255, o)
            },
            getPixel: function(t, e, i) {
                i || (i = n.Color.createColor());
                var s = ~~(t + e * this.width);
                return s *= 4, i.r = this.data[s], i.g = this.data[++s], i.b = this.data[++s], i.a = this.data[++s], i
            },
            getPixel32: function(t, e) {
                if (t >= 0 && t <= this.width && e >= 0 && e <= this.height) return this.pixels[e * this.width + t]
            },
            getPixelRGB: function(t, e, i, s, o) {
                return n.Color.unpackPixel(this.getPixel32(t, e), i, s, o)
            },
            getPixels: function(t) {
                return this.context.getImageData(t.x, t.y, t.width, t.height)
            },
            getFirstPixel: function(t) {
                void 0 === t && (t = 0);
                var e = n.Color.createColor(),
                    i = 0,
                    s = 0,
                    o = 1,
                    r = !1;
                1 === t ? (o = -1, s = this.height) : 3 === t && (o = -1, i = this.width);
                do {
                    n.Color.unpackPixel(this.getPixel32(i, s), e), 0 === t || 1 === t ? ++i === this.width && (i = 0, ((s += o) >= this.height || s <= 0) && (r = !0)) : 2 !== t && 3 !== t || ++s === this.height && (s = 0, ((i += o) >= this.width || i <= 0) && (r = !0))
                } while (0 === e.a && !r);
                return e.x = i, e.y = s, e
            },
            getBounds: function(t) {
                return void 0 === t && (t = new n.Rectangle), t.x = this.getFirstPixel(2).x, t.x === this.width ? t.setTo(0, 0, 0, 0) : (t.y = this.getFirstPixel(0).y, t.width = this.getFirstPixel(3).x - t.x + 1, t.height = this.getFirstPixel(1).y - t.y + 1, t)
            },
            addToWorld: function(t, e, i, s, n, o) {
                n = n || 1, o = o || 1;
                var r = this.game.add.image(t, e, this);
                return r.anchor.set(i, s), r.scale.set(n, o), r
            },
            copy: function(t, e, i, s, o, r, a, h, l, c, u, d, p, f, m, g, y) {
                if (null != t || (t = this), t instanceof n.RenderTexture && (t = t.getCanvas()), this._image = t, t instanceof n.Sprite || t instanceof n.Image || t instanceof n.Text || t instanceof PIXI.Sprite) this._pos.set(t.texture.crop.x, t.texture.crop.y), this._size.set(t.texture.crop.width, t.texture.crop.height), this._scale.set(t.scale.x, t.scale.y), this._anchor.set(t.anchor.x, t.anchor.y), this._rotate = t.rotation, this._alpha.current = t.alpha, t.texture instanceof n.RenderTexture ? this._image = t.texture.getCanvas() : this._image = t.texture.baseTexture.source, null != r || (r = t.x), null != a || (a = t.y), t.texture.trim && (r += t.texture.trim.x - t.anchor.x * t.texture.trim.width, a += t.texture.trim.y - t.anchor.y * t.texture.trim.height), 16777215 !== t.tint && (t.cachedTint !== t.tint && (t.cachedTint = t.tint, t.tintedTexture = PIXI.CanvasTinter.getTintedTexture(t, t.tint)), this._image = t.tintedTexture, this._pos.set(0));
                else {
                    if (this._pos.set(0), this._scale.set(1), this._anchor.set(0), this._rotate = 0, this._alpha.current = 1, t instanceof n.BitmapData) this._image = t.canvas;
                    else if ("string" == typeof t) {
                        if (null === (t = this.game.cache.getImage(t))) return;
                        this._image = t
                    }
                    this._size.set(this._image.width, this._image.height)
                }
                if (null != e || (e = 0), null != i || (i = 0), s && (this._size.x = s), o && (this._size.y = o), null != r || (r = e), null != a || (a = i), null != h || (h = this._size.x), null != l || (l = this._size.y), "number" == typeof c && (this._rotate = c), "number" == typeof u && (this._anchor.x = u), "number" == typeof d && (this._anchor.y = d), "number" == typeof p && (this._scale.x = p), "number" == typeof f && (this._scale.y = f), "number" == typeof m && (this._alpha.current = m), void 0 === g && (g = null), void 0 === y && (y = !1), !(this._alpha.current <= 0 || 0 === this._scale.x || 0 === this._scale.y || 0 === this._size.x || 0 === this._size.y)) {
                    var v = this.context;
                    return this._alpha.prev = v.globalAlpha, v.save(), v.globalAlpha = this._alpha.current, g && (this.op = g), y && (r |= 0, a |= 0), v.translate(r, a), v.scale(this._scale.x, this._scale.y), v.rotate(this._rotate), v.drawImage(this._image, this._pos.x + e, this._pos.y + i, this._size.x, this._size.y, -h * this._anchor.x, -l * this._anchor.y, h, l), v.restore(), v.globalAlpha = this._alpha.prev, this.dirty = !0, this
                }
            },
            copyTransform: function(t, e, i) {
                if (void 0 === e && (e = null), void 0 === i && (i = !1), !t.hasOwnProperty("worldTransform") || !t.worldVisible || 0 === t.worldAlpha) return this;
                var s = t.worldTransform;
                if (this._pos.set(t.texture.crop.x, t.texture.crop.y), this._size.set(t.texture.crop.width, t.texture.crop.height), 0 === s.a || 0 === s.d || 0 === this._size.x || 0 === this._size.y) return this;
                t.texture instanceof n.RenderTexture ? this._image = t.texture.getCanvas() : this._image = t.texture.baseTexture.source;
                var o = s.tx,
                    r = s.ty;
                t.texture.trim && (o += t.texture.trim.x - t.anchor.x * t.texture.trim.width, r += t.texture.trim.y - t.anchor.y * t.texture.trim.height), 16777215 !== t.tint && (t.cachedTint !== t.tint && (t.cachedTint = t.tint, t.tintedTexture = PIXI.CanvasTinter.getTintedTexture(t, t.tint)), this._image = t.tintedTexture, this._pos.set(0)), i && (o |= 0, r |= 0);
                var a = this.context;
                return this._alpha.prev = a.globalAlpha, a.save(), a.globalAlpha = this._alpha.current, e && (this.op = e), a[this.smoothProperty] = t.texture.baseTexture.scaleMode === PIXI.scaleModes.LINEAR, a.setTransform(s.a, s.b, s.c, s.d, o, r), a.drawImage(this._image, this._pos.x, this._pos.y, this._size.x, this._size.y, -this._size.x * t.anchor.x, -this._size.y * t.anchor.y, this._size.x, this._size.y), a.restore(), a.globalAlpha = this._alpha.prev, this.dirty = !0, this
            },
            copyRect: function(t, e, i, s, n, o, r) {
                return this.copy(t, e.x, e.y, e.width, e.height, i, s, e.width, e.height, 0, 0, 0, 1, 1, n, o, r)
            },
            draw: function(t, e, i, s, n, o, r) {
                return this.copy(t, null, null, null, null, e, i, s, n, null, null, null, null, null, null, o, r)
            },
            drawGroup: function(t, e, i) {
                return t.total > 0 && t.forEachExists(this.drawGroupProxy, this, e, i), this
            },
            drawGroupProxy: function(t, e, i) {
                if (t.hasOwnProperty("texture") && this.copyTransform(t, e, i), t.type === n.GROUP && t.exists) this.drawGroup(t, e, i);
                else if (t.hasOwnProperty("children") && t.children.length > 0)
                    for (var s = 0; s < t.children.length; s++) t.children[s].exists && this.copyTransform(t.children[s], e, i)
            },
            drawFull: function(t, e, i) {
                if (!1 === t.worldVisible || 0 === t.worldAlpha || t.hasOwnProperty("exists") && !1 === t.exists) return this;
                if (t.type !== n.GROUP && t.type !== n.EMITTER && t.type !== n.BITMAPTEXT)
                    if (t.type === n.GRAPHICS) {
                        var s = t.getBounds();
                        this.ctx.save(), this.ctx.translate(s.x, s.y), PIXI.CanvasGraphics.renderGraphics(t, this.ctx), this.ctx.restore()
                    } else this.copy(t, null, null, null, null, t.worldPosition.x, t.worldPosition.y, null, null, t.worldRotation, null, null, t.worldScale.x, t.worldScale.y, t.worldAlpha, e, i);
                if (t.children)
                    for (var o = 0; o < t.children.length; o++) this.drawFull(t.children[o], e, i);
                return this
            },
            shadow: function(t, e, i, s) {
                var n = this.context;
                return null == t ? n.shadowColor = "rgba(0,0,0,0)" : (n.shadowColor = t, n.shadowBlur = e || 5, n.shadowOffsetX = i || 10, n.shadowOffsetY = s || 10), this
            },
            alphaMask: function(t, e, i, s) {
                return null == s ? this.draw(e).blendSourceAtop() : this.draw(e, s.x, s.y, s.width, s.height).blendSourceAtop(), null == i ? this.draw(t).blendReset() : this.draw(t, i.x, i.y, i.width, i.height).blendReset(), this
            },
            extract: function(t, e, i, s, n, o, r, a, h) {
                return void 0 === n && (n = 255), void 0 === o && (o = !1), void 0 === r && (r = e), void 0 === a && (a = i), void 0 === h && (h = s), o && t.resize(this.width, this.height), this.processPixelRGB(function(o, l, c) {
                    return o.r === e && o.g === i && o.b === s && t.setPixel32(l, c, r, a, h, n, !1), !1
                }, this), t.context.putImageData(t.imageData, 0, 0), t.dirty = !0, t
            },
            rect: function(t, e, i, s, n) {
                return void 0 !== n && (this.context.fillStyle = n), this.context.fillRect(t, e, i, s), this
            },
            text: function(t, e, i, s, n, o) {
                void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === s && (s = "14px Courier"), void 0 === n && (n = "rgb(255,255,255)"), void 0 === o && (o = !0);
                var r = this.context,
                    a = r.font;
                return r.font = s, o && (r.fillStyle = "rgb(0,0,0)", r.fillText(t, e + 1, i + 1)), r.fillStyle = n, r.fillText(t, e, i), r.font = a, this
            },
            circle: function(t, e, i, s) {
                var n = this.context;
                return void 0 !== s && (n.fillStyle = s), n.beginPath(), n.arc(t, e, i, 0, 2 * Math.PI, !1), n.closePath(), n.fill(), this
            },
            line: function(t, e, i, s, n, o) {
                void 0 === n && (n = "#fff"), void 0 === o && (o = 1);
                var r = this.context;
                return r.beginPath(), r.moveTo(t, e), r.lineTo(i, s), r.lineWidth = o, r.strokeStyle = n, r.stroke(), r.closePath(), this
            },
            textureLine: function(t, e, i) {
                if (void 0 === i && (i = "repeat-x"), "string" != typeof e || (e = this.game.cache.getImage(e))) {
                    var s = t.length;
                    "no-repeat" === i && s > e.width && (s = e.width);
                    var o = this.context;
                    return o.fillStyle = o.createPattern(e, i), this._circle = new n.Circle(t.start.x, t.start.y, e.height), this._circle.circumferencePoint(t.angle - 1.5707963267948966, !1, this._pos), o.save(), o.translate(this._pos.x, this._pos.y), o.rotate(t.angle), o.fillRect(0, 0, s, e.height), o.restore(), this.dirty = !0, this
                }
            },
            render: function() {
                return !this.disableTextureUpload && this.dirty && (this.baseTexture.dirty(), this.dirty = !1), this
            },
            destroy: function() {
                this.frameData.destroy(), this.texture.destroy(!0), n.CanvasPool.remove(this)
            },
            blendReset: function() {
                return this.op = "source-over", this
            },
            blendSourceOver: function() {
                return this.op = "source-over", this
            },
            blendSourceIn: function() {
                return this.op = "source-in", this
            },
            blendSourceOut: function() {
                return this.op = "source-out", this
            },
            blendSourceAtop: function() {
                return this.op = "source-atop", this
            },
            blendDestinationOver: function() {
                return this.op = "destination-over", this
            },
            blendDestinationIn: function() {
                return this.op = "destination-in", this
            },
            blendDestinationOut: function() {
                return this.op = "destination-out", this
            },
            blendDestinationAtop: function() {
                return this.op = "destination-atop", this
            },
            blendXor: function() {
                return this.op = "xor", this
            },
            blendAdd: function() {
                return this.op = "lighter", this
            },
            blendMultiply: function() {
                return this.op = "multiply", this
            },
            blendScreen: function() {
                return this.op = "screen", this
            },
            blendOverlay: function() {
                return this.op = "overlay", this
            },
            blendDarken: function() {
                return this.op = "darken", this
            },
            blendLighten: function() {
                return this.op = "lighten", this
            },
            blendColorDodge: function() {
                return this.op = "color-dodge", this
            },
            blendColorBurn: function() {
                return this.op = "color-burn", this
            },
            blendHardLight: function() {
                return this.op = "hard-light", this
            },
            blendSoftLight: function() {
                return this.op = "soft-light", this
            },
            blendDifference: function() {
                return this.op = "difference", this
            },
            blendExclusion: function() {
                return this.op = "exclusion", this
            },
            blendHue: function() {
                return this.op = "hue", this
            },
            blendSaturation: function() {
                return this.op = "saturation", this
            },
            blendColor: function() {
                return this.op = "color", this
            },
            blendLuminosity: function() {
                return this.op = "luminosity", this
            }
        }, Object.defineProperty(n.BitmapData.prototype, "smoothed", {
            get: function() {
                n.Canvas.getSmoothingEnabled(this.context)
            },
            set: function(t) {
                n.Canvas.setSmoothingEnabled(this.context, t)
            }
        }), Object.defineProperty(n.BitmapData.prototype, "op", {
            get: function() {
                return this.context.globalCompositeOperation
            },
            set: function(t) {
                this.context.globalCompositeOperation = t
            }
        }), n.BitmapData.getTransform = function(t, e, i, s, n, o) {
            return "number" != typeof t && (t = 0), "number" != typeof e && (e = 0), "number" != typeof i && (i = 1), "number" != typeof s && (s = 1), "number" != typeof n && (n = 0), "number" != typeof o && (o = 0), {
                sx: i,
                sy: s,
                scaleX: i,
                scaleY: s,
                skewX: n,
                skewY: o,
                translateX: t,
                translateY: e,
                tx: t,
                ty: e
            }
        }, n.BitmapData.prototype.constructor = n.BitmapData, n.EarCut = {}, n.EarCut.Triangulate = function(t, e, i) {
            i = i || 2;
            var s, o, r, a, h, l, c, u = e && e.length,
                d = u ? e[0] * i : t.length,
                p = n.EarCut.linkedList(t, 0, d, i, !0),
                f = [];
            if (!p) return f;
            if (u && (p = n.EarCut.eliminateHoles(t, e, p, i)), t.length > 80 * i) {
                s = r = t[0], o = a = t[1];
                for (var m = i; m < d; m += i)(h = t[m]) < s && (s = h), (l = t[m + 1]) < o && (o = l), h > r && (r = h), l > a && (a = l);
                c = Math.max(r - s, a - o)
            }
            return n.EarCut.earcutLinked(p, f, i, s, o, c), f
        }, n.EarCut.linkedList = function(t, e, i, s, o) {
            var r, a, h, l = 0;
            for (r = e, a = i - s; r < i; r += s) l += (t[a] - t[r]) * (t[r + 1] + t[a + 1]), a = r;
            if (o === l > 0)
                for (r = e; r < i; r += s) h = n.EarCut.insertNode(r, t[r], t[r + 1], h);
            else
                for (r = i - s; r >= e; r -= s) h = n.EarCut.insertNode(r, t[r], t[r + 1], h);
            return h
        }, n.EarCut.filterPoints = function(t, e) {
            if (!t) return t;
            e || (e = t);
            var i, s = t;
            do {
                if (i = !1, s.steiner || !n.EarCut.equals(s, s.next) && 0 !== n.EarCut.area(s.prev, s, s.next)) s = s.next;
                else {
                    if (n.EarCut.removeNode(s), (s = e = s.prev) === s.next) return null;
                    i = !0
                }
            } while (i || s !== e);
            return e
        }, n.EarCut.earcutLinked = function(t, e, i, s, o, r, a) {
            if (t) {
                !a && r && n.EarCut.indexCurve(t, s, o, r);
                for (var h, l, c = t; t.prev !== t.next;)
                    if (h = t.prev, l = t.next, r ? n.EarCut.isEarHashed(t, s, o, r) : n.EarCut.isEar(t)) e.push(h.i / i), e.push(t.i / i), e.push(l.i / i), n.EarCut.removeNode(t), t = l.next, c = l.next;
                    else if ((t = l) === c) {
                    a ? 1 === a ? (t = n.EarCut.cureLocalIntersections(t, e, i), n.EarCut.earcutLinked(t, e, i, s, o, r, 2)) : 2 === a && n.EarCut.splitEarcut(t, e, i, s, o, r) : n.EarCut.earcutLinked(n.EarCut.filterPoints(t), e, i, s, o, r, 1);
                    break
                }
            }
        }, n.EarCut.isEar = function(t) {
            var e = t.prev,
                i = t,
                s = t.next;
            if (n.EarCut.area(e, i, s) >= 0) return !1;
            for (var o = t.next.next; o !== t.prev;) {
                if (n.EarCut.pointInTriangle(e.x, e.y, i.x, i.y, s.x, s.y, o.x, o.y) && n.EarCut.area(o.prev, o, o.next) >= 0) return !1;
                o = o.next
            }
            return !0
        }, n.EarCut.isEarHashed = function(t, e, i, s) {
            var o = t.prev,
                r = t,
                a = t.next;
            if (n.EarCut.area(o, r, a) >= 0) return !1;
            for (var h = o.x < r.x ? o.x < a.x ? o.x : a.x : r.x < a.x ? r.x : a.x, l = o.y < r.y ? o.y < a.y ? o.y : a.y : r.y < a.y ? r.y : a.y, c = o.x > r.x ? o.x > a.x ? o.x : a.x : r.x > a.x ? r.x : a.x, u = o.y > r.y ? o.y > a.y ? o.y : a.y : r.y > a.y ? r.y : a.y, d = n.EarCut.zOrder(h, l, e, i, s), p = n.EarCut.zOrder(c, u, e, i, s), f = t.nextZ; f && f.z <= p;) {
                if (f !== t.prev && f !== t.next && n.EarCut.pointInTriangle(o.x, o.y, r.x, r.y, a.x, a.y, f.x, f.y) && n.EarCut.area(f.prev, f, f.next) >= 0) return !1;
                f = f.nextZ
            }
            for (f = t.prevZ; f && f.z >= d;) {
                if (f !== t.prev && f !== t.next && n.EarCut.pointInTriangle(o.x, o.y, r.x, r.y, a.x, a.y, f.x, f.y) && n.EarCut.area(f.prev, f, f.next) >= 0) return !1;
                f = f.prevZ
            }
            return !0
        }, n.EarCut.cureLocalIntersections = function(t, e, i) {
            var s = t;
            do {
                var o = s.prev,
                    r = s.next.next;
                n.EarCut.intersects(o, s, s.next, r) && n.EarCut.locallyInside(o, r) && n.EarCut.locallyInside(r, o) && (e.push(o.i / i), e.push(s.i / i), e.push(r.i / i), n.EarCut.removeNode(s), n.EarCut.removeNode(s.next), s = t = r), s = s.next
            } while (s !== t);
            return s
        }, n.EarCut.splitEarcut = function(t, e, i, s, o, r) {
            var a = t;
            do {
                for (var h = a.next.next; h !== a.prev;) {
                    if (a.i !== h.i && n.EarCut.isValidDiagonal(a, h)) {
                        var l = n.EarCut.splitPolygon(a, h);
                        return a = n.EarCut.filterPoints(a, a.next), l = n.EarCut.filterPoints(l, l.next), n.EarCut.earcutLinked(a, e, i, s, o, r), void n.EarCut.earcutLinked(l, e, i, s, o, r)
                    }
                    h = h.next
                }
                a = a.next
            } while (a !== t)
        }, n.EarCut.eliminateHoles = function(t, e, i, s) {
            var o, r, a, h, l, c = [];
            for (o = 0, r = e.length; o < r; o++) a = e[o] * s, h = o < r - 1 ? e[o + 1] * s : t.length, (l = n.EarCut.linkedList(t, a, h, s, !1)) === l.next && (l.steiner = !0), c.push(n.EarCut.getLeftmost(l));
            for (c.sort(compareX), o = 0; o < c.length; o++) n.EarCut.eliminateHole(c[o], i), i = n.EarCut.filterPoints(i, i.next);
            return i
        }, n.EarCut.compareX = function(t, e) {
            return t.x - e.x
        }, n.EarCut.eliminateHole = function(t, e) {
            if (e = n.EarCut.findHoleBridge(t, e)) {
                var i = n.EarCut.splitPolygon(e, t);
                n.EarCut.filterPoints(i, i.next)
            }
        }, n.EarCut.findHoleBridge = function(t, e) {
            var i, s = e,
                o = t.x,
                r = t.y,
                a = -1 / 0;
            do {
                if (r <= s.y && r >= s.next.y) {
                    var h = s.x + (r - s.y) * (s.next.x - s.x) / (s.next.y - s.y);
                    h <= o && h > a && (a = h, i = s.x < s.next.x ? s : s.next)
                }
                s = s.next
            } while (s !== e);
            if (!i) return null;
            if (t.x === i.x) return i.prev;
            var l, c = i,
                u = 1 / 0;
            for (s = i.next; s !== c;) o >= s.x && s.x >= i.x && n.EarCut.pointInTriangle(r < i.y ? o : a, r, i.x, i.y, r < i.y ? a : o, r, s.x, s.y) && ((l = Math.abs(r - s.y) / (o - s.x)) < u || l === u && s.x > i.x) && n.EarCut.locallyInside(s, t) && (i = s, u = l), s = s.next;
            return i
        }, n.EarCut.indexCurve = function(t, e, i, s) {
            var o = t;
            do {
                null === o.z && (o.z = n.EarCut.zOrder(o.x, o.y, e, i, s)), o.prevZ = o.prev, o.nextZ = o.next, o = o.next
            } while (o !== t);
            o.prevZ.nextZ = null, o.prevZ = null, n.EarCut.sortLinked(o)
        }, n.EarCut.sortLinked = function(t) {
            var e, i, s, n, o, r, a, h, l = 1;
            do {
                for (i = t, t = null, o = null, r = 0; i;) {
                    for (r++, s = i, a = 0, e = 0; e < l && (a++, s = s.nextZ); e++);
                    for (h = l; a > 0 || h > 0 && s;) 0 === a ? (n = s, s = s.nextZ, h--) : 0 !== h && s ? i.z <= s.z ? (n = i, i = i.nextZ, a--) : (n = s, s = s.nextZ, h--) : (n = i, i = i.nextZ, a--), o ? o.nextZ = n : t = n, n.prevZ = o, o = n;
                    i = s
                }
                o.nextZ = null, l *= 2
            } while (r > 1);
            return t
        }, n.EarCut.zOrder = function(t, e, i, s, n) {
            return (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - i) / n) | t << 8)) | t << 4)) | t << 2)) | t << 1)) | (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - s) / n) | e << 8)) | e << 4)) | e << 2)) | e << 1)) << 1
        }, n.EarCut.getLeftmost = function(t) {
            var e = t,
                i = t;
            do {
                e.x < i.x && (i = e), e = e.next
            } while (e !== t);
            return i
        }, n.EarCut.pointInTriangle = function(t, e, i, s, n, o, r, a) {
            return (n - r) * (e - a) - (t - r) * (o - a) >= 0 && (t - r) * (s - a) - (i - r) * (e - a) >= 0 && (i - r) * (o - a) - (n - r) * (s - a) >= 0
        }, n.EarCut.isValidDiagonal = function(t, e) {
            return n.EarCut.equals(t, e) || t.next.i !== e.i && t.prev.i !== e.i && !n.EarCut.intersectsPolygon(t, e) && n.EarCut.locallyInside(t, e) && n.EarCut.locallyInside(e, t) && n.EarCut.middleInside(t, e)
        }, n.EarCut.area = function(t, e, i) {
            return (e.y - t.y) * (i.x - e.x) - (e.x - t.x) * (i.y - e.y)
        }, n.EarCut.equals = function(t, e) {
            return t.x === e.x && t.y === e.y
        }, n.EarCut.intersects = function(t, e, i, s) {
            return n.EarCut.area(t, e, i) > 0 != n.EarCut.area(t, e, s) > 0 && n.EarCut.area(i, s, t) > 0 != n.EarCut.area(i, s, e) > 0
        }, n.EarCut.intersectsPolygon = function(t, e) {
            var i = t;
            do {
                if (i.i !== t.i && i.next.i !== t.i && i.i !== e.i && i.next.i !== e.i && n.EarCut.intersects(i, i.next, t, e)) return !0;
                i = i.next
            } while (i !== t);
            return !1
        }, n.EarCut.locallyInside = function(t, e) {
            return n.EarCut.area(t.prev, t, t.next) < 0 ? n.EarCut.area(t, e, t.next) >= 0 && n.EarCut.area(t, t.prev, e) >= 0 : n.EarCut.area(t, e, t.prev) < 0 || n.EarCut.area(t, t.next, e) < 0
        }, n.EarCut.middleInside = function(t, e) {
            var i = t,
                s = !1,
                n = (t.x + e.x) / 2,
                o = (t.y + e.y) / 2;
            do {
                i.y > o != i.next.y > o && n < (i.next.x - i.x) * (o - i.y) / (i.next.y - i.y) + i.x && (s = !s), i = i.next
            } while (i !== t);
            return s
        }, n.EarCut.splitPolygon = function(t, e) {
            var i = new n.EarCut.Node(t.i, t.x, t.y),
                s = new n.EarCut.Node(e.i, e.x, e.y),
                o = t.next,
                r = e.prev;
            return t.next = e, e.prev = t, i.next = o, o.prev = i, s.next = i, i.prev = s, r.next = s, s.prev = r, s
        }, n.EarCut.insertNode = function(t, e, i, s) {
            var o = new n.EarCut.Node(t, e, i);
            return s ? (o.next = s.next, o.prev = s, s.next.prev = o, s.next = o) : (o.prev = o, o.next = o), o
        }, n.EarCut.removeNode = function(t) {
            t.next.prev = t.prev, t.prev.next = t.next, t.prevZ && (t.prevZ.nextZ = t.nextZ), t.nextZ && (t.nextZ.prevZ = t.prevZ)
        }, n.EarCut.Node = function(t, e, i) {
            this.i = t, this.x = e, this.y = i, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = !1
        }, PIXI.WebGLGraphics = function() {}, PIXI.WebGLGraphics.stencilBufferLimit = 6, PIXI.WebGLGraphics.renderGraphics = function(t, e) {
            var i, s = e.gl,
                o = e.projection,
                r = e.offset,
                a = e.shaderManager.primitiveShader;
            t.dirty && PIXI.WebGLGraphics.updateGraphics(t, s);
            for (var h = t._webGL[s.id], l = 0; l < h.data.length; l++) 1 === h.data[l].mode ? (i = h.data[l], e.stencilManager.pushStencil(t, i, e), s.drawElements(s.TRIANGLE_FAN, 4, s.UNSIGNED_SHORT, 2 * (i.indices.length - 4)), e.stencilManager.popStencil(t, i, e)) : (i = h.data[l], e.shaderManager.setShader(a), a = e.shaderManager.primitiveShader, s.uniformMatrix3fv(a.translationMatrix, !1, t.worldTransform.toArray(!0)), s.uniform1f(a.flipY, 1), s.uniform2f(a.projectionVector, o.x, -o.y), s.uniform2f(a.offsetVector, -r.x, -r.y), s.uniform3fv(a.tintColor, n.Color.hexToRGBArray(t.tint)), s.uniform1f(a.alpha, t.worldAlpha), s.bindBuffer(s.ARRAY_BUFFER, i.buffer), s.vertexAttribPointer(a.aVertexPosition, 2, s.FLOAT, !1, 24, 0), s.vertexAttribPointer(a.colorAttribute, 4, s.FLOAT, !1, 24, 8), s.bindBuffer(s.ELEMENT_ARRAY_BUFFER, i.indexBuffer), s.drawElements(s.TRIANGLE_STRIP, i.indices.length, s.UNSIGNED_SHORT, 0))
        }, PIXI.WebGLGraphics.updateGraphics = function(t, e) {
            var i, s, o = t._webGL[e.id];
            if (o || (o = t._webGL[e.id] = {
                    lastIndex: 0,
                    data: [],
                    gl: e
                }), t.dirty = !1, t.clearDirty) {
                for (t.clearDirty = !1, i = 0; i < o.data.length; i++) {
                    var r = o.data[i];
                    r.reset(), PIXI.WebGLGraphics.graphicsDataPool.push(r)
                }
                o.data = [], o.lastIndex = 0
            }
            for (i = o.lastIndex; i < t.graphicsData.length; i++) {
                var a = t.graphicsData[i];
                if (a.type === n.POLYGON) {
                    if (a.points = a.shape.points.slice(), a.shape.closed && (a.points[0] === a.points[a.points.length - 2] && a.points[1] === a.points[a.points.length - 1] || a.points.push(a.points[0], a.points[1])), a.fill && a.points.length >= PIXI.WebGLGraphics.stencilBufferLimit)
                        if (a.points.length < 2 * PIXI.WebGLGraphics.stencilBufferLimit) {
                            s = PIXI.WebGLGraphics.switchMode(o, 0), PIXI.WebGLGraphics.buildPoly(a, s) || (s = PIXI.WebGLGraphics.switchMode(o, 1), PIXI.WebGLGraphics.buildComplexPoly(a, s))
                        } else s = PIXI.WebGLGraphics.switchMode(o, 1), PIXI.WebGLGraphics.buildComplexPoly(a, s);
                    a.lineWidth > 0 && (s = PIXI.WebGLGraphics.switchMode(o, 0), PIXI.WebGLGraphics.buildLine(a, s))
                } else s = PIXI.WebGLGraphics.switchMode(o, 0), a.type === n.RECTANGLE ? PIXI.WebGLGraphics.buildRectangle(a, s) : a.type === n.CIRCLE || a.type === n.ELLIPSE ? PIXI.WebGLGraphics.buildCircle(a, s) : a.type === n.ROUNDEDRECTANGLE && PIXI.WebGLGraphics.buildRoundedRectangle(a, s);
                o.lastIndex++
            }
            for (i = 0; i < o.data.length; i++)(s = o.data[i]).dirty && s.upload()
        }, PIXI.WebGLGraphics.switchMode = function(t, e) {
            var i;
            return t.data.length ? (i = t.data[t.data.length - 1]).mode === e && 1 !== e || ((i = PIXI.WebGLGraphics.graphicsDataPool.pop() || new PIXI.WebGLGraphicsData(t.gl)).mode = e, t.data.push(i)) : ((i = PIXI.WebGLGraphics.graphicsDataPool.pop() || new PIXI.WebGLGraphicsData(t.gl)).mode = e, t.data.push(i)), i.dirty = !0, i
        }, PIXI.WebGLGraphics.buildRectangle = function(t, e) {
            var i = t.shape,
                s = i.x,
                o = i.y,
                r = i.width,
                a = i.height;
            if (t.fill) {
                var h = n.Color.hexToRGBArray(t.fillColor),
                    l = t.fillAlpha,
                    c = h[0] * l,
                    u = h[1] * l,
                    d = h[2] * l,
                    p = e.points,
                    f = e.indices,
                    m = p.length / 6;
                p.push(s, o), p.push(c, u, d, l), p.push(s + r, o), p.push(c, u, d, l), p.push(s, o + a), p.push(c, u, d, l), p.push(s + r, o + a), p.push(c, u, d, l), f.push(m, m, m + 1, m + 2, m + 3, m + 3)
            }
            if (t.lineWidth) {
                var g = t.points;
                t.points = [s, o, s + r, o, s + r, o + a, s, o + a, s, o], PIXI.WebGLGraphics.buildLine(t, e), t.points = g
            }
        }, PIXI.WebGLGraphics.buildRoundedRectangle = function(t, e) {
            var i = t.shape,
                s = i.x,
                o = i.y,
                r = i.width,
                a = i.height,
                h = i.radius,
                l = [];
            if (l.push(s, o + h), l = (l = (l = (l = l.concat(PIXI.WebGLGraphics.quadraticBezierCurve(s, o + a - h, s, o + a, s + h, o + a))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(s + r - h, o + a, s + r, o + a, s + r, o + a - h))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(s + r, o + h, s + r, o, s + r - h, o))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(s + h, o, s, o, s, o + h)), t.fill) {
                var c = n.Color.hexToRGBArray(t.fillColor),
                    u = t.fillAlpha,
                    d = c[0] * u,
                    p = c[1] * u,
                    f = c[2] * u,
                    m = e.points,
                    g = e.indices,
                    y = m.length / 6,
                    v = n.EarCut.Triangulate(l, null, 2),
                    b = 0;
                for (b = 0; b < v.length; b += 3) g.push(v[b] + y), g.push(v[b] + y), g.push(v[b + 1] + y), g.push(v[b + 2] + y), g.push(v[b + 2] + y);
                for (b = 0; b < l.length; b++) m.push(l[b], l[++b], d, p, f, u)
            }
            if (t.lineWidth) {
                var _ = t.points;
                t.points = l, PIXI.WebGLGraphics.buildLine(t, e), t.points = _
            }
        }, PIXI.WebGLGraphics.quadraticBezierCurve = function(t, e, i, s, n, o) {
            function r(t, e, i) {
                return t + (e - t) * i
            }
            for (var a, h, l, c, u, d, p = [], f = 0, m = 0; m <= 20; m++) a = r(t, i, f = m / 20), h = r(e, s, f), l = r(i, n, f), c = r(s, o, f), u = r(a, l, f), d = r(h, c, f), p.push(u, d);
            return p
        }, PIXI.WebGLGraphics.buildCircle = function(t, e) {
            var i, s, o = t.shape,
                r = o.x,
                a = o.y;
            t.type === n.CIRCLE ? (i = o.radius, s = o.radius) : (i = o.width, s = o.height);
            var h = 2 * Math.PI / 40,
                l = 0;
            if (t.fill) {
                var c = n.Color.hexToRGBArray(t.fillColor),
                    u = t.fillAlpha,
                    d = c[0] * u,
                    p = c[1] * u,
                    f = c[2] * u,
                    m = e.points,
                    g = e.indices,
                    y = m.length / 6;
                for (g.push(y), l = 0; l < 41; l++) m.push(r, a, d, p, f, u), m.push(r + Math.sin(h * l) * i, a + Math.cos(h * l) * s, d, p, f, u), g.push(y++, y++);
                g.push(y - 1)
            }
            if (t.lineWidth) {
                var v = t.points;
                for (t.points = [], l = 0; l < 41; l++) t.points.push(r + Math.sin(h * l) * i, a + Math.cos(h * l) * s);
                PIXI.WebGLGraphics.buildLine(t, e), t.points = v
            }
        }, PIXI.WebGLGraphics.buildLine = function(t, e) {
            var i = 0,
                s = t.points;
            if (0 !== s.length) {
                if (t.lineWidth % 2)
                    for (i = 0; i < s.length; i++) s[i] += .5;
                var o = new PIXI.Point(s[0], s[1]),
                    r = new PIXI.Point(s[s.length - 2], s[s.length - 1]);
                if (o.x === r.x && o.y === r.y) {
                    (s = s.slice()).pop(), s.pop();
                    var a = (r = new PIXI.Point(s[s.length - 2], s[s.length - 1])).x + .5 * (o.x - r.x),
                        h = r.y + .5 * (o.y - r.y);
                    s.unshift(a, h), s.push(a, h)
                }
                var l, c, u, d, p, f, m, g, y, v, b, _, w, x, P, T, C, S, A, E, k, M, O = e.points,
                    R = e.indices,
                    B = s.length / 2,
                    I = s.length,
                    L = O.length / 6,
                    D = t.lineWidth / 2,
                    F = n.Color.hexToRGBArray(t.lineColor),
                    U = t.lineAlpha,
                    N = F[0] * U,
                    G = F[1] * U,
                    j = F[2] * U;
                for (u = s[0], d = s[1], p = s[2], y = -(d - (f = s[3])), v = u - p, y /= M = Math.sqrt(y * y + v * v), v /= M, y *= D, v *= D, O.push(u - y, d - v, N, G, j, U), O.push(u + y, d + v, N, G, j, U), i = 1; i < B - 1; i++) u = s[2 * (i - 1)], d = s[2 * (i - 1) + 1], p = s[2 * i], f = s[2 * i + 1], m = s[2 * (i + 1)], g = s[2 * (i + 1) + 1], y = -(d - f), v = u - p, y /= M = Math.sqrt(y * y + v * v), v /= M, y *= D, v *= D, b = -(f - g), _ = p - m, b /= M = Math.sqrt(b * b + _ * _), _ /= M, C = (-y + u) * (-v + f) - (-y + p) * (-v + d), E = (-(b *= D) + m) * (-(_ *= D) + f) - (-b + p) * (-_ + g), k = (P = -v + d - (-v + f)) * (A = -b + p - (-b + m)) - (S = -_ + g - (-_ + f)) * (T = -y + p - (-y + u)), Math.abs(k) < .1 ? (k += 10.1, O.push(p - y, f - v, N, G, j, U), O.push(p + y, f + v, N, G, j, U)) : ((l = (T * E - A * C) / k) - p) * (l - p) + ((c = (S * C - P * E) / k) - f) + (c - f) > 19600 ? (w = y - b, x = v - _, w /= M = Math.sqrt(w * w + x * x), x /= M, w *= D, x *= D, O.push(p - w, f - x), O.push(N, G, j, U), O.push(p + w, f + x), O.push(N, G, j, U), O.push(p - w, f - x), O.push(N, G, j, U), I++) : (O.push(l, c), O.push(N, G, j, U), O.push(p - (l - p), f - (c - f)), O.push(N, G, j, U));
                for (u = s[2 * (B - 2)], d = s[2 * (B - 2) + 1], p = s[2 * (B - 1)], y = -(d - (f = s[2 * (B - 1) + 1])), v = u - p, y /= M = Math.sqrt(y * y + v * v), v /= M, y *= D, v *= D, O.push(p - y, f - v), O.push(N, G, j, U), O.push(p + y, f + v), O.push(N, G, j, U), R.push(L), i = 0; i < I; i++) R.push(L++);
                R.push(L - 1)
            }
        }, PIXI.WebGLGraphics.buildComplexPoly = function(t, e) {
            var i = t.points.slice();
            if (!(i.length < 6)) {
                var s = e.indices;
                e.points = i, e.alpha = t.fillAlpha, e.color = n.Color.hexToRGBArray(t.fillColor);
                for (var o, r, a = 1 / 0, h = -1 / 0, l = 1 / 0, c = -1 / 0, u = 0; u < i.length; u += 2) a = (o = i[u]) < a ? o : a, h = o > h ? o : h, l = (r = i[u + 1]) < l ? r : l, c = r > c ? r : c;
                i.push(a, l, h, l, h, c, a, c);
                var d = i.length / 2;
                for (u = 0; u < d; u++) s.push(u)
            }
        }, PIXI.WebGLGraphics.buildPoly = function(t, e) {
            var i = t.points;
            if (!(i.length < 6)) {
                var s = e.points,
                    o = e.indices,
                    r = i.length / 2,
                    a = n.Color.hexToRGBArray(t.fillColor),
                    h = t.fillAlpha,
                    l = a[0] * h,
                    c = a[1] * h,
                    u = a[2] * h,
                    d = n.EarCut.Triangulate(i, null, 2);
                if (!d) return !1;
                var p = s.length / 6,
                    f = 0;
                for (f = 0; f < d.length; f += 3) o.push(d[f] + p), o.push(d[f] + p), o.push(d[f + 1] + p), o.push(d[f + 2] + p), o.push(d[f + 2] + p);
                for (f = 0; f < r; f++) s.push(i[2 * f], i[2 * f + 1], l, c, u, h);
                return !0
            }
        }, PIXI.WebGLGraphics.graphicsDataPool = [], PIXI.WebGLGraphicsData = function(t) {
            this.gl = t, this.color = [0, 0, 0], this.points = [], this.indices = [], this.buffer = t.createBuffer(), this.indexBuffer = t.createBuffer(), this.mode = 1, this.alpha = 1, this.dirty = !0
        }, PIXI.WebGLGraphicsData.prototype.reset = function() {
            this.points = [], this.indices = []
        }, PIXI.WebGLGraphicsData.prototype.upload = function() {
            var t = this.gl;
            this.glPoints = new Float32Array(this.points), t.bindBuffer(t.ARRAY_BUFFER, this.buffer), t.bufferData(t.ARRAY_BUFFER, this.glPoints, t.STATIC_DRAW), this.glIndicies = new Uint16Array(this.indices), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.glIndicies, t.STATIC_DRAW), this.dirty = !1
        }, PIXI.CanvasGraphics = function() {}, PIXI.CanvasGraphics.renderGraphics = function(t, e) {
            var i = t.worldAlpha;
            t.dirty && (this.updateGraphicsTint(t), t.dirty = !1);
            for (var s = 0; s < t.graphicsData.length; s++) {
                var o = t.graphicsData[s],
                    r = o.shape,
                    a = o._fillTint,
                    h = o._lineTint;
                if (e.lineWidth = o.lineWidth, o.type === n.POLYGON) {
                    e.beginPath();
                    var l = r.points;
                    e.moveTo(l[0], l[1]);
                    for (var c = 1; c < l.length / 2; c++) e.lineTo(l[2 * c], l[2 * c + 1]);
                    r.closed && e.lineTo(l[0], l[1]), l[0] === l[l.length - 2] && l[1] === l[l.length - 1] && e.closePath(), o.fill && (e.globalAlpha = o.fillAlpha * i, e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), e.fill()), o.lineWidth && (e.globalAlpha = o.lineAlpha * i, e.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), e.stroke())
                } else if (o.type === n.RECTANGLE)(o.fillColor || 0 === o.fillColor) && (e.globalAlpha = o.fillAlpha * i, e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), e.fillRect(r.x, r.y, r.width, r.height)), o.lineWidth && (e.globalAlpha = o.lineAlpha * i, e.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), e.strokeRect(r.x, r.y, r.width, r.height));
                else if (o.type === n.CIRCLE) e.beginPath(), e.arc(r.x, r.y, r.radius, 0, 2 * Math.PI), e.closePath(), o.fill && (e.globalAlpha = o.fillAlpha * i, e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), e.fill()), o.lineWidth && (e.globalAlpha = o.lineAlpha * i, e.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), e.stroke());
                else if (o.type === n.ELLIPSE) {
                    var u = 2 * r.width,
                        d = 2 * r.height,
                        p = r.x - u / 2,
                        f = r.y - d / 2;
                    e.beginPath();
                    var m = .5522848,
                        g = u / 2 * m,
                        y = d / 2 * m,
                        v = p + u,
                        b = f + d,
                        _ = p + u / 2,
                        w = f + d / 2;
                    e.moveTo(p, w), e.bezierCurveTo(p, w - y, _ - g, f, _, f), e.bezierCurveTo(_ + g, f, v, w - y, v, w), e.bezierCurveTo(v, w + y, _ + g, b, _, b), e.bezierCurveTo(_ - g, b, p, w + y, p, w), e.closePath(), o.fill && (e.globalAlpha = o.fillAlpha * i, e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), e.fill()), o.lineWidth && (e.globalAlpha = o.lineAlpha * i, e.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), e.stroke())
                } else if (o.type === n.ROUNDEDRECTANGLE) {
                    var x = r.x,
                        P = r.y,
                        T = r.width,
                        C = r.height,
                        S = r.radius,
                        A = Math.min(T, C) / 2 | 0;
                    S = S > A ? A : S, e.beginPath(), e.moveTo(x, P + S), e.lineTo(x, P + C - S), e.quadraticCurveTo(x, P + C, x + S, P + C), e.lineTo(x + T - S, P + C), e.quadraticCurveTo(x + T, P + C, x + T, P + C - S), e.lineTo(x + T, P + S), e.quadraticCurveTo(x + T, P, x + T - S, P), e.lineTo(x + S, P), e.quadraticCurveTo(x, P, x, P + S), e.closePath(), (o.fillColor || 0 === o.fillColor) && (e.globalAlpha = o.fillAlpha * i, e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), e.fill()), o.lineWidth && (e.globalAlpha = o.lineAlpha * i, e.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), e.stroke())
                }
            }
        }, PIXI.CanvasGraphics.renderGraphicsMask = function(t, e) {
            var i = t.graphicsData.length;
            if (0 !== i) {
                e.beginPath();
                for (var s = 0; s < i; s++) {
                    var o = t.graphicsData[s],
                        r = o.shape;
                    if (o.type === n.POLYGON) {
                        var a = r.points;
                        e.moveTo(a[0], a[1]);
                        for (var h = 1; h < a.length / 2; h++) e.lineTo(a[2 * h], a[2 * h + 1]);
                        a[0] === a[a.length - 2] && a[1] === a[a.length - 1] && e.closePath()
                    } else if (o.type === n.RECTANGLE) e.rect(r.x, r.y, r.width, r.height), e.closePath();
                    else if (o.type === n.CIRCLE) e.arc(r.x, r.y, r.radius, 0, 2 * Math.PI), e.closePath();
                    else if (o.type === n.ELLIPSE) {
                        var l = 2 * r.width,
                            c = 2 * r.height,
                            u = r.x - l / 2,
                            d = r.y - c / 2,
                            p = .5522848,
                            f = l / 2 * p,
                            m = c / 2 * p,
                            g = u + l,
                            y = d + c,
                            v = u + l / 2,
                            b = d + c / 2;
                        e.moveTo(u, b), e.bezierCurveTo(u, b - m, v - f, d, v, d), e.bezierCurveTo(v + f, d, g, b - m, g, b), e.bezierCurveTo(g, b + m, v + f, y, v, y), e.bezierCurveTo(v - f, y, u, b + m, u, b), e.closePath()
                    } else if (o.type === n.ROUNDEDRECTANGLE) {
                        var _ = r.x,
                            w = r.y,
                            x = r.width,
                            P = r.height,
                            T = r.radius,
                            C = Math.min(x, P) / 2 | 0;
                        T = T > C ? C : T, e.moveTo(_, w + T), e.lineTo(_, w + P - T), e.quadraticCurveTo(_, w + P, _ + T, w + P), e.lineTo(_ + x - T, w + P), e.quadraticCurveTo(_ + x, w + P, _ + x, w + P - T), e.lineTo(_ + x, w + T), e.quadraticCurveTo(_ + x, w, _ + x - T, w), e.lineTo(_ + T, w), e.quadraticCurveTo(_, w, _, w + T), e.closePath()
                    }
                }
            }
        }, PIXI.CanvasGraphics.updateGraphicsTint = function(t) {
            if (16777215 !== t.tint)
                for (var e = (t.tint >> 16 & 255) / 255, i = (t.tint >> 8 & 255) / 255, s = (255 & t.tint) / 255, n = 0; n < t.graphicsData.length; n++) {
                    var o = t.graphicsData[n],
                        r = 0 | o.fillColor,
                        a = 0 | o.lineColor;
                    o._fillTint = ((r >> 16 & 255) / 255 * e * 255 << 16) + ((r >> 8 & 255) / 255 * i * 255 << 8) + (255 & r) / 255 * s * 255, o._lineTint = ((a >> 16 & 255) / 255 * e * 255 << 16) + ((a >> 8 & 255) / 255 * i * 255 << 8) + (255 & a) / 255 * s * 255
                }
        }, n.GraphicsData = function(t, e, i, s, n, o, r) {
            this.lineWidth = t, this.lineColor = e, this.lineAlpha = i, this._lineTint = e, this.fillColor = s, this.fillAlpha = n, this._fillTint = s, this.fill = o, this.shape = r, this.type = r.type
        }, n.GraphicsData.prototype.constructor = n.GraphicsData, n.GraphicsData.prototype.clone = function() {
            return new n.GraphicsData(this.lineWidth, this.lineColor, this.lineAlpha, this.fillColor, this.fillAlpha, this.fill, this.shape)
        }, n.Graphics = function(t, e, i) {
            void 0 === e && (e = 0), void 0 === i && (i = 0), this.type = n.GRAPHICS, this.physicsType = n.SPRITE, this.anchor = new n.Point, PIXI.DisplayObjectContainer.call(this), this.renderable = !0, this.fillAlpha = 1, this.lineWidth = 0, this.lineColor = 0, this.graphicsData = [], this.tint = 16777215, this.blendMode = PIXI.blendModes.NORMAL, this.currentPath = null, this._webGL = [], this.isMask = !1, this.boundsPadding = 0, this._localBounds = new n.Rectangle(0, 0, 1, 1), this.dirty = !0, this._boundsDirty = !1, this.webGLDirty = !1, this.cachedSpriteDirty = !1, n.Component.Core.init.call(this, t, e, i, "", null)
        }, n.Graphics.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), n.Graphics.prototype.constructor = n.Graphics, n.Component.Core.install.call(n.Graphics.prototype, ["Angle", "AutoCull", "Bounds", "Destroy", "FixedToCamera", "InputEnabled", "InWorld", "LifeSpan", "PhysicsBody", "Reset"]), n.Graphics.prototype.preUpdatePhysics = n.Component.PhysicsBody.preUpdate, n.Graphics.prototype.preUpdateLifeSpan = n.Component.LifeSpan.preUpdate, n.Graphics.prototype.preUpdateInWorld = n.Component.InWorld.preUpdate, n.Graphics.prototype.preUpdateCore = n.Component.Core.preUpdate, n.Graphics.prototype.preUpdate = function() {
            return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore()
        }, n.Graphics.prototype.postUpdate = function() {
            n.Component.PhysicsBody.postUpdate.call(this), n.Component.FixedToCamera.postUpdate.call(this), this._boundsDirty && (this.updateLocalBounds(), this._boundsDirty = !1);
            for (var t = 0; t < this.children.length; t++) this.children[t].postUpdate()
        }, n.Graphics.prototype.destroy = function(t) {
            this.clear(), n.Component.Destroy.prototype.destroy.call(this, t)
        }, n.Graphics.prototype.drawTriangle = function(t, e) {
            void 0 === e && (e = !1);
            var i = new n.Polygon(t);
            if (e) {
                var s = new n.Point(this.game.camera.x - t[0].x, this.game.camera.y - t[0].y),
                    o = new n.Point(t[1].x - t[0].x, t[1].y - t[0].y),
                    r = new n.Point(t[1].x - t[2].x, t[1].y - t[2].y).cross(o);
                s.dot(r) > 0 && this.drawPolygon(i)
            } else this.drawPolygon(i)
        }, n.Graphics.prototype.drawTriangles = function(t, e, i) {
            void 0 === i && (i = !1);
            var s, o = new n.Point,
                r = new n.Point,
                a = new n.Point,
                h = [];
            if (e)
                if (t[0] instanceof n.Point)
                    for (s = 0; s < e.length / 3; s++) h.push(t[e[3 * s]]), h.push(t[e[3 * s + 1]]), h.push(t[e[3 * s + 2]]), 3 === h.length && (this.drawTriangle(h, i), h = []);
                else
                    for (s = 0; s < e.length; s++) o.x = t[2 * e[s]], o.y = t[2 * e[s] + 1], h.push(o.copyTo({})), 3 === h.length && (this.drawTriangle(h, i), h = []);
            else if (t[0] instanceof n.Point)
                for (s = 0; s < t.length / 3; s++) this.drawTriangle([t[3 * s], t[3 * s + 1], t[3 * s + 2]], i);
            else
                for (s = 0; s < t.length / 6; s++) o.x = t[6 * s + 0], o.y = t[6 * s + 1], r.x = t[6 * s + 2], r.y = t[6 * s + 3], a.x = t[6 * s + 4], a.y = t[6 * s + 5], this.drawTriangle([o, r, a], i)
        }, n.Graphics.prototype.lineStyle = function(t, e, i) {
            return this.lineWidth = t || 0, this.lineColor = e || 0, this.lineAlpha = void 0 === i ? 1 : i, this.currentPath && (this.currentPath.shape.points.length ? this.drawShape(new n.Polygon(this.currentPath.shape.points.slice(-2))) : (this.currentPath.lineWidth = this.lineWidth, this.currentPath.lineColor = this.lineColor, this.currentPath.lineAlpha = this.lineAlpha)), this
        }, n.Graphics.prototype.moveTo = function(t, e) {
            return this.drawShape(new n.Polygon([t, e])), this
        }, n.Graphics.prototype.lineTo = function(t, e) {
            return this.currentPath || this.moveTo(0, 0), this.currentPath.shape.points.push(t, e), this.dirty = !0, this._boundsDirty = !0, this
        }, n.Graphics.prototype.quadraticCurveTo = function(t, e, i, s) {
            this.currentPath ? 0 === this.currentPath.shape.points.length && (this.currentPath.shape.points = [0, 0]) : this.moveTo(0, 0);
            var n, o, r = this.currentPath.shape.points;
            0 === r.length && this.moveTo(0, 0);
            for (var a = r[r.length - 2], h = r[r.length - 1], l = 0, c = 1; c <= 20; ++c) n = a + (t - a) * (l = c / 20), o = h + (e - h) * l, r.push(n + (t + (i - t) * l - n) * l, o + (e + (s - e) * l - o) * l);
            return this.dirty = !0, this._boundsDirty = !0, this
        }, n.Graphics.prototype.bezierCurveTo = function(t, e, i, s, n, o) {
            this.currentPath ? 0 === this.currentPath.shape.points.length && (this.currentPath.shape.points = [0, 0]) : this.moveTo(0, 0);
            for (var r, a, h, l, c, u = this.currentPath.shape.points, d = u[u.length - 2], p = u[u.length - 1], f = 0, m = 1; m <= 20; ++m) h = (a = (r = 1 - (f = m / 20)) * r) * r, c = (l = f * f) * f, u.push(h * d + 3 * a * f * t + 3 * r * l * i + c * n, h * p + 3 * a * f * e + 3 * r * l * s + c * o);
            return this.dirty = !0, this._boundsDirty = !0, this
        }, n.Graphics.prototype.arcTo = function(t, e, i, s, n) {
            this.currentPath ? 0 === this.currentPath.shape.points.length && this.currentPath.shape.points.push(t, e) : this.moveTo(t, e);
            var o = this.currentPath.shape.points,
                r = o[o.length - 2],
                a = o[o.length - 1] - e,
                h = r - t,
                l = s - e,
                c = i - t,
                u = Math.abs(a * c - h * l);
            if (u < 1e-8 || 0 === n) o[o.length - 2] === t && o[o.length - 1] === e || o.push(t, e);
            else {
                var d = a * a + h * h,
                    p = l * l + c * c,
                    f = a * l + h * c,
                    m = n * Math.sqrt(d) / u,
                    g = n * Math.sqrt(p) / u,
                    y = m * f / d,
                    v = g * f / p,
                    b = m * c + g * h,
                    _ = m * l + g * a,
                    w = h * (g + y),
                    x = a * (g + y),
                    P = c * (m + v),
                    T = l * (m + v),
                    C = Math.atan2(x - _, w - b),
                    S = Math.atan2(T - _, P - b);
                this.arc(b + t, _ + e, n, C, S, h * l > c * a)
            }
            return this.dirty = !0, this._boundsDirty = !0, this
        }, n.Graphics.prototype.arc = function(t, e, i, s, n, o, r) {
            if (s === n) return this;
            void 0 === o && (o = !1), void 0 === r && (r = 40), !o && n <= s ? n += 2 * Math.PI : o && s <= n && (s += 2 * Math.PI);
            var a = o ? -1 * (s - n) : n - s,
                h = Math.ceil(Math.abs(a) / (2 * Math.PI)) * r;
            if (0 === a) return this;
            var l = t + Math.cos(s) * i,
                c = e + Math.sin(s) * i;
            o && this.filling ? this.moveTo(t, e) : this.moveTo(l, c);
            for (var u = this.currentPath.shape.points, d = a / (2 * h), p = 2 * d, f = Math.cos(d), m = Math.sin(d), g = h - 1, y = g % 1 / g, v = 0; v <= g; v++) {
                var b = d + s + p * (v + y * v),
                    _ = Math.cos(b),
                    w = -Math.sin(b);
                u.push((f * _ + m * w) * i + t, (f * -w + m * _) * i + e)
            }
            return this.dirty = !0, this._boundsDirty = !0, this
        }, n.Graphics.prototype.beginFill = function(t, e) {
            return this.filling = !0, this.fillColor = t || 0, this.fillAlpha = void 0 === e ? 1 : e, this.currentPath && this.currentPath.shape.points.length <= 2 && (this.currentPath.fill = this.filling, this.currentPath.fillColor = this.fillColor, this.currentPath.fillAlpha = this.fillAlpha), this
        }, n.Graphics.prototype.endFill = function() {
            return this.filling = !1, this.fillColor = null, this.fillAlpha = 1, this
        }, n.Graphics.prototype.drawRect = function(t, e, i, s) {
            return this.drawShape(new n.Rectangle(t, e, i, s)), this
        }, n.Graphics.prototype.drawRoundedRect = function(t, e, i, s, o) {
            return this.drawShape(new n.RoundedRectangle(t, e, i, s, o)), this
        }, n.Graphics.prototype.drawCircle = function(t, e, i) {
            return this.drawShape(new n.Circle(t, e, i)), this
        }, n.Graphics.prototype.drawEllipse = function(t, e, i, s) {
            return this.drawShape(new n.Ellipse(t, e, i, s)), this
        }, n.Graphics.prototype.drawPolygon = function(t) {
            t instanceof n.Polygon && (t = t.points);
            var e = t;
            if (!Array.isArray(e)) {
                e = new Array(arguments.length);
                for (var i = 0; i < e.length; ++i) e[i] = arguments[i]
            }
            return this.drawShape(new n.Polygon(e)), this
        }, n.Graphics.prototype.clear = function() {
            return this.lineWidth = 0, this.filling = !1, this.dirty = !0, this._boundsDirty = !0, this.clearDirty = !0, this.graphicsData = [], this.updateLocalBounds(), this
        }, n.Graphics.prototype.generateTexture = function(t, e, i) {
            void 0 === t && (t = 1), void 0 === e && (e = PIXI.scaleModes.DEFAULT), void 0 === i && (i = 0);
            var s = this.getBounds();
            s.width += i, s.height += i;
            var n = new PIXI.CanvasBuffer(s.width * t, s.height * t),
                o = PIXI.Texture.fromCanvas(n.canvas, e);
            return o.baseTexture.resolution = t, n.context.scale(t, t), n.context.translate(-s.x, -s.y), PIXI.CanvasGraphics.renderGraphics(this, n.context), o
        }, n.Graphics.prototype._renderWebGL = function(t) {
            if (!1 !== this.visible && 0 !== this.alpha && !0 !== this.isMask) {
                if (this._cacheAsBitmap) return (this.dirty || this.cachedSpriteDirty) && (this._generateCachedSprite(), this.updateCachedSpriteTexture(), this.cachedSpriteDirty = !1, this.dirty = !1), this._cachedSprite.worldAlpha = this.worldAlpha, void PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite, t);
                if (t.spriteBatch.stop(), t.blendModeManager.setBlendMode(this.blendMode), this._mask && t.maskManager.pushMask(this._mask, t), this._filters && t.filterManager.pushFilter(this._filterBlock), this.blendMode !== t.spriteBatch.currentBlendMode) {
                    t.spriteBatch.currentBlendMode = this.blendMode;
                    var e = PIXI.blendModesWebGL[t.spriteBatch.currentBlendMode];
                    t.spriteBatch.gl.blendFunc(e[0], e[1])
                }
                if (this.webGLDirty && (this.dirty = !0, this.webGLDirty = !1), PIXI.WebGLGraphics.renderGraphics(this, t), this.children.length) {
                    t.spriteBatch.start();
                    for (var i = 0; i < this.children.length; i++) this.children[i]._renderWebGL(t);
                    t.spriteBatch.stop()
                }
                this._filters && t.filterManager.popFilter(), this._mask && t.maskManager.popMask(this.mask, t), t.drawCount++, t.spriteBatch.start()
            }
        }, n.Graphics.prototype._renderCanvas = function(t) {
            if (!1 !== this.visible && 0 !== this.alpha && !0 !== this.isMask) {
                if (this._prevTint !== this.tint && (this.dirty = !0, this._prevTint = this.tint), this._cacheAsBitmap) return (this.dirty || this.cachedSpriteDirty) && (this._generateCachedSprite(), this.updateCachedSpriteTexture(), this.cachedSpriteDirty = !1, this.dirty = !1), this._cachedSprite.alpha = this.alpha, void PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite, t);
                var e = t.context,
                    i = this.worldTransform;
                this.blendMode !== t.currentBlendMode && (t.currentBlendMode = this.blendMode, e.globalCompositeOperation = PIXI.blendModesCanvas[t.currentBlendMode]), this._mask && t.maskManager.pushMask(this._mask, t);
                var s = t.resolution,
                    n = i.tx * t.resolution + t.shakeX,
                    o = i.ty * t.resolution + t.shakeY;
                e.setTransform(i.a * s, i.b * s, i.c * s, i.d * s, n, o), PIXI.CanvasGraphics.renderGraphics(this, e);
                for (var r = 0; r < this.children.length; r++) this.children[r]._renderCanvas(t);
                this._mask && t.maskManager.popMask(t)
            }
        }, n.Graphics.prototype.getBounds = function(t) {
            if (this._currentBounds) return this._currentBounds;
            if (!this.renderable) return n.EmptyRectangle;
            this.dirty && (this.updateLocalBounds(), this.webGLDirty = !0, this.cachedSpriteDirty = !0, this.dirty = !1);
            var e = this._localBounds,
                i = e.x,
                s = e.width + e.x,
                o = e.y,
                r = e.height + e.y,
                a = t || this.worldTransform,
                h = a.a,
                l = a.b,
                c = a.c,
                u = a.d,
                d = a.tx,
                p = a.ty,
                f = h * s + c * r + d,
                m = u * r + l * s + p,
                g = h * i + c * r + d,
                y = u * r + l * i + p,
                v = h * i + c * o + d,
                b = u * o + l * i + p,
                _ = h * s + c * o + d,
                w = u * o + l * s + p,
                x = f,
                P = m,
                T = f,
                C = m;
            return T = _ < (T = v < (T = g < T ? g : T) ? v : T) ? _ : T, C = w < (C = b < (C = y < C ? y : C) ? b : C) ? w : C, x = _ > (x = v > (x = g > x ? g : x) ? v : x) ? _ : x, P = w > (P = b > (P = y > P ? y : P) ? b : P) ? w : P, this._bounds.x = T, this._bounds.width = x - T, this._bounds.y = C, this._bounds.height = P - C, this._currentBounds = this._bounds, this._currentBounds
        }, n.Graphics.prototype.getLocalBounds = function() {
            var t = this.worldTransform;
            this.worldTransform = n.identityMatrix;
            for (var e = 0; e < this.children.length; e++) this.children[e].updateTransform();
            var i = this.getBounds();
            for (this.worldTransform = t, e = 0; e < this.children.length; e++) this.children[e].updateTransform();
            return i
        }, n.Graphics.prototype.containsPoint = function(t, e) {
            void 0 === e && (e = new n.Point), this.worldTransform.applyInverse(t, e);
            for (var i = this.graphicsData, s = 0; s < i.length; s++) {
                var o = i[s];
                if (o.fill && o.shape && o.shape.contains(e.x, e.y)) return !0
            }
            return !1
        }, n.Graphics.prototype.updateLocalBounds = function() {
            var t = 1 / 0,
                e = -1 / 0,
                i = 1 / 0,
                s = -1 / 0;
            if (this.graphicsData.length)
                for (var o, r, a, h, l, c, u = 0; u < this.graphicsData.length; u++) {
                    var d = this.graphicsData[u],
                        p = d.type,
                        f = d.lineWidth;
                    if (o = d.shape, p === n.RECTANGLE || p === n.ROUNDEDRECTANGLE) a = o.x - f / 2, h = o.y - f / 2, t = a < t ? a : t, e = a + (l = o.width + f) > e ? a + l : e, i = h < i ? h : i, s = h + (c = o.height + f) > s ? h + c : s;
                    else if (p === n.CIRCLE) a = o.x, h = o.y, t = a - (l = o.radius + f / 2) < t ? a - l : t, e = a + l > e ? a + l : e, i = h - (c = o.radius + f / 2) < i ? h - c : i, s = h + c > s ? h + c : s;
                    else if (p === n.ELLIPSE) a = o.x, h = o.y, t = a - (l = o.width + f / 2) < t ? a - l : t, e = a + l > e ? a + l : e, i = h - (c = o.height + f / 2) < i ? h - c : i, s = h + c > s ? h + c : s;
                    else {
                        r = o.points;
                        for (var m = 0; m < r.length; m++) r[m] instanceof n.Point ? (a = r[m].x, h = r[m].y) : (a = r[m], h = r[m + 1], m < r.length - 1 && m++), t = a - f < t ? a - f : t, e = a + f > e ? a + f : e, i = h - f < i ? h - f : i, s = h + f > s ? h + f : s
                    }
                } else t = 0, e = 0, i = 0, s = 0;
            var g = this.boundsPadding;
            this._localBounds.x = t - g, this._localBounds.width = e - t + 2 * g, this._localBounds.y = i - g, this._localBounds.height = s - i + 2 * g
        }, n.Graphics.prototype._generateCachedSprite = function() {
            var t = this.getLocalBounds();
            if (this._cachedSprite) this._cachedSprite.buffer.resize(t.width, t.height);
            else {
                var e = new PIXI.CanvasBuffer(t.width, t.height),
                    i = PIXI.Texture.fromCanvas(e.canvas);
                this._cachedSprite = new PIXI.Sprite(i), this._cachedSprite.buffer = e, this._cachedSprite.worldTransform = this.worldTransform
            }
            this._cachedSprite.anchor.x = -t.x / t.width, this._cachedSprite.anchor.y = -t.y / t.height, this._cachedSprite.buffer.context.translate(-t.x, -t.y), this.worldAlpha = 1, PIXI.CanvasGraphics.renderGraphics(this, this._cachedSprite.buffer.context), this._cachedSprite.alpha = this.alpha
        }, n.Graphics.prototype.updateCachedSpriteTexture = function() {
            var t = this._cachedSprite,
                e = t.texture,
                i = t.buffer.canvas;
            e.baseTexture.width = i.width, e.baseTexture.height = i.height, e.crop.width = e.frame.width = i.width, e.crop.height = e.frame.height = i.height, t._width = i.width, t._height = i.height, e.baseTexture.dirty()
        }, n.Graphics.prototype.destroyCachedSprite = function() {
            this._cachedSprite.texture.destroy(!0), this._cachedSprite = null
        }, n.Graphics.prototype.drawShape = function(t) {
            this.currentPath && this.currentPath.shape.points.length <= 2 && this.graphicsData.pop(), this.currentPath = null, t instanceof n.Polygon && (t = t.clone()).flatten();
            var e = new n.GraphicsData(this.lineWidth, this.lineColor, this.lineAlpha, this.fillColor, this.fillAlpha, this.filling, t);
            return this.graphicsData.push(e), e.type === n.POLYGON && (e.shape.closed = this.filling, this.currentPath = e), this.dirty = !0, this._boundsDirty = !0, e
        }, Object.defineProperty(n.Graphics.prototype, "cacheAsBitmap", {
            get: function() {
                return this._cacheAsBitmap
            },
            set: function(t) {
                this._cacheAsBitmap = t, this._cacheAsBitmap ? this._generateCachedSprite() : this.destroyCachedSprite(), this.dirty = !0, this.webGLDirty = !0
            }
        }), n.RenderTexture = function(t, e, i, s, o, r, a, h) {
            if (void 0 === e && (e = 100), void 0 === i && (i = 100), void 0 === s && (s = ""), void 0 === o && (o = n.scaleModes.DEFAULT), void 0 === r && (r = 1), void 0 === a && (a = PIXI.defaultRenderer), void 0 === h && (h = 0), this.game = t, this.key = s, this.type = n.RENDERTEXTURE, this._tempMatrix = new n.Matrix, this.width = e, this.height = i, this.resolution = r, this.frame = new n.Rectangle(0, 0, this.width * this.resolution, this.height * this.resolution), this.crop = this.frame.clone(), this.baseTexture = new PIXI.BaseTexture, this.baseTexture.width = this.width * this.resolution, this.baseTexture.height = this.height * this.resolution, this.baseTexture._glTextures = [], this.baseTexture.resolution = this.resolution, this.baseTexture.scaleMode = o, this.baseTexture.hasLoaded = !0, PIXI.Texture.call(this, this.baseTexture, this.frame.clone()), this.renderer = a, this.renderer.type === n.WEBGL) {
                var l = this.renderer.gl;
                this.baseTexture.textureIndex = h, this.baseTexture._dirty[l.id] = !1, this.textureBuffer = new PIXI.FilterTexture(l, this.width, this.height, this.baseTexture.scaleMode, h), this.baseTexture._glTextures[l.id] = this.textureBuffer.texture, this.projection = new n.Point(.5 * this.width, .5 * -this.height)
            } else this.textureBuffer = new PIXI.CanvasBuffer(this.width * this.resolution, this.height * this.resolution), this.baseTexture.source = this.textureBuffer.canvas;
            this.valid = !0, this.tempMatrix = new n.Matrix, this._updateUvs()
        }, n.RenderTexture.prototype = Object.create(PIXI.Texture.prototype), n.RenderTexture.prototype.constructor = n.RenderTexture, n.RenderTexture.prototype.renderXY = function(t, e, i, s) {
            t.updateTransform(), this._tempMatrix.copyFrom(t.worldTransform), this._tempMatrix.tx = e, this._tempMatrix.ty = i, this.renderer.type === n.WEBGL ? this._renderWebGL(t, this._tempMatrix, s) : this._renderCanvas(t, this._tempMatrix, s)
        }, n.RenderTexture.prototype.renderRawXY = function(t, e, i, s) {
            this._tempMatrix.identity().translate(e, i), this.renderer.type === n.WEBGL ? this._renderWebGL(t, this._tempMatrix, s) : this._renderCanvas(t, this._tempMatrix, s)
        }, n.RenderTexture.prototype.render = function(t, e, i) {
            null == e ? this._tempMatrix.copyFrom(t.worldTransform) : this._tempMatrix.copyFrom(e), this.renderer.type === n.WEBGL ? this._renderWebGL(t, this._tempMatrix, i) : this._renderCanvas(t, this._tempMatrix, i)
        }, n.RenderTexture.prototype.resize = function(t, e, i) {
            t === this.width && e === this.height || (this.valid = t > 0 && e > 0, this.width = t, this.height = e, this.frame.width = this.crop.width = t * this.resolution, this.frame.height = this.crop.height = e * this.resolution, i && (this.baseTexture.width = this.width * this.resolution, this.baseTexture.height = this.height * this.resolution), this.renderer.type === n.WEBGL && (this.projection.x = this.width / 2, this.projection.y = -this.height / 2), this.valid && this.textureBuffer.resize(this.width, this.height))
        }, n.RenderTexture.prototype.clear = function() {
            this.valid && (this.renderer.type === n.WEBGL && this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER, this.textureBuffer.frameBuffer), this.textureBuffer.clear())
        }, n.RenderTexture.prototype._renderWebGL = function(t, e, i) {
            if (this.valid && 0 !== t.alpha) {
                var s = t.worldTransform;
                s.identity(), s.translate(0, 2 * this.projection.y), e && s.append(e), s.scale(1, -1);
                for (var n = 0; n < t.children.length; n++) t.children[n].updateTransform();
                var o = this.renderer.gl;
                o.viewport(0, 0, this.width * this.resolution, this.height * this.resolution), o.bindFramebuffer(o.FRAMEBUFFER, this.textureBuffer.frameBuffer), i && this.textureBuffer.clear(), this.renderer.spriteBatch.dirty = !0, this.renderer.renderDisplayObject(t, this.projection, this.textureBuffer.frameBuffer, e), this.renderer.spriteBatch.dirty = !0, o.bindFramebuffer(o.FRAMEBUFFER, null)
            }
        }, n.RenderTexture.prototype._renderCanvas = function(t, e, i) {
            if (this.valid && 0 !== t.alpha) {
                var s = t.worldTransform;
                s.identity(), e && s.append(e);
                for (var n = 0; n < t.children.length; n++) t.children[n].updateTransform();
                i && this.textureBuffer.clear();
                var o = this.renderer.resolution;
                this.renderer.resolution = this.resolution, this.renderer.renderDisplayObject(t, this.textureBuffer.context, e), this.renderer.resolution = o
            }
        }, n.RenderTexture.prototype.getImage = function() {
            var t = new Image;
            return t.src = this.getBase64(), t
        }, n.RenderTexture.prototype.getBase64 = function() {
            return this.getCanvas().toDataURL()
        }, n.RenderTexture.prototype.getCanvas = function() {
            if (this.renderer.type === n.WEBGL) {
                var t = this.renderer.gl,
                    e = this.textureBuffer.width,
                    i = this.textureBuffer.height,
                    s = new Uint8Array(4 * e * i);
                t.bindFramebuffer(t.FRAMEBUFFER, this.textureBuffer.frameBuffer), t.readPixels(0, 0, e, i, t.RGBA, t.UNSIGNED_BYTE, s), t.bindFramebuffer(t.FRAMEBUFFER, null);
                var o = new PIXI.CanvasBuffer(e, i),
                    r = o.context.getImageData(0, 0, e, i);
                return r.data.set(s), o.context.putImageData(r, 0, 0), o.canvas
            }
            return this.textureBuffer.canvas
        }, n.Text = function(t, e, i, s, o) {
            e = e || 0, i = i || 0, s = null == s ? "" : s.toString(), o = n.Utils.extend({}, o), this.type = n.TEXT, this.physicsType = n.SPRITE, this.padding = new n.Point, this.textBounds = null, this.canvas = n.CanvasPool.create(this), this.context = this.canvas.getContext("2d"), this.colors = [], this.strokeColors = [], this.fontStyles = [], this.fontWeights = [], this.autoRound = !1, this.useAdvancedWrap = !1, this.splitRegExp = /(?:\r\n|\r|\n)/, this.characterLimitSize = -1, this.characterLimitSuffix = "", this._res = t.renderer.resolution, this._text = s, this._fontComponents = null, this._lineSpacing = 0, this._charCount = 0, this._width = 0, this._height = 0, n.Sprite.call(this, t, e, i, PIXI.Texture.fromCanvas(this.canvas)), this.setStyle(o), "" !== s && this.updateText()
        }, n.Text.prototype = Object.create(n.Sprite.prototype), n.Text.prototype.constructor = n.Text, n.Text.prototype.preUpdate = function() {
            return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore()
        }, n.Text.prototype.update = function() {}, n.Text.prototype.destroy = function(t) {
            this.texture.destroy(!0), n.Component.Destroy.prototype.destroy.call(this, t)
        }, n.Text.prototype.setShadow = function(t, e, i, s, n, o) {
            return void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = "rgba(0, 0, 0, 1)"), void 0 === s && (s = 0), void 0 === n && (n = !0), void 0 === o && (o = !0), this.style.shadowOffsetX = t, this.style.shadowOffsetY = e, this.style.shadowColor = i, this.style.shadowBlur = s, this.style.shadowStroke = n, this.style.shadowFill = o, this.dirty = !0, this
        }, n.Text.prototype.setStyle = function(t, e) {
            void 0 === e && (e = !1), (t = t || {}).font = t.font || "bold 20pt Arial", t.backgroundColor = t.backgroundColor || null, t.fill = t.fill || "black", t.align = t.align || "left", t.boundsAlignH = t.boundsAlignH || "left", t.boundsAlignV = t.boundsAlignV || "top", t.stroke = t.stroke || "black", t.strokeThickness = t.strokeThickness || 0, t.wordWrap = t.wordWrap || !1, t.wordWrapWidth = t.wordWrapWidth || 100, t.maxLines = t.maxLines || 0, t.shadowOffsetX = t.shadowOffsetX || 0, t.shadowOffsetY = t.shadowOffsetY || 0, t.shadowColor = t.shadowColor || "rgba(0,0,0,0)", t.shadowBlur = t.shadowBlur || 0, t.tabs = t.tabs || 0;
            var i = this.fontToComponents(t.font);
            return t.fontStyle && (i.fontStyle = t.fontStyle), t.fontVariant && (i.fontVariant = t.fontVariant), t.fontWeight && (i.fontWeight = t.fontWeight), t.fontSize && ("number" == typeof t.fontSize && (t.fontSize = t.fontSize + "px"), i.fontSize = t.fontSize), this._fontComponents = i, t.font = this.componentsToFont(this._fontComponents), this.style = t, this.dirty = !0, e && this.updateText(), this
        }, n.Text.prototype.updateText = function() {
            this.texture.baseTexture.resolution = this._res, this.context.font = this.style.font;
            var t = this.text;
            this.characterLimitSize > -1 && this.characterLimitSize < t.length && (t = this.text.substring(0, this.characterLimitSize) + this.characterLimitSuffix), this.style.wordWrap && (t = this.runWordWrap(this.text));
            var e = t.split(this.splitRegExp),
                i = this.style.tabs,
                s = [],
                n = 0,
                o = this.determineFontProperties(this.style.font),
                r = e.length;
            this.style.maxLines > 0 && this.style.maxLines < e.length && (r = this.style.maxLines), this._charCount = 0;
            for (var a = 0; a < r; a++) {
                if (0 === i) {
                    var h = this.style.strokeThickness + this.padding.x;
                    this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? h += this.measureLine(e[a]) : h += this.context.measureText(e[a]).width, this.style.wordWrap && (h -= this.context.measureText(" ").width)
                } else {
                    var l = e[a].split(/(?:\t)/);
                    h = this.padding.x + this.style.strokeThickness;
                    if (Array.isArray(i))
                        for (var c = 0, u = 0; u < l.length; u++) {
                            var d;
                            d = this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.measureLine(l[u]) : Math.ceil(this.context.measureText(l[u]).width), u > 0 && (c += i[u - 1]), h = c + d
                        } else
                            for (u = 0; u < l.length; u++) {
                                this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? h += this.measureLine(l[u]) : h += Math.ceil(this.context.measureText(l[u]).width), h += this.game.math.snapToCeil(h, i) - h
                            }
                }
                s[a] = Math.ceil(h), n = Math.max(n, s[a])
            }
            this.canvas.width = n * this._res;
            var p, f, m = o.fontSize + this.style.strokeThickness + this.padding.y,
                g = m * r,
                y = this._lineSpacing;
            for (y < 0 && Math.abs(y) > m && (y = -m), 0 !== y && (g += y > 0 ? y * e.length : y * (e.length - 1)), this.canvas.height = g * this._res, this.context.scale(this._res, this._res), navigator.isCocoonJS && this.context.clearRect(0, 0, this.canvas.width, this.canvas.height), this.style.backgroundColor && (this.context.fillStyle = this.style.backgroundColor, this.context.fillRect(0, 0, this.canvas.width, this.canvas.height)), this.context.fillStyle = this.style.fill, this.context.font = this.style.font, this.context.strokeStyle = this.style.stroke, this.context.textBaseline = "alphabetic", this.context.lineWidth = this.style.strokeThickness, this.context.lineCap = "round", this.context.lineJoin = "round", this._charCount = 0, a = 0; a < r; a++) p = this.style.strokeThickness / 2, f = this.style.strokeThickness / 2 + a * m + o.ascent, a > 0 && (f += y * a), "right" === this.style.align ? p += n - s[a] : "center" === this.style.align && (p += (n - s[a]) / 2), this.autoRound && (p = Math.round(p), f = Math.round(f)), this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.updateLine(e[a], p, f) : (this.style.stroke && this.style.strokeThickness && (this.updateShadow(this.style.shadowStroke), 0 === i ? this.context.strokeText(e[a], p, f) : this.renderTabLine(e[a], p, f, !1)), this.style.fill && (this.updateShadow(this.style.shadowFill), 0 === i ? this.context.fillText(e[a], p, f) : this.renderTabLine(e[a], p, f, !0)));
            this.updateTexture(), this.dirty = !1
        }, n.Text.prototype.renderTabLine = function(t, e, i, s) {
            var n = t.split(/(?:\t)/),
                o = this.style.tabs,
                r = 0;
            if (Array.isArray(o))
                for (var a = 0, h = 0; h < n.length; h++) h > 0 && (a += o[h - 1]), r = e + a, s ? this.context.fillText(n[h], r, i) : this.context.strokeText(n[h], r, i);
            else
                for (h = 0; h < n.length; h++) {
                    var l = Math.ceil(this.context.measureText(n[h]).width);
                    r = this.game.math.snapToCeil(e, o), s ? this.context.fillText(n[h], r, i) : this.context.strokeText(n[h], r, i), e = r + l
                }
        }, n.Text.prototype.updateShadow = function(t) {
            t ? (this.context.shadowOffsetX = this.style.shadowOffsetX, this.context.shadowOffsetY = this.style.shadowOffsetY, this.context.shadowColor = this.style.shadowColor, this.context.shadowBlur = this.style.shadowBlur) : (this.context.shadowOffsetX = 0, this.context.shadowOffsetY = 0, this.context.shadowColor = 0, this.context.shadowBlur = 0)
        }, n.Text.prototype.measureLine = function(t) {
            for (var e = 0, i = 0; i < t.length; i++) {
                var s = t[i];
                if (this.fontWeights.length > 0 || this.fontStyles.length > 0) {
                    var n = this.fontToComponents(this.context.font);
                    this.fontStyles[this._charCount] && (n.fontStyle = this.fontStyles[this._charCount]), this.fontWeights[this._charCount] && (n.fontWeight = this.fontWeights[this._charCount]), this.context.font = this.componentsToFont(n)
                }
                this.style.stroke && this.style.strokeThickness && (this.strokeColors[this._charCount] && (this.context.strokeStyle = this.strokeColors[this._charCount]), this.updateShadow(this.style.shadowStroke)), this.style.fill && (this.colors[this._charCount] && (this.context.fillStyle = this.colors[this._charCount]), this.updateShadow(this.style.shadowFill)), e += this.context.measureText(s).width, this._charCount++
            }
            return Math.ceil(e)
        }, n.Text.prototype.updateLine = function(t, e, i) {
            for (var s = 0; s < t.length; s++) {
                var n = t[s];
                if (this.fontWeights.length > 0 || this.fontStyles.length > 0) {
                    var o = this.fontToComponents(this.context.font);
                    this.fontStyles[this._charCount] && (o.fontStyle = this.fontStyles[this._charCount]), this.fontWeights[this._charCount] && (o.fontWeight = this.fontWeights[this._charCount]), this.context.font = this.componentsToFont(o)
                }
                this.style.stroke && this.style.strokeThickness && (this.strokeColors[this._charCount] && (this.context.strokeStyle = this.strokeColors[this._charCount]), this.updateShadow(this.style.shadowStroke), this.context.strokeText(n, e, i)), this.style.fill && (this.colors[this._charCount] && (this.context.fillStyle = this.colors[this._charCount]), this.updateShadow(this.style.shadowFill), this.context.fillText(n, e, i)), e += this.context.measureText(n).width, this._charCount++
            }
        }, n.Text.prototype.clearColors = function() {
            return this.colors = [], this.strokeColors = [], this.dirty = !0, this
        }, n.Text.prototype.clearFontValues = function() {
            return this.fontStyles = [], this.fontWeights = [], this.dirty = !0, this
        }, n.Text.prototype.addColor = function(t, e) {
            return this.colors[e] = t, this.dirty = !0, this
        }, n.Text.prototype.addStrokeColor = function(t, e) {
            return this.strokeColors[e] = t, this.dirty = !0, this
        }, n.Text.prototype.addFontStyle = function(t, e) {
            return this.fontStyles[e] = t, this.dirty = !0, this
        }, n.Text.prototype.addFontWeight = function(t, e) {
            return this.fontWeights[e] = t, this.dirty = !0, this
        }, n.Text.prototype.precalculateWordWrap = function(t) {
            return this.texture.baseTexture.resolution = this._res, this.context.font = this.style.font, this.runWordWrap(t).split(/(?:\r\n|\r|\n)/)
        }, n.Text.prototype.runWordWrap = function(t) {
            return this.useAdvancedWrap ? this.advancedWordWrap(t) : this.basicWordWrap(t)
        }, n.Text.prototype.advancedWordWrap = function(t) {
            for (var e = this.context, i = this.style.wordWrapWidth, s = "", n = t.replace(/ +/gi, " ").split(/\r?\n/gi), o = n.length, r = 0; r < o; r++) {
                var a = n[r],
                    h = "";
                if (a = a.replace(/^ *|\s*$/gi, ""), e.measureText(a).width < i) s += a + "\n";
                else {
                    for (var l = i, c = a.split(" "), u = 0; u < c.length; u++) {
                        var d = c[u],
                            p = d + " ",
                            f = e.measureText(p).width;
                        if (f > l) {
                            if (0 === u) {
                                for (var m = p; m.length && (m = m.slice(0, -1), !((f = e.measureText(m).width) <= l)););
                                if (!m.length) throw new Error("This text's wordWrapWidth setting is less than a single character!");
                                var g = d.substr(m.length);
                                c[u] = g, h += m
                            }
                            var y = c[u].length ? u : u + 1,
                                v = c.slice(y).join(" ").replace(/[ \n]*$/gi, "");
                            n[r + 1] = v + " " + (n[r + 1] || ""), o = n.length;
                            break
                        }
                        h += p, l -= f
                    }
                    s += h.replace(/[ \n]*$/gi, "") + "\n"
                }
            }
            return s.replace(/[\s|\n]*$/gi, "")
        }, n.Text.prototype.basicWordWrap = function(t) {
            for (var e = "", i = t.split("\n"), s = 0; s < i.length; s++) {
                for (var n = this.style.wordWrapWidth, o = i[s].split(" "), r = 0; r < o.length; r++) {
                    var a = this.context.measureText(o[r]).width,
                        h = a + this.context.measureText(" ").width;
                    h > n ? (r > 0 && (e += "\n"), e += o[r] + " ", n = this.style.wordWrapWidth - a) : (n -= h, e += o[r] + " ")
                }
                s < i.length - 1 && (e += "\n")
            }
            return e
        }, n.Text.prototype.updateFont = function(t) {
            var e = this.componentsToFont(t);
            this.style.font !== e && (this.style.font = e, this.dirty = !0, this.parent && this.updateTransform())
        }, n.Text.prototype.fontToComponents = function(t) {
            var e = t.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/);
            if (e) {
                var i = e[5].trim();
                return /^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(i) || /['",]/.exec(i) || (i = "'" + i + "'"), {
                    font: t,
                    fontStyle: e[1] || "normal",
                    fontVariant: e[2] || "normal",
                    fontWeight: e[3] || "normal",
                    fontSize: e[4] || "medium",
                    fontFamily: i
                }
            }
            return console.warn("Phaser.Text - unparsable CSS font: " + t), {
                font: t
            }
        }, n.Text.prototype.componentsToFont = function(t) {
            var e, i = [];
            return (e = t.fontStyle) && "normal" !== e && i.push(e), (e = t.fontVariant) && "normal" !== e && i.push(e), (e = t.fontWeight) && "normal" !== e && i.push(e), (e = t.fontSize) && "medium" !== e && i.push(e), (e = t.fontFamily) && i.push(e), i.length || i.push(t.font), i.join(" ")
        }, n.Text.prototype.setText = function(t, e) {
            return void 0 === e && (e = !1), this.text = t.toString() || "", e ? this.updateText() : this.dirty = !0, this
        }, n.Text.prototype.parseList = function(t) {
            if (!Array.isArray(t)) return this;
            for (var e = "", i = 0; i < t.length; i++) Array.isArray(t[i]) ? (e += t[i].join("\t"), i < t.length - 1 && (e += "\n")) : (e += t[i], i < t.length - 1 && (e += "\t"));
            return this.text = e, this.dirty = !0, this
        }, n.Text.prototype.setTextBounds = function(t, e, i, s) {
            return void 0 === t ? this.textBounds = null : (this.textBounds ? this.textBounds.setTo(t, e, i, s) : this.textBounds = new n.Rectangle(t, e, i, s), this.style.wordWrapWidth > i && (this.style.wordWrapWidth = i)), this.updateTexture(), this
        }, n.Text.prototype.updateTexture = function() {
            var t = this.texture.baseTexture,
                e = this.texture.crop,
                i = this.texture.frame,
                s = this.canvas.width,
                n = this.canvas.height;
            if (t.width = s, t.height = n, e.width = s, e.height = n, i.width = s, i.height = n, this.texture.width = s, this.texture.height = n, this._width = s, this._height = n, this.textBounds) {
                var o = this.textBounds.x,
                    r = this.textBounds.y;
                "right" === this.style.boundsAlignH ? o += this.textBounds.width - this.canvas.width / this.resolution : "center" === this.style.boundsAlignH && (o += this.textBounds.halfWidth - this.canvas.width / this.resolution / 2), "bottom" === this.style.boundsAlignV ? r += this.textBounds.height - this.canvas.height / this.resolution : "middle" === this.style.boundsAlignV && (r += this.textBounds.halfHeight - this.canvas.height / this.resolution / 2), this.pivot.x = -o, this.pivot.y = -r
            }
            this.renderable = 0 !== s && 0 !== n, this.texture.requiresReTint = !0, this.texture.baseTexture.dirty()
        }, n.Text.prototype._renderWebGL = function(t) {
            this.dirty && (this.updateText(), this.dirty = !1), PIXI.Sprite.prototype._renderWebGL.call(this, t)
        }, n.Text.prototype._renderCanvas = function(t) {
            this.dirty && (this.updateText(), this.dirty = !1), PIXI.Sprite.prototype._renderCanvas.call(this, t)
        }, n.Text.prototype.determineFontProperties = function(t) {
            var e = n.Text.fontPropertiesCache[t];
            if (!e) {
                e = {};
                var i = n.Text.fontPropertiesCanvas,
                    s = n.Text.fontPropertiesContext;
                s.font = t;
                var o = Math.ceil(s.measureText("|Mq").width),
                    r = Math.ceil(s.measureText("|Mq").width),
                    a = 2 * r;
                if (r = 1.4 * r | 0, i.width = o, i.height = a, s.fillStyle = "#f00", s.fillRect(0, 0, o, a), s.font = t, s.textBaseline = "alphabetic", s.fillStyle = "#000", s.fillText("|Mq", 0, r), !s.getImageData(0, 0, o, a)) return e.ascent = r, e.descent = r + 6, e.fontSize = e.ascent + e.descent, n.Text.fontPropertiesCache[t] = e, e;
                var h, l, c = s.getImageData(0, 0, o, a).data,
                    u = c.length,
                    d = 4 * o,
                    p = 0,
                    f = !1;
                for (h = 0; h < r; h++) {
                    for (l = 0; l < d; l += 4)
                        if (255 !== c[p + l]) {
                            f = !0;
                            break
                        } if (f) break;
                    p += d
                }
                for (e.ascent = r - h, p = u - d, f = !1, h = a; h > r; h--) {
                    for (l = 0; l < d; l += 4)
                        if (255 !== c[p + l]) {
                            f = !0;
                            break
                        } if (f) break;
                    p -= d
                }
                e.descent = h - r, e.descent += 6, e.fontSize = e.ascent + e.descent, n.Text.fontPropertiesCache[t] = e
            }
            return e
        }, n.Text.prototype.getBounds = function(t) {
            return this.dirty && (this.updateText(), this.dirty = !1), PIXI.Sprite.prototype.getBounds.call(this, t)
        }, n.Text.prototype.setCharacterLimit = function(t, e) {
            this.characterLimitSuffix = void 0 === e ? "" : e, this.characterLimitSize = t, this.updateText()
        }, Object.defineProperty(n.Text.prototype, "text", {
            get: function() {
                return this._text
            },
            set: function(t) {
                t !== this._text && (this._text = t.toString() || "", this.dirty = !0, this.parent && this.updateTransform())
            }
        }), Object.defineProperty(n.Text.prototype, "cssFont", {
            get: function() {
                return this.componentsToFont(this._fontComponents)
            },
            set: function(t) {
                t = t || "bold 20pt Arial", this._fontComponents = this.fontToComponents(t), this.updateFont(this._fontComponents)
            }
        }), Object.defineProperty(n.Text.prototype, "font", {
            get: function() {
                return this._fontComponents.fontFamily
            },
            set: function(t) {
                t = (t = t || "Arial").trim(), /^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(t) || /['",]/.exec(t) || (t = "'" + t + "'"), this._fontComponents.fontFamily = t, this.updateFont(this._fontComponents)
            }
        }), Object.defineProperty(n.Text.prototype, "fontSize", {
            get: function() {
                var t = this._fontComponents.fontSize;
                return t && /(?:^0$|px$)/.exec(t) ? parseInt(t, 10) : t
            },
            set: function(t) {
                "number" == typeof(t = t || "0") && (t += "px"), this._fontComponents.fontSize = t, this.updateFont(this._fontComponents)
            }
        }), Object.defineProperty(n.Text.prototype, "fontWeight", {
            get: function() {
                return this._fontComponents.fontWeight || "normal"
            },
            set: function(t) {
                t = t || "normal", this._fontComponents.fontWeight = t, this.updateFont(this._fontComponents)
            }
        }), Object.defineProperty(n.Text.prototype, "fontStyle", {
            get: function() {
                return this._fontComponents.fontStyle || "normal"
            },
            set: function(t) {
                t = t || "normal", this._fontComponents.fontStyle = t, this.updateFont(this._fontComponents)
            }
        }), Object.defineProperty(n.Text.prototype, "fontVariant", {
            get: function() {
                return this._fontComponents.fontVariant || "normal"
            },
            set: function(t) {
                t = t || "normal", this._fontComponents.fontVariant = t, this.updateFont(this._fontComponents)
            }
        }), Object.defineProperty(n.Text.prototype, "fill", {
            get: function() {
                return this.style.fill
            },
            set: function(t) {
                t !== this.style.fill && (this.style.fill = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "align", {
            get: function() {
                return this.style.align
            },
            set: function(t) {
                t !== this.style.align && (this.style.align = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "resolution", {
            get: function() {
                return this._res
            },
            set: function(t) {
                t !== this._res && (this._res = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "tabs", {
            get: function() {
                return this.style.tabs
            },
            set: function(t) {
                t !== this.style.tabs && (this.style.tabs = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "boundsAlignH", {
            get: function() {
                return this.style.boundsAlignH
            },
            set: function(t) {
                t !== this.style.boundsAlignH && (this.style.boundsAlignH = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "boundsAlignV", {
            get: function() {
                return this.style.boundsAlignV
            },
            set: function(t) {
                t !== this.style.boundsAlignV && (this.style.boundsAlignV = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "stroke", {
            get: function() {
                return this.style.stroke
            },
            set: function(t) {
                t !== this.style.stroke && (this.style.stroke = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "strokeThickness", {
            get: function() {
                return this.style.strokeThickness
            },
            set: function(t) {
                t !== this.style.strokeThickness && (this.style.strokeThickness = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "wordWrap", {
            get: function() {
                return this.style.wordWrap
            },
            set: function(t) {
                t !== this.style.wordWrap && (this.style.wordWrap = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "wordWrapWidth", {
            get: function() {
                return this.style.wordWrapWidth
            },
            set: function(t) {
                t !== this.style.wordWrapWidth && (this.style.wordWrapWidth = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "lineSpacing", {
            get: function() {
                return this._lineSpacing
            },
            set: function(t) {
                t !== this._lineSpacing && (this._lineSpacing = parseFloat(t), this.dirty = !0, this.parent && this.updateTransform())
            }
        }), Object.defineProperty(n.Text.prototype, "shadowOffsetX", {
            get: function() {
                return this.style.shadowOffsetX
            },
            set: function(t) {
                t !== this.style.shadowOffsetX && (this.style.shadowOffsetX = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "shadowOffsetY", {
            get: function() {
                return this.style.shadowOffsetY
            },
            set: function(t) {
                t !== this.style.shadowOffsetY && (this.style.shadowOffsetY = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "shadowColor", {
            get: function() {
                return this.style.shadowColor
            },
            set: function(t) {
                t !== this.style.shadowColor && (this.style.shadowColor = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "shadowBlur", {
            get: function() {
                return this.style.shadowBlur
            },
            set: function(t) {
                t !== this.style.shadowBlur && (this.style.shadowBlur = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "shadowStroke", {
            get: function() {
                return this.style.shadowStroke
            },
            set: function(t) {
                t !== this.style.shadowStroke && (this.style.shadowStroke = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "shadowFill", {
            get: function() {
                return this.style.shadowFill
            },
            set: function(t) {
                t !== this.style.shadowFill && (this.style.shadowFill = t, this.dirty = !0)
            }
        }), Object.defineProperty(n.Text.prototype, "width", {
            get: function() {
                return this.dirty && (this.updateText(), this.dirty = !1), this.scale.x * (this.texture.frame.width / this.resolution)
            },
            set: function(t) {
                this.scale.x = t / this.texture.frame.width, this._width = t
            }
        }), Object.defineProperty(n.Text.prototype, "height", {
            get: function() {
                return this.dirty && (this.updateText(), this.dirty = !1), this.scale.y * (this.texture.frame.height / this.resolution)
            },
            set: function(t) {
                this.scale.y = t / this.texture.frame.height, this._height = t
            }
        }), n.Text.fontPropertiesCache = {}, n.Text.fontPropertiesCanvas = document.createElement("canvas"), n.Text.fontPropertiesContext = n.Text.fontPropertiesCanvas.getContext("2d"), n.BitmapText = function(t, e, i, s, o, r, a) {
            e = e || 0, i = i || 0, s = s || "", o = o || "", r = r || 32, a = a || "left", PIXI.DisplayObjectContainer.call(this), this.type = n.BITMAPTEXT, this.physicsType = n.SPRITE, this.textWidth = 0, this.textHeight = 0, this.anchor = new n.Point, this._prevAnchor = new n.Point, this._glyphs = [], this._maxWidth = 0, this._text = o.toString() || "", this._data = t.cache.getBitmapFont(s), this._font = s, this._fontSize = r, this._align = a, this._tint = 16777215, this.updateText(), this.dirty = !1, n.Component.Core.init.call(this, t, e, i, "", null)
        }, n.BitmapText.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), n.BitmapText.prototype.constructor = n.BitmapText, n.Component.Core.install.call(n.BitmapText.prototype, ["Angle", "AutoCull", "Bounds", "Destroy", "FixedToCamera", "InputEnabled", "InWorld", "LifeSpan", "PhysicsBody", "Reset"]), n.BitmapText.prototype.preUpdatePhysics = n.Component.PhysicsBody.preUpdate, n.BitmapText.prototype.preUpdateLifeSpan = n.Component.LifeSpan.preUpdate, n.BitmapText.prototype.preUpdateInWorld = n.Component.InWorld.preUpdate, n.BitmapText.prototype.preUpdateCore = n.Component.Core.preUpdate, n.BitmapText.prototype.preUpdate = function() {
            return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore()
        }, n.BitmapText.prototype.postUpdate = function() {
            n.Component.PhysicsBody.postUpdate.call(this), n.Component.FixedToCamera.postUpdate.call(this), this.body && this.body.type === n.Physics.ARCADE && (this.textWidth === this.body.sourceWidth && this.textHeight === this.body.sourceHeight || this.body.setSize(this.textWidth, this.textHeight))
        }, n.BitmapText.prototype.setText = function(t) {
            this.text = t
        }, n.BitmapText.prototype.scanLine = function(t, e, i) {
            for (var s = 0, n = 0, o = -1, r = 0, a = null, h = this._maxWidth > 0 ? this._maxWidth : null, l = [], c = 0; c < i.length; c++) {
                var u = c === i.length - 1;
                if (/(?:\r\n|\r|\n)/.test(i.charAt(c))) return {
                    width: n,
                    text: i.substr(0, c),
                    end: u,
                    chars: l
                };
                var d, p = i.charCodeAt(c),
                    f = t.chars[p];
                void 0 === f && (p = 32, f = t.chars[p]);
                var m = a && f.kerning[a] ? f.kerning[a] : 0;
                if (/(\s)/.test(i.charAt(c)) && (o = c, r = n), d = (m + f.texture.width + f.xOffset) * e, h && n + d >= h && o > -1) return {
                    width: r || n,
                    text: i.substr(0, c - (c - o)),
                    end: u,
                    chars: l
                };
                n += (f.xAdvance + m) * e, l.push(s + (f.xOffset + m) * e), s += (f.xAdvance + m) * e, a = p
            }
            return {
                width: n,
                text: i,
                end: u,
                chars: l
            }
        }, n.BitmapText.prototype.cleanText = function(t, e) {
            void 0 === e && (e = "");
            var i = this._data.font;
            if (!i) return "";
            for (var s = t.replace(/\r\n|\n\r|\n|\r/g, "\n").split("\n"), n = 0; n < s.length; n++) {
                for (var o = "", r = s[n], a = 0; a < r.length; a++) o = i.chars[r.charCodeAt(a)] ? o.concat(r[a]) : o.concat(e);
                s[n] = o
            }
            return s.join("\n")
        }, n.BitmapText.prototype.updateText = function() {
            var t = this._data.font;
            if (t) {
                var e = this.text,
                    i = this._fontSize / t.size,
                    s = [],
                    n = 0;
                this.textWidth = 0;
                do {
                    (c = this.scanLine(t, i, e)).y = n, s.push(c), c.width > this.textWidth && (this.textWidth = c.width), n += t.lineHeight * i, e = e.substr(c.text.length + 1)
                } while (!1 === c.end);
                this.textHeight = n;
                for (var o = 0, r = 0, a = this.textWidth * this.anchor.x, h = this.textHeight * this.anchor.y, l = 0; l < s.length; l++) {
                    var c = s[l];
                    "right" === this._align ? r = this.textWidth - c.width : "center" === this._align && (r = (this.textWidth - c.width) / 2);
                    for (var u = 0; u < c.text.length; u++) {
                        var d = c.text.charCodeAt(u),
                            p = t.chars[d];
                        void 0 === p && (d = 32, p = t.chars[d]);
                        var f = this._glyphs[o];
                        f ? f.texture = p.texture : ((f = new PIXI.Sprite(p.texture)).name = c.text[u], this._glyphs.push(f)), f.position.x = c.chars[u] + r - a, f.position.y = c.y + p.yOffset * i - h, f.scale.set(i), f.tint = this.tint, f.texture.requiresReTint = !0, f.parent || this.addChild(f), o++
                    }
                }
                for (l = o; l < this._glyphs.length; l++) this.removeChild(this._glyphs[l])
            }
        }, n.BitmapText.prototype.purgeGlyphs = function() {
            for (var t = this._glyphs.length, e = [], i = 0; i < this._glyphs.length; i++) this._glyphs[i].parent !== this ? this._glyphs[i].destroy() : e.push(this._glyphs[i]);
            return this._glyphs = [], this._glyphs = e, this.updateText(), t - e.length
        }, n.BitmapText.prototype.updateTransform = function() {
            !this.dirty && this.anchor.equals(this._prevAnchor) || (this.updateText(), this.dirty = !1, this._prevAnchor.copyFrom(this.anchor)), PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)
        }, Object.defineProperty(n.BitmapText.prototype, "align", {
            get: function() {
                return this._align
            },
            set: function(t) {
                t === this._align || "left" !== t && "center" !== t && "right" !== t || (this._align = t, this.updateText())
            }
        }), Object.defineProperty(n.BitmapText.prototype, "tint", {
            get: function() {
                return this._tint
            },
            set: function(t) {
                t !== this._tint && (this._tint = t, this.updateText())
            }
        }), Object.defineProperty(n.BitmapText.prototype, "font", {
            get: function() {
                return this._font
            },
            set: function(t) {
                t !== this._font && (this._font = t.trim(), this._data = this.game.cache.getBitmapFont(this._font), this.updateText())
            }
        }), Object.defineProperty(n.BitmapText.prototype, "fontSize", {
            get: function() {
                return this._fontSize
            },
            set: function(t) {
                (t = parseInt(t, 10)) !== this._fontSize && t > 0 && (this._fontSize = t, this.updateText())
            }
        }), Object.defineProperty(n.BitmapText.prototype, "text", {
            get: function() {
                return this._text
            },
            set: function(t) {
                t !== this._text && (this._text = t.toString() || "", this.updateText())
            }
        }), Object.defineProperty(n.BitmapText.prototype, "maxWidth", {
            get: function() {
                return this._maxWidth
            },
            set: function(t) {
                t !== this._maxWidth && (this._maxWidth = t, this.updateText())
            }
        }), Object.defineProperty(n.BitmapText.prototype, "smoothed", {
            get: function() {
                return !this._data.base.scaleMode
            },
            set: function(t) {
                this._data.base.scaleMode = t ? 0 : 1
            }
        }), n.RetroFont = function(t, e, i, s, o, r, a, h, l, c) {
            if (!t.cache.checkImageKey(e)) return !1;
            null != r || (r = t.cache.getImage(e).width / i), this.characterWidth = i, this.characterHeight = s, this.characterSpacingX = a || 0, this.characterSpacingY = h || 0, this.characterPerRow = r, this.offsetX = l || 0, this.offsetY = c || 0, this.align = "left", this.multiLine = !1, this.autoUpperCase = !0, this.customSpacingX = 0, this.customSpacingY = 0, this.fixedWidth = 0, this.fontSet = t.cache.getImage(e), this._text = "", this.grabData = [], this.frameData = new n.FrameData;
            for (var u = this.offsetX, d = this.offsetY, p = 0, f = 0; f < o.length; f++) {
                var m = this.frameData.addFrame(new n.Frame(f, u, d, this.characterWidth, this.characterHeight));
                this.grabData[o.charCodeAt(f)] = m.index, ++p === this.characterPerRow ? (p = 0, u = this.offsetX, d += this.characterHeight + this.characterSpacingY) : u += this.characterWidth + this.characterSpacingX
            }
            t.cache.updateFrameData(e, this.frameData), this.stamp = new n.Image(t, 0, 0, e, 0), n.RenderTexture.call(this, t, 100, 100, "", n.scaleModes.NEAREST), this.type = n.RETROFONT
        }, n.RetroFont.prototype = Object.create(n.RenderTexture.prototype), n.RetroFont.prototype.constructor = n.RetroFont, n.RetroFont.ALIGN_LEFT = "left", n.RetroFont.ALIGN_RIGHT = "right", n.RetroFont.ALIGN_CENTER = "center", n.RetroFont.TEXT_SET1 = " !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~", n.RetroFont.TEXT_SET2 = " !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ", n.RetroFont.TEXT_SET3 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ", n.RetroFont.TEXT_SET4 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789", n.RetroFont.TEXT_SET5 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789", n.RetroFont.TEXT_SET6 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ", n.RetroFont.TEXT_SET7 = "AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39", n.RetroFont.TEXT_SET8 = "0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ", n.RetroFont.TEXT_SET9 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!", n.RetroFont.TEXT_SET10 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ", n.RetroFont.TEXT_SET11 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789", n.RetroFont.prototype.setFixedWidth = function(t, e) {
            void 0 === e && (e = "left"), this.fixedWidth = t, this.align = e
        }, n.RetroFont.prototype.setText = function(t, e, i, s, n, o) {
            this.multiLine = e || !1, this.customSpacingX = i || 0, this.customSpacingY = s || 0, this.align = n || "left", this.autoUpperCase = !o, t.length > 0 && (this.text = t)
        }, n.RetroFont.prototype.buildRetroFontText = function() {
            var t = 0,
                e = 0;
            if (this.clear(), this.multiLine) {
                var i = this._text.split("\n");
                this.fixedWidth > 0 ? this.resize(this.fixedWidth, i.length * (this.characterHeight + this.customSpacingY) - this.customSpacingY, !0) : this.resize(this.getLongestLine() * (this.characterWidth + this.customSpacingX), i.length * (this.characterHeight + this.customSpacingY) - this.customSpacingY, !0);
                for (var s = 0; s < i.length; s++) t = 0, this.align === n.RetroFont.ALIGN_RIGHT ? t = this.width - i[s].length * (this.characterWidth + this.customSpacingX) : this.align === n.RetroFont.ALIGN_CENTER && (t = this.width / 2 - i[s].length * (this.characterWidth + this.customSpacingX) / 2, t += this.customSpacingX / 2), t < 0 && (t = 0), this.pasteLine(i[s], t, e, this.customSpacingX), e += this.characterHeight + this.customSpacingY
            } else this.fixedWidth > 0 ? this.resize(this.fixedWidth, this.characterHeight, !0) : this.resize(this._text.length * (this.characterWidth + this.customSpacingX), this.characterHeight, !0), t = 0, this.align === n.RetroFont.ALIGN_RIGHT ? t = this.width - this._text.length * (this.characterWidth + this.customSpacingX) : this.align === n.RetroFont.ALIGN_CENTER && (t = this.width / 2 - this._text.length * (this.characterWidth + this.customSpacingX) / 2, t += this.customSpacingX / 2), t < 0 && (t = 0), this.pasteLine(this._text, t, 0, this.customSpacingX);
            this.requiresReTint = !0
        }, n.RetroFont.prototype.pasteLine = function(t, e, i, s) {
            for (var n = 0; n < t.length; n++)
                if (" " === t.charAt(n)) e += this.characterWidth + s;
                else if (this.grabData[t.charCodeAt(n)] >= 0 && (this.stamp.frame = this.grabData[t.charCodeAt(n)], this.renderXY(this.stamp, e, i, !1), (e += this.characterWidth + s) > this.width)) break
        }, n.RetroFont.prototype.getLongestLine = function() {
            var t = 0;
            if (this._text.length > 0)
                for (var e = this._text.split("\n"), i = 0; i < e.length; i++) e[i].length > t && (t = e[i].length);
            return t
        }, n.RetroFont.prototype.removeUnsupportedCharacters = function(t) {
            for (var e = "", i = 0; i < this._text.length; i++) {
                var s = this._text[i],
                    n = s.charCodeAt(0);
                (this.grabData[n] >= 0 || !t && "\n" === s) && (e = e.concat(s))
            }
            return e
        }, n.RetroFont.prototype.updateOffset = function(t, e) {
            if (this.offsetX !== t || this.offsetY !== e) {
                for (var i = t - this.offsetX, s = e - this.offsetY, n = this.game.cache.getFrameData(this.stamp.key).getFrames(), o = n.length; o--;) n[o].x += i, n[o].y += s;
                this.buildRetroFontText()
            }
        }, Object.defineProperty(n.RetroFont.prototype, "text", {
            get: function() {
                return this._text
            },
            set: function(t) {
                var e;
                (e = this.autoUpperCase ? t.toUpperCase() : t) !== this._text && (this._text = e, this.removeUnsupportedCharacters(this.multiLine), this.buildRetroFontText())
            }
        }), Object.defineProperty(n.RetroFont.prototype, "smoothed", {
            get: function() {
                return this.stamp.smoothed
            },
            set: function(t) {
                this.stamp.smoothed = t, this.buildRetroFontText()
            }
        }), n.Rope = function(t, e, i, s, o, r) {
            this.points = [], this.points = r, this._hasUpdateAnimation = !1, this._updateAnimationCallback = null, e = e || 0, i = i || 0, s = s || null, o = o || null, this.type = n.ROPE, this.points = r, PIXI.DisplayObjectContainer.call(this), this.texture = n.Cache.DEFAULT, this.uvs = new Float32Array([0, 1, 1, 1, 1, 0, 0, 1]), this.vertices = new Float32Array([0, 0, 100, 0, 100, 100, 0, 100]), this.colors = new Float32Array([1, 1, 1, 1]), this.indices = new Uint16Array([0, 1, 2, 3]), r && (this.vertices = new Float32Array(4 * r.length), this.uvs = new Float32Array(4 * r.length), this.colors = new Float32Array(2 * r.length), this.indices = new Uint16Array(2 * r.length)), this.dirty = !0, this.canvasPadding = 0, this.drawMode = n.Rope.TRIANGLE_STRIP, n.Component.Core.init.call(this, t, e, i, s, o), this.refresh()
        }, n.Rope.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), n.Rope.prototype.constructor = n.Rope, n.Component.Core.install.call(n.Rope.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Delta", "Destroy", "FixedToCamera", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "ScaleMinMax", "Smoothed"]), n.Rope.prototype.preUpdatePhysics = n.Component.PhysicsBody.preUpdate, n.Rope.prototype.preUpdateLifeSpan = n.Component.LifeSpan.preUpdate, n.Rope.prototype.preUpdateInWorld = n.Component.InWorld.preUpdate, n.Rope.prototype.preUpdateCore = n.Component.Core.preUpdate, n.Rope.TRIANGLE_STRIP = 0, n.Rope.TRIANGLES = 1, n.Rope.prototype.preUpdate = function() {
            return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore()
        }, n.Rope.prototype.update = function() {
            this._hasUpdateAnimation && this.updateAnimation.call(this)
        }, n.Rope.prototype.reset = function(t, e) {
            return n.Component.Reset.prototype.reset.call(this, t, e), this
        }, n.Rope.prototype.refresh = function() {
            var t = this.points;
            if (!(t.length < 1)) {
                var e = this.uvs,
                    i = this.indices,
                    s = this.colors;
                this.count -= .2, e[0] = 0, e[1] = 0, e[2] = 0, e[3] = 1, s[0] = 1, s[1] = 1, i[0] = 0, i[1] = 1;
                for (var n, o, r = t.length, a = 1; a < r; a++) o = a / (r - 1), e[n = 4 * a] = o, e[n + 1] = 0, e[n + 2] = o, e[n + 3] = 1, s[n = 2 * a] = 1, s[n + 1] = 1, i[n = 2 * a] = n, i[n + 1] = n + 1
            }
        }, n.Rope.prototype.updateTransform = function() {
            var t = this.points;
            if (!(t.length < 1)) {
                var e, i = t[0],
                    s = {
                        x: 0,
                        y: 0
                    };
                this.count -= .2;
                for (var n, o, r, a, h = this.vertices, l = t.length, c = 0; c < l; c++) n = t[c], o = 4 * c, e = c < t.length - 1 ? t[c + 1] : n, s.y = -(e.x - i.x), s.x = e.y - i.y, 10 * (1 - c / (l - 1)) > 1 && 1, r = Math.sqrt(s.x * s.x + s.y * s.y), a = this.texture.height / 2, s.x /= r, s.y /= r, s.x *= a, s.y *= a, h[o] = n.x + s.x, h[o + 1] = n.y + s.y, h[o + 2] = n.x - s.x, h[o + 3] = n.y - s.y, i = n;
                PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)
            }
        }, n.Rope.prototype.setTexture = function(t) {
            this.texture = t
        }, n.Rope.prototype._renderWebGL = function(t) {
            !this.visible || this.alpha <= 0 || (t.spriteBatch.stop(), this._vertexBuffer || this._initWebGL(t), t.shaderManager.setShader(t.shaderManager.stripShader), this._renderStrip(t), t.spriteBatch.start())
        }, n.Rope.prototype._initWebGL = function(t) {
            var e = t.gl;
            this._vertexBuffer = e.createBuffer(), this._indexBuffer = e.createBuffer(), this._uvBuffer = e.createBuffer(), this._colorBuffer = e.createBuffer(), e.bindBuffer(e.ARRAY_BUFFER, this._vertexBuffer), e.bufferData(e.ARRAY_BUFFER, this.vertices, e.DYNAMIC_DRAW), e.bindBuffer(e.ARRAY_BUFFER, this._uvBuffer), e.bufferData(e.ARRAY_BUFFER, this.uvs, e.STATIC_DRAW), e.bindBuffer(e.ARRAY_BUFFER, this._colorBuffer), e.bufferData(e.ARRAY_BUFFER, this.colors, e.STATIC_DRAW), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this._indexBuffer), e.bufferData(e.ELEMENT_ARRAY_BUFFER, this.indices, e.STATIC_DRAW)
        }, n.Rope.prototype._renderStrip = function(t) {
            var e = t.gl,
                i = t.projection,
                s = t.offset,
                o = t.shaderManager.stripShader,
                r = this.drawMode === n.Rope.TRIANGLE_STRIP ? e.TRIANGLE_STRIP : e.TRIANGLES;
            t.blendModeManager.setBlendMode(this.blendMode), e.uniformMatrix3fv(o.translationMatrix, !1, this.worldTransform.toArray(!0)), e.uniform2f(o.projectionVector, i.x, -i.y), e.uniform2f(o.offsetVector, -s.x, -s.y), e.uniform1f(o.alpha, this.worldAlpha), this.dirty ? (this.dirty = !1, e.bindBuffer(e.ARRAY_BUFFER, this._vertexBuffer), e.bufferData(e.ARRAY_BUFFER, this.vertices, e.STATIC_DRAW), e.vertexAttribPointer(o.aVertexPosition, 2, e.FLOAT, !1, 0, 0), e.bindBuffer(e.ARRAY_BUFFER, this._uvBuffer), e.bufferData(e.ARRAY_BUFFER, this.uvs, e.STATIC_DRAW), e.vertexAttribPointer(o.aTextureCoord, 2, e.FLOAT, !1, 0, 0), e.activeTexture(e.TEXTURE0), this.texture.baseTexture._dirty[e.id] ? t.renderer.updateTexture(this.texture.baseTexture) : e.bindTexture(e.TEXTURE_2D, this.texture.baseTexture._glTextures[e.id]), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this._indexBuffer), e.bufferData(e.ELEMENT_ARRAY_BUFFER, this.indices, e.STATIC_DRAW)) : (e.bindBuffer(e.ARRAY_BUFFER, this._vertexBuffer), e.bufferSubData(e.ARRAY_BUFFER, 0, this.vertices), e.vertexAttribPointer(o.aVertexPosition, 2, e.FLOAT, !1, 0, 0), e.bindBuffer(e.ARRAY_BUFFER, this._uvBuffer), e.vertexAttribPointer(o.aTextureCoord, 2, e.FLOAT, !1, 0, 0), e.activeTexture(e.TEXTURE0), this.texture.baseTexture._dirty[e.id] ? t.renderer.updateTexture(this.texture.baseTexture) : e.bindTexture(e.TEXTURE_2D, this.texture.baseTexture._glTextures[e.id]), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this._indexBuffer)), e.drawElements(r, this.indices.length, e.UNSIGNED_SHORT, 0)
        }, n.Rope.prototype._renderCanvas = function(t) {
            var e = t.context,
                i = this.worldTransform,
                s = i.tx * t.resolution + t.shakeX,
                o = i.ty * t.resolution + t.shakeY;
            t.roundPixels ? e.setTransform(i.a, i.b, i.c, i.d, 0 | s, 0 | o) : e.setTransform(i.a, i.b, i.c, i.d, s, o), this.drawMode === n.Rope.TRIANGLE_STRIP ? this._renderCanvasTriangleStrip(e) : this._renderCanvasTriangles(e)
        }, n.Rope.prototype._renderCanvasTriangleStrip = function(t) {
            var e = this.vertices,
                i = this.uvs,
                s = e.length / 2;
            this.count++;
            for (var n = 0; n < s - 2; n++) {
                var o = 2 * n;
                this._renderCanvasDrawTriangle(t, e, i, o, o + 2, o + 4)
            }
        }, n.Rope.prototype._renderCanvasTriangles = function(t) {
            var e = this.vertices,
                i = this.uvs,
                s = this.indices,
                n = s.length;
            this.count++;
            for (var o = 0; o < n; o += 3) {
                var r = 2 * s[o],
                    a = 2 * s[o + 1],
                    h = 2 * s[o + 2];
                this._renderCanvasDrawTriangle(t, e, i, r, a, h)
            }
        }, n.Rope.prototype._renderCanvasDrawTriangle = function(t, e, i, s, n, o) {
            var r = this.texture.baseTexture.source,
                a = this.texture.width,
                h = this.texture.height,
                l = e[s],
                c = e[n],
                u = e[o],
                d = e[s + 1],
                p = e[n + 1],
                f = e[o + 1],
                m = i[s] * a,
                g = i[n] * a,
                y = i[o] * a,
                v = i[s + 1] * h,
                b = i[n + 1] * h,
                _ = i[o + 1] * h;
            if (this.canvasPadding > 0) {
                var w = this.canvasPadding / this.worldTransform.a,
                    x = this.canvasPadding / this.worldTransform.d,
                    P = (l + c + u) / 3,
                    T = (d + p + f) / 3,
                    C = l - P,
                    S = d - T,
                    A = Math.sqrt(C * C + S * S);
                l = P + C / A * (A + w), d = T + S / A * (A + x), S = p - T, c = P + (C = c - P) / (A = Math.sqrt(C * C + S * S)) * (A + w), p = T + S / A * (A + x), S = f - T, u = P + (C = u - P) / (A = Math.sqrt(C * C + S * S)) * (A + w), f = T + S / A * (A + x)
            }
            t.save(), t.beginPath(), t.moveTo(l, d), t.lineTo(c, p), t.lineTo(u, f), t.closePath(), t.clip();
            var E = m * b + v * y + g * _ - b * y - v * g - m * _,
                k = l * b + v * u + c * _ - b * u - v * c - l * _,
                M = m * c + l * y + g * u - c * y - l * g - m * u,
                O = m * b * u + v * c * y + l * g * _ - l * b * y - v * g * u - m * c * _,
                R = d * b + v * f + p * _ - b * f - v * p - d * _,
                B = m * p + d * y + g * f - p * y - d * g - m * f,
                I = m * b * f + v * p * y + d * g * _ - d * b * y - v * g * f - m * p * _;
            t.transform(k / E, R / E, M / E, B / E, O / E, I / E), t.drawImage(r, 0, 0), t.restore()
        }, n.Rope.prototype.renderStripFlat = function(t) {
            var e = this.context,
                i = t.vertices,
                s = i.length / 2;
            this.count++, e.beginPath();
            for (var n = 1; n < s - 2; n++) {
                var o = 2 * n,
                    r = i[o],
                    a = i[o + 2],
                    h = i[o + 4],
                    l = i[o + 1],
                    c = i[o + 3],
                    u = i[o + 5];
                e.moveTo(r, l), e.lineTo(a, c), e.lineTo(h, u)
            }
            e.fillStyle = "#FF0000", e.fill(), e.closePath()
        }, n.Rope.prototype.getBounds = function(t) {
            for (var e = t || this.worldTransform, i = e.a, s = e.b, n = e.c, o = e.d, r = e.tx, a = e.ty, h = -1 / 0, l = -1 / 0, c = 1 / 0, u = 1 / 0, d = this.vertices, p = 0; p < d.length; p += 2) {
                var f = d[p],
                    m = d[p + 1],
                    g = i * f + n * m + r,
                    y = o * m + s * f + a;
                c = g < c ? g : c, u = y < u ? y : u, h = g > h ? g : h, l = y > l ? y : l
            }
            if (c === -1 / 0 || l === 1 / 0) return PIXI.EmptyRectangle;
            var v = this._bounds;
            return v.x = c, v.width = h - c, v.y = u, v.height = l - u, this._currentBounds = v, v
        }, Object.defineProperty(n.Rope.prototype, "updateAnimation", {
            get: function() {
                return this._updateAnimation
            },
            set: function(t) {
                t && "function" == typeof t ? (this._hasUpdateAnimation = !0, this._updateAnimation = t) : (this._hasUpdateAnimation = !1, this._updateAnimation = null)
            }
        }), Object.defineProperty(n.Rope.prototype, "segments", {
            get: function() {
                for (var t, e, i, s, o, r, a, h, l = [], c = 0; c < this.points.length; c++) t = 4 * c, e = this.vertices[t] * this.scale.x, i = this.vertices[t + 1] * this.scale.y, s = this.vertices[t + 4] * this.scale.x, o = this.vertices[t + 3] * this.scale.y, r = n.Math.difference(e, s), a = n.Math.difference(i, o), e += this.world.x, i += this.world.y, h = new n.Rectangle(e, i, r, a), l.push(h);
                return l
            }
        }), n.TileSprite = function(t, e, i, s, o, r, a) {
            e = e || 0, i = i || 0, s = s || 256, o = o || 256, r = r || null, a = a || null;
            var h = t.cache.getImage("__default", !0);
            PIXI.Sprite.call(this, new PIXI.Texture(h.base), s, o), this.type = n.TILESPRITE, this.physicsType = n.SPRITE, this._scroll = new n.Point, this.tileScale = new n.Point(1, 1), this.tileScaleOffset = new n.Point(1, 1), this.tilePosition = new n.Point, this.textureDebug = !1, this.canvasBuffer = null, this.tilingTexture = null, this.tilePattern = null, this.refreshTexture = !0, this.frameWidth = 0, this.frameHeight = 0, this._width = s, this._height = o, n.Component.Core.init.call(this, t, e, i, r, a)
        }, n.TileSprite.prototype = Object.create(PIXI.Sprite.prototype), n.TileSprite.prototype.constructor = n.TileSprite, n.Component.Core.install.call(n.TileSprite.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Destroy", "FixedToCamera", "Health", "InCamera", "InputEnabled", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "Smoothed"]), n.TileSprite.prototype.preUpdatePhysics = n.Component.PhysicsBody.preUpdate, n.TileSprite.prototype.preUpdateLifeSpan = n.Component.LifeSpan.preUpdate, n.TileSprite.prototype.preUpdateInWorld = n.Component.InWorld.preUpdate, n.TileSprite.prototype.preUpdateCore = n.Component.Core.preUpdate, n.TileSprite.prototype.preUpdate = function() {
            return 0 !== this._scroll.x && (this.tilePosition.x += this._scroll.x * this.game.time.physicsElapsed), 0 !== this._scroll.y && (this.tilePosition.y += this._scroll.y * this.game.time.physicsElapsed), !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore()
        }, n.TileSprite.prototype.autoScroll = function(t, e) {
            return this._scroll.set(t, e), this
        }, n.TileSprite.prototype.stopScroll = function() {
            return this._scroll.set(0, 0), this
        }, n.TileSprite.prototype.destroy = function(t) {
            n.Component.Destroy.prototype.destroy.call(this, t), PIXI.Sprite.prototype.destroy.call(this), this.canvasBuffer && (this.canvasBuffer.destroy(), this.canvasBuffer = null), this.tileScale = null, this.tileScaleOffset = null, this.tilePosition = null, this.tilingTexture && (this.tilingTexture.destroy(!0), this.tilingTexture = null)
        }, n.TileSprite.prototype.reset = function(t, e) {
            return n.Component.Reset.prototype.reset.call(this, t, e), this.tilePosition.x = 0, this.tilePosition.y = 0, this
        }, n.TileSprite.prototype.setTexture = function(t) {
            return this.texture !== t && (this.texture = t, this.refreshTexture = !0, this.cachedTint = 16777215), this
        }, n.TileSprite.prototype._renderWebGL = function(t) {
            if (this.visible && this.renderable && 0 !== this.alpha) {
                if (this._mask && (t.spriteBatch.stop(), t.maskManager.pushMask(this.mask, t), t.spriteBatch.start()), this._filters && (t.spriteBatch.flush(), t.filterManager.pushFilter(this._filterBlock)), this.refreshTexture) {
                    if (this.generateTilingTexture(!0, t), !this.tilingTexture) return;
                    this.tilingTexture.needsUpdate && (this.tilingTexture.baseTexture.textureIndex = this.texture.baseTexture.textureIndex, t.renderer.updateTexture(this.tilingTexture.baseTexture), this.tilingTexture.needsUpdate = !1)
                }
                t.spriteBatch.renderTilingSprite(this);
                for (var e = 0; e < this.children.length; e++) this.children[e]._renderWebGL(t);
                var i = !1;
                this._filters && (i = !0, t.spriteBatch.stop(), t.filterManager.popFilter()), this._mask && (i || t.spriteBatch.stop(), t.maskManager.popMask(this._mask, t)), i && t.spriteBatch.start()
            }
        }, n.TileSprite.prototype._renderCanvas = function(t) {
            if (this.visible && this.renderable && 0 !== this.alpha) {
                var e = t.context;
                this._mask && t.maskManager.pushMask(this._mask, t), e.globalAlpha = this.worldAlpha;
                var i = this.worldTransform,
                    s = t.resolution,
                    n = i.tx * s + t.shakeX,
                    o = i.ty * s + t.shakeY;
                if (e.setTransform(i.a * s, i.b * s, i.c * s, i.d * s, n, o), this.refreshTexture) {
                    if (this.generateTilingTexture(!1, t), !this.tilingTexture) return;
                    this.tilePattern = e.createPattern(this.tilingTexture.baseTexture.source, "repeat")
                }
                var r = t.currentBlendMode;
                this.blendMode !== t.currentBlendMode && (t.currentBlendMode = this.blendMode, e.globalCompositeOperation = PIXI.blendModesCanvas[t.currentBlendMode]);
                var a = this.tilePosition,
                    h = this.tileScale;
                a.x %= this.tilingTexture.baseTexture.width, a.y %= this.tilingTexture.baseTexture.height, e.scale(h.x, h.y), e.translate(a.x + this.anchor.x * -this._width, a.y + this.anchor.y * -this._height), e.fillStyle = this.tilePattern, n = -a.x, o = -a.y;
                var l = this._width / h.x,
                    c = this._height / h.y;
                t.roundPixels && (n |= 0, o |= 0, l |= 0, c |= 0), e.fillRect(n, o, l, c), e.scale(1 / h.x, 1 / h.y), e.translate(-a.x + this.anchor.x * this._width, -a.y + this.anchor.y * this._height), this._mask && t.maskManager.popMask(t);
                for (var u = 0; u < this.children.length; u++) this.children[u]._renderCanvas(t);
                r !== this.blendMode && (t.currentBlendMode = r, e.globalCompositeOperation = PIXI.blendModesCanvas[r])
            }
        }, n.TileSprite.prototype.onTextureUpdate = function() {}, n.TileSprite.prototype.generateTilingTexture = function(t) {
            if (this.texture.baseTexture.hasLoaded) {
                var e = this.texture,
                    i = e.frame,
                    s = this._frame.sourceSizeW || this._frame.width,
                    o = this._frame.sourceSizeH || this._frame.height,
                    r = 0,
                    a = 0;
                this._frame.trimmed && (r = this._frame.spriteSourceSizeX, a = this._frame.spriteSourceSizeY), t && (s = n.Math.getNextPowerOfTwo(s), o = n.Math.getNextPowerOfTwo(o)), this.canvasBuffer ? (this.canvasBuffer.resize(s, o), this.tilingTexture.baseTexture.width = s, this.tilingTexture.baseTexture.height = o, this.tilingTexture.needsUpdate = !0) : (this.canvasBuffer = new PIXI.CanvasBuffer(s, o), this.tilingTexture = PIXI.Texture.fromCanvas(this.canvasBuffer.canvas), this.tilingTexture.isTiling = !0, this.tilingTexture.needsUpdate = !0), this.textureDebug && (this.canvasBuffer.context.strokeStyle = "#00ff00", this.canvasBuffer.context.strokeRect(0, 0, s, o));
                var h = e.crop.width,
                    l = e.crop.height;
                h === s && l === o || (h = s, l = o), this.canvasBuffer.context.drawImage(e.baseTexture.source, e.crop.x, e.crop.y, e.crop.width, e.crop.height, r, a, h, l), this.tileScaleOffset.x = i.width / s, this.tileScaleOffset.y = i.height / o, this.refreshTexture = !1, this.tilingTexture.baseTexture._powerOf2 = !0
            }
        }, n.TileSprite.prototype.getBounds = function() {
            var t = this._width,
                e = this._height,
                i = t * (1 - this.anchor.x),
                s = t * -this.anchor.x,
                n = e * (1 - this.anchor.y),
                o = e * -this.anchor.y,
                r = this.worldTransform,
                a = r.a,
                h = r.b,
                l = r.c,
                c = r.d,
                u = r.tx,
                d = r.ty,
                p = a * s + l * o + u,
                f = c * o + h * s + d,
                m = a * i + l * o + u,
                g = c * o + h * i + d,
                y = a * i + l * n + u,
                v = c * n + h * i + d,
                b = a * s + l * n + u,
                _ = c * n + h * s + d,
                w = -1 / 0,
                x = -1 / 0,
                P = 1 / 0,
                T = 1 / 0;
            P = b < (P = y < (P = m < (P = p < P ? p : P) ? m : P) ? y : P) ? b : P, T = _ < (T = v < (T = g < (T = f < T ? f : T) ? g : T) ? v : T) ? _ : T, w = b > (w = y > (w = m > (w = p > w ? p : w) ? m : w) ? y : w) ? b : w, x = _ > (x = v > (x = g > (x = f > x ? f : x) ? g : x) ? v : x) ? _ : x;
            var C = this._bounds;
            return C.x = P, C.width = w - P, C.y = T, C.height = x - T, this._currentBounds = C, C
        }, Object.defineProperty(n.TileSprite.prototype, "width", {
            get: function() {
                return this._width
            },
            set: function(t) {
                this._width = t
            }
        }), Object.defineProperty(n.TileSprite.prototype, "height", {
            get: function() {
                return this._height
            },
            set: function(t) {
                this._height = t
            }
        }), n.CanvasPool = {
            create: function(t, e, i) {
                var s, o = n.CanvasPool.getFirst();
                if (-1 === o) {
                    var r = {
                        parent: t,
                        canvas: document.createElement("canvas")
                    };
                    n.CanvasPool.pool.push(r), s = r.canvas
                } else n.CanvasPool.pool[o].parent = t, s = n.CanvasPool.pool[o].canvas;
                return void 0 !== e && (s.width = e, s.height = i), s
            },
            getFirst: function() {
                for (var t = n.CanvasPool.pool, e = 0; e < t.length; e++)
                    if (!t[e].parent) return e;
                return -1
            },
            remove: function(t) {
                for (var e = n.CanvasPool.pool, i = 0; i < e.length; i++) e[i].parent === t && (e[i].parent = null, e[i].canvas.width = 1, e[i].canvas.height = 1)
            },
            removeByCanvas: function(t) {
                for (var e = n.CanvasPool.pool, i = 0; i < e.length; i++) e[i].canvas === t && (e[i].parent = null, e[i].canvas.width = 1, e[i].canvas.height = 1)
            },
            getTotal: function() {
                for (var t = n.CanvasPool.pool, e = 0, i = 0; i < t.length; i++) t[i].parent && e++;
                return e
            },
            getFree: function() {
                for (var t = n.CanvasPool.pool, e = 0, i = 0; i < t.length; i++) t[i].parent || e++;
                return e
            }
        }, n.CanvasPool.pool = [], n.Device = function() {
            this.deviceReadyAt = 0, this.initialized = !1, this.desktop = !1, this.iOS = !1, this.iOSVersion = 0, this.cocoonJS = !1, this.cocoonJSApp = !1, this.cordova = !1, this.node = !1, this.nodeWebkit = !1, this.electron = !1, this.ejecta = !1, this.crosswalk = !1, this.android = !1, this.chromeOS = !1, this.linux = !1, this.macOS = !1, this.windows = !1, this.windowsPhone = !1, this.canvas = !1, this.canvasBitBltShift = null, this.canHandleAlpha = !1, this.canUseMultiply = !1, this.webGL = !1, this.file = !1, this.fileSystem = !1, this.localStorage = !1, this.worker = !1, this.css3D = !1, this.pointerLock = !1, this.typedArray = !1, this.vibration = !1, this.getUserMedia = !0, this.quirksMode = !1, this.touch = !1, this.mspointer = !1, this.wheelEvent = null, this.arora = !1, this.chrome = !1, this.chromeVersion = 0, this.epiphany = !1, this.firefox = !1, this.firefoxVersion = 0, this.ie = !1, this.ieVersion = 0, this.trident = !1, this.tridentVersion = 0, this.edge = !1, this.mobileSafari = !1, this.midori = !1, this.opera = !1, this.safari = !1, this.safariVersion = 0, this.webApp = !1, this.silk = !1, this.audioData = !1, this.webAudio = !1, this.ogg = !1, this.opus = !1, this.mp3 = !1, this.wav = !1, this.m4a = !1, this.webm = !1, this.dolby = !1, this.oggVideo = !1, this.h264Video = !1, this.mp4Video = !1, this.webmVideo = !1, this.vp9Video = !1, this.hlsVideo = !1, this.iPhone = !1, this.iPhone4 = !1, this.iPad = !1, this.pixelRatio = 0, this.littleEndian = !1, this.LITTLE_ENDIAN = !1, this.support32bit = !1, this.fullscreen = !1, this.requestFullscreen = "", this.cancelFullscreen = "", this.fullscreenKeyboard = !1
        }, n.Device = new n.Device, n.Device.onInitialized = new n.Signal, n.Device.whenReady = function(t, e, i) {
            var s = this._readyCheck;
            if (this.deviceReadyAt || !s) t.call(e, this);
            else if (s._monitor || i) s._queue = s._queue || [], s._queue.push([t, e]);
            else {
                s._monitor = s.bind(this), s._queue = s._queue || [], s._queue.push([t, e]);
                var n = void 0 !== window.cordova,
                    o = navigator.isCocoonJS;
                "complete" === document.readyState || "interactive" === document.readyState ? window.setTimeout(s._monitor, 0) : n && !o ? document.addEventListener("deviceready", s._monitor, !1) : (document.addEventListener("DOMContentLoaded", s._monitor, !1), window.addEventListener("load", s._monitor, !1))
            }
        }, n.Device._readyCheck = function() {
            var t = this._readyCheck;
            if (document.body) {
                if (!this.deviceReadyAt) {
                    this.deviceReadyAt = Date.now(), document.removeEventListener("deviceready", t._monitor), document.removeEventListener("DOMContentLoaded", t._monitor), window.removeEventListener("load", t._monitor), this._initialize(), this.initialized = !0, this.onInitialized.dispatch(this);
                    for (var e; e = t._queue.shift();) {
                        var i = e[0],
                            s = e[1];
                        i.call(s, this)
                    }
                    this._readyCheck = null, this._initialize = null, this.onInitialized = null
                }
            } else window.setTimeout(t._monitor, 20)
        }, n.Device._initialize = function() {
            var t = this;
            (function() {
                var e = navigator.userAgent;
                /Playstation Vita/.test(e) ? t.vita = !0 : /Kindle/.test(e) || /\bKF[A-Z][A-Z]+/.test(e) || /Silk.*Mobile Safari/.test(e) ? t.kindle = !0 : /Android/.test(e) ? t.android = !0 : /CrOS/.test(e) ? t.chromeOS = !0 : /iP[ao]d|iPhone/i.test(e) ? (t.iOS = !0, navigator.appVersion.match(/OS (\d+)/), t.iOSVersion = parseInt(RegExp.$1, 10)) : /Linux/.test(e) ? t.linux = !0 : /Mac OS/.test(e) ? t.macOS = !0 : /Windows/.test(e) && (t.windows = !0), (/Windows Phone/i.test(e) || /IEMobile/i.test(e)) && (t.android = !1, t.iOS = !1, t.macOS = !1, t.windows = !0, t.windowsPhone = !0);
                var i = /Silk/.test(e);
                (t.windows || t.macOS || t.linux && !i || t.chromeOS) && (t.desktop = !0), (t.windowsPhone || /Windows NT/i.test(e) && /Touch/i.test(e)) && (t.desktop = !1)
            })(),
            function() {
                var e = navigator.userAgent;
                if (/Arora/.test(e) ? t.arora = !0 : /Edge\/\d+/.test(e) ? t.edge = !0 : /Chrome\/(\d+)/.test(e) && !t.windowsPhone ? (t.chrome = !0, t.chromeVersion = parseInt(RegExp.$1, 10)) : /Epiphany/.test(e) ? t.epiphany = !0 : /Firefox\D+(\d+)/.test(e) ? (t.firefox = !0, t.firefoxVersion = parseInt(RegExp.$1, 10)) : /AppleWebKit/.test(e) && t.iOS ? t.mobileSafari = !0 : /MSIE (\d+\.\d+);/.test(e) ? (t.ie = !0, t.ieVersion = parseInt(RegExp.$1, 10)) : /Midori/.test(e) ? t.midori = !0 : /Opera/.test(e) ? t.opera = !0 : /Safari\/(\d+)/.test(e) && !t.windowsPhone ? (t.safari = !0, /Version\/(\d+)\./.test(e) && (t.safariVersion = parseInt(RegExp.$1, 10))) : /Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(e) && (t.ie = !0, t.trident = !0, t.tridentVersion = parseInt(RegExp.$1, 10), t.ieVersion = parseInt(RegExp.$3, 10)), /Silk/.test(e) && (t.silk = !0), navigator.standalone && (t.webApp = !0), void 0 !== window.cordova && (t.cordova = !0), "undefined" != typeof process && "undefined" != typeof require && (t.node = !0), t.node && "object" == typeof process.versions && (t.nodeWebkit = !!process.versions["node-webkit"], t.electron = !!process.versions.electron), navigator.isCocoonJS && (t.cocoonJS = !0), t.cocoonJS) try {
                    t.cocoonJSApp = "undefined" != typeof CocoonJS
                } catch (e) {
                    t.cocoonJSApp = !1
                }
                void 0 !== window.ejecta && (t.ejecta = !0), /Crosswalk/.test(e) && (t.crosswalk = !0)
            }(),
            function() {
                t.audioData = !!window.Audio, t.webAudio = !(!window.AudioContext && !window.webkitAudioContext);
                var e = document.createElement("audio");
                try {
                    if (e.canPlayType && (e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/, "") && (t.ogg = !0), (e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/, "") || e.canPlayType("audio/opus;").replace(/^no$/, "")) && (t.opus = !0), e.canPlayType("audio/mpeg;").replace(/^no$/, "") && (t.mp3 = !0), e.canPlayType('audio/wav; codecs="1"').replace(/^no$/, "") && (t.wav = !0), (e.canPlayType("audio/x-m4a;") || e.canPlayType("audio/aac;").replace(/^no$/, "")) && (t.m4a = !0), e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/, "") && (t.webm = !0), "" !== e.canPlayType('audio/mp4;codecs="ec-3"')))
                        if (t.edge) t.dolby = !0;
                        else if (t.safari && t.safariVersion >= 9 && /Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)) {
                        var i = parseInt(RegExp.$1, 10),
                            s = parseInt(RegExp.$2, 10);
                        (10 === i && s >= 11 || i > 10) && (t.dolby = !0)
                    }
                } catch (e) {}
            }(),
            function() {
                var e = document.createElement("video");
                try {
                    e.canPlayType && (e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/, "") && (t.oggVideo = !0), e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/, "") && (t.h264Video = !0, t.mp4Video = !0), e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/, "") && (t.webmVideo = !0), e.canPlayType('video/webm; codecs="vp9"').replace(/^no$/, "") && (t.vp9Video = !0), e.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/, "") && (t.hlsVideo = !0))
                } catch (e) {}
            }(),
            function() {
                var e, i = document.createElement("p"),
                    s = {
                        webkitTransform: "-webkit-transform",
                        OTransform: "-o-transform",
                        msTransform: "-ms-transform",
                        MozTransform: "-moz-transform",
                        transform: "transform"
                    };
                for (var n in document.body.insertBefore(i, null), s) void 0 !== i.style[n] && (i.style[n] = "translate3d(1px,1px,1px)", e = window.getComputedStyle(i).getPropertyValue(s[n]));
                document.body.removeChild(i), t.css3D = void 0 !== e && e.length > 0 && "none" !== e
            }(),
            function() {
                var e, i, s;
                t.pixelRatio = window.devicePixelRatio || 1, t.iPhone = -1 !== navigator.userAgent.toLowerCase().indexOf("iphone"), t.iPhone4 = 2 === t.pixelRatio && t.iPhone, t.iPad = -1 !== navigator.userAgent.toLowerCase().indexOf("ipad"), "undefined" != typeof Int8Array ? t.typedArray = !0 : t.typedArray = !1, "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8Array && "undefined" != typeof Uint32Array && (t.littleEndian = (e = new ArrayBuffer(4), i = new Uint8Array(e), s = new Uint32Array(e), i[0] = 161, i[1] = 178, i[2] = 195, i[3] = 212, 3569595041 === s[0] || 2712847316 !== s[0] && null), t.LITTLE_ENDIAN = t.littleEndian), t.support32bit = "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8ClampedArray && "undefined" != typeof Int32Array && null !== t.littleEndian && function() {
                    if (void 0 === Uint8ClampedArray) return !1;
                    var t = n.CanvasPool.create(this, 1, 1).getContext("2d");
                    if (!t) return !1;
                    var e = t.createImageData(1, 1);
                    return n.CanvasPool.remove(this), e.data instanceof Uint8ClampedArray
                }(), navigator.vibrate = navigator.vibrate || navigator.webkitVibrate || navigator.mozVibrate || navigator.msVibrate, navigator.vibrate && (t.vibration = !0)
            }(),
            function() {
                t.canvas = !!window.CanvasRenderingContext2D || t.cocoonJS;
                try {
                    t.localStorage = !!localStorage.getItem
                } catch (e) {
                    t.localStorage = !1
                }
                t.file = !!(window.File && window.FileReader && window.FileList && window.Blob), t.fileSystem = !!window.requestFileSystem, t.webGL = function() {
                    try {
                        var t = document.createElement("canvas");
                        return t.screencanvas = !1, !!window.WebGLRenderingContext && (t.getContext("webgl") || t.getContext("experimental-webgl"))
                    } catch (t) {
                        return !1
                    }
                }(), t.webGL = !!t.webGL, t.worker = !!window.Worker, t.pointerLock = "pointerLockElement" in document || "mozPointerLockElement" in document || "webkitPointerLockElement" in document, t.quirksMode = "CSS1Compat" !== document.compatMode, navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia, window.URL = window.URL || window.webkitURL || window.mozURL || window.msURL, t.getUserMedia = t.getUserMedia && !!navigator.getUserMedia && !!window.URL, t.firefox && t.firefoxVersion < 21 && (t.getUserMedia = !1), !t.iOS && (t.ie || t.firefox || t.chrome) && (t.canvasBitBltShift = !0), (t.safari || t.mobileSafari) && (t.canvasBitBltShift = !1)
            }(),
            function() {
                var e = n.CanvasPool.create(this, 6, 1),
                    i = e.getContext("2d");
                i.fillStyle = "rgba(10, 20, 30, 0.5)", i.fillRect(0, 0, 1, 1);
                var s = i.getImageData(0, 0, 1, 1);
                if (s) {
                    i.putImageData(s, 1, 0);
                    var o = i.getImageData(1, 0, 1, 1);
                    t.canHandleAlpha = o.data[0] === s.data[0] && o.data[1] === s.data[1] && o.data[2] === s.data[2] && o.data[3] === s.data[3]
                }
                var r = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",
                    a = "AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",
                    h = new Image;
                h.src = r + "AP804Oa6" + a;
                var l = new Image;
                if (l.src = r + "/wCKxvRF" + a, i.clearRect(0, 0, 6, 1), i.globalCompositeOperation = "multiply", i.drawImage(h, 0, 0), i.drawImage(l, 2, 0), i.getImageData(2, 0, 1, 1)) {
                    var c = i.getImageData(2, 0, 1, 1).data;
                    t.canUseMultiply = 255 === c[0] && 0 === c[1] && 0 === c[2]
                }
                n.CanvasPool.removeByCanvas(e), PIXI.CanvasTinter.tintMethod = t.canUseMultiply ? PIXI.CanvasTinter.tintWithMultiply : PIXI.CanvasTinter.tintWithPerPixel
            }(),
            function() {
                for (var e = ["requestFullscreen", "requestFullScreen", "webkitRequestFullscreen", "webkitRequestFullScreen", "msRequestFullscreen", "msRequestFullScreen", "mozRequestFullScreen", "mozRequestFullscreen"], i = document.createElement("div"), s = 0; s < e.length; s++)
                    if (i[e[s]]) {
                        t.fullscreen = !0, t.requestFullscreen = e[s];
                        break
                    } var n = ["cancelFullScreen", "exitFullscreen", "webkitCancelFullScreen", "webkitExitFullscreen", "msCancelFullScreen", "msExitFullscreen", "mozCancelFullScreen", "mozExitFullscreen"];
                if (t.fullscreen)
                    for (s = 0; s < n.length; s++)
                        if (document[n[s]]) {
                            t.cancelFullscreen = n[s];
                            break
                        } window.Element && Element.ALLOW_KEYBOARD_INPUT && (t.fullscreenKeyboard = !0)
            }(), ("ontouchstart" in document.documentElement || window.navigator.maxTouchPoints && window.navigator.maxTouchPoints >= 1) && (t.touch = !0), (window.PointerEvent || window.MSPointerEvent || window.navigator.msPointerEnabled || window.navigator.pointerEnabled) && (t.mspointer = !0), t.cocoonJS || ("onwheel" in window || t.ie && "WheelEvent" in window ? t.wheelEvent = "wheel" : "onmousewheel" in window ? t.wheelEvent = "mousewheel" : t.firefox && "MouseScrollEvent" in window && (t.wheelEvent = "DOMMouseScroll"))
        }, n.Device.canPlayAudio = function(t) {
            return !!("mp3" === t && this.mp3 || "ogg" === t && (this.ogg || this.opus) || "m4a" === t && this.m4a || "opus" === t && this.opus || "wav" === t && this.wav || "webm" === t && this.webm || "mp4" === t && this.dolby)
        }, n.Device.canPlayVideo = function(t) {
            return !!("webm" === t && (this.webmVideo || this.vp9Video) || "mp4" === t && (this.mp4Video || this.h264Video) || ("ogg" === t || "ogv" === t) && this.oggVideo || "mpeg" === t && this.hlsVideo)
        }, n.Device.isConsoleOpen = function() {
            return !(!window.console || !window.console.firebug) || !(!window.console || (console.profile(), console.profileEnd(), console.clear && console.clear(), !console.profiles)) && console.profiles.length > 0
        }, n.Device.isAndroidStockBrowser = function() {
            var t = window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);
            return t && t[1] < 537
        }, n.Canvas = {
            create: function(t, e, i, s, o) {
                e = e || 256, i = i || 256;
                var r = o ? document.createElement("canvas") : n.CanvasPool.create(t, e, i);
                return "string" == typeof s && "" !== s && (r.id = s), r.width = e, r.height = i, r.style.display = "block", r
            },
            setBackgroundColor: function(t, e) {
                return e = e || "rgb(0,0,0)", t.style.backgroundColor = e, t
            },
            setTouchAction: function(t, e) {
                return e = e || "none", t.style.msTouchAction = e, t.style["ms-touch-action"] = e, t.style["touch-action"] = e, t
            },
            setUserSelect: function(t, e) {
                return e = e || "none", t.style["-webkit-touch-callout"] = e, t.style["-webkit-user-select"] = e, t.style["-khtml-user-select"] = e, t.style["-moz-user-select"] = e, t.style["-ms-user-select"] = e, t.style["user-select"] = e, t.style["-webkit-tap-highlight-color"] = "rgba(0, 0, 0, 0)", t
            },
            addToDOM: function(t, e, i) {
                var s;
                return void 0 === i && (i = !0), e && ("string" == typeof e ? s = document.getElementById(e) : "object" == typeof e && 1 === e.nodeType && (s = e)), s || (s = document.body), i && s.style && (s.style.overflow = "hidden"), s.appendChild(t), t
            },
            removeFromDOM: function(t) {
                t.parentNode && t.parentNode.removeChild(t)
            },
            setTransform: function(t, e, i, s, n, o, r) {
                return t.setTransform(s, o, r, n, e, i), t
            },
            setSmoothingEnabled: function(t, e) {
                var i = n.Canvas.getSmoothingPrefix(t);
                return i && (t[i] = e), t
            },
            getSmoothingPrefix: function(t) {
                var e = ["i", "webkitI", "msI", "mozI", "oI"];
                for (var i in e) {
                    var s = e[i] + "mageSmoothingEnabled";
                    if (s in t) return s
                }
                return null
            },
            getSmoothingEnabled: function(t) {
                var e = n.Canvas.getSmoothingPrefix(t);
                if (e) return t[e]
            },
            setImageRenderingCrisp: function(t) {
                for (var e = ["optimizeSpeed", "crisp-edges", "-moz-crisp-edges", "-webkit-optimize-contrast", "optimize-contrast", "pixelated"], i = 0; i < e.length; i++) t.style["image-rendering"] = e[i];
                return t.style.msInterpolationMode = "nearest-neighbor", t
            },
            setImageRenderingBicubic: function(t) {
                return t.style["image-rendering"] = "auto", t.style.msInterpolationMode = "bicubic", t
            }
        }, n.RequestAnimationFrame = function(t, e) {
            void 0 === e && (e = !1), this.game = t, this.isRunning = !1, this.forceSetTimeOut = e;
            for (var i = ["ms", "moz", "webkit", "o"], s = 0; s < i.length && !window.requestAnimationFrame; s++) window.requestAnimationFrame = window[i[s] + "RequestAnimationFrame"], window.cancelAnimationFrame = window[i[s] + "CancelAnimationFrame"] || window[i[s] + "CancelRequestAnimationFrame"];
            this._isSetTimeOut = !1, this._onLoop = null, this._timeOutID = null
        }, n.RequestAnimationFrame.prototype = {
            start: function() {
                this.isRunning = !0;
                var t = this;
                !window.requestAnimationFrame || this.forceSetTimeOut ? (this._isSetTimeOut = !0, this._onLoop = function() {
                    return t.updateSetTimeout()
                }, this._timeOutID = window.setTimeout(this._onLoop, 0)) : (this._isSetTimeOut = !1, this._onLoop = function(e) {
                    return t.updateRAF(e)
                }, this._timeOutID = window.requestAnimationFrame(this._onLoop))
            },
            updateRAF: function(t) {
                this.isRunning && (this.game.update(Math.floor(t)), this._timeOutID = window.requestAnimationFrame(this._onLoop))
            },
            updateSetTimeout: function() {
                this.isRunning && (this.game.update(Date.now()), this._timeOutID = window.setTimeout(this._onLoop, this.game.time.timeToCall))
            },
            stop: function() {
                this._isSetTimeOut ? clearTimeout(this._timeOutID) : window.cancelAnimationFrame(this._timeOutID), this.isRunning = !1
            },
            isSetTimeOut: function() {
                return this._isSetTimeOut
            },
            isRAF: function() {
                return !1 === this._isSetTimeOut
            }
        }, n.RequestAnimationFrame.prototype.constructor = n.RequestAnimationFrame, n.Math = {
            PI2: 2 * Math.PI,
            DEG_TO_RAD: Math.PI / 180,
            RAD_TO_DEG: 180 / Math.PI,
            degToRad: function(t) {
                return t * n.Math.DEG_TO_RAD
            },
            radToDeg: function(t) {
                return t * n.Math.RAD_TO_DEG
            },
            getNextPowerOfTwo: function(t) {
                if (t > 0 && 0 == (t & t - 1)) return t;
                for (var e = 1; e < t;) e <<= 1;
                return e
            },
            isPowerOfTwo: function(t, e) {
                return t > 0 && 0 == (t & t - 1) && e > 0 && 0 == (e & e - 1)
            },
            random: function(t, e) {
                if (void 0 === t && (t = 0), void 0 === e && (e = 1), t === e) return t;
                if (t < e) {
                    var i = t;
                    t = e, e = i
                }
                return Math.random() * (e - t) + t
            },
            between: function(t, e) {
                if (void 0 === t && (t = 0), void 0 === e && (e = 1), t === e) return t;
                if (t < e) {
                    var i = t;
                    t = e, e = i
                }
                return t = Math.ceil(t), e = Math.floor(e), Math.floor(Math.random() * (e - t + 1)) + t
            },
            fuzzyEqual: function(t, e, i) {
                return void 0 === i && (i = 1e-4), Math.abs(t - e) < i
            },
            fuzzyLessThan: function(t, e, i) {
                return void 0 === i && (i = 1e-4), t < e + i
            },
            fuzzyGreaterThan: function(t, e, i) {
                return void 0 === i && (i = 1e-4), t > e - i
            },
            fuzzyCeil: function(t, e) {
                return void 0 === e && (e = 1e-4), Math.ceil(t - e)
            },
            fuzzyFloor: function(t, e) {
                return void 0 === e && (e = 1e-4), Math.floor(t + e)
            },
            average: function() {
                for (var t = 0, e = arguments.length, i = 0; i < e; i++) t += +arguments[i];
                return t / e
            },
            shear: function(t) {
                return t % 1
            },
            snapTo: function(t, e, i) {
                return void 0 === i && (i = 0), 0 === e ? t : (t -= i, i + (t = e * Math.round(t / e)))
            },
            snapToFloor: function(t, e, i) {
                return void 0 === i && (i = 0), 0 === e ? t : (t -= i, i + (t = e * Math.floor(t / e)))
            },
            snapToCeil: function(t, e, i) {
                return void 0 === i && (i = 0), 0 === e ? t : (t -= i, i + (t = e * Math.ceil(t / e)))
            },
            roundTo: function(t, e, i) {
                void 0 === e && (e = 0), void 0 === i && (i = 10);
                var s = Math.pow(i, -e);
                return Math.round(t * s) / s
            },
            floorTo: function(t, e, i) {
                void 0 === e && (e = 0), void 0 === i && (i = 10);
                var s = Math.pow(i, -e);
                return Math.floor(t * s) / s
            },
            ceilTo: function(t, e, i) {
                void 0 === e && (e = 0), void 0 === i && (i = 10);
                var s = Math.pow(i, -e);
                return Math.ceil(t * s) / s
            },
            rotateToAngle: function(t, e, i) {
                return void 0 === i && (i = .05), t === e ? t : (Math.abs(e - t) <= i || Math.abs(e - t) >= n.Math.PI2 - i ? t = e : (Math.abs(e - t) > Math.PI && (e < t ? e += n.Math.PI2 : e -= n.Math.PI2), e > t ? t += i : e < t && (t -= i)), t)
            },
            getShortestAngle: function(t, e) {
                var i = e - t;
                return 0 === i ? 0 : i - 360 * Math.floor((i - -180) / 360)
            },
            angleBetween: function(t, e, i, s) {
                return Math.atan2(s - e, i - t)
            },
            angleBetweenY: function(t, e, i, s) {
                return Math.atan2(i - t, s - e)
            },
            angleBetweenPoints: function(t, e) {
                return Math.atan2(e.y - t.y, e.x - t.x)
            },
            angleBetweenPointsY: function(t, e) {
                return Math.atan2(e.x - t.x, e.y - t.y)
            },
            reverseAngle: function(t) {
                return this.normalizeAngle(t + Math.PI, !0)
            },
            normalizeAngle: function(t) {
                return (t %= 2 * Math.PI) >= 0 ? t : t + 2 * Math.PI
            },
            maxAdd: function(t, e, i) {
                return Math.min(t + e, i)
            },
            minSub: function(t, e, i) {
                return Math.max(t - e, i)
            },
            wrap: function(t, e, i) {
                var s = i - e;
                if (s <= 0) return 0;
                var n = (t - e) % s;
                return n < 0 && (n += s), n + e
            },
            wrapValue: function(t, e, i) {
                return ((t = Math.abs(t)) + (e = Math.abs(e))) % (i = Math.abs(i))
            },
            isOdd: function(t) {
                return !!(1 & t)
            },
            isEven: function(t) {
                return !(1 & t)
            },
            min: function() {
                if (1 === arguments.length && "object" == typeof arguments[0]) var t = arguments[0];
                else t = arguments;
                for (var e = 1, i = 0, s = t.length; e < s; e++) t[e] < t[i] && (i = e);
                return t[i]
            },
            max: function() {
                if (1 === arguments.length && "object" == typeof arguments[0]) var t = arguments[0];
                else t = arguments;
                for (var e = 1, i = 0, s = t.length; e < s; e++) t[e] > t[i] && (i = e);
                return t[i]
            },
            minProperty: function(t) {
                if (2 === arguments.length && "object" == typeof arguments[1]) var e = arguments[1];
                else e = arguments.slice(1);
                for (var i = 1, s = 0, n = e.length; i < n; i++) e[i][t] < e[s][t] && (s = i);
                return e[s][t]
            },
            maxProperty: function(t) {
                if (2 === arguments.length && "object" == typeof arguments[1]) var e = arguments[1];
                else e = arguments.slice(1);
                for (var i = 1, s = 0, n = e.length; i < n; i++) e[i][t] > e[s][t] && (s = i);
                return e[s][t]
            },
            wrapAngle: function(t, e) {
                return e ? this.wrap(t, -Math.PI, Math.PI) : this.wrap(t, -180, 180)
            },
            linearInterpolation: function(t, e) {
                var i = t.length - 1,
                    s = i * e,
                    n = Math.floor(s);
                return e < 0 ? this.linear(t[0], t[1], s) : e > 1 ? this.linear(t[i], t[i - 1], i - s) : this.linear(t[n], t[n + 1 > i ? i : n + 1], s - n)
            },
            bezierInterpolation: function(t, e) {
                for (var i = 0, s = t.length - 1, n = 0; n <= s; n++) i += Math.pow(1 - e, s - n) * Math.pow(e, n) * t[n] * this.bernstein(s, n);
                return i
            },
            catmullRomInterpolation: function(t, e) {
                var i = t.length - 1,
                    s = i * e,
                    n = Math.floor(s);
                return t[0] === t[i] ? (e < 0 && (n = Math.floor(s = i * (1 + e))), this.catmullRom(t[(n - 1 + i) % i], t[n], t[(n + 1) % i], t[(n + 2) % i], s - n)) : e < 0 ? t[0] - (this.catmullRom(t[0], t[0], t[1], t[1], -s) - t[0]) : e > 1 ? t[i] - (this.catmullRom(t[i], t[i], t[i - 1], t[i - 1], s - i) - t[i]) : this.catmullRom(t[n ? n - 1 : 0], t[n], t[i < n + 1 ? i : n + 1], t[i < n + 2 ? i : n + 2], s - n)
            },
            linear: function(t, e, i) {
                return (e - t) * i + t
            },
            bernstein: function(t, e) {
                return this.factorial(t) / this.factorial(e) / this.factorial(t - e)
            },
            factorial: function(t) {
                if (0 === t) return 1;
                for (var e = t; --t;) e *= t;
                return e
            },
            catmullRom: function(t, e, i, s, n) {
                var o = .5 * (i - t),
                    r = .5 * (s - e),
                    a = n * n;
                return (2 * e - 2 * i + o + r) * (n * a) + (-3 * e + 3 * i - 2 * o - r) * a + o * n + e
            },
            difference: function(t, e) {
                return Math.abs(t - e)
            },
            roundAwayFromZero: function(t) {
                return t > 0 ? Math.ceil(t) : Math.floor(t)
            },
            sinCosGenerator: function(t, e, i, s) {
                void 0 === e && (e = 1), void 0 === i && (i = 1), void 0 === s && (s = 1);
                for (var n = e, o = i, r = s * Math.PI / t, a = [], h = [], l = 0; l < t; l++) n += (o -= n * r) * r, a[l] = o, h[l] = n;
                return {
                    sin: h,
                    cos: a,
                    length: t
                }
            },
            distance: function(t, e, i, s) {
                var n = t - i,
                    o = e - s;
                return Math.sqrt(n * n + o * o)
            },
            distanceSq: function(t, e, i, s) {
                var n = t - i,
                    o = e - s;
                return n * n + o * o
            },
            distancePow: function(t, e, i, s, n) {
                return void 0 === n && (n = 2), Math.sqrt(Math.pow(i - t, n) + Math.pow(s - e, n))
            },
            clamp: function(t, e, i) {
                return t < e ? e : i < t ? i : t
            },
            clampBottom: function(t, e) {
                return t < e ? e : t
            },
            within: function(t, e, i) {
                return Math.abs(t - e) <= i
            },
            mapLinear: function(t, e, i, s, n) {
                return s + (t - e) * (n - s) / (i - e)
            },
            smoothstep: function(t, e, i) {
                return (t = Math.max(0, Math.min(1, (t - e) / (i - e)))) * t * (3 - 2 * t)
            },
            smootherstep: function(t, e, i) {
                return (t = Math.max(0, Math.min(1, (t - e) / (i - e)))) * t * t * (t * (6 * t - 15) + 10)
            },
            sign: function(t) {
                return t < 0 ? -1 : t > 0 ? 1 : 0
            },
            percent: function(t, e, i) {
                return void 0 === i && (i = 0), t > e || i > e ? 1 : t < i || i > t ? 0 : (t - i) / e
            }
        }, n.RandomDataGenerator = function(t) {
            void 0 === t && (t = []), this.c = 1, this.s0 = 0, this.s1 = 0, this.s2 = 0, "string" == typeof t ? this.state(t) : this.sow(t)
        }, n.RandomDataGenerator.prototype = {
            rnd: function() {
                var t = 2091639 * this.s0 + 2.3283064365386963e-10 * this.c;
                return this.c = 0 | t, this.s0 = this.s1, this.s1 = this.s2, this.s2 = t - this.c, this.s2
            },
            sow: function(t) {
                if (this.s0 = this.hash(" "), this.s1 = this.hash(this.s0), this.s2 = this.hash(this.s1), this.c = 1, t)
                    for (var e = 0; e < t.length && null != t[e]; e++) {
                        var i = t[e];
                        this.s0 -= this.hash(i), this.s0 += ~~(this.s0 < 0), this.s1 -= this.hash(i), this.s1 += ~~(this.s1 < 0), this.s2 -= this.hash(i), this.s2 += ~~(this.s2 < 0)
                    }
            },
            hash: function(t) {
                var e, i, s;
                for (s = 4022871197, t = t.toString(), i = 0; i < t.length; i++) e = .02519603282416938 * (s += t.charCodeAt(i)), e -= s = e >>> 0, s = (e *= s) >>> 0, s += 4294967296 * (e -= s);
                return 2.3283064365386963e-10 * (s >>> 0)
            },
            integer: function() {
                return 4294967296 * this.rnd.apply(this)
            },
            frac: function() {
                return this.rnd.apply(this) + 1.1102230246251565e-16 * (2097152 * this.rnd.apply(this) | 0)
            },
            real: function() {
                return this.integer() + this.frac()
            },
            integerInRange: function(t, e) {
                return Math.floor(this.realInRange(0, e - t + 1) + t)
            },
            between: function(t, e) {
                return this.integerInRange(t, e)
            },
            realInRange: function(t, e) {
                return this.frac() * (e - t) + t
            },
            normal: function() {
                return 1 - 2 * this.frac()
            },
            uuid: function() {
                var t = "",
                    e = "";
                for (e = t = ""; t++ < 36; e += ~t % 5 | 3 * t & 4 ? (15 ^ t ? 8 ^ this.frac() * (20 ^ t ? 16 : 4) : 4).toString(16) : "-");
                return e
            },
            pick: function(t) {
                return t[this.integerInRange(0, t.length - 1)]
            },
            sign: function() {
                return this.pick([-1, 1])
            },
            weightedPick: function(t) {
                return t[~~(Math.pow(this.frac(), 2) * (t.length - 1) + .5)]
            },
            timestamp: function(t, e) {
                return this.realInRange(t || 9466848e5, e || 1577862e6)
            },
            angle: function() {
                return this.integerInRange(-180, 180)
            },
            state: function(t) {
                return "string" == typeof t && t.match(/^!rnd/) && (t = t.split(","), this.c = parseFloat(t[1]), this.s0 = parseFloat(t[2]), this.s1 = parseFloat(t[3]), this.s2 = parseFloat(t[4])), ["!rnd", this.c, this.s0, this.s1, this.s2].join(",")
            }
        }, n.RandomDataGenerator.prototype.constructor = n.RandomDataGenerator, n.QuadTree = function(t, e, i, s, n, o, r) {
            this.maxObjects = 10, this.maxLevels = 4, this.level = 0, this.bounds = {}, this.objects = [], this.nodes = [], this._empty = [], this.reset(t, e, i, s, n, o, r)
        }, n.QuadTree.prototype = {
            reset: function(t, e, i, s, n, o, r) {
                this.maxObjects = n || 10, this.maxLevels = o || 4, this.level = r || 0, this.bounds = {
                    x: Math.round(t),
                    y: Math.round(e),
                    width: i,
                    height: s,
                    subWidth: Math.floor(i / 2),
                    subHeight: Math.floor(s / 2),
                    right: Math.round(t) + Math.floor(i / 2),
                    bottom: Math.round(e) + Math.floor(s / 2)
                }, this.objects.length = 0, this.nodes.length = 0
            },
            populate: function(t) {
                t.forEach(this.populateHandler, this, !0)
            },
            populateHandler: function(t) {
                t.body && t.exists && this.insert(t.body)
            },
            split: function() {
                this.nodes[0] = new n.QuadTree(this.bounds.right, this.bounds.y, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1), this.nodes[1] = new n.QuadTree(this.bounds.x, this.bounds.y, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1), this.nodes[2] = new n.QuadTree(this.bounds.x, this.bounds.bottom, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1), this.nodes[3] = new n.QuadTree(this.bounds.right, this.bounds.bottom, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1)
            },
            insert: function(t) {
                var e, i = 0;
                if (null == this.nodes[0] || -1 === (e = this.getIndex(t))) {
                    if (this.objects.push(t), this.objects.length > this.maxObjects && this.level < this.maxLevels)
                        for (null == this.nodes[0] && this.split(); i < this.objects.length;) - 1 !== (e = this.getIndex(this.objects[i])) ? this.nodes[e].insert(this.objects.splice(i, 1)[0]) : i++
                } else this.nodes[e].insert(t)
            },
            getIndex: function(t) {
                var e = -1;
                return t.x < this.bounds.right && t.right < this.bounds.right ? t.y < this.bounds.bottom && t.bottom < this.bounds.bottom ? e = 1 : t.y > this.bounds.bottom && (e = 2) : t.x > this.bounds.right && (t.y < this.bounds.bottom && t.bottom < this.bounds.bottom ? e = 0 : t.y > this.bounds.bottom && (e = 3)), e
            },
            retrieve: function(t) {
                if (t instanceof n.Rectangle) var e = this.objects,
                    i = this.getIndex(t);
                else {
                    if (!t.body) return this._empty;
                    e = this.objects, i = this.getIndex(t.body)
                }
                return this.nodes[0] && (-1 !== i ? e = e.concat(this.nodes[i].retrieve(t)) : e = (e = (e = (e = e.concat(this.nodes[0].retrieve(t))).concat(this.nodes[1].retrieve(t))).concat(this.nodes[2].retrieve(t))).concat(this.nodes[3].retrieve(t))), e
            },
            clear: function() {
                this.objects.length = 0;
                for (var t = this.nodes.length; t--;) this.nodes[t].clear(), this.nodes.splice(t, 1);
                this.nodes.length = 0
            }
        }, n.QuadTree.prototype.constructor = n.QuadTree, n.Net = function(t) {
            this.game = t
        }, n.Net.prototype = {
            getHostName: function() {
                return window.location && window.location.hostname ? window.location.hostname : null
            },
            checkDomainName: function(t) {
                return -1 !== window.location.hostname.indexOf(t)
            },
            updateQueryString: function(t, e, i, s) {
                void 0 === i && (i = !1), void 0 !== s && "" !== s || (s = window.location.href);
                var n = "",
                    o = new RegExp("([?|&])" + t + "=.*?(&|#|$)(.*)", "gi");
                if (o.test(s)) n = null != e ? s.replace(o, "$1" + t + "=" + e + "$2$3") : s.replace(o, "$1$3").replace(/(&|\?)$/, "");
                else if (null != e) {
                    var r = -1 !== s.indexOf("?") ? "&" : "?",
                        a = s.split("#");
                    s = a[0] + r + t + "=" + e, a[1] && (s += "#" + a[1]), n = s
                } else n = s;
                if (!i) return n;
                window.location.href = n
            },
            getQueryString: function(t) {
                void 0 === t && (t = "");
                var e = {},
                    i = location.search.substring(1).split("&");
                for (var s in i) {
                    var n = i[s].split("=");
                    if (n.length > 1) {
                        if (t && t === this.decodeURI(n[0])) return this.decodeURI(n[1]);
                        e[this.decodeURI(n[0])] = this.decodeURI(n[1])
                    }
                }
                return e
            },
            decodeURI: function(t) {
                return decodeURIComponent(t.replace(/\+/g, " "))
            }
        }, n.Net.prototype.constructor = n.Net, n.TweenManager = function(t) {
            this.game = t, this.frameBased = !1, this._tweens = [], this._add = [], this.easeMap = {
                Power0: n.Easing.Power0,
                Power1: n.Easing.Power1,
                Power2: n.Easing.Power2,
                Power3: n.Easing.Power3,
                Power4: n.Easing.Power4,
                Linear: n.Easing.Linear.None,
                Quad: n.Easing.Quadratic.Out,
                Cubic: n.Easing.Cubic.Out,
                Quart: n.Easing.Quartic.Out,
                Quint: n.Easing.Quintic.Out,
                Sine: n.Easing.Sinusoidal.Out,
                Expo: n.Easing.Exponential.Out,
                Circ: n.Easing.Circular.Out,
                Elastic: n.Easing.Elastic.Out,
                Back: n.Easing.Back.Out,
                Bounce: n.Easing.Bounce.Out,
                "Quad.easeIn": n.Easing.Quadratic.In,
                "Cubic.easeIn": n.Easing.Cubic.In,
                "Quart.easeIn": n.Easing.Quartic.In,
                "Quint.easeIn": n.Easing.Quintic.In,
                "Sine.easeIn": n.Easing.Sinusoidal.In,
                "Expo.easeIn": n.Easing.Exponential.In,
                "Circ.easeIn": n.Easing.Circular.In,
                "Elastic.easeIn": n.Easing.Elastic.In,
                "Back.easeIn": n.Easing.Back.In,
                "Bounce.easeIn": n.Easing.Bounce.In,
                "Quad.easeOut": n.Easing.Quadratic.Out,
                "Cubic.easeOut": n.Easing.Cubic.Out,
                "Quart.easeOut": n.Easing.Quartic.Out,
                "Quint.easeOut": n.Easing.Quintic.Out,
                "Sine.easeOut": n.Easing.Sinusoidal.Out,
                "Expo.easeOut": n.Easing.Exponential.Out,
                "Circ.easeOut": n.Easing.Circular.Out,
                "Elastic.easeOut": n.Easing.Elastic.Out,
                "Back.easeOut": n.Easing.Back.Out,
                "Bounce.easeOut": n.Easing.Bounce.Out,
                "Quad.easeInOut": n.Easing.Quadratic.InOut,
                "Cubic.easeInOut": n.Easing.Cubic.InOut,
                "Quart.easeInOut": n.Easing.Quartic.InOut,
                "Quint.easeInOut": n.Easing.Quintic.InOut,
                "Sine.easeInOut": n.Easing.Sinusoidal.InOut,
                "Expo.easeInOut": n.Easing.Exponential.InOut,
                "Circ.easeInOut": n.Easing.Circular.InOut,
                "Elastic.easeInOut": n.Easing.Elastic.InOut,
                "Back.easeInOut": n.Easing.Back.InOut,
                "Bounce.easeInOut": n.Easing.Bounce.InOut
            }, this.game.onPause.add(this._pauseAll, this), this.game.onResume.add(this._resumeAll, this)
        }, n.TweenManager.prototype = {
            getAll: function() {
                return this._tweens
            },
            removeAll: function() {
                for (var t = 0; t < this._tweens.length; t++) this._tweens[t].pendingDelete = !0;
                this._add = []
            },
            removeFrom: function(t, e) {
                if (void 0 === e && (e = !0), Array.isArray(t))
                    for (i = 0, s = t.length; i < s; i++) this.removeFrom(t[i]);
                else if (t.type === n.GROUP && e)
                    for (var i = 0, s = t.children.length; i < s; i++) this.removeFrom(t.children[i]);
                else {
                    for (i = 0, s = this._tweens.length; i < s; i++) t === this._tweens[i].target && this.remove(this._tweens[i]);
                    for (i = 0, s = this._add.length; i < s; i++) t === this._add[i].target && this.remove(this._add[i])
                }
            },
            add: function(t) {
                t._manager = this, this._add.push(t)
            },
            create: function(t) {
                return new n.Tween(t, this.game, this)
            },
            remove: function(t) {
                var e = this._tweens.indexOf(t); - 1 !== e ? this._tweens[e].pendingDelete = !0 : -1 !== (e = this._add.indexOf(t)) && (this._add[e].pendingDelete = !0)
            },
            update: function() {
                var t = this._add.length,
                    e = this._tweens.length;
                if (0 === e && 0 === t) return !1;
                for (var i = 0; i < e;) this._tweens[i].update(this.game.time.time) ? i++ : (this._tweens.splice(i, 1), e--);
                return t > 0 && (this._tweens = this._tweens.concat(this._add), this._add.length = 0), !0
            },
            isTweening: function(t) {
                return this._tweens.some(function(e) {
                    return e.target === t
                })
            },
            _pauseAll: function() {
                for (var t = this._tweens.length - 1; t >= 0; t--) this._tweens[t]._pause()
            },
            _resumeAll: function() {
                for (var t = this._tweens.length - 1; t >= 0; t--) this._tweens[t]._resume()
            },
            pauseAll: function() {
                for (var t = this._tweens.length - 1; t >= 0; t--) this._tweens[t].pause()
            },
            resumeAll: function() {
                for (var t = this._tweens.length - 1; t >= 0; t--) this._tweens[t].resume(!0)
            }
        }, n.TweenManager.prototype.constructor = n.TweenManager, n.Tween = function(t, e, i) {
            this.game = e, this.target = t, this.manager = i, this.timeline = [], this.reverse = !1, this.timeScale = 1, this.repeatCounter = 0, this.pendingDelete = !1, this.onStart = new n.Signal, this.onLoop = new n.Signal, this.onRepeat = new n.Signal, this.onChildComplete = new n.Signal, this.onComplete = new n.Signal, this.isRunning = !1, this.current = 0, this.properties = {}, this.chainedTween = null, this.isPaused = !1, this.frameBased = i.frameBased, this._onUpdateCallback = null, this._onUpdateCallbackContext = null, this._pausedTime = 0, this._codePaused = !1, this._hasStarted = !1
        }, n.Tween.prototype = {
            to: function(t, e, i, s, o, r, a) {
                return (void 0 === e || e <= 0) && (e = 1e3), null != i || (i = n.Easing.Default), void 0 === s && (s = !1), void 0 === o && (o = 0), void 0 === r && (r = 0), void 0 === a && (a = !1), "string" == typeof i && this.manager.easeMap[i] && (i = this.manager.easeMap[i]), this.isRunning ? (console.warn("Phaser.Tween.to cannot be called after Tween.start"), this) : (this.timeline.push(new n.TweenData(this).to(t, e, i, o, r, a)), s && this.start(), this)
            },
            from: function(t, e, i, s, o, r, a) {
                return void 0 === e && (e = 1e3), null != i || (i = n.Easing.Default), void 0 === s && (s = !1), void 0 === o && (o = 0), void 0 === r && (r = 0), void 0 === a && (a = !1), "string" == typeof i && this.manager.easeMap[i] && (i = this.manager.easeMap[i]), this.isRunning ? (console.warn("Phaser.Tween.from cannot be called after Tween.start"), this) : (this.timeline.push(new n.TweenData(this).from(t, e, i, o, r, a)), s && this.start(), this)
            },
            start: function(t) {
                if (void 0 === t && (t = 0), null === this.game || null === this.target || 0 === this.timeline.length || this.isRunning) return this;
                for (var e = 0; e < this.timeline.length; e++)
                    for (var i in this.timeline[e].vEnd) this.properties[i] = this.target[i] || 0, Array.isArray(this.properties[i]) || (this.properties[i] *= 1);
                for (e = 0; e < this.timeline.length; e++) this.timeline[e].loadValues();
                return this.manager.add(this), this.isRunning = !0, (t < 0 || t > this.timeline.length - 1) && (t = 0), this.current = t, this.timeline[this.current].start(), this
            },
            stop: function(t) {
                return void 0 === t && (t = !1), this.isRunning = !1, this._onUpdateCallback = null, this._onUpdateCallbackContext = null, t && (this.onComplete.dispatch(this.target, this), this._hasStarted = !1, this.chainedTween && this.chainedTween.start()), this.manager.remove(this), this
            },
            updateTweenData: function(t, e, i) {
                if (0 === this.timeline.length) return this;
                if (void 0 === i && (i = 0), -1 === i)
                    for (var s = 0; s < this.timeline.length; s++) this.timeline[s][t] = e;
                else this.timeline[i][t] = e;
                return this
            },
            delay: function(t, e) {
                return this.updateTweenData("delay", t, e)
            },
            repeat: function(t, e, i) {
                return void 0 === e && (e = 0), this.updateTweenData("repeatCounter", t, i), this.updateTweenData("repeatDelay", e, i)
            },
            repeatDelay: function(t, e) {
                return this.updateTweenData("repeatDelay", t, e)
            },
            yoyo: function(t, e, i) {
                return void 0 === e && (e = 0), this.updateTweenData("yoyo", t, i), this.updateTweenData("yoyoDelay", e, i)
            },
            yoyoDelay: function(t, e) {
                return this.updateTweenData("yoyoDelay", t, e)
            },
            easing: function(t, e) {
                return "string" == typeof t && this.manager.easeMap[t] && (t = this.manager.easeMap[t]), this.updateTweenData("easingFunction", t, e)
            },
            interpolation: function(t, e, i) {
                return void 0 === e && (e = n.Math), this.updateTweenData("interpolationFunction", t, i), this.updateTweenData("interpolationContext", e, i)
            },
            repeatAll: function(t) {
                return void 0 === t && (t = 0), this.repeatCounter = t, this
            },
            chain: function() {
                for (var t = arguments.length; t--;) t > 0 ? arguments[t - 1].chainedTween = arguments[t] : this.chainedTween = arguments[t];
                return this
            },
            loop: function(t) {
                return void 0 === t && (t = !0), this.repeatCounter = t ? -1 : 0, this
            },
            onUpdateCallback: function(t, e) {
                return this._onUpdateCallback = t, this._onUpdateCallbackContext = e, this
            },
            pause: function() {
                this.isPaused = !0, this._codePaused = !0, this._pausedTime = this.game.time.time
            },
            _pause: function() {
                this._codePaused || (this.isPaused = !0, this._pausedTime = this.game.time.time)
            },
            resume: function() {
                if (this.isPaused) {
                    this.isPaused = !1, this._codePaused = !1;
                    for (var t = 0; t < this.timeline.length; t++) this.timeline[t].isRunning || (this.timeline[t].startTime += this.game.time.time - this._pausedTime)
                }
            },
            _resume: function() {
                this._codePaused || this.resume()
            },
            update: function(t) {
                if (this.pendingDelete || !this.target) return !1;
                if (this.isPaused) return !0;
                var e = this.timeline[this.current].update(t);
                if (e === n.TweenData.PENDING) return !0;
                if (e === n.TweenData.RUNNING) return this._hasStarted || (this.onStart.dispatch(this.target, this), this._hasStarted = !0), null !== this._onUpdateCallback && this._onUpdateCallback.call(this._onUpdateCallbackContext, this, this.timeline[this.current].value, this.timeline[this.current]), this.isRunning;
                if (e === n.TweenData.LOOPED) return -1 === this.timeline[this.current].repeatCounter ? this.onLoop.dispatch(this.target, this) : this.onRepeat.dispatch(this.target, this), !0;
                if (e === n.TweenData.COMPLETE) {
                    var i = !1;
                    return this.reverse ? --this.current < 0 && (this.current = this.timeline.length - 1, i = !0) : ++this.current === this.timeline.length && (this.current = 0, i = !0), i ? -1 === this.repeatCounter ? (this.timeline[this.current].start(), this.onLoop.dispatch(this.target, this), !0) : this.repeatCounter > 0 ? (this.repeatCounter--, this.timeline[this.current].start(), this.onRepeat.dispatch(this.target, this), !0) : (this.isRunning = !1, this.onComplete.dispatch(this.target, this), this._hasStarted = !1, this.chainedTween && this.chainedTween.start(), !1) : (this.onChildComplete.dispatch(this.target, this), this.timeline[this.current].start(), !0)
                }
            },
            generateData: function(t, e) {
                if (null === this.game || null === this.target) return null;
                void 0 === t && (t = 60), void 0 === e && (e = []);
                for (var i = 0; i < this.timeline.length; i++)
                    for (var s in this.timeline[i].vEnd) this.properties[s] = this.target[s] || 0, Array.isArray(this.properties[s]) || (this.properties[s] *= 1);
                for (i = 0; i < this.timeline.length; i++) this.timeline[i].loadValues();
                for (i = 0; i < this.timeline.length; i++) e = e.concat(this.timeline[i].generateData(t));
                return e
            }
        }, Object.defineProperty(n.Tween.prototype, "totalDuration", {
            get: function() {
                for (var t = 0, e = 0; e < this.timeline.length; e++) t += this.timeline[e].duration;
                return t
            }
        }), n.Tween.prototype.constructor = n.Tween, n.TweenData = function(t) {
            this.parent = t, this.game = t.game, this.vStart = {}, this.vStartCache = {}, this.vEnd = {}, this.vEndCache = {}, this.duration = 1e3, this.percent = 0, this.value = 0, this.repeatCounter = 0, this.repeatDelay = 0, this.repeatTotal = 0, this.interpolate = !1, this.yoyo = !1, this.yoyoDelay = 0, this.inReverse = !1, this.delay = 0, this.dt = 0, this.startTime = null, this.easingFunction = n.Easing.Default, this.interpolationFunction = n.Math.linearInterpolation, this.interpolationContext = n.Math, this.isRunning = !1, this.isFrom = !1
        }, n.TweenData.PENDING = 0, n.TweenData.RUNNING = 1, n.TweenData.LOOPED = 2, n.TweenData.COMPLETE = 3, n.TweenData.prototype = {
            to: function(t, e, i, s, n, o) {
                return this.vEnd = t, this.duration = e, this.easingFunction = i, this.delay = s, this.repeatTotal = n, this.yoyo = o, this.isFrom = !1, this
            },
            from: function(t, e, i, s, n, o) {
                return this.vEnd = t, this.duration = e, this.easingFunction = i, this.delay = s, this.repeatTotal = n, this.yoyo = o, this.isFrom = !0, this
            },
            start: function() {
                if (this.startTime = this.game.time.time + this.delay, this.parent.reverse ? this.dt = this.duration : this.dt = 0, this.delay > 0 ? this.isRunning = !1 : this.isRunning = !0, this.isFrom)
                    for (var t in this.vStartCache) this.vStart[t] = this.vEndCache[t], this.vEnd[t] = this.vStartCache[t], this.parent.target[t] = this.vStart[t];
                return this.value = 0, this.yoyoCounter = 0, this.repeatCounter = this.repeatTotal, this
            },
            loadValues: function() {
                for (var t in this.parent.properties) {
                    if (this.vStart[t] = this.parent.properties[t], Array.isArray(this.vEnd[t])) {
                        if (0 === this.vEnd[t].length) continue;
                        0 === this.percent && (this.vEnd[t] = [this.vStart[t]].concat(this.vEnd[t]))
                    }
                    void 0 !== this.vEnd[t] ? ("string" == typeof this.vEnd[t] && (this.vEnd[t] = this.vStart[t] + parseFloat(this.vEnd[t], 10)), this.parent.properties[t] = this.vEnd[t]) : this.vEnd[t] = this.vStart[t], this.vStartCache[t] = this.vStart[t], this.vEndCache[t] = this.vEnd[t]
                }
                return this
            },
            update: function(t) {
                if (this.isRunning) {
                    if (t < this.startTime) return n.TweenData.RUNNING
                } else {
                    if (!(t >= this.startTime)) return n.TweenData.PENDING;
                    this.isRunning = !0
                }
                var e = this.parent.frameBased ? this.game.time.physicsElapsedMS : this.game.time.elapsedMS;
                for (var i in this.parent.reverse ? (this.dt -= e * this.parent.timeScale, this.dt = Math.max(this.dt, 0)) : (this.dt += e * this.parent.timeScale, this.dt = Math.min(this.dt, this.duration)), this.percent = this.dt / this.duration, this.value = this.easingFunction(this.percent), this.vEnd) {
                    var s = this.vStart[i],
                        o = this.vEnd[i];
                    Array.isArray(o) ? this.parent.target[i] = this.interpolationFunction.call(this.interpolationContext, o, this.value) : this.parent.target[i] = s + (o - s) * this.value
                }
                return !this.parent.reverse && 1 === this.percent || this.parent.reverse && 0 === this.percent ? this.repeat() : n.TweenData.RUNNING
            },
            generateData: function(t) {
                this.parent.reverse ? this.dt = this.duration : this.dt = 0;
                var e = [],
                    i = !1,
                    s = 1 / t * 1e3;
                do {
                    this.parent.reverse ? (this.dt -= s, this.dt = Math.max(this.dt, 0)) : (this.dt += s, this.dt = Math.min(this.dt, this.duration)), this.percent = this.dt / this.duration, this.value = this.easingFunction(this.percent);
                    var n = {};
                    for (var o in this.vEnd) {
                        var r = this.vStart[o],
                            a = this.vEnd[o];
                        Array.isArray(a) ? n[o] = this.interpolationFunction(a, this.value) : n[o] = r + (a - r) * this.value
                    }
                    e.push(n), (!this.parent.reverse && 1 === this.percent || this.parent.reverse && 0 === this.percent) && (i = !0)
                } while (!i);
                if (this.yoyo) {
                    var h = e.slice();
                    h.reverse(), e = e.concat(h)
                }
                return e
            },
            repeat: function() {
                if (this.yoyo) {
                    if (this.inReverse && 0 === this.repeatCounter) {
                        for (var t in this.vStartCache) this.vStart[t] = this.vStartCache[t], this.vEnd[t] = this.vEndCache[t];
                        return this.inReverse = !1, n.TweenData.COMPLETE
                    }
                    this.inReverse = !this.inReverse
                } else if (0 === this.repeatCounter) return n.TweenData.COMPLETE;
                if (this.inReverse)
                    for (var t in this.vStartCache) this.vStart[t] = this.vEndCache[t], this.vEnd[t] = this.vStartCache[t];
                else {
                    for (var t in this.vStartCache) this.vStart[t] = this.vStartCache[t], this.vEnd[t] = this.vEndCache[t];
                    this.repeatCounter > 0 && this.repeatCounter--
                }
                return this.startTime = this.game.time.time, this.yoyo && this.inReverse ? this.startTime += this.yoyoDelay : this.inReverse || (this.startTime += this.repeatDelay), this.parent.reverse ? this.dt = this.duration : this.dt = 0, n.TweenData.LOOPED
            }
        }, n.TweenData.prototype.constructor = n.TweenData, n.Easing = {
            Linear: {
                None: function(t) {
                    return t
                }
            },
            Quadratic: {
                In: function(t) {
                    return t * t
                },
                Out: function(t) {
                    return t * (2 - t)
                },
                InOut: function(t) {
                    return (t *= 2) < 1 ? .5 * t * t : -.5 * (--t * (t - 2) - 1)
                }
            },
            Cubic: {
                In: function(t) {
                    return t * t * t
                },
                Out: function(t) {
                    return --t * t * t + 1
                },
                InOut: function(t) {
                    return (t *= 2) < 1 ? .5 * t * t * t : .5 * ((t -= 2) * t * t + 2)
                }
            },
            Quartic: {
                In: function(t) {
                    return t * t * t * t
                },
                Out: function(t) {
                    return 1 - --t * t * t * t
                },
                InOut: function(t) {
                    return (t *= 2) < 1 ? .5 * t * t * t * t : -.5 * ((t -= 2) * t * t * t - 2)
                }
            },
            Quintic: {
                In: function(t) {
                    return t * t * t * t * t
                },
                Out: function(t) {
                    return --t * t * t * t * t + 1
                },
                InOut: function(t) {
                    return (t *= 2) < 1 ? .5 * t * t * t * t * t : .5 * ((t -= 2) * t * t * t * t + 2)
                }
            },
            Sinusoidal: {
                In: function(t) {
                    return 0 === t ? 0 : 1 === t ? 1 : 1 - Math.cos(t * Math.PI / 2)
                },
                Out: function(t) {
                    return 0 === t ? 0 : 1 === t ? 1 : Math.sin(t * Math.PI / 2)
                },
                InOut: function(t) {
                    return 0 === t ? 0 : 1 === t ? 1 : .5 * (1 - Math.cos(Math.PI * t))
                }
            },
            Exponential: {
                In: function(t) {
                    return 0 === t ? 0 : Math.pow(1024, t - 1)
                },
                Out: function(t) {
                    return 1 === t ? 1 : 1 - Math.pow(2, -10 * t)
                },
                InOut: function(t) {
                    return 0 === t ? 0 : 1 === t ? 1 : (t *= 2) < 1 ? .5 * Math.pow(1024, t - 1) : .5 * (2 - Math.pow(2, -10 * (t - 1)))
                }
            },
            Circular: {
                In: function(t) {
                    return 1 - Math.sqrt(1 - t * t)
                },
                Out: function(t) {
                    return Math.sqrt(1 - --t * t)
                },
                InOut: function(t) {
                    return (t *= 2) < 1 ? -.5 * (Math.sqrt(1 - t * t) - 1) : .5 * (Math.sqrt(1 - (t -= 2) * t) + 1)
                }
            },
            Elastic: {
                In: function(t) {
                    var e, i = .1;
                    return 0 === t ? 0 : 1 === t ? 1 : (!i || i < 1 ? (i = 1, e = .1) : e = .4 * Math.asin(1 / i) / (2 * Math.PI), -i * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - e) * (2 * Math.PI) / .4))
                },
                Out: function(t) {
                    var e, i = .1;
                    return 0 === t ? 0 : 1 === t ? 1 : (!i || i < 1 ? (i = 1, e = .1) : e = .4 * Math.asin(1 / i) / (2 * Math.PI), i * Math.pow(2, -10 * t) * Math.sin((t - e) * (2 * Math.PI) / .4) + 1)
                },
                InOut: function(t) {
                    var e, i = .1;
                    return 0 === t ? 0 : 1 === t ? 1 : (!i || i < 1 ? (i = 1, e = .1) : e = .4 * Math.asin(1 / i) / (2 * Math.PI), (t *= 2) < 1 ? i * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - e) * (2 * Math.PI) / .4) * -.5 : i * Math.pow(2, -10 * (t -= 1)) * Math.sin((t - e) * (2 * Math.PI) / .4) * .5 + 1)
                }
            },
            Back: {
                In: function(t) {
                    var e = 1.70158;
                    return t * t * ((e + 1) * t - e)
                },
                Out: function(t) {
                    var e = 1.70158;
                    return --t * t * ((e + 1) * t + e) + 1
                },
                InOut: function(t) {
                    var e = 2.5949095;
                    return (t *= 2) < 1 ? t * t * ((e + 1) * t - e) * .5 : .5 * ((t -= 2) * t * ((e + 1) * t + e) + 2)
                }
            },
            Bounce: {
                In: function(t) {
                    return 1 - n.Easing.Bounce.Out(1 - t)
                },
                Out: function(t) {
                    return t < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : t < 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375
                },
                InOut: function(t) {
                    return t < .5 ? .5 * n.Easing.Bounce.In(2 * t) : .5 * n.Easing.Bounce.Out(2 * t - 1) + .5
                }
            }
        }, n.Easing.Default = n.Easing.Linear.None, n.Easing.Power0 = n.Easing.Linear.None, n.Easing.Power1 = n.Easing.Quadratic.Out, n.Easing.Power2 = n.Easing.Cubic.Out, n.Easing.Power3 = n.Easing.Quartic.Out, n.Easing.Power4 = n.Easing.Quintic.Out, n.Time = function(t) {
            this.game = t, this.time = 0, this.prevTime = 0, this.now = 0, this.elapsed = 0, this.elapsedMS = 0, this.physicsElapsed = 1 / 60, this.physicsElapsedMS = 1 / 60 * 1e3, this.desiredFpsMult = 1 / 60, this._desiredFps = 60, this.suggestedFps = this.desiredFps, this.slowMotion = 1, this.advancedTiming = !1, this.frames = 0, this.fps = 0, this.fpsMin = 1e3, this.fpsMax = 0, this.msMin = 1e3, this.msMax = 0, this.pauseDuration = 0, this.timeToCall = 0, this.timeExpected = 0, this.events = new n.Timer(this.game, !1), this._frameCount = 0, this._elapsedAccumulator = 0, this._started = 0, this._timeLastSecond = 0, this._pauseStarted = 0, this._justResumed = !1, this._timers = []
        }, n.Time.prototype = {
            boot: function() {
                this._started = Date.now(), this.time = Date.now(), this.events.start(), this.timeExpected = this.time
            },
            add: function(t) {
                return this._timers.push(t), t
            },
            create: function(t) {
                void 0 === t && (t = !0);
                var e = new n.Timer(this.game, t);
                return this._timers.push(e), e
            },
            removeAll: function() {
                for (var t = 0; t < this._timers.length; t++) this._timers[t].destroy();
                this._timers = [], this.events.removeAll()
            },
            refresh: function() {
                var t = this.time;
                this.time = Date.now(), this.elapsedMS = this.time - t
            },
            update: function(t) {
                var e = this.time;
                this.time = Date.now(), this.elapsedMS = this.time - e, this.prevTime = this.now, this.now = t, this.elapsed = this.now - this.prevTime, this.game.raf._isSetTimeOut && (this.timeToCall = Math.floor(Math.max(0, 1e3 / this._desiredFps - (this.timeExpected - t))), this.timeExpected = t + this.timeToCall), this.advancedTiming && this.updateAdvancedTiming(), this.game.paused || (this.events.update(this.time), this._timers.length && this.updateTimers())
            },
            updateTimers: function() {
                for (var t = 0, e = this._timers.length; t < e;) this._timers[t].update(this.time) ? t++ : (this._timers.splice(t, 1), e--)
            },
            updateAdvancedTiming: function() {
                this._frameCount++, this._elapsedAccumulator += this.elapsed, this._frameCount >= 2 * this._desiredFps && (this.suggestedFps = 5 * Math.floor(200 / (this._elapsedAccumulator / this._frameCount)), this._frameCount = 0, this._elapsedAccumulator = 0), this.msMin = Math.min(this.msMin, this.elapsed), this.msMax = Math.max(this.msMax, this.elapsed), this.frames++, this.now > this._timeLastSecond + 1e3 && (this.fps = Math.round(1e3 * this.frames / (this.now - this._timeLastSecond)), this.fpsMin = Math.min(this.fpsMin, this.fps), this.fpsMax = Math.max(this.fpsMax, this.fps), this._timeLastSecond = this.now, this.frames = 0)
            },
            gamePaused: function() {
                this._pauseStarted = Date.now(), this.events.pause();
                for (var t = this._timers.length; t--;) this._timers[t]._pause()
            },
            gameResumed: function() {
                this.time = Date.now(), this.pauseDuration = this.time - this._pauseStarted, this.events.resume();
                for (var t = this._timers.length; t--;) this._timers[t]._resume()
            },
            totalElapsedSeconds: function() {
                return .001 * (this.time - this._started)
            },
            elapsedSince: function(t) {
                return this.time - t
            },
            elapsedSecondsSince: function(t) {
                return .001 * (this.time - t)
            },
            reset: function() {
                this._started = this.time, this.removeAll()
            }
        }, Object.defineProperty(n.Time.prototype, "desiredFps", {
            get: function() {
                return this._desiredFps
            },
            set: function(t) {
                this._desiredFps = t, this.physicsElapsed = 1 / t, this.physicsElapsedMS = 1e3 * this.physicsElapsed, this.desiredFpsMult = 1 / t
            }
        }), n.Time.prototype.constructor = n.Time, n.Timer = function(t, e) {
            void 0 === e && (e = !0), this.game = t, this.running = !1, this.autoDestroy = e, this.expired = !1, this.elapsed = 0, this.events = [], this.onComplete = new n.Signal, this.nextTick = 0, this.timeCap = 1e3, this.paused = !1, this._codePaused = !1, this._started = 0, this._pauseStarted = 0, this._pauseTotal = 0, this._now = Date.now(), this._len = 0, this._marked = 0, this._i = 0, this._diff = 0, this._newTick = 0
        }, n.Timer.MINUTE = 6e4, n.Timer.SECOND = 1e3, n.Timer.HALF = 500, n.Timer.QUARTER = 250, n.Timer.prototype = {
            create: function(t, e, i, s, o, r) {
                var a = t = Math.round(t);
                0 === this._now ? a += this.game.time.time : a += this._now;
                var h = new n.TimerEvent(this, t, a, i, e, s, o, r);
                return this.events.push(h), this.order(), this.expired = !1, h
            },
            add: function(t, e, i) {
                return this.create(t, !1, 0, e, i, Array.prototype.slice.call(arguments, 3))
            },
            repeat: function(t, e, i, s) {
                return this.create(t, !1, e, i, s, Array.prototype.slice.call(arguments, 4))
            },
            loop: function(t, e, i) {
                return this.create(t, !0, 0, e, i, Array.prototype.slice.call(arguments, 3))
            },
            start: function(t) {
                if (!this.running) {
                    this._started = this.game.time.time + (t || 0), this.running = !0;
                    for (var e = 0; e < this.events.length; e++) this.events[e].tick = this.events[e].delay + this._started
                }
            },
            stop: function(t) {
                this.running = !1, void 0 === t && (t = !0), t && (this.events.length = 0)
            },
            remove: function(t) {
                for (var e = 0; e < this.events.length; e++)
                    if (this.events[e] === t) return this.events[e].pendingDelete = !0, !0;
                return !1
            },
            order: function() {
                this.events.length > 0 && (this.events.sort(this.sortHandler), this.nextTick = this.events[0].tick)
            },
            sortHandler: function(t, e) {
                return t.tick < e.tick ? -1 : t.tick > e.tick ? 1 : 0
            },
            clearPendingEvents: function() {
                for (this._i = this.events.length; this._i--;) this.events[this._i].pendingDelete && this.events.splice(this._i, 1);
                this._len = this.events.length, this._i = 0
            },
            update: function(t) {
                if (this.paused) return !0;
                if (this.elapsed = t - this._now, this._now = t, this.elapsed > this.timeCap && this.adjustEvents(t - this.elapsed), this._marked = 0, this.clearPendingEvents(), this.running && this._now >= this.nextTick && this._len > 0) {
                    for (; this._i < this._len && this.running && this._now >= this.events[this._i].tick && !this.events[this._i].pendingDelete;) this._newTick = this._now + this.events[this._i].delay - (this._now - this.events[this._i].tick), this._newTick < 0 && (this._newTick = this._now + this.events[this._i].delay), !0 === this.events[this._i].loop ? (this.events[this._i].tick = this._newTick, this.events[this._i].callback.apply(this.events[this._i].callbackContext, this.events[this._i].args)) : this.events[this._i].repeatCount > 0 ? (this.events[this._i].repeatCount--, this.events[this._i].tick = this._newTick, this.events[this._i].callback.apply(this.events[this._i].callbackContext, this.events[this._i].args)) : (this._marked++, this.events[this._i].pendingDelete = !0, this.events[this._i].callback.apply(this.events[this._i].callbackContext, this.events[this._i].args)), this._i++;
                    this.events.length > this._marked ? this.order() : (this.expired = !0, this.onComplete.dispatch(this))
                }
                return !this.expired || !this.autoDestroy
            },
            pause: function() {
                this.running && (this._codePaused = !0, this.paused || (this._pauseStarted = this.game.time.time, this.paused = !0))
            },
            _pause: function() {
                !this.paused && this.running && (this._pauseStarted = this.game.time.time, this.paused = !0)
            },
            adjustEvents: function(t) {
                for (var e = 0; e < this.events.length; e++)
                    if (!this.events[e].pendingDelete) {
                        var i = this.events[e].tick - t;
                        i < 0 && (i = 0), this.events[e].tick = this._now + i
                    } var s = this.nextTick - t;
                this.nextTick = s < 0 ? this._now : this._now + s
            },
            resume: function() {
                if (this.paused) {
                    var t = this.game.time.time;
                    this._pauseTotal += t - this._now, this._now = t, this.adjustEvents(this._pauseStarted), this.paused = !1, this._codePaused = !1
                }
            },
            _resume: function() {
                this._codePaused || this.resume()
            },
            removeAll: function() {
                this.onComplete.removeAll(), this.events.length = 0, this._len = 0, this._i = 0
            },
            destroy: function() {
                this.onComplete.removeAll(), this.running = !1, this.events = [], this._len = 0, this._i = 0
            }
        }, Object.defineProperty(n.Timer.prototype, "next", {
            get: function() {
                return this.nextTick
            }
        }), Object.defineProperty(n.Timer.prototype, "duration", {
            get: function() {
                return this.running && this.nextTick > this._now ? this.nextTick - this._now : 0
            }
        }), Object.defineProperty(n.Timer.prototype, "length", {
            get: function() {
                return this.events.length
            }
        }), Object.defineProperty(n.Timer.prototype, "ms", {
            get: function() {
                return this.running ? this._now - this._started - this._pauseTotal : 0
            }
        }), Object.defineProperty(n.Timer.prototype, "seconds", {
            get: function() {
                return this.running ? .001 * this.ms : 0
            }
        }), n.Timer.prototype.constructor = n.Timer, n.TimerEvent = function(t, e, i, s, n, o, r, a) {
            this.timer = t, this.delay = e, this.tick = i, this.repeatCount = s - 1, this.loop = n, this.callback = o, this.callbackContext = r, this.args = a, this.pendingDelete = !1
        }, n.TimerEvent.prototype.constructor = n.TimerEvent, n.AnimationManager = function(t) {
            this.sprite = t, this.game = t.game, this.currentFrame = null, this.currentAnim = null, this.updateIfVisible = !0, this.isLoaded = !1, this._frameData = null, this._anims = {}, this._outputFrames = []
        }, n.AnimationManager.prototype = {
            loadFrameData: function(t, e) {
                if (void 0 === t) return !1;
                if (this.isLoaded)
                    for (var i in this._anims) this._anims[i].updateFrameData(t);
                return this._frameData = t, null == e ? this.frame = 0 : "string" == typeof e ? this.frameName = e : this.frame = e, this.isLoaded = !0, !0
            },
            copyFrameData: function(t, e) {
                if (this._frameData = t.clone(), this.isLoaded)
                    for (var i in this._anims) this._anims[i].updateFrameData(this._frameData);
                return null == e ? this.frame = 0 : "string" == typeof e ? this.frameName = e : this.frame = e, this.isLoaded = !0, !0
            },
            add: function(t, e, i, s, o) {
                return e = e || [], i = i || 60, void 0 === s && (s = !1), void 0 === o && (o = !(!e || "number" != typeof e[0])), this._outputFrames = [], this._frameData.getFrameIndexes(e, o, this._outputFrames), this._anims[t] = new n.Animation(this.game, this.sprite, t, this._frameData, this._outputFrames, i, s), this.currentAnim = this._anims[t], this.sprite.tilingTexture && (this.sprite.refreshTexture = !0), this._anims[t]
            },
            validateFrames: function(t, e) {
                void 0 === e && (e = !0);
                for (var i = 0; i < t.length; i++)
                    if (!0 === e) {
                        if (t[i] > this._frameData.total) return !1
                    } else if (!1 === this._frameData.checkFrameName(t[i])) return !1;
                return !0
            },
            play: function(t, e, i, s) {
                if (this._anims[t]) return this.currentAnim === this._anims[t] ? !1 === this.currentAnim.isPlaying ? (this.currentAnim.paused = !1, this.currentAnim.play(e, i, s)) : this.currentAnim : (this.currentAnim && this.currentAnim.isPlaying && this.currentAnim.stop(), this.currentAnim = this._anims[t], this.currentAnim.paused = !1, this.currentFrame = this.currentAnim.currentFrame, this.currentAnim.play(e, i, s))
            },
            stop: function(t, e) {
                void 0 === e && (e = !1), !this.currentAnim || "string" == typeof t && t !== this.currentAnim.name || this.currentAnim.stop(e)
            },
            update: function() {
                return !(this.updateIfVisible && !this.sprite.visible || !this.currentAnim || !this.currentAnim.update() || (this.currentFrame = this.currentAnim.currentFrame, 0))
            },
            next: function(t) {
                this.currentAnim && (this.currentAnim.next(t), this.currentFrame = this.currentAnim.currentFrame)
            },
            previous: function(t) {
                this.currentAnim && (this.currentAnim.previous(t), this.currentFrame = this.currentAnim.currentFrame)
            },
            getAnimation: function(t) {
                return "string" == typeof t && this._anims[t] ? this._anims[t] : null
            },
            refreshFrame: function() {},
            destroy: function() {
                var t = null;
                for (var t in this._anims) this._anims.hasOwnProperty(t) && this._anims[t].destroy();
                this._anims = {}, this._outputFrames = [], this._frameData = null, this.currentAnim = null, this.currentFrame = null, this.sprite = null, this.game = null
            }
        }, n.AnimationManager.prototype.constructor = n.AnimationManager, Object.defineProperty(n.AnimationManager.prototype, "frameData", {
            get: function() {
                return this._frameData
            }
        }), Object.defineProperty(n.AnimationManager.prototype, "frameTotal", {
            get: function() {
                return this._frameData.total
            }
        }), Object.defineProperty(n.AnimationManager.prototype, "paused", {
            get: function() {
                return this.currentAnim.isPaused
            },
            set: function(t) {
                this.currentAnim.paused = t
            }
        }), Object.defineProperty(n.AnimationManager.prototype, "name", {
            get: function() {
                if (this.currentAnim) return this.currentAnim.name
            }
        }), Object.defineProperty(n.AnimationManager.prototype, "frame", {
            get: function() {
                if (this.currentFrame) return this.currentFrame.index
            },
            set: function(t) {
                "number" == typeof t && this._frameData && null !== this._frameData.getFrame(t) && (this.currentFrame = this._frameData.getFrame(t), this.currentFrame && this.sprite.setFrame(this.currentFrame))
            }
        }), Object.defineProperty(n.AnimationManager.prototype, "frameName", {
            get: function() {
                if (this.currentFrame) return this.currentFrame.name
            },
            set: function(t) {
                "string" == typeof t && this._frameData && null !== this._frameData.getFrameByName(t) ? (this.currentFrame = this._frameData.getFrameByName(t), this.currentFrame && (this._frameIndex = this.currentFrame.index, this.sprite.setFrame(this.currentFrame))) : console.warn("Cannot set frameName: " + t)
            }
        }), n.Animation = function(t, e, i, s, o, r, a) {
            void 0 === a && (a = !1), this.game = t, this._parent = e, this._frameData = s, this.name = i, this._frames = [], this._frames = this._frames.concat(o), this.delay = 1e3 / r, this.loop = a, this.loopCount = 0, this.killOnComplete = !1, this.isFinished = !1, this.isPlaying = !1, this.isPaused = !1, this._pauseStartTime = 0, this._frameIndex = 0, this._frameDiff = 0, this._frameSkip = 1, this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this.onStart = new n.Signal, this.onUpdate = null, this.onComplete = new n.Signal, this.onLoop = new n.Signal, this.isReversed = !1, this.game.onPause.add(this.onPause, this), this.game.onResume.add(this.onResume, this)
        }, n.Animation.prototype = {
            play: function(t, e, i) {
                return "number" == typeof t && (this.delay = 1e3 / t), "boolean" == typeof e && (this.loop = e), void 0 !== i && (this.killOnComplete = i), this.isPlaying = !0, this.isFinished = !1, this.paused = !1, this.loopCount = 0, this._timeLastFrame = this.game.time.time, this._timeNextFrame = this.game.time.time + this.delay, this._frameIndex = this.isReversed ? this._frames.length - 1 : 0, this.updateCurrentFrame(!1, !0), this._parent.events.onAnimationStart$dispatch(this._parent, this), this.onStart.dispatch(this._parent, this), this._parent.animations.currentAnim = this, this._parent.animations.currentFrame = this.currentFrame, this
            },
            restart: function() {
                this.isPlaying = !0, this.isFinished = !1, this.paused = !1, this.loopCount = 0, this._timeLastFrame = this.game.time.time, this._timeNextFrame = this.game.time.time + this.delay, this._frameIndex = 0, this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this._parent.setFrame(this.currentFrame), this._parent.animations.currentAnim = this, this._parent.animations.currentFrame = this.currentFrame, this.onStart.dispatch(this._parent, this)
            },
            reverse: function() {
                return this.reversed = !this.reversed, this
            },
            reverseOnce: function() {
                return this.onComplete.addOnce(this.reverse, this), this.reverse()
            },
            setFrame: function(t, e) {
                var i;
                if (void 0 === e && (e = !1), "string" == typeof t)
                    for (var s = 0; s < this._frames.length; s++) this._frameData.getFrame(this._frames[s]).name === t && (i = s);
                else if ("number" == typeof t)
                    if (e) i = t;
                    else
                        for (s = 0; s < this._frames.length; s++) this._frames[s] === t && (i = s);
                if (i) {
                    var n = this.isReversed ? -1 : 1;
                    this._frameIndex = i - n, this._timeNextFrame = this.game.time.time, this.update()
                }
            },
            stop: function(t, e) {
                void 0 === t && (t = !1), void 0 === e && (e = !1), this.isPlaying = !1, this.isFinished = !0, this.paused = !1, t && (this.currentFrame = this._frameData.getFrame(this._frames[0]), this._parent.setFrame(this.currentFrame)), e && (this._parent.events.onAnimationComplete$dispatch(this._parent, this), this.onComplete.dispatch(this._parent, this))
            },
            onPause: function() {
                this.isPlaying && (this._frameDiff = this._timeNextFrame - this.game.time.time)
            },
            onResume: function() {
                this.isPlaying && (this._timeNextFrame = this.game.time.time + this._frameDiff)
            },
            update: function() {
                return !this.isPaused && !!(this.isPlaying && this.game.time.time >= this._timeNextFrame) && (this._frameSkip = 1, this._frameDiff = this.game.time.time - this._timeNextFrame, this._timeLastFrame = this.game.time.time, this._frameDiff > this.delay && (this._frameSkip = Math.floor(this._frameDiff / this.delay), this._frameDiff -= this._frameSkip * this.delay), this._timeNextFrame = this.game.time.time + (this.delay - this._frameDiff), this.isReversed ? this._frameIndex -= this._frameSkip : this._frameIndex += this._frameSkip, !this.isReversed && this._frameIndex >= this._frames.length || this.isReversed && this._frameIndex <= -1 ? this.loop ? (this._frameIndex = Math.abs(this._frameIndex) % this._frames.length, this.isReversed && (this._frameIndex = this._frames.length - 1 - this._frameIndex), this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this.currentFrame && this._parent.setFrame(this.currentFrame), this.loopCount++, this._parent.events.onAnimationLoop$dispatch(this._parent, this), this.onLoop.dispatch(this._parent, this), !this.onUpdate || (this.onUpdate.dispatch(this, this.currentFrame), !!this._frameData)) : (this.complete(), !1) : this.updateCurrentFrame(!0))
            },
            updateCurrentFrame: function(t, e) {
                if (void 0 === e && (e = !1), !this._frameData) return !1;
                var i = this.currentFrame.index;
                return this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this.currentFrame && (e || !e && i !== this.currentFrame.index) && this._parent.setFrame(this.currentFrame), !this.onUpdate || !t || (this.onUpdate.dispatch(this, this.currentFrame), !!this._frameData)
            },
            next: function(t) {
                void 0 === t && (t = 1);
                var e = this._frameIndex + t;
                e >= this._frames.length && (this.loop ? e %= this._frames.length : e = this._frames.length - 1), e !== this._frameIndex && (this._frameIndex = e, this.updateCurrentFrame(!0))
            },
            previous: function(t) {
                void 0 === t && (t = 1);
                var e = this._frameIndex - t;
                e < 0 && (this.loop ? e = this._frames.length + e : e++), e !== this._frameIndex && (this._frameIndex = e, this.updateCurrentFrame(!0))
            },
            updateFrameData: function(t) {
                this._frameData = t, this.currentFrame = this._frameData ? this._frameData.getFrame(this._frames[this._frameIndex % this._frames.length]) : null
            },
            destroy: function() {
                this._frameData && (this.game.onPause.remove(this.onPause, this), this.game.onResume.remove(this.onResume, this), this.game = null, this._parent = null, this._frames = null, this._frameData = null, this.currentFrame = null, this.isPlaying = !1, this.onStart.dispose(), this.onLoop.dispose(), this.onComplete.dispose(), this.onUpdate && this.onUpdate.dispose())
            },
            complete: function() {
                this._frameIndex = this._frames.length - 1, this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this.isPlaying = !1, this.isFinished = !0, this.paused = !1, this._parent.events.onAnimationComplete$dispatch(this._parent, this), this.onComplete.dispatch(this._parent, this), this.killOnComplete && this._parent.kill()
            }
        }, n.Animation.prototype.constructor = n.Animation, Object.defineProperty(n.Animation.prototype, "paused", {
            get: function() {
                return this.isPaused
            },
            set: function(t) {
                this.isPaused = t, t ? this._pauseStartTime = this.game.time.time : this.isPlaying && (this._timeNextFrame = this.game.time.time + this.delay)
            }
        }), Object.defineProperty(n.Animation.prototype, "reversed", {
            get: function() {
                return this.isReversed
            },
            set: function(t) {
                this.isReversed = t
            }
        }), Object.defineProperty(n.Animation.prototype, "frameTotal", {
            get: function() {
                return this._frames.length
            }
        }), Object.defineProperty(n.Animation.prototype, "frame", {
            get: function() {
                return null !== this.currentFrame ? this.currentFrame.index : this._frameIndex
            },
            set: function(t) {
                this.currentFrame = this._frameData.getFrame(this._frames[t]), null !== this.currentFrame && (this._frameIndex = t, this._parent.setFrame(this.currentFrame), this.onUpdate && this.onUpdate.dispatch(this, this.currentFrame))
            }
        }), Object.defineProperty(n.Animation.prototype, "speed", {
            get: function() {
                return 1e3 / this.delay
            },
            set: function(t) {
                t > 0 && (this.delay = 1e3 / t)
            }
        }), Object.defineProperty(n.Animation.prototype, "enableUpdate", {
            get: function() {
                return null !== this.onUpdate
            },
            set: function(t) {
                t && null === this.onUpdate ? this.onUpdate = new n.Signal : t || null === this.onUpdate || (this.onUpdate.dispose(), this.onUpdate = null)
            }
        }), n.Animation.generateFrameNames = function(t, e, i, s, o) {
            void 0 === s && (s = "");
            var r = [],
                a = "";
            if (e < i)
                for (var h = e; h <= i; h++) a = t + (a = "number" == typeof o ? n.Utils.pad(h.toString(), o, "0", 1) : h.toString()) + s, r.push(a);
            else
                for (h = e; h >= i; h--) a = t + (a = "number" == typeof o ? n.Utils.pad(h.toString(), o, "0", 1) : h.toString()) + s, r.push(a);
            return r
        }, n.Frame = function(t, e, i, s, o, r) {
            this.index = t, this.x = e, this.y = i, this.width = s, this.height = o, this.name = r, this.centerX = Math.floor(s / 2), this.centerY = Math.floor(o / 2), this.distance = n.Math.distance(0, 0, s, o), this.rotated = !1, this.trimmed = !1, this.sourceSizeW = s, this.sourceSizeH = o, this.spriteSourceSizeX = 0, this.spriteSourceSizeY = 0, this.spriteSourceSizeW = 0, this.spriteSourceSizeH = 0, this.right = this.x + this.width, this.bottom = this.y + this.height
        }, n.Frame.prototype = {
            resize: function(t, e) {
                this.width = t, this.height = e, this.centerX = Math.floor(t / 2), this.centerY = Math.floor(e / 2), this.distance = n.Math.distance(0, 0, t, e), this.sourceSizeW = t, this.sourceSizeH = e, this.right = this.x + t, this.bottom = this.y + e
            },
            setTrim: function(t, e, i, s, n, o, r) {
                this.trimmed = t, t && (this.sourceSizeW = e, this.sourceSizeH = i, this.centerX = Math.floor(e / 2), this.centerY = Math.floor(i / 2), this.spriteSourceSizeX = s, this.spriteSourceSizeY = n, this.spriteSourceSizeW = o, this.spriteSourceSizeH = r)
            },
            clone: function() {
                var t = new n.Frame(this.index, this.x, this.y, this.width, this.height, this.name);
                for (var e in this) this.hasOwnProperty(e) && (t[e] = this[e]);
                return t
            },
            getRect: function(t) {
                return void 0 === t ? t = new n.Rectangle(this.x, this.y, this.width, this.height) : t.setTo(this.x, this.y, this.width, this.height), t
            }
        }, n.Frame.prototype.constructor = n.Frame, n.FrameData = function() {
            this._frames = [], this._frameNames = []
        }, n.FrameData.prototype = {
            addFrame: function(t) {
                return t.index = this._frames.length, this._frames.push(t), "" !== t.name && (this._frameNames[t.name] = t.index), t
            },
            getFrame: function(t) {
                return t >= this._frames.length && (t = 0), this._frames[t]
            },
            getFrameByName: function(t) {
                return "number" == typeof this._frameNames[t] ? this._frames[this._frameNames[t]] : null
            },
            checkFrameName: function(t) {
                return null != this._frameNames[t]
            },
            clone: function() {
                for (var t = new n.FrameData, e = 0; e < this._frames.length; e++) t._frames.push(this._frames[e].clone());
                for (var i in this._frameNames) this._frameNames.hasOwnProperty(i) && t._frameNames.push(this._frameNames[i]);
                return t
            },
            getFrameRange: function(t, e, i) {
                void 0 === i && (i = []);
                for (var s = t; s <= e; s++) i.push(this._frames[s]);
                return i
            },
            getFrames: function(t, e, i) {
                if (void 0 === e && (e = !0), void 0 === i && (i = []), void 0 === t || 0 === t.length)
                    for (var s = 0; s < this._frames.length; s++) i.push(this._frames[s]);
                else
                    for (s = 0; s < t.length; s++) e ? i.push(this.getFrame(t[s])) : i.push(this.getFrameByName(t[s]));
                return i
            },
            getFrameIndexes: function(t, e, i) {
                if (void 0 === e && (e = !0), void 0 === i && (i = []), void 0 === t || 0 === t.length)
                    for (var s = 0; s < this._frames.length; s++) i.push(this._frames[s].index);
                else
                    for (s = 0; s < t.length; s++) e && this._frames[t[s]] ? i.push(this._frames[t[s]].index) : this.getFrameByName(t[s]) && i.push(this.getFrameByName(t[s]).index);
                return i
            },
            destroy: function() {
                this._frames = null, this._frameNames = null
            }
        }, n.FrameData.prototype.constructor = n.FrameData, Object.defineProperty(n.FrameData.prototype, "total", {
            get: function() {
                return this._frames.length
            }
        }), n.AnimationParser = {
            spriteSheet: function(t, e, i, s, o, r, a, h) {
                void 0 === o && (o = -1), void 0 === r && (r = 0), void 0 === a && (a = 0), void 0 === h && (h = 0);
                var l = e;
                if ("string" == typeof e && (l = t.cache.getImage(e)), null === l) return null;
                var c = l.width,
                    u = l.height;
                i <= 0 && (i = Math.floor(-c / Math.min(-1, i))), s <= 0 && (s = Math.floor(-u / Math.min(-1, s)));
                var d = Math.floor((c - r) / (i + a)) * Math.floor((u - r) / (s + a));
                if (h > d || h < -d) return console.warn("Phaser.AnimationParser.spriteSheet: skipFrames = " + h.toString() + " is larger than total sprite number " + d.toString()), null;
                if (h < 0 && (h = d + h), -1 !== o && (d = h + o), 0 === c || 0 === u || c < i || u < s || 0 === d) return console.warn("Phaser.AnimationParser.spriteSheet: '" + e + "'s width/height zero or width/height < given frameWidth/frameHeight"), null;
                for (var p = new n.FrameData, f = r, m = r, g = 0; g < d; g++) p.addFrame(new n.Frame(g, f, m, i, s, "")), (f += i + a) + i > c && (f = r, m += s + a);
                return p
            },
            JSONData: function(t, e) {
                if (!e.frames) return console.warn("Phaser.AnimationParser.JSONData: Invalid Texture Atlas JSON given, missing 'frames' array"), void console.log(e);
                for (var i, s = new n.FrameData, o = e.frames, r = 0; r < o.length; r++) i = s.addFrame(new n.Frame(r, o[r].frame.x, o[r].frame.y, o[r].frame.w, o[r].frame.h, o[r].filename)), o[r].trimmed && i.setTrim(o[r].trimmed, o[r].sourceSize.w, o[r].sourceSize.h, o[r].spriteSourceSize.x, o[r].spriteSourceSize.y, o[r].spriteSourceSize.w, o[r].spriteSourceSize.h), o[r].rotated && (i.rotated = !0);
                return s
            },
            JSONDataPyxel: function(t, e) {
                if (["layers", "tilewidth", "tileheight", "tileswide", "tileshigh"].forEach(function(t) {
                        if (!e[t]) return console.warn('Phaser.AnimationParser.JSONDataPyxel: Invalid Pyxel Tilemap JSON given, missing "' + t + '" key.'), void console.log(e)
                    }), 1 !== e.layers.length) return console.warn("Phaser.AnimationParser.JSONDataPyxel: Too many layers, this parser only supports flat Tilemaps."), void console.log(e);
                for (var i = new n.FrameData, s = e.tileheight, o = e.tilewidth, r = e.layers[0].tiles, a = 0; a < r.length; a++) i.addFrame(new n.Frame(a, r[a].x, r[a].y, o, s, "frame_" + a)).setTrim(!1);
                return i
            },
            JSONDataHash: function(t, e) {
                if (!e.frames) return console.warn("Phaser.AnimationParser.JSONDataHash: Invalid Texture Atlas JSON given, missing 'frames' object"), void console.log(e);
                var i, s = new n.FrameData,
                    o = e.frames,
                    r = 0;
                for (var a in o) i = s.addFrame(new n.Frame(r, o[a].frame.x, o[a].frame.y, o[a].frame.w, o[a].frame.h, a)), o[a].trimmed && i.setTrim(o[a].trimmed, o[a].sourceSize.w, o[a].sourceSize.h, o[a].spriteSourceSize.x, o[a].spriteSourceSize.y, o[a].spriteSourceSize.w, o[a].spriteSourceSize.h), o[a].rotated && (i.rotated = !0), r++;
                return s
            },
            XMLData: function(t, e) {
                if (e.getElementsByTagName("TextureAtlas")) {
                    for (var i, s, o, r, a, h, l, c, u, d, p, f = new n.FrameData, m = e.getElementsByTagName("SubTexture"), g = 0; g < m.length; g++) s = (o = m[g].attributes).name.value, r = parseInt(o.x.value, 10), a = parseInt(o.y.value, 10), h = parseInt(o.width.value, 10), l = parseInt(o.height.value, 10), c = null, u = null, o.frameX && (c = Math.abs(parseInt(o.frameX.value, 10)), u = Math.abs(parseInt(o.frameY.value, 10)), d = parseInt(o.frameWidth.value, 10), p = parseInt(o.frameHeight.value, 10)), i = f.addFrame(new n.Frame(g, r, a, h, l, s)), null === c && null === u || i.setTrim(!0, h, l, c, u, d, p);
                    return f
                }
                console.warn("Phaser.AnimationParser.XMLData: Invalid Texture Atlas XML given, missing <TextureAtlas> tag")
            }
        }, n.Cache = function(t) {
            this.game = t, this.autoResolveURL = !1, this._cache = {
                canvas: {},
                image: {},
                texture: {},
                sound: {},
                video: {},
                text: {},
                json: {},
                xml: {},
                physics: {},
                tilemap: {},
                binary: {},
                bitmapData: {},
                bitmapFont: {},
                shader: {},
                renderTexture: {},
                compressedTexture: {}
            }, this._urlMap = {}, this._urlResolver = new Image, this._urlTemp = null, this.onSoundUnlock = new n.Signal, this._cacheMap = [], this._cacheMap[n.Cache.CANVAS] = this._cache.canvas, this._cacheMap[n.Cache.IMAGE] = this._cache.image, this._cacheMap[n.Cache.TEXTURE] = this._cache.texture, this._cacheMap[n.Cache.SOUND] = this._cache.sound, this._cacheMap[n.Cache.TEXT] = this._cache.text, this._cacheMap[n.Cache.PHYSICS] = this._cache.physics, this._cacheMap[n.Cache.TILEMAP] = this._cache.tilemap, this._cacheMap[n.Cache.BINARY] = this._cache.binary, this._cacheMap[n.Cache.BITMAPDATA] = this._cache.bitmapData, this._cacheMap[n.Cache.BITMAPFONT] = this._cache.bitmapFont, this._cacheMap[n.Cache.JSON] = this._cache.json, this._cacheMap[n.Cache.XML] = this._cache.xml, this._cacheMap[n.Cache.VIDEO] = this._cache.video, this._cacheMap[n.Cache.SHADER] = this._cache.shader, this._cacheMap[n.Cache.RENDER_TEXTURE] = this._cache.renderTexture, this.addDefaultImage(), this.addMissingImage()
        }, n.Cache.CANVAS = 1, n.Cache.IMAGE = 2, n.Cache.TEXTURE = 3, n.Cache.SOUND = 4, n.Cache.TEXT = 5, n.Cache.PHYSICS = 6, n.Cache.TILEMAP = 7, n.Cache.BINARY = 8, n.Cache.BITMAPDATA = 9, n.Cache.BITMAPFONT = 10, n.Cache.JSON = 11, n.Cache.XML = 12, n.Cache.VIDEO = 13, n.Cache.SHADER = 14, n.Cache.RENDER_TEXTURE = 15, n.Cache.DEFAULT = null, n.Cache.MISSING = null, n.Cache.prototype = {
            addCompressedTextureMetaData: function(t, e, i, s) {
                this.checkImageKey(t) && this.removeImage(t);
                var o = i in n.LoaderParser ? n.LoaderParser[i](s) : s,
                    r = {
                        key: t,
                        url: e,
                        data: o,
                        base: new PIXI.BaseTexture(o, null, this.game.resolution),
                        frame: new n.Frame(0, 0, 0, o.width, o.height, t),
                        frameData: new n.FrameData,
                        fileFormat: i
                    };
                return r.frameData.addFrame(new n.Frame(0, 0, 0, o.width, o.height, e)), this._cache.image[t] = r, this._resolveURL(e, r), r
            },
            addCanvas: function(t, e, i) {
                void 0 === i && (i = e.getContext("2d")), this._cache.canvas[t] = {
                    canvas: e,
                    context: i
                }
            },
            addImage: function(t, e, i) {
                this.checkImageKey(t) && this.removeImage(t);
                var s = {
                    key: t,
                    url: e,
                    data: i,
                    base: new PIXI.BaseTexture(i, null, this.game.resolution),
                    frame: new n.Frame(0, 0, 0, i.width, i.height, t),
                    frameData: new n.FrameData
                };
                return s.frameData.addFrame(new n.Frame(0, 0, 0, i.width, i.height, e)), this._cache.image[t] = s, this._resolveURL(e, s), "__default" === t ? n.Cache.DEFAULT = new PIXI.Texture(s.base) : "__missing" === t && (n.Cache.MISSING = new PIXI.Texture(s.base)), s
            },
            addDefaultImage: function() {
                var t = new Image;
                t.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==";
                var e = this.addImage("__default", null, t);
                e.base.skipRender = !0, n.Cache.DEFAULT = new PIXI.Texture(e.base)
            },
            addMissingImage: function() {
                var t = new Image;
                t.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==";
                var e = this.addImage("__missing", null, t);
                n.Cache.MISSING = new PIXI.Texture(e.base)
            },
            addSound: function(t, e, i, s, n) {
                void 0 === s && (s = !0, n = !1), void 0 === n && (s = !1, n = !0);
                var o = !1;
                n && (o = !0), this._cache.sound[t] = {
                    url: e,
                    data: i,
                    isDecoding: !1,
                    decoded: o,
                    webAudio: s,
                    audioTag: n,
                    locked: this.game.sound.touchLocked
                }, this._resolveURL(e, this._cache.sound[t])
            },
            addText: function(t, e, i) {
                this._cache.text[t] = {
                    url: e,
                    data: i
                }, this._resolveURL(e, this._cache.text[t])
            },
            addPhysicsData: function(t, e, i, s) {
                this._cache.physics[t] = {
                    url: e,
                    data: i,
                    format: s
                }, this._resolveURL(e, this._cache.physics[t])
            },
            addTilemap: function(t, e, i, s) {
                this._cache.tilemap[t] = {
                    url: e,
                    data: i,
                    format: s
                }, this._resolveURL(e, this._cache.tilemap[t])
            },
            addBinary: function(t, e) {
                this._cache.binary[t] = e
            },
            addBitmapData: function(t, e, i) {
                return e.key = t, void 0 === i && (i = new n.FrameData).addFrame(e.textureFrame), this._cache.bitmapData[t] = {
                    data: e,
                    frameData: i
                }, e
            },
            addBitmapFont: function(t, e, i, s, o, r, a) {
                var h = {
                    url: e,
                    data: i,
                    font: null,
                    base: new PIXI.BaseTexture(i, null, this.game.resolution)
                };
                void 0 === r && (r = 0), void 0 === a && (a = 0), h.font = "json" === o ? n.LoaderParser.jsonBitmapFont(s, h.base, r, a, !1, this.game.resolution) : n.LoaderParser.xmlBitmapFont(s, h.base, r, a, !1, this.game.resolution), this._cache.bitmapFont[t] = h, this._resolveURL(e, h)
            },
            addBitmapFontFromAtlas: function(t, e, i, s, o, r, a) {
                var h = this.getFrameByName(e, i);
                if (h) {
                    var l, c = {
                        font: null,
                        base: this.getBaseTexture(e),
                        frame: h
                    };
                    void 0 === r && (r = 0), void 0 === a && (a = 0), "json" === o ? (l = this.getJSON(s), c.font = n.LoaderParser.jsonBitmapFont(l, c.base, r, a, h, this.game.resolution)) : (l = this.getXML(s), c.font = n.LoaderParser.xmlBitmapFont(l, c.base, r, a, h, this.game.resolution)), this._cache.bitmapFont[t] = c
                }
            },
            addJSON: function(t, e, i) {
                this._cache.json[t] = {
                    url: e,
                    data: i
                }, this._resolveURL(e, this._cache.json[t])
            },
            addXML: function(t, e, i) {
                this._cache.xml[t] = {
                    url: e,
                    data: i
                }, this._resolveURL(e, this._cache.xml[t])
            },
            addVideo: function(t, e, i, s) {
                this._cache.video[t] = {
                    url: e,
                    data: i,
                    isBlob: s,
                    locked: !0
                }, this._resolveURL(e, this._cache.video[t])
            },
            addShader: function(t, e, i) {
                this._cache.shader[t] = {
                    url: e,
                    data: i
                }, this._resolveURL(e, this._cache.shader[t])
            },
            addRenderTexture: function(t, e) {
                this._cache.renderTexture[t] = {
                    texture: e,
                    frame: new n.Frame(0, 0, 0, e.width, e.height, "", "")
                }
            },
            addSpriteSheet: function(t, e, i, s, o, r, a, h, l) {
                void 0 === r && (r = -1), void 0 === a && (a = 0), void 0 === h && (h = 0);
                var c = {
                    key: t,
                    url: e,
                    data: i,
                    frameWidth: s,
                    frameHeight: o,
                    margin: a,
                    spacing: h,
                    base: new PIXI.BaseTexture(i, null, this.game.resolution),
                    frameData: n.AnimationParser.spriteSheet(this.game, i, s, o, r, a, h, l)
                };
                this._cache.image[t] = c, this._resolveURL(e, c)
            },
            addTextureAtlas: function(t, e, i, s, o) {
                var r = {
                    key: t,
                    url: e,
                    data: i,
                    base: new PIXI.BaseTexture(i, null, this.game.resolution)
                };
                o === n.Loader.TEXTURE_ATLAS_XML_STARLING ? r.frameData = n.AnimationParser.XMLData(this.game, s, t) : o === n.Loader.TEXTURE_ATLAS_JSON_PYXEL ? r.frameData = n.AnimationParser.JSONDataPyxel(this.game, s, t) : Array.isArray(s.frames) ? r.frameData = n.AnimationParser.JSONData(this.game, s, t) : r.frameData = n.AnimationParser.JSONDataHash(this.game, s, t), this._cache.image[t] = r, this._resolveURL(e, r)
            },
            reloadSound: function(t) {
                var e = this,
                    i = this.getSound(t);
                i && (i.data.src = i.url, i.data.addEventListener("canplaythrough", function() {
                    return e.reloadSoundComplete(t)
                }, !1), i.data.load())
            },
            reloadSoundComplete: function(t) {
                var e = this.getSound(t);
                e && (e.locked = !1, this.onSoundUnlock.dispatch(t))
            },
            updateSound: function(t, e, i) {
                var s = this.getSound(t);
                s && (s[e] = i)
            },
            decodedSound: function(t, e) {
                var i = this.getSound(t);
                i.data = e, i.decoded = !0, i.isDecoding = !1
            },
            isSoundDecoded: function(t) {
                var e = this.getItem(t, n.Cache.SOUND, "isSoundDecoded");
                if (e) return e.decoded
            },
            isSoundReady: function(t) {
                var e = this.getItem(t, n.Cache.SOUND, "isSoundDecoded");
                if (e) return e.decoded && !this.game.sound.touchLocked
            },
            checkKey: function(t, e) {
                return !!this._cacheMap[t][e]
            },
            checkURL: function(t) {
                return !!this._urlMap[this._resolveURL(t)]
            },
            checkCanvasKey: function(t) {
                return this.checkKey(n.Cache.CANVAS, t)
            },
            checkImageKey: function(t) {
                return this.checkKey(n.Cache.IMAGE, t)
            },
            checkTextureKey: function(t) {
                return this.checkKey(n.Cache.TEXTURE, t)
            },
            checkSoundKey: function(t) {
                return this.checkKey(n.Cache.SOUND, t)
            },
            checkTextKey: function(t) {
                return this.checkKey(n.Cache.TEXT, t)
            },
            checkPhysicsKey: function(t) {
                return this.checkKey(n.Cache.PHYSICS, t)
            },
            checkTilemapKey: function(t) {
                return this.checkKey(n.Cache.TILEMAP, t)
            },
            checkBinaryKey: function(t) {
                return this.checkKey(n.Cache.BINARY, t)
            },
            checkBitmapDataKey: function(t) {
                return this.checkKey(n.Cache.BITMAPDATA, t)
            },
            checkBitmapFontKey: function(t) {
                return this.checkKey(n.Cache.BITMAPFONT, t)
            },
            checkJSONKey: function(t) {
                return this.checkKey(n.Cache.JSON, t)
            },
            checkXMLKey: function(t) {
                return this.checkKey(n.Cache.XML, t)
            },
            checkVideoKey: function(t) {
                return this.checkKey(n.Cache.VIDEO, t)
            },
            checkShaderKey: function(t) {
                return this.checkKey(n.Cache.SHADER, t)
            },
            checkRenderTextureKey: function(t) {
                return this.checkKey(n.Cache.RENDER_TEXTURE, t)
            },
            getItem: function(t, e, i, s) {
                return this.checkKey(e, t) ? void 0 === s ? this._cacheMap[e][t] : this._cacheMap[e][t][s] : (i && console.warn("Phaser.Cache." + i + ': Key "' + t + '" not found in Cache.'), null)
            },
            getCanvas: function(t) {
                return this.getItem(t, n.Cache.CANVAS, "getCanvas", "canvas")
            },
            getImage: function(t, e) {
                null != t || (t = "__default"), void 0 === e && (e = !1);
                var i = this.getItem(t, n.Cache.IMAGE, "getImage");
                return null === i && (i = this.getItem("__missing", n.Cache.IMAGE, "getImage")), e ? i : i.data
            },
            getTextureFrame: function(t) {
                return this.getItem(t, n.Cache.TEXTURE, "getTextureFrame", "frame")
            },
            getSound: function(t) {
                return this.getItem(t, n.Cache.SOUND, "getSound")
            },
            getSoundData: function(t) {
                return this.getItem(t, n.Cache.SOUND, "getSoundData", "data")
            },
            getText: function(t) {
                return this.getItem(t, n.Cache.TEXT, "getText", "data")
            },
            getPhysicsData: function(t, e, i) {
                var s = this.getItem(t, n.Cache.PHYSICS, "getPhysicsData", "data");
                if (null === s || null == e) return s;
                if (s[e]) {
                    var o = s[e];
                    if (!o || !i) return o;
                    for (var r in o)
                        if ((r = o[r]).fixtureKey === i) return r;
                    console.warn('Phaser.Cache.getPhysicsData: Could not find given fixtureKey: "' + i + " in " + t + '"')
                } else console.warn('Phaser.Cache.getPhysicsData: Invalid key/object: "' + t + " / " + e + '"');
                return null
            },
            getTilemapData: function(t) {
                return this.getItem(t, n.Cache.TILEMAP, "getTilemapData")
            },
            getBinary: function(t) {
                return this.getItem(t, n.Cache.BINARY, "getBinary")
            },
            getBitmapData: function(t) {
                return this.getItem(t, n.Cache.BITMAPDATA, "getBitmapData", "data")
            },
            getBitmapFont: function(t) {
                return this.getItem(t, n.Cache.BITMAPFONT, "getBitmapFont")
            },
            getJSON: function(t, e) {
                var i = this.getItem(t, n.Cache.JSON, "getJSON", "data");
                return i ? e ? n.Utils.extend(!0, Array.isArray(i) ? [] : {}, i) : i : null
            },
            getXML: function(t) {
                return this.getItem(t, n.Cache.XML, "getXML", "data")
            },
            getVideo: function(t) {
                return this.getItem(t, n.Cache.VIDEO, "getVideo")
            },
            getShader: function(t) {
                return this.getItem(t, n.Cache.SHADER, "getShader", "data")
            },
            getRenderTexture: function(t) {
                return this.getItem(t, n.Cache.RENDER_TEXTURE, "getRenderTexture")
            },
            getBaseTexture: function(t, e) {
                return void 0 === e && (e = n.Cache.IMAGE), this.getItem(t, e, "getBaseTexture", "base")
            },
            getFrame: function(t, e) {
                return void 0 === e && (e = n.Cache.IMAGE), this.getItem(t, e, "getFrame", "frame")
            },
            getFrameCount: function(t, e) {
                var i = this.getFrameData(t, e);
                return i ? i.total : 0
            },
            getFrameData: function(t, e) {
                return void 0 === e && (e = n.Cache.IMAGE), this.getItem(t, e, "getFrameData", "frameData")
            },
            hasFrameData: function(t, e) {
                return void 0 === e && (e = n.Cache.IMAGE), null !== this.getItem(t, e, "", "frameData")
            },
            updateFrameData: function(t, e, i) {
                void 0 === i && (i = n.Cache.IMAGE), this._cacheMap[i][t] && (this._cacheMap[i][t].frameData = e)
            },
            getFrameByIndex: function(t, e, i) {
                var s = this.getFrameData(t, i);
                return s ? s.getFrame(e) : null
            },
            getFrameByName: function(t, e, i) {
                var s = this.getFrameData(t, i);
                return s ? s.getFrameByName(e) : null
            },
            getURL: function(t) {
                return (t = this._resolveURL(t)) ? this._urlMap[t] : (console.warn('Phaser.Cache.getUrl: Invalid url: "' + t + '" or Cache.autoResolveURL was false'), null)
            },
            getKeys: function(t) {
                void 0 === t && (t = n.Cache.IMAGE);
                var e = [];
                if (this._cacheMap[t])
                    for (var i in this._cacheMap[t]) "__default" !== i && "__missing" !== i && e.push(i);
                return e
            },
            removeCanvas: function(t) {
                delete this._cache.canvas[t]
            },
            removeImage: function(t, e) {
                void 0 === e && (e = !0);
                var i = this.getImage(t, !0);
                e && i.base && i.base.destroy(), delete this._cache.image[t]
            },
            removeSound: function(t) {
                delete this._cache.sound[t]
            },
            removeText: function(t) {
                delete this._cache.text[t]
            },
            removePhysics: function(t) {
                delete this._cache.physics[t]
            },
            removeTilemap: function(t) {
                delete this._cache.tilemap[t]
            },
            removeBinary: function(t) {
                delete this._cache.binary[t]
            },
            removeBitmapData: function(t) {
                delete this._cache.bitmapData[t]
            },
            removeBitmapFont: function(t) {
                delete this._cache.bitmapFont[t]
            },
            removeJSON: function(t) {
                delete this._cache.json[t]
            },
            removeXML: function(t) {
                delete this._cache.xml[t]
            },
            removeVideo: function(t) {
                delete this._cache.video[t]
            },
            removeShader: function(t) {
                delete this._cache.shader[t]
            },
            removeRenderTexture: function(t) {
                delete this._cache.renderTexture[t]
            },
            removeSpriteSheet: function(t) {
                delete this._cache.spriteSheet[t]
            },
            removeTextureAtlas: function(t) {
                delete this._cache.image[t]
            },
            clearGLTextures: function() {
                for (var t in this._cache.image) this._cache.image[t].base._glTextures = []
            },
            _resolveURL: function(t, e) {
                return this.autoResolveURL ? (this._urlResolver.src = this.game.load.baseURL + t, this._urlTemp = this._urlResolver.src, this._urlResolver.src = "", e && (this._urlMap[this._urlTemp] = e), this._urlTemp) : null
            },
            destroy: function() {
                for (var t = 0; t < this._cacheMap.length; t++) {
                    var e = this._cacheMap[t];
                    for (var i in e) "__default" !== i && "__missing" !== i && (e[i].destroy && e[i].destroy(), delete e[i])
                }
                this._urlMap = null, this._urlResolver = null, this._urlTemp = null
            }
        }, n.Cache.prototype.constructor = n.Cache, n.Loader = function(t) {
            this.game = t, this.cache = t.cache, this.resetLocked = !1, this.isLoading = !1, this.hasLoaded = !1, this.preloadSprite = null, this.crossOrigin = !1, this.baseURL = "", this.path = "", this.headers = {
                requestedWith: !1,
                json: "application/json",
                xml: "application/xml"
            }, this.onLoadStart = new n.Signal, this.onLoadComplete = new n.Signal, this.onPackComplete = new n.Signal, this.onFileStart = new n.Signal, this.onFileComplete = new n.Signal, this.onFileError = new n.Signal, this.useXDomainRequest = !1, this._warnedAboutXDomainRequest = !1, this.enableParallel = !0, this.maxParallelDownloads = 4, this._withSyncPointDepth = 0, this._fileList = [], this._flightQueue = [], this._processingHead = 0, this._fileLoadStarted = !1, this._totalPackCount = 0, this._totalFileCount = 0, this._loadedPackCount = 0, this._loadedFileCount = 0
        }, n.Loader.TEXTURE_ATLAS_JSON_ARRAY = 0, n.Loader.TEXTURE_ATLAS_JSON_HASH = 1, n.Loader.TEXTURE_ATLAS_XML_STARLING = 2, n.Loader.PHYSICS_LIME_CORONA_JSON = 3, n.Loader.PHYSICS_PHASER_JSON = 4, n.Loader.TEXTURE_ATLAS_JSON_PYXEL = 5, n.Loader.prototype = {
            setPreloadSprite: function(t, e) {
                e = e || 0, this.preloadSprite = {
                    sprite: t,
                    direction: e,
                    width: t.width,
                    height: t.height,
                    rect: null
                }, this.preloadSprite.rect = 0 === e ? new n.Rectangle(0, 0, 1, t.height) : new n.Rectangle(0, 0, t.width, 1), t.crop(this.preloadSprite.rect), t.visible = !0
            },
            resize: function() {
                this.preloadSprite && this.preloadSprite.height !== this.preloadSprite.sprite.height && (this.preloadSprite.rect.height = this.preloadSprite.sprite.height)
            },
            checkKeyExists: function(t, e) {
                return this.getAssetIndex(t, e) > -1
            },
            getAssetIndex: function(t, e) {
                for (var i = -1, s = 0; s < this._fileList.length; s++) {
                    var n = this._fileList[s];
                    if (n.type === t && n.key === e && (i = s, !n.loaded && !n.loading)) break
                }
                return i
            },
            getAsset: function(t, e) {
                var i = this.getAssetIndex(t, e);
                return i > -1 && {
                    index: i,
                    file: this._fileList[i]
                }
            },
            reset: function(t, e) {
                void 0 === e && (e = !1), this.resetLocked || (t && (this.preloadSprite = null), this.isLoading = !1, this._processingHead = 0, this._fileList.length = 0, this._flightQueue.length = 0, this._fileLoadStarted = !1, this._totalFileCount = 0, this._totalPackCount = 0, this._loadedPackCount = 0, this._loadedFileCount = 0, e && (this.onLoadStart.removeAll(), this.onLoadComplete.removeAll(), this.onPackComplete.removeAll(), this.onFileStart.removeAll(), this.onFileComplete.removeAll(), this.onFileError.removeAll()))
            },
            addToFileList: function(t, e, i, s, n, o) {
                if (void 0 === n && (n = !1), void 0 === e || "" === e) return console.warn("Phaser.Loader: Invalid or no key given of type " + t), this;
                if (null == i) {
                    if (!o) return console.warn("Phaser.Loader: No URL given for file type: " + t + " key: " + e), this;
                    i = e + o
                }
                var r = {
                    type: t,
                    key: e,
                    path: this.path,
                    url: i,
                    syncPoint: this._withSyncPointDepth > 0,
                    data: null,
                    loading: !1,
                    loaded: !1,
                    error: !1
                };
                if (s)
                    for (var a in s) r[a] = s[a];
                var h = this.getAssetIndex(t, e);
                if (n && h > -1) {
                    var l = this._fileList[h];
                    l.loading || l.loaded ? (this._fileList.push(r), this._totalFileCount++) : this._fileList[h] = r
                } else -1 === h && (this._fileList.push(r), this._totalFileCount++);
                return this
            },
            replaceInFileList: function(t, e, i, s) {
                return this.addToFileList(t, e, i, s, !0)
            },
            pack: function(t, e, i, s) {
                if (void 0 === e && (e = null), void 0 === i && (i = null), void 0 === s && (s = null), !e && !i) return console.warn("Phaser.Loader.pack - Both url and data are null. One must be set."), this;
                var n = {
                    type: "packfile",
                    key: t,
                    url: e,
                    path: this.path,
                    syncPoint: !0,
                    data: null,
                    loading: !1,
                    loaded: !1,
                    error: !1,
                    callbackContext: s
                };
                i && ("string" == typeof i && (i = JSON.parse(i)), n.data = i || {}, n.loaded = !0);
                for (var o = 0; o < this._fileList.length + 1; o++) {
                    var r = this._fileList[o];
                    if (!r || !r.loaded && !r.loading && "packfile" !== r.type) {
                        this._fileList.splice(o, 0, n), this._totalPackCount++;
                        break
                    }
                }
                return this
            },
            image: function(t, e, i) {
                return "object" == typeof e ? this.texture(t, e, i) : this.addToFileList("image", t, e, void 0, i, ".png")
            },
            texture: function(t, e, i) {
                if (this.game.renderType === n.WEBGL) {
                    var s, o = this.game.renderer.extensions.compression;
                    for (s in e)
                        if (s.toUpperCase() in o) return this.addToFileList("texture", t, e[s], void 0, i, ".pvr")
                }
                return e.truecolor && this.addToFileList("image", t, e.truecolor, void 0, i, ".png"), this
            },
            images: function(t, e) {
                if (Array.isArray(e))
                    for (var i = 0; i < t.length; i++) this.image(t[i], e[i]);
                else
                    for (i = 0; i < t.length; i++) this.image(t[i]);
                return this
            },
            text: function(t, e, i) {
                return this.addToFileList("text", t, e, void 0, i, ".txt")
            },
            json: function(t, e, i) {
                return this.addToFileList("json", t, e, void 0, i, ".json")
            },
            shader: function(t, e, i) {
                return this.addToFileList("shader", t, e, void 0, i, ".frag")
            },
            xml: function(t, e, i) {
                return this.addToFileList("xml", t, e, void 0, i, ".xml")
            },
            script: function(t, e, i, s) {
                return void 0 === i && (i = !1), !1 !== i && void 0 === s && (s = this), this.addToFileList("script", t, e, {
                    syncPoint: !0,
                    callback: i,
                    callbackContext: s
                }, !1, ".js")
            },
            binary: function(t, e, i, s) {
                return void 0 === i && (i = !1), !1 !== i && void 0 === s && (s = i), this.addToFileList("binary", t, e, {
                    callback: i,
                    callbackContext: s
                }, !1, ".bin")
            },
            spritesheet: function(t, e, i, s, n, o, r, a) {
                return void 0 === n && (n = -1), void 0 === o && (o = 0), void 0 === r && (r = 0), void 0 === a && (a = 0), this.addToFileList("spritesheet", t, e, {
                    frameWidth: i,
                    frameHeight: s,
                    frameMax: n,
                    margin: o,
                    spacing: r,
                    skipFrames: a
                }, !1, ".png")
            },
            audio: function(t, e, i) {
                return this.game.sound.noAudio ? this : (void 0 === i && (i = !0), "string" == typeof e && (e = [e]), this.addToFileList("audio", t, e, {
                    buffer: null,
                    autoDecode: i
                }))
            },
            audioSprite: function(t, e, i, s, n) {
                return this.game.sound.noAudio ? this : (void 0 === i && (i = null), void 0 === s && (s = null), void 0 === n && (n = !0), this.audio(t, e, n), i ? this.json(t + "-audioatlas", i) : s ? ("string" == typeof s && (s = JSON.parse(s)), this.cache.addJSON(t + "-audioatlas", "", s)) : console.warn("Phaser.Loader.audiosprite - You must specify either a jsonURL or provide a jsonData object"), this)
            },
            audiosprite: function(t, e, i, s, n) {
                return this.audioSprite(t, e, i, s, n)
            },
            video: function(t, e, i, s) {
                return void 0 === i && (i = this.game.device.firefox ? "loadeddata" : "canplaythrough"), void 0 === s && (s = !1), "string" == typeof e && (e = [e]), this.addToFileList("video", t, e, {
                    buffer: null,
                    asBlob: s,
                    loadEvent: i
                })
            },
            tilemap: function(t, e, i, s) {
                if (void 0 === e && (e = null), void 0 === i && (i = null), void 0 === s && (s = n.Tilemap.CSV), e || i || (e = s === n.Tilemap.CSV ? t + ".csv" : t + ".json"), i) {
                    switch (s) {
                        case n.Tilemap.CSV:
                            break;
                        case n.Tilemap.TILED_JSON:
                            "string" == typeof i && (i = JSON.parse(i))
                    }
                    this.cache.addTilemap(t, null, i, s)
                } else this.addToFileList("tilemap", t, e, {
                    format: s
                });
                return this
            },
            physics: function(t, e, i, s) {
                return void 0 === e && (e = null), void 0 === i && (i = null), void 0 === s && (s = n.Physics.LIME_CORONA_JSON), e || i || (e = t + ".json"), i ? ("string" == typeof i && (i = JSON.parse(i)), this.cache.addPhysicsData(t, null, i, s)) : this.addToFileList("physics", t, e, {
                    format: s
                }), this
            },
            bitmapFont: function(t, e, i, s, n, o) {
                if (null != e || (e = t + ".png"), void 0 === i && (i = null), void 0 === s && (s = null), null === i && null === s && (i = t + ".xml"), void 0 === n && (n = 0), void 0 === o && (o = 0), i) this.addToFileList("bitmapfont", t, e, {
                    atlasURL: i,
                    xSpacing: n,
                    ySpacing: o
                });
                else if ("string" == typeof s) {
                    var r, a;
                    try {
                        r = JSON.parse(s)
                    } catch (t) {
                        a = this.parseXml(s)
                    }
                    if (!a && !r) throw new Error("Phaser.Loader. Invalid Bitmap Font atlas given");
                    this.addToFileList("bitmapfont", t, e, {
                        atlasURL: null,
                        atlasData: r || a,
                        atlasType: r ? "json" : "xml",
                        xSpacing: n,
                        ySpacing: o
                    })
                }
                return this
            },
            atlasJSONArray: function(t, e, i, s) {
                return this.atlas(t, e, i, s, n.Loader.TEXTURE_ATLAS_JSON_ARRAY)
            },
            atlasJSONHash: function(t, e, i, s) {
                return this.atlas(t, e, i, s, n.Loader.TEXTURE_ATLAS_JSON_HASH)
            },
            atlasXML: function(t, e, i, s) {
                return void 0 === i && (i = null), void 0 === s && (s = null), i || s || (i = t + ".xml"), this.atlas(t, e, i, s, n.Loader.TEXTURE_ATLAS_XML_STARLING)
            },
            atlas: function(t, e, i, s, o) {
                if (null != e || (e = t + ".png"), void 0 === i && (i = null), void 0 === s && (s = null), void 0 === o && (o = n.Loader.TEXTURE_ATLAS_JSON_ARRAY), i || s || (i = o === n.Loader.TEXTURE_ATLAS_XML_STARLING ? t + ".xml" : t + ".json"), i) this.addToFileList("textureatlas", t, e, {
                    atlasURL: i,
                    format: o
                });
                else {
                    switch (o) {
                        case n.Loader.TEXTURE_ATLAS_JSON_ARRAY:
                            "string" == typeof s && (s = JSON.parse(s));
                            break;
                        case n.Loader.TEXTURE_ATLAS_XML_STARLING:
                            if ("string" == typeof s) {
                                var r = this.parseXml(s);
                                if (!r) throw new Error("Phaser.Loader. Invalid Texture Atlas XML given");
                                s = r
                            }
                    }
                    this.addToFileList("textureatlas", t, e, {
                        atlasURL: null,
                        atlasData: s,
                        format: o
                    })
                }
                return this
            },
            withSyncPoint: function(t, e) {
                this._withSyncPointDepth++;
                try {
                    t.call(e || this, this)
                } finally {
                    this._withSyncPointDepth--
                }
                return this
            },
            addSyncPoint: function(t, e) {
                var i = this.getAsset(t, e);
                return i && (i.file.syncPoint = !0), this
            },
            removeFile: function(t, e) {
                var i = this.getAsset(t, e);
                i && (i.loaded || i.loading || this._fileList.splice(i.index, 1))
            },
            removeAll: function() {
                this._fileList.length = 0, this._flightQueue.length = 0
            },
            start: function() {
                this.isLoading || (this.hasLoaded = !1, this.isLoading = !0, this.updateProgress(), this.processLoadQueue())
            },
            processLoadQueue: function() {
                if (!this.isLoading) return console.warn("Phaser.Loader - active loading canceled / reset"), void this.finishedLoading(!0);
                for (var t = 0; t < this._flightQueue.length; t++) {
                    ((s = this._flightQueue[t]).loaded || s.error) && (this._flightQueue.splice(t, 1), t--, s.loading = !1, s.requestUrl = null, s.requestObject = null, s.error && this.onFileError.dispatch(s.key, s), "packfile" !== s.type ? (this._loadedFileCount++, this.onFileComplete.dispatch(this.progress, s.key, !s.error, this._loadedFileCount, this._totalFileCount)) : "packfile" === s.type && s.error && (this._loadedPackCount++, this.onPackComplete.dispatch(s.key, !s.error, this._loadedPackCount, this._totalPackCount)))
                }
                var e = !1,
                    i = this.enableParallel ? n.Math.clamp(this.maxParallelDownloads, 1, 12) : 1;
                for (t = this._processingHead; t < this._fileList.length; t++) {
                    var s;
                    if ("packfile" === (s = this._fileList[t]).type && !s.error && s.loaded && t === this._processingHead && (this.processPack(s), this._loadedPackCount++, this.onPackComplete.dispatch(s.key, !s.error, this._loadedPackCount, this._totalPackCount)), s.loaded || s.error ? t === this._processingHead && (this._processingHead = t + 1) : !s.loading && this._flightQueue.length < i && ("packfile" !== s.type || s.data ? e || (this._fileLoadStarted || (this._fileLoadStarted = !0, this.onLoadStart.dispatch()), this._flightQueue.push(s), s.loading = !0, this.onFileStart.dispatch(this.progress, s.key, s.url), this.loadFile(s)) : (this._flightQueue.push(s), s.loading = !0, this.loadFile(s))), !s.loaded && s.syncPoint && (e = !0), this._flightQueue.length >= i || e && this._loadedPackCount === this._totalPackCount) break
                }
                if (this.updateProgress(), this._processingHead >= this._fileList.length) this.finishedLoading();
                else if (!this._flightQueue.length) {
                    console.warn("Phaser.Loader - aborting: processing queue empty, loading may have stalled");
                    var o = this;
                    setTimeout(function() {
                        o.finishedLoading(!0)
                    }, 2e3)
                }
            },
            finishedLoading: function(t) {
                this.hasLoaded || (this.hasLoaded = !0, this.isLoading = !1, t || this._fileLoadStarted || (this._fileLoadStarted = !0, this.onLoadStart.dispatch()), this.onLoadComplete.dispatch(), this.game.state.loadComplete(), this.reset())
            },
            asyncComplete: function(t, e) {
                void 0 === e && (e = ""), t.loaded = !0, t.error = !!e, e && (t.errorMessage = e, console.warn("Phaser.Loader - " + t.type + "[" + t.key + "]: " + e)), this.processLoadQueue()
            },
            processPack: function(t) {
                var e = t.data[t.key];
                if (e)
                    for (var i = 0; i < e.length; i++) {
                        var s = e[i];
                        switch (s.type) {
                            case "image":
                                this.image(s.key, s.url, s.overwrite);
                                break;
                            case "text":
                                this.text(s.key, s.url, s.overwrite);
                                break;
                            case "json":
                                this.json(s.key, s.url, s.overwrite);
                                break;
                            case "xml":
                                this.xml(s.key, s.url, s.overwrite);
                                break;
                            case "script":
                                this.script(s.key, s.url, s.callback, t.callbackContext || this);
                                break;
                            case "binary":
                                this.binary(s.key, s.url, s.callback, t.callbackContext || this);
                                break;
                            case "spritesheet":
                                this.spritesheet(s.key, s.url, s.frameWidth, s.frameHeight, s.frameMax, s.margin, s.spacing, s.skipFrames);
                                break;
                            case "video":
                                this.video(s.key, s.urls);
                                break;
                            case "audio":
                                this.audio(s.key, s.urls, s.autoDecode);
                                break;
                            case "audiosprite":
                                this.audiosprite(s.key, s.urls, s.jsonURL, s.jsonData, s.autoDecode);
                                break;
                            case "tilemap":
                                this.tilemap(s.key, s.url, s.data, n.Tilemap[s.format]);
                                break;
                            case "physics":
                                this.physics(s.key, s.url, s.data, n.Loader[s.format]);
                                break;
                            case "bitmapFont":
                                this.bitmapFont(s.key, s.textureURL, s.atlasURL, s.atlasData, s.xSpacing, s.ySpacing);
                                break;
                            case "atlasJSONArray":
                                this.atlasJSONArray(s.key, s.textureURL, s.atlasURL, s.atlasData);
                                break;
                            case "atlasJSONHash":
                                this.atlasJSONHash(s.key, s.textureURL, s.atlasURL, s.atlasData);
                                break;
                            case "atlasXML":
                                this.atlasXML(s.key, s.textureURL, s.atlasURL, s.atlasData);
                                break;
                            case "atlas":
                                this.atlas(s.key, s.textureURL, s.atlasURL, s.atlasData, n.Loader[s.format]);
                                break;
                            case "shader":
                                this.shader(s.key, s.url, s.overwrite)
                        }
                    } else console.warn("Phaser.Loader - " + t.key + ": pack has data, but not for pack key")
            },
            transformUrl: function(t, e) {
                return !!t && (t.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/) ? t : this.baseURL + e.path + t)
            },
            loadFile: function(t) {
                switch (t.type) {
                    case "packfile":
                        this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.fileComplete);
                        break;
                    case "image":
                    case "spritesheet":
                    case "textureatlas":
                    case "bitmapfont":
                        this.loadImageTag(t);
                        break;
                    case "audio":
                        t.url = this.getAudioURL(t.url), t.url ? this.game.sound.usingWebAudio ? this.xhrLoad(t, this.transformUrl(t.url, t), "arraybuffer", this.fileComplete) : this.game.sound.usingAudioTag && this.loadAudioTag(t) : this.fileError(t, null, "No supported audio URL specified or device does not have audio playback support");
                        break;
                    case "video":
                        t.url = this.getVideoURL(t.url), t.url ? t.asBlob ? this.xhrLoad(t, this.transformUrl(t.url, t), "blob", this.fileComplete) : this.loadVideoTag(t) : this.fileError(t, null, "No supported video URL specified or device does not have video playback support");
                        break;
                    case "json":
                        this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.jsonLoadComplete);
                        break;
                    case "xml":
                        this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.xmlLoadComplete);
                        break;
                    case "tilemap":
                        t.format === n.Tilemap.TILED_JSON ? this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.jsonLoadComplete) : t.format === n.Tilemap.CSV ? this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.csvLoadComplete) : this.asyncComplete(t, "invalid Tilemap format: " + t.format);
                        break;
                    case "text":
                    case "script":
                    case "shader":
                    case "physics":
                        this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.fileComplete);
                        break;
                    case "texture":
                        "truecolor" === t.key.split("_").pop() && this.loadImageTag(t);
                        break;
                    case "binary":
                        this.xhrLoad(t, this.transformUrl(t.url, t), "arraybuffer", this.fileComplete)
                }
            },
            loadImageTag: function(t) {
                var e = this;
                t.data = new Image, t.data.name = t.key, this.crossOrigin && (t.data.crossOrigin = this.crossOrigin), t.data.onload = function() {
                    t.data.onload && (t.data.onload = null, t.data.onerror = null, e.fileComplete(t))
                }, t.data.onerror = function() {
                    t.data.onload && (t.data.onload = null, t.data.onerror = null, e.fileError(t))
                }, t.data.src = this.transformUrl(t.url, t), t.data.complete && t.data.width && t.data.height && (t.data.onload = null, t.data.onerror = null, this.fileComplete(t))
            },
            loadVideoTag: function(t) {
                var e = this;
                t.data = document.createElement("video"), t.data.name = t.key, t.data.controls = !1, t.data.autoplay = !1;
                var i = function() {
                    t.data.removeEventListener(t.loadEvent, i, !1), t.data.onerror = null, t.data.canplay = !0, n.GAMES[e.game.id].load.fileComplete(t)
                };
                t.data.onerror = function() {
                    t.data.removeEventListener(t.loadEvent, i, !1), t.data.onerror = null, t.data.canplay = !1, e.fileError(t)
                }, t.data.addEventListener(t.loadEvent, i, !1), t.data.src = this.transformUrl(t.url, t), t.data.load()
            },
            loadAudioTag: function(t) {
                var e = this;
                if (this.game.sound.touchLocked) t.data = new Audio, t.data.name = t.key, t.data.preload = "auto", t.data.src = this.transformUrl(t.url, t), this.fileComplete(t);
                else {
                    t.data = new Audio, t.data.name = t.key;
                    var i = function() {
                        t.data.removeEventListener("canplaythrough", i, !1), t.data.onerror = null, e.fileComplete(t)
                    };
                    t.data.onerror = function() {
                        t.data.removeEventListener("canplaythrough", i, !1), t.data.onerror = null, e.fileError(t)
                    }, t.data.preload = "auto", t.data.src = this.transformUrl(t.url, t), t.data.addEventListener("canplaythrough", i, !1), t.data.load()
                }
            },
            xhrLoad: function(t, e, i, s, n) {
                if (this.useXDomainRequest && window.XDomainRequest) this.xhrLoadWithXDR(t, e, i, s, n);
                else {
                    var o = new XMLHttpRequest;
                    o.open("GET", e, !0), o.responseType = i, !1 !== this.headers.requestedWith && o.setRequestHeader("X-Requested-With", this.headers.requestedWith), this.headers[t.type] && o.setRequestHeader("Accept", this.headers[t.type]), n = n || this.fileError;
                    var r = this;
                    o.onload = function() {
                        try {
                            return 4 === o.readyState && o.status >= 400 && o.status <= 599 ? n.call(r, t, o) : s.call(r, t, o)
                        } catch (e) {
                            r.hasLoaded ? window.console && console.error(e) : r.asyncComplete(t, e.message || "Exception")
                        }
                    }, o.onerror = function() {
                        try {
                            return n.call(r, t, o)
                        } catch (e) {
                            r.hasLoaded ? window.console && console.error(e) : r.asyncComplete(t, e.message || "Exception")
                        }
                    }, t.requestObject = o, t.requestUrl = e, o.send()
                }
            },
            xhrLoadWithXDR: function(t, e, i, s, n) {
                this._warnedAboutXDomainRequest || this.game.device.ie && !(this.game.device.ieVersion >= 10) || (this._warnedAboutXDomainRequest = !0, console.warn("Phaser.Loader - using XDomainRequest outside of IE 9"));
                var o = new window.XDomainRequest;
                o.open("GET", e, !0), o.responseType = i, o.timeout = 3e3, n = n || this.fileError;
                var r = this;
                o.onerror = function() {
                    try {
                        return n.call(r, t, o)
                    } catch (e) {
                        r.asyncComplete(t, e.message || "Exception")
                    }
                }, o.ontimeout = function() {
                    try {
                        return n.call(r, t, o)
                    } catch (e) {
                        r.asyncComplete(t, e.message || "Exception")
                    }
                }, o.onprogress = function() {}, o.onload = function() {
                    try {
                        return 4 === o.readyState && o.status >= 400 && o.status <= 599 ? n.call(r, t, o) : s.call(r, t, o)
                    } catch (e) {
                        r.asyncComplete(t, e.message || "Exception")
                    }
                }, t.requestObject = o, t.requestUrl = e, setTimeout(function() {
                    o.send()
                }, 0)
            },
            getVideoURL: function(t) {
                for (var e = 0; e < t.length; e++) {
                    var i, s = t[e];
                    if (s.uri) {
                        if (i = s.type, s = s.uri, this.game.device.canPlayVideo(i)) return s
                    } else {
                        if (0 === s.indexOf("blob:") || 0 === s.indexOf("data:")) return s;
                        if (s.indexOf("?") >= 0 && (s = s.substr(0, s.indexOf("?"))), i = s.substr((Math.max(0, s.lastIndexOf(".")) || 1 / 0) + 1).toLowerCase(), this.game.device.canPlayVideo(i)) return t[e]
                    }
                }
                return null
            },
            getAudioURL: function(t) {
                if (this.game.sound.noAudio) return null;
                for (var e = 0; e < t.length; e++) {
                    var i, s = t[e];
                    if (s.uri) {
                        if (i = s.type, s = s.uri, this.game.device.canPlayAudio(i)) return s
                    } else {
                        if (0 === s.indexOf("blob:") || 0 === s.indexOf("data:")) return s;
                        if (s.indexOf("?") >= 0 && (s = s.substr(0, s.indexOf("?"))), i = s.substr((Math.max(0, s.lastIndexOf(".")) || 1 / 0) + 1).toLowerCase(), this.game.device.canPlayAudio(i)) return t[e]
                    }
                }
                return null
            },
            fileError: function(t, e, i) {
                var s = "error loading asset from URL " + (t.requestUrl || this.transformUrl(t.url, t));
                !i && e && (i = e.status), i && (s = s + " (" + i + ")"), this.asyncComplete(t, s)
            },
            fileComplete: function(t, e) {
                var i = !0;
                switch (t.type) {
                    case "packfile":
                        var s = JSON.parse(e.responseText);
                        t.data = s || {};
                        break;
                    case "texture":
                        null !== t.data ? this.cache.addCompressedTextureMetaData(t.key, t.url, t.url.split(".").pop().toLowerCase(), t.data) : this.cache.addCompressedTextureMetaData(t.key, t.url, t.url.split(".").pop().toLowerCase(), e.response);
                        break;
                    case "image":
                        this.cache.addImage(t.key, t.url, t.data);
                        break;
                    case "spritesheet":
                        this.cache.addSpriteSheet(t.key, t.url, t.data, t.frameWidth, t.frameHeight, t.frameMax, t.margin, t.spacing, t.skipFrames);
                        break;
                    case "textureatlas":
                        if (null == t.atlasURL) this.cache.addTextureAtlas(t.key, t.url, t.data, t.atlasData, t.format);
                        else if (i = !1, t.format === n.Loader.TEXTURE_ATLAS_JSON_ARRAY || t.format === n.Loader.TEXTURE_ATLAS_JSON_HASH || t.format === n.Loader.TEXTURE_ATLAS_JSON_PYXEL) this.xhrLoad(t, this.transformUrl(t.atlasURL, t), "text", this.jsonLoadComplete);
                        else {
                            if (t.format !== n.Loader.TEXTURE_ATLAS_XML_STARLING) throw new Error("Phaser.Loader. Invalid Texture Atlas format: " + t.format);
                            this.xhrLoad(t, this.transformUrl(t.atlasURL, t), "text", this.xmlLoadComplete)
                        }
                        break;
                    case "bitmapfont":
                        t.atlasURL ? (i = !1, this.xhrLoad(t, this.transformUrl(t.atlasURL, t), "text", function(t, e) {
                            var i;
                            try {
                                i = JSON.parse(e.responseText)
                            } catch (t) {}
                            i ? (t.atlasType = "json", this.jsonLoadComplete(t, e)) : (t.atlasType = "xml", this.xmlLoadComplete(t, e))
                        })) : this.cache.addBitmapFont(t.key, t.url, t.data, t.atlasData, t.atlasType, t.xSpacing, t.ySpacing);
                        break;
                    case "video":
                        if (t.asBlob) try {
                            t.data = e.response
                        } catch (e) {
                            throw new Error("Phaser.Loader. Unable to parse video file as Blob: " + t.key)
                        }
                        this.cache.addVideo(t.key, t.url, t.data, t.asBlob);
                        break;
                    case "audio":
                        this.game.sound.usingWebAudio ? (t.data = e.response, this.cache.addSound(t.key, t.url, t.data, !0, !1), t.autoDecode && this.game.sound.decode(t.key)) : this.cache.addSound(t.key, t.url, t.data, !1, !0);
                        break;
                    case "text":
                        t.data = e.responseText, this.cache.addText(t.key, t.url, t.data);
                        break;
                    case "shader":
                        t.data = e.responseText, this.cache.addShader(t.key, t.url, t.data);
                        break;
                    case "physics":
                        s = JSON.parse(e.responseText);
                        this.cache.addPhysicsData(t.key, t.url, s, t.format);
                        break;
                    case "script":
                        t.data = document.createElement("script"), t.data.language = "javascript", t.data.type = "text/javascript", t.data.defer = !1, t.data.text = e.responseText, document.head.appendChild(t.data), t.callback && (t.data = t.callback.call(t.callbackContext, t.key, e.responseText));
                        break;
                    case "binary":
                        t.callback ? t.data = t.callback.call(t.callbackContext, t.key, e.response) : t.data = e.response, this.cache.addBinary(t.key, t.data)
                }
                i && this.asyncComplete(t)
            },
            jsonLoadComplete: function(t, e) {
                var i = JSON.parse(e.responseText);
                "tilemap" === t.type ? this.cache.addTilemap(t.key, t.url, i, t.format) : "bitmapfont" === t.type ? this.cache.addBitmapFont(t.key, t.url, t.data, i, t.atlasType, t.xSpacing, t.ySpacing) : "json" === t.type ? this.cache.addJSON(t.key, t.url, i) : this.cache.addTextureAtlas(t.key, t.url, t.data, i, t.format), this.asyncComplete(t)
            },
            csvLoadComplete: function(t, e) {
                var i = e.responseText;
                this.cache.addTilemap(t.key, t.url, i, t.format), this.asyncComplete(t)
            },
            xmlLoadComplete: function(t, e) {
                var i = e.responseText,
                    s = this.parseXml(i);
                if (!s) {
                    var n = e.responseType || e.contentType;
                    return console.warn("Phaser.Loader - " + t.key + ": invalid XML (" + n + ")"), void this.asyncComplete(t, "invalid XML")
                }
                "bitmapfont" === t.type ? this.cache.addBitmapFont(t.key, t.url, t.data, s, t.atlasType, t.xSpacing, t.ySpacing) : "textureatlas" === t.type ? this.cache.addTextureAtlas(t.key, t.url, t.data, s, t.format) : "xml" === t.type && this.cache.addXML(t.key, t.url, s), this.asyncComplete(t)
            },
            parseXml: function(t) {
                var e;
                try {
                    if (window.DOMParser) e = (new DOMParser).parseFromString(t, "text/xml");
                    else(e = new ActiveXObject("Microsoft.XMLDOM")).async = "false", e.loadXML(t)
                } catch (t) {
                    e = null
                }
                return e && e.documentElement && !e.getElementsByTagName("parsererror").length ? e : null
            },
            updateProgress: function() {
                this.preloadSprite && (0 === this.preloadSprite.direction ? this.preloadSprite.rect.width = Math.floor(this.preloadSprite.width / 100 * this.progress) : this.preloadSprite.rect.height = Math.floor(this.preloadSprite.height / 100 * this.progress), this.preloadSprite.sprite ? this.preloadSprite.sprite.updateCrop() : this.preloadSprite = null)
            },
            totalLoadedFiles: function() {
                return this._loadedFileCount
            },
            totalQueuedFiles: function() {
                return this._totalFileCount - this._loadedFileCount
            },
            totalLoadedPacks: function() {
                return this._totalPackCount
            },
            totalQueuedPacks: function() {
                return this._totalPackCount - this._loadedPackCount
            }
        }, Object.defineProperty(n.Loader.prototype, "progressFloat", {
            get: function() {
                var t = this._loadedFileCount / this._totalFileCount * 100;
                return n.Math.clamp(t || 0, 0, 100)
            }
        }), Object.defineProperty(n.Loader.prototype, "progress", {
            get: function() {
                return Math.round(this.progressFloat)
            }
        }), n.Loader.prototype.constructor = n.Loader, n.LoaderParser = {
            bitmapFont: function(t, e, i, s) {
                return this.xmlBitmapFont(t, e, i, s)
            },
            xmlBitmapFont: function(t, e, i, s, n, o) {
                var r = {},
                    a = t.getElementsByTagName("info")[0],
                    h = t.getElementsByTagName("common")[0];
                r.font = a.getAttribute("face"), r.size = parseInt(a.getAttribute("size"), 10), r.lineHeight = parseInt(h.getAttribute("lineHeight"), 10) + s, r.chars = {};
                for (var l = t.getElementsByTagName("char"), c = n ? n.x : 0, u = n ? n.y : 0, d = 0; d < l.length; d++) {
                    var p = parseInt(l[d].getAttribute("id"), 10);
                    r.chars[p] = {
                        x: c + parseInt(l[d].getAttribute("x"), 10),
                        y: u + parseInt(l[d].getAttribute("y"), 10),
                        width: parseInt(l[d].getAttribute("width"), 10),
                        height: parseInt(l[d].getAttribute("height"), 10),
                        xOffset: parseInt(l[d].getAttribute("xoffset"), 10) / o,
                        yOffset: parseInt(l[d].getAttribute("yoffset"), 10) / o,
                        xAdvance: (parseInt(l[d].getAttribute("xadvance"), 10) + i) / o,
                        kerning: {}
                    }
                }
                var f = t.getElementsByTagName("kerning");
                for (d = 0; d < f.length; d++) {
                    var m = parseInt(f[d].getAttribute("first"), 10),
                        g = parseInt(f[d].getAttribute("second"), 10),
                        y = parseInt(f[d].getAttribute("amount"), 10) / o;
                    r.chars[g].kerning[m] = y
                }
                return this.finalizeBitmapFont(e, r)
            },
            jsonBitmapFont: function(t, e, i, s, n, o) {
                var r = {
                        font: t.font.info._face,
                        size: parseInt(t.font.info._size, 10),
                        lineHeight: parseInt(t.font.common._lineHeight, 10) + s,
                        chars: {}
                    },
                    a = n ? n.x : 0,
                    h = n ? n.y : 0;
                return t.font.chars.char.forEach(function(t) {
                    var e = parseInt(t._id, 10);
                    r.chars[e] = {
                        x: a + parseInt(t._x, 10),
                        y: h + parseInt(t._y, 10),
                        width: parseInt(t._width, 10),
                        height: parseInt(t._height, 10),
                        xOffset: parseInt(t._xoffset, 10) / o,
                        yOffset: parseInt(t._yoffset, 10) / o,
                        xAdvance: (parseInt(t._xadvance, 10) + i) / o,
                        kerning: {}
                    }
                }), t.font.kernings && t.font.kernings.kerning && t.font.kernings.kerning.forEach(function(t) {
                    r.chars[t._second].kerning[t._first] = parseInt(t._amount, 10) / o
                }), this.finalizeBitmapFont(e, r)
            },
            finalizeBitmapFont: function(t, e) {
                return Object.keys(e.chars).forEach(function(i) {
                    var s = e.chars[i];
                    s.texture = new PIXI.Texture(t, new n.Rectangle(s.x, s.y, s.width, s.height))
                }), e
            },
            pvr: function(t) {
                var e, i = new Uint32Array(t.slice(0, 52)),
                    s = new Uint8Array(t),
                    n = null,
                    o = i[3] << 32 | i[2],
                    r = 0;
                if (55727696 === i[0] && [0, 1, 2, 3, 6, 7, 9, 11].indexOf(o) >= 0) {
                    switch (o >= 0 && o <= 3 ? e = "PVRTC" : o >= 7 && o <= 11 ? e = "S3TC" : 6 === o && (e = "ETC1"), o) {
                        case 0:
                            r = 35841;
                            break;
                        case 1:
                            r = 35843;
                            break;
                        case 2:
                            r = 35840;
                            break;
                        case 3:
                            r = 35842;
                            break;
                        case 6:
                            r = 36196;
                            break;
                        case 7:
                            r = 33777;
                            break;
                        case 9:
                            r = 33778;
                            break;
                        case 11:
                            r = 33779;
                            break;
                        default:
                            r = -1
                    }
                    n = {
                        complete: !0,
                        fileFormat: "PVR",
                        compressionAlgorithm: e,
                        flags: i[1],
                        pixelFormat: o,
                        colorSpace: i[4],
                        channelType: i[5],
                        height: i[6],
                        width: i[7],
                        depth: i[8],
                        numberOfSurfaces: i[9],
                        numberOfFaces: i[10],
                        numberOfMipmaps: i[11],
                        metaDataSize: i[12],
                        textureData: s.subarray(52 + i[12], s.byteLength),
                        glExtensionFormat: r
                    }
                }
                return n
            },
            dds: function(t) {
                var e = new Uint8Array(t),
                    i = new Uint32Array(t),
                    s = null;
                return 68 === e[0] && 68 === e[1] && 83 === e[2] && 32 === e[3] && ("DX10" === (s = {
                    complete: !0,
                    fileFormat: "DDS",
                    compressionAlgorithm: "S3TC",
                    size: i[1],
                    flags: i[2],
                    height: i[3],
                    width: i[4],
                    pitch: i[5],
                    depth: i[6],
                    mipmapCount: i[7],
                    formatSize: i[19],
                    formatFlag: i[19],
                    formatFourCC: [String.fromCharCode(e[84]), String.fromCharCode(e[85]), String.fromCharCode(e[86]), String.fromCharCode(e[87])].join(""),
                    formatBitCount: i[21],
                    formatRBitMask: i[22],
                    formatGBitMask: i[23],
                    formatBBitMask: i[24],
                    formatABitMask: i[25],
                    caps1: i[26],
                    caps2: i[27],
                    caps3: i[28],
                    caps4: i[29],
                    reserved2: i[30],
                    DXGIFormat: null,
                    resourceDimension: null,
                    miscFlag: null,
                    arraySize: null,
                    textureData: e.subarray(i[1] + 4, e.byteLength)
                }).formatFourCC && (s.DXGIFormat = i[31], s.resourceDimension = i[32], s.miscFlag = i[33], s.arraySize = i[34], s.miscFlag = i[35])), s
            },
            ktx: function(t) {
                var e = new Uint8Array(t),
                    i = new Uint32Array(t),
                    s = null,
                    n = 16 + i[15] / 4 | 0,
                    o = i[n],
                    r = i[7],
                    a = 0;
                if (171 === e[0] && 75 === e[1] && 84 === e[2] && 88 === e[3] && 32 === e[4] && 49 === e[5] && 49 === e[6] && 187 === e[7] && 13 === e[8] && 10 === e[9] && 26 === e[10] && 10 === e[11] && [36196, 35840, 35841, 35842, 35843, 33776, 33777, 33778, 33779].indexOf(r) >= 0) {
                    switch (r) {
                        case 36196:
                            a = "ETC1";
                            break;
                        case 35840:
                        case 35841:
                        case 35842:
                        case 35843:
                            a = "PVRTC";
                            break;
                        case 33776:
                        case 33777:
                        case 33778:
                        case 33779:
                            a = "S3TC"
                    }
                    s = {
                        complete: !0,
                        fileFormat: "KTX",
                        compressionAlgorithm: a,
                        endianness: i[3],
                        glType: i[4],
                        glTypeSize: i[5],
                        glFormat: i[6],
                        glInternalFormat: i[7],
                        glBaseInternalFormat: i[8],
                        width: i[9],
                        height: i[10],
                        pixelDepth: i[11],
                        numberOfArrayElements: i[12],
                        numberOfFaces: i[13],
                        numberOfMipmapLevels: i[14],
                        bytesOfKeyValueData: i[15],
                        keyAndValueByteSize: i[16],
                        imageSize: o,
                        textureData: e.subarray(4 * (n + 1), o + 100)
                    }
                }
                return s
            },
            pkm: function(t) {
                var e = new Uint8Array(t),
                    i = null;
                return 80 === e[0] && 75 === e[1] && 77 === e[2] && 32 === e[3] && (i = {
                    complete: !0,
                    fileFormat: "PKM",
                    compressionAlgorithm: "ETC1",
                    format: 65535 & (e[6] << 8 | e[7]),
                    width: 65535 & (e[8] << 8 | e[9]),
                    height: 65535 & (e[10] << 8 | e[11]),
                    originalWidth: 65535 & (e[12] << 8 | e[13]),
                    originalHeight: 65535 & (e[14] << 8 | e[15]),
                    textureData: e.subarray(16, e.length)
                }), i
            }
        }, n.AudioSprite = function(t, e) {
            for (var i in this.game = t, this.key = e, this.config = this.game.cache.getJSON(e + "-audioatlas"), this.autoplayKey = null, this.autoplay = !1, this.sounds = {}, this.config.spritemap) {
                var s = this.config.spritemap[i],
                    n = this.game.add.sound(this.key);
                n.addMarker(i, s.start, s.end - s.start, null, s.loop), this.sounds[i] = n
            }
            this.config.autoplay && (this.autoplayKey = this.config.autoplay, this.play(this.autoplayKey), this.autoplay = this.sounds[this.autoplayKey])
        }, n.AudioSprite.prototype = {
            play: function(t, e) {
                return void 0 === e && (e = 1), this.sounds[t].play(t, null, e)
            },
            stop: function(t) {
                if (t) this.sounds[t].stop();
                else
                    for (var e in this.sounds) this.sounds[e].stop()
            },
            get: function(t) {
                return this.sounds[t]
            }
        }, n.AudioSprite.prototype.constructor = n.AudioSprite, n.Sound = function(t, e, i, s, o) {
            void 0 === i && (i = 1), void 0 === s && (s = !1), void 0 === o && (o = t.sound.connectToMaster), this.game = t, this.name = e, this.key = e, this.loop = s, this.markers = {}, this.context = null, this.autoplay = !1, this.totalDuration = 0, this.startTime = 0, this.currentTime = 0, this.duration = 0, this.durationMS = 0, this.position = 0, this.stopTime = 0, this.paused = !1, this.pausedPosition = 0, this.pausedTime = 0, this.isPlaying = !1, this.currentMarker = "", this.fadeTween = null, this.pendingPlayback = !1, this.override = !1, this.allowMultiple = !1, this.usingWebAudio = this.game.sound.usingWebAudio, this.usingAudioTag = this.game.sound.usingAudioTag, this.externalNode = null, this.masterGainNode = null, this.gainNode = null, this._sound = null, this.usingWebAudio ? (this.context = this.game.sound.context, this.masterGainNode = this.game.sound.masterGain, void 0 === this.context.createGain ? this.gainNode = this.context.createGainNode() : this.gainNode = this.context.createGain(), this.gainNode.gain.value = i * this.game.sound.volume, o && this.gainNode.connect(this.masterGainNode)) : this.usingAudioTag && (this.game.cache.getSound(e) && this.game.cache.isSoundReady(e) ? (this._sound = this.game.cache.getSoundData(e), this.totalDuration = 0, this._sound.duration && (this.totalDuration = this._sound.duration)) : this.game.cache.onSoundUnlock.add(this.soundHasUnlocked, this)), this.onDecoded = new n.Signal, this.onPlay = new n.Signal, this.onPause = new n.Signal, this.onResume = new n.Signal, this.onLoop = new n.Signal, this.onStop = new n.Signal, this.onMute = new n.Signal, this.onMarkerComplete = new n.Signal, this.onFadeComplete = new n.Signal, this._volume = i, this._buffer = null, this._muted = !1, this._tempMarker = 0, this._tempPosition = 0, this._tempVolume = 0, this._tempPause = 0, this._muteVolume = 0, this._tempLoop = 0, this._paused = !1, this._onDecodedEventDispatched = !1
        }, n.Sound.prototype = {
            soundHasUnlocked: function(t) {
                t === this.key && (this._sound = this.game.cache.getSoundData(this.key), this.totalDuration = this._sound.duration)
            },
            addMarker: function(t, e, i, s, n) {
                null != i || (i = 1), null != s || (s = 1), void 0 === n && (n = !1), this.markers[t] = {
                    name: t,
                    start: e,
                    stop: e + i,
                    volume: s,
                    duration: i,
                    durationMS: 1e3 * i,
                    loop: n
                }
            },
            removeMarker: function(t) {
                delete this.markers[t]
            },
            onEndedHandler: function() {
                this._sound.onended = null, this.isPlaying = !1, this.currentTime = this.durationMS, this.stop()
            },
            update: function() {
                this.game.cache.checkSoundKey(this.key) ? (this.isDecoded && !this._onDecodedEventDispatched && (this.onDecoded.dispatch(this), this._onDecodedEventDispatched = !0), this.pendingPlayback && this.game.cache.isSoundReady(this.key) && (this.pendingPlayback = !1, this.play(this._tempMarker, this._tempPosition, this._tempVolume, this._tempLoop)), this.isPlaying && (this.currentTime = this.game.time.time - this.startTime, this.currentTime >= this.durationMS && (this.usingWebAudio ? this.loop ? (this.onLoop.dispatch(this), this.isPlaying = !1, "" === this.currentMarker ? (this.currentTime = 0, this.startTime = this.game.time.time, this.isPlaying = !0) : (this.onMarkerComplete.dispatch(this.currentMarker, this), this.play(this.currentMarker, 0, this.volume, !0, !0))) : "" !== this.currentMarker && this.stop() : this.loop ? (this.onLoop.dispatch(this), "" === this.currentMarker && (this.currentTime = 0, this.startTime = this.game.time.time), this.isPlaying = !1, this.play(this.currentMarker, 0, this.volume, !0, !0)) : this.stop()))) : this.destroy()
            },
            loopFull: function(t) {
                return this.play(null, 0, t, !0)
            },
            play: function(t, e, i, s, n) {
                if (void 0 !== t && !1 !== t && null !== t || (t = ""), void 0 === n && (n = !0), this.isPlaying && !this.allowMultiple && !n && !this.override) return this;
                if (this._sound && this.isPlaying && !this.allowMultiple && (this.override || n)) {
                    if (this.usingWebAudio) {
                        if (void 0 === this._sound.stop) this._sound.noteOff(0);
                        else try {
                            this._sound.stop(0)
                        } catch (t) {}
                        this.externalNode ? this._sound.disconnect(this.externalNode) : this.gainNode && this._sound.disconnect(this.gainNode)
                    } else this.usingAudioTag && (this._sound.pause(), this._sound.currentTime = 0);
                    this.isPlaying = !1
                }
                if ("" === t && Object.keys(this.markers).length > 0) return this;
                if ("" !== t) {
                    if (!this.markers[t]) return console.warn("Phaser.Sound.play: audio marker " + t + " doesn't exist"), this;
                    this.currentMarker = t, this.position = this.markers[t].start, this.volume = this.markers[t].volume, this.loop = this.markers[t].loop, this.duration = this.markers[t].duration, this.durationMS = this.markers[t].durationMS, void 0 !== i && (this.volume = i), void 0 !== s && (this.loop = s), this._tempMarker = t, this._tempPosition = this.position, this._tempVolume = this.volume, this._tempLoop = this.loop
                } else e = e || 0, void 0 === i && (i = this._volume), void 0 === s && (s = this.loop), this.position = Math.max(0, e), this.volume = i, this.loop = s, this.duration = 0, this.durationMS = 0, this._tempMarker = t, this._tempPosition = e, this._tempVolume = i, this._tempLoop = s;
                return this.usingWebAudio ? this.game.cache.isSoundDecoded(this.key) ? (this._sound = this.context.createBufferSource(), this.externalNode ? this._sound.connect(this.externalNode) : this._sound.connect(this.gainNode), this._buffer = this.game.cache.getSoundData(this.key), this._sound.buffer = this._buffer, this.loop && "" === t && (this._sound.loop = !0), this.loop || "" !== t || (this._sound.onended = this.onEndedHandler.bind(this)), this.totalDuration = this._sound.buffer.duration, 0 === this.duration && (this.duration = this.totalDuration, this.durationMS = Math.ceil(1e3 * this.totalDuration)), void 0 === this._sound.start ? this._sound.noteGrainOn(0, this.position, this.duration) : this.loop && "" === t ? this._sound.start(0, 0) : this._sound.start(0, this.position, this.duration), this.isPlaying = !0, this.startTime = this.game.time.time, this.currentTime = 0, this.stopTime = this.startTime + this.durationMS, this.onPlay.dispatch(this)) : (this.pendingPlayback = !0, this.game.cache.getSound(this.key) && !1 === this.game.cache.getSound(this.key).isDecoding && this.game.sound.decode(this.key, this)) : this.game.cache.getSound(this.key) && this.game.cache.getSound(this.key).locked ? (this.game.cache.reloadSound(this.key), this.pendingPlayback = !0) : this._sound && (this.game.device.cocoonJS || 4 === this._sound.readyState) ? (this._sound.play(), this.totalDuration = this._sound.duration, 0 === this.duration && (this.duration = this.totalDuration, this.durationMS = 1e3 * this.totalDuration), this._sound.currentTime = this.position, this._sound.muted = this._muted, this._muted || this.game.sound.mute ? this._sound.volume = 0 : this._sound.volume = this._volume, this.isPlaying = !0, this.startTime = this.game.time.time, this.currentTime = 0, this.stopTime = this.startTime + this.durationMS, this.onPlay.dispatch(this)) : this.pendingPlayback = !0, this
            },
            restart: function(t, e, i, s) {
                t = t || "", e = e || 0, i = i || 1, void 0 === s && (s = !1), this.play(t, e, i, s, !0)
            },
            pause: function() {
                this.isPlaying && this._sound && (this.paused = !0, this.pausedPosition = this.currentTime, this.pausedTime = this.game.time.time, this._tempPause = this._sound.currentTime, this.onPause.dispatch(this), this.stop())
            },
            resume: function() {
                if (this.paused && this._sound) {
                    if (this.usingWebAudio) {
                        var t = Math.max(0, this.position + this.pausedPosition / 1e3);
                        this._sound = this.context.createBufferSource(), this._sound.buffer = this._buffer, this.externalNode ? this._sound.connect(this.externalNode) : this._sound.connect(this.gainNode), this.loop && (this._sound.loop = !0), this.loop || "" !== this.currentMarker || (this._sound.onended = this.onEndedHandler.bind(this));
                        var e = this.duration - this.pausedPosition / 1e3;
                        void 0 === this._sound.start ? this._sound.noteGrainOn(0, t, e) : this.loop && this.game.device.chrome ? 42 === this.game.device.chromeVersion ? this._sound.start(0) : this._sound.start(0, t) : this._sound.start(0, t, e)
                    } else this._sound.currentTime = this._tempPause, this._sound.play();
                    this.isPlaying = !0, this.paused = !1, this.startTime += this.game.time.time - this.pausedTime, this.onResume.dispatch(this)
                }
            },
            stop: function() {
                if (this.isPlaying && this._sound)
                    if (this.usingWebAudio) {
                        if (void 0 === this._sound.stop) this._sound.noteOff(0);
                        else try {
                            this._sound.stop(0)
                        } catch (t) {}
                        this.externalNode ? this._sound.disconnect(this.externalNode) : this.gainNode && this._sound.disconnect(this.gainNode)
                    } else this.usingAudioTag && (this._sound.pause(), this._sound.currentTime = 0);
                if (this.pendingPlayback = !1, this.isPlaying = !1, !this.paused) {
                    var t = this.currentMarker;
                    "" !== this.currentMarker && this.onMarkerComplete.dispatch(this.currentMarker, this), this.currentMarker = "", null !== this.fadeTween && this.fadeTween.stop(), this.onStop.dispatch(this, t)
                }
            },
            fadeIn: function(t, e, i) {
                void 0 === e && (e = !1), void 0 === i && (i = this.currentMarker), this.paused || (this.play(i, 0, 0, e), this.fadeTo(t, 1))
            },
            fadeOut: function(t) {
                this.fadeTo(t, 0)
            },
            fadeTo: function(t, e) {
                if (this.isPlaying && !this.paused && e !== this.volume) {
                    if (void 0 === t && (t = 1e3), void 0 === e) return void console.warn("Phaser.Sound.fadeTo: No Volume Specified.");
                    this.fadeTween = this.game.add.tween(this).to({
                        volume: e
                    }, t, n.Easing.Linear.None, !0), this.fadeTween.onComplete.add(this.fadeComplete, this)
                }
            },
            fadeComplete: function() {
                this.onFadeComplete.dispatch(this, this.volume), 0 === this.volume && this.stop()
            },
            updateGlobalVolume: function(t) {
                this.usingAudioTag && this._sound && (this._sound.volume = t * this._volume)
            },
            destroy: function(t) {
                void 0 === t && (t = !0), this.stop(), t ? this.game.sound.remove(this) : (this.markers = {}, this.context = null, this._buffer = null, this.externalNode = null, this.onDecoded.dispose(), this.onPlay.dispose(), this.onPause.dispose(), this.onResume.dispose(), this.onLoop.dispose(), this.onStop.dispose(), this.onMute.dispose(), this.onMarkerComplete.dispose())
            }
        }, n.Sound.prototype.constructor = n.Sound, Object.defineProperty(n.Sound.prototype, "isDecoding", {
            get: function() {
                return this.game.cache.getSound(this.key).isDecoding
            }
        }), Object.defineProperty(n.Sound.prototype, "isDecoded", {
            get: function() {
                return this.game.cache.isSoundDecoded(this.key)
            }
        }), Object.defineProperty(n.Sound.prototype, "mute", {
            get: function() {
                return this._muted || this.game.sound.mute
            },
            set: function(t) {
                (t = t || !1) !== this._muted && (t ? (this._muted = !0, this._muteVolume = this._tempVolume, this.usingWebAudio ? this.gainNode.gain.value = 0 : this.usingAudioTag && this._sound && (this._sound.volume = 0)) : (this._muted = !1, this.usingWebAudio ? this.gainNode.gain.value = this._muteVolume : this.usingAudioTag && this._sound && (this._sound.volume = this._muteVolume)), this.onMute.dispatch(this))
            }
        }), Object.defineProperty(n.Sound.prototype, "volume", {
            get: function() {
                return this._volume
            },
            set: function(t) {
                this.game.device.firefox && this.usingAudioTag && (t = this.game.math.clamp(t, 0, 1)), this._muted ? this._muteVolume = t : (this._tempVolume = t, this._volume = t, this.usingWebAudio ? this.gainNode.gain.value = t : this.usingAudioTag && this._sound && (this._sound.volume = t))
            }
        }), n.SoundManager = function(t) {
            this.game = t, this.onSoundDecode = new n.Signal, this.onVolumeChange = new n.Signal, this.onMute = new n.Signal, this.onUnMute = new n.Signal, this.context = null, this.usingWebAudio = !1, this.usingAudioTag = !1, this.noAudio = !1, this.connectToMaster = !0, this.touchLocked = !1, this.channels = 32, this.muteOnPause = !0, this._codeMuted = !1, this._muted = !1, this._unlockSource = null, this._volume = 1, this._sounds = [], this._watchList = new n.ArraySet, this._watching = !1, this._watchCallback = null, this._watchContext = null
        }, n.SoundManager.prototype = {
            boot: function() {
                if (this.game.device.iOS && !1 === this.game.device.webAudio && (this.channels = 1), window.PhaserGlobal) {
                    if (!0 === window.PhaserGlobal.disableAudio) return this.noAudio = !0, void(this.touchLocked = !1);
                    if (!0 === window.PhaserGlobal.disableWebAudio) return this.usingAudioTag = !0, void(this.touchLocked = !1)
                }
                if (window.PhaserGlobal && window.PhaserGlobal.audioContext) this.context = window.PhaserGlobal.audioContext;
                else if (window.AudioContext) try {
                    this.context = new window.AudioContext
                } catch (t) {
                    this.context = null, this.usingWebAudio = !1, this.touchLocked = !1
                } else if (window.webkitAudioContext) try {
                    this.context = new window.webkitAudioContext
                } catch (t) {
                    this.context = null, this.usingWebAudio = !1, this.touchLocked = !1
                }
                if (null === this.context) {
                    if (void 0 === window.Audio) return void(this.noAudio = !0);
                    this.usingAudioTag = !0
                } else this.usingWebAudio = !0, void 0 === this.context.createGain ? this.masterGain = this.context.createGainNode() : this.masterGain = this.context.createGain(), this.masterGain.gain.value = 1, this.masterGain.connect(this.context.destination);
                this.noAudio || (!this.game.device.cocoonJS && this.game.device.iOS || window.PhaserGlobal && window.PhaserGlobal.fakeiOSTouchLock) && this.setTouchLock()
            },
            setTouchLock: function() {
                this.noAudio || window.PhaserGlobal && !0 === window.PhaserGlobal.disableAudio || (this.game.device.iOSVersion > 8 ? this.game.input.touch.addTouchLockCallback(this.unlock, this, !0) : this.game.input.touch.addTouchLockCallback(this.unlock, this), this.touchLocked = !0)
            },
            unlock: function() {
                if (this.noAudio || !this.touchLocked || null !== this._unlockSource) return !0;
                if (this.usingAudioTag) this.touchLocked = !1, this._unlockSource = null;
                else if (this.usingWebAudio) {
                    var t = this.context.createBuffer(1, 1, 22050);
                    this._unlockSource = this.context.createBufferSource(), this._unlockSource.buffer = t, this._unlockSource.connect(this.context.destination), void 0 === this._unlockSource.start ? this._unlockSource.noteOn(0) : this._unlockSource.start(0)
                }
                return !0
            },
            stopAll: function() {
                if (!this.noAudio)
                    for (var t = 0; t < this._sounds.length; t++) this._sounds[t] && this._sounds[t].stop()
            },
            pauseAll: function() {
                if (!this.noAudio)
                    for (var t = 0; t < this._sounds.length; t++) this._sounds[t] && this._sounds[t].pause()
            },
            resumeAll: function() {
                if (!this.noAudio)
                    for (var t = 0; t < this._sounds.length; t++) this._sounds[t] && this._sounds[t].resume()
            },
            decode: function(t, e) {
                e = e || null;
                var i = this.game.cache.getSoundData(t);
                if (i && !1 === this.game.cache.isSoundDecoded(t)) {
                    this.game.cache.updateSound(t, "isDecoding", !0);
                    var s = this;
                    try {
                        this.context.decodeAudioData(i, function(i) {
                            i && (s.game.cache.decodedSound(t, i), s.onSoundDecode.dispatch(t, e))
                        })
                    } catch (t) {}
                }
            },
            setDecodedCallback: function(t, e, i) {
                "string" == typeof t && (t = [t]), this._watchList.reset();
                for (var s = 0; s < t.length; s++) t[s] instanceof n.Sound ? this.game.cache.isSoundDecoded(t[s].key) || this._watchList.add(t[s].key) : this.game.cache.isSoundDecoded(t[s]) || this._watchList.add(t[s]);
                0 === this._watchList.total ? (this._watching = !1, e.call(i)) : (this._watching = !0, this._watchCallback = e, this._watchContext = i)
            },
            update: function() {
                if (!this.noAudio) {
                    !this.touchLocked || null === this._unlockSource || this._unlockSource.playbackState !== this._unlockSource.PLAYING_STATE && this._unlockSource.playbackState !== this._unlockSource.FINISHED_STATE || (this.touchLocked = !1, this._unlockSource = null);
                    for (var t = 0; t < this._sounds.length; t++) this._sounds[t].update();
                    if (this._watching) {
                        for (var e = this._watchList.first; e;) this.game.cache.isSoundDecoded(e) && this._watchList.remove(e), e = this._watchList.next;
                        0 === this._watchList.total && (this._watching = !1, this._watchCallback.call(this._watchContext))
                    }
                }
            },
            add: function(t, e, i, s) {
                void 0 === e && (e = 1), void 0 === i && (i = !1), void 0 === s && (s = this.connectToMaster);
                var o = new n.Sound(this.game, t, e, i, s);
                return this._sounds.push(o), o
            },
            addSprite: function(t) {
                return new n.AudioSprite(this.game, t)
            },
            remove: function(t) {
                for (var e = this._sounds.length; e--;)
                    if (this._sounds[e] === t) return this._sounds[e].destroy(!1), this._sounds.splice(e, 1), !0;
                return !1
            },
            removeByKey: function(t) {
                for (var e = this._sounds.length, i = 0; e--;) this._sounds[e].key === t && (this._sounds[e].destroy(!1), this._sounds.splice(e, 1), i++);
                return i
            },
            play: function(t, e, i) {
                if (!this.noAudio) {
                    var s = this.add(t, e, i);
                    return s.play(), s
                }
            },
            setMute: function() {
                if (!this._muted) {
                    this._muted = !0, this.usingWebAudio && (this._muteVolume = this.masterGain.gain.value, this.masterGain.gain.value = 0);
                    for (var t = 0; t < this._sounds.length; t++) this._sounds[t].usingAudioTag && (this._sounds[t].mute = !0);
                    this.onMute.dispatch()
                }
            },
            unsetMute: function() {
                if (this._muted && !this._codeMuted) {
                    this._muted = !1, this.usingWebAudio && (this.masterGain.gain.value = this._muteVolume);
                    for (var t = 0; t < this._sounds.length; t++) this._sounds[t].usingAudioTag && (this._sounds[t].mute = !1);
                    this.onUnMute.dispatch()
                }
            },
            destroy: function() {
                this.stopAll();
                for (var t = 0; t < this._sounds.length; t++) this._sounds[t] && this._sounds[t].destroy();
                this._sounds = [], this.onSoundDecode.dispose(), this.context && (window.PhaserGlobal ? window.PhaserGlobal.audioContext = this.context : this.context.close && this.context.close())
            }
        }, n.SoundManager.prototype.constructor = n.SoundManager, Object.defineProperty(n.SoundManager.prototype, "mute", {
            get: function() {
                return this._muted
            },
            set: function(t) {
                if (t = t || !1) {
                    if (this._muted) return;
                    this._codeMuted = !0, this.setMute()
                } else {
                    if (!this._muted) return;
                    this._codeMuted = !1, this.unsetMute()
                }
            }
        }), Object.defineProperty(n.SoundManager.prototype, "volume", {
            get: function() {
                return this._volume
            },
            set: function(t) {
                if (t < 0 ? t = 0 : t > 1 && (t = 1), this._volume !== t) {
                    if (this._volume = t, this.usingWebAudio) this.masterGain.gain.value = t;
                    else
                        for (var e = 0; e < this._sounds.length; e++) this._sounds[e].usingAudioTag && this._sounds[e].updateGlobalVolume(t);
                    this.onVolumeChange.dispatch(t)
                }
            }
        }), n.ScaleManager = function(t, e, i) {
            this.game = t, this.dom = n.DOM, this.grid = null, this.width = 0, this.height = 0, this.minWidth = null, this.maxWidth = null, this.minHeight = null, this.maxHeight = null, this.offset = new n.Point, this.forceLandscape = !1, this.forcePortrait = !1, this.incorrectOrientation = !1, this._pageAlignHorizontally = !1, this._pageAlignVertically = !1, this.onOrientationChange = new n.Signal, this.enterIncorrectOrientation = new n.Signal, this.leaveIncorrectOrientation = new n.Signal, this.hasPhaserSetFullScreen = !1, this.fullScreenTarget = null, this._createdFullScreenTarget = null, this.onFullScreenInit = new n.Signal, this.onFullScreenChange = new n.Signal, this.onFullScreenError = new n.Signal, this.screenOrientation = this.dom.getScreenOrientation(), this.scaleFactor = new n.Point(1, 1), this.scaleFactorInversed = new n.Point(1, 1), this.margin = {
                left: 0,
                top: 0,
                right: 0,
                bottom: 0,
                x: 0,
                y: 0
            }, this.bounds = new n.Rectangle, this.aspectRatio = 0, this.sourceAspectRatio = 0, this.event = null, this.windowConstraints = {
                right: "layout",
                bottom: ""
            }, this.compatibility = {
                supportsFullScreen: !1,
                orientationFallback: null,
                noMargins: !1,
                scrollTo: null,
                forceMinimumDocumentHeight: !1,
                canExpandParent: !0,
                clickTrampoline: ""
            }, this._scaleMode = n.ScaleManager.NO_SCALE, this._fullScreenScaleMode = n.ScaleManager.NO_SCALE, this.parentIsWindow = !1, this.parentNode = null, this.parentScaleFactor = new n.Point(1, 1), this.trackParentInterval = 2e3, this.onSizeChange = new n.Signal, this.onResize = null, this.onResizeContext = null, this._pendingScaleMode = null, this._fullScreenRestore = null, this._gameSize = new n.Rectangle, this._userScaleFactor = new n.Point(1, 1), this._userScaleTrim = new n.Point(0, 0), this._lastUpdate = 0, this._updateThrottle = 0, this._updateThrottleReset = 100, this._parentBounds = new n.Rectangle, this._tempBounds = new n.Rectangle, this._lastReportedCanvasSize = new n.Rectangle, this._lastReportedGameSize = new n.Rectangle, this._booted = !1, t.config && this.parseConfig(t.config), this.setupScale(e, i)
        }, n.ScaleManager.EXACT_FIT = 0, n.ScaleManager.NO_SCALE = 1, n.ScaleManager.SHOW_ALL = 2, n.ScaleManager.RESIZE = 3, n.ScaleManager.USER_SCALE = 4, n.ScaleManager.prototype = {
            boot: function() {
                var t = this.compatibility;
                t.supportsFullScreen = this.game.device.fullscreen && !this.game.device.cocoonJS, this.game.device.iPad || this.game.device.webApp || this.game.device.desktop || (this.game.device.android && !this.game.device.chrome ? t.scrollTo = new n.Point(0, 1) : t.scrollTo = new n.Point(0, 0)), this.game.device.desktop ? (t.orientationFallback = "screen", t.clickTrampoline = "when-not-mouse") : (t.orientationFallback = "", t.clickTrampoline = "");
                var e = this;
                this._orientationChange = function(t) {
                    return e.orientationChange(t)
                }, this._windowResize = function(t) {
                    return e.windowResize(t)
                }, window.addEventListener("orientationchange", this._orientationChange, !1), window.addEventListener("resize", this._windowResize, !1), this.compatibility.supportsFullScreen && (this._fullScreenChange = function(t) {
                    return e.fullScreenChange(t)
                }, this._fullScreenError = function(t) {
                    return e.fullScreenError(t)
                }, document.addEventListener("webkitfullscreenchange", this._fullScreenChange, !1), document.addEventListener("mozfullscreenchange", this._fullScreenChange, !1), document.addEventListener("MSFullscreenChange", this._fullScreenChange, !1), document.addEventListener("fullscreenchange", this._fullScreenChange, !1), document.addEventListener("webkitfullscreenerror", this._fullScreenError, !1), document.addEventListener("mozfullscreenerror", this._fullScreenError, !1), document.addEventListener("MSFullscreenError", this._fullScreenError, !1), document.addEventListener("fullscreenerror", this._fullScreenError, !1)), this.game.onResume.add(this._gameResumed, this), this.dom.getOffset(this.game.canvas, this.offset), this.bounds.setTo(this.offset.x, this.offset.y, this.width, this.height), this.setGameSize(this.game.width, this.game.height), this.screenOrientation = this.dom.getScreenOrientation(this.compatibility.orientationFallback), n.FlexGrid && (this.grid = new n.FlexGrid(this, this.width, this.height)), this._booted = !0, null !== this._pendingScaleMode && (this.scaleMode = this._pendingScaleMode, this._pendingScaleMode = null)
            },
            parseConfig: function(t) {
                void 0 !== t.scaleMode && (this._booted ? this.scaleMode = t.scaleMode : this._pendingScaleMode = t.scaleMode), void 0 !== t.fullScreenScaleMode && (this.fullScreenScaleMode = t.fullScreenScaleMode), t.fullScreenTarget && (this.fullScreenTarget = t.fullScreenTarget)
            },
            setupScale: function(t, e) {
                var i, s = new n.Rectangle;
                "" !== this.game.parent && ("string" == typeof this.game.parent ? i = document.getElementById(this.game.parent) : this.game.parent && 1 === this.game.parent.nodeType && (i = this.game.parent)), i ? (this.parentNode = i, this.parentIsWindow = !1, this.getParentBounds(this._parentBounds), s.width = this._parentBounds.width, s.height = this._parentBounds.height, this.offset.set(this._parentBounds.x, this._parentBounds.y)) : (this.parentNode = null, this.parentIsWindow = !0, s.width = this.dom.visualBounds.width, s.height = this.dom.visualBounds.height, this.offset.set(0, 0));
                var o = 0,
                    r = 0;
                "number" == typeof t ? o = t : (this.parentScaleFactor.x = parseInt(t, 10) / 100, o = s.width * this.parentScaleFactor.x), "number" == typeof e ? r = e : (this.parentScaleFactor.y = parseInt(e, 10) / 100, r = s.height * this.parentScaleFactor.y), o = Math.floor(o), r = Math.floor(r), this._gameSize.setTo(0, 0, o, r), this.updateDimensions(o, r, !1)
            },
            _gameResumed: function() {
                this.queueUpdate(!0)
            },
            setGameSize: function(t, e) {
                this._gameSize.setTo(0, 0, t, e), this.currentScaleMode !== n.ScaleManager.RESIZE && this.updateDimensions(t, e, !0), this.queueUpdate(!0)
            },
            setUserScale: function(t, e, i, s) {
                this._userScaleFactor.setTo(t, e), this._userScaleTrim.setTo(0 | i, 0 | s), this.queueUpdate(!0)
            },
            setResizeCallback: function(t, e) {
                this.onResize = t, this.onResizeContext = e
            },
            signalSizeChange: function() {
                if (!n.Rectangle.sameDimensions(this, this._lastReportedCanvasSize) || !n.Rectangle.sameDimensions(this.game, this._lastReportedGameSize)) {
                    var t = this.width,
                        e = this.height;
                    this._lastReportedCanvasSize.setTo(0, 0, t, e), this._lastReportedGameSize.setTo(0, 0, this.game.width, this.game.height), this.grid && this.grid.onResize(t, e), this.onSizeChange.dispatch(this, t, e), this.currentScaleMode === n.ScaleManager.RESIZE && (this.game.state.resize(t, e), this.game.load.resize(t, e))
                }
            },
            setMinMax: function(t, e, i, s) {
                this.minWidth = t, this.minHeight = e, void 0 !== i && (this.maxWidth = i), void 0 !== s && (this.maxHeight = s)
            },
            preUpdate: function() {
                if (!(this.game.time.time < this._lastUpdate + this._updateThrottle)) {
                    var t = this._updateThrottle;
                    this._updateThrottleReset = t >= 400 ? 0 : 100, this.dom.getOffset(this.game.canvas, this.offset);
                    var e = this._parentBounds.width,
                        i = this._parentBounds.height,
                        s = this.getParentBounds(this._parentBounds),
                        o = s.width !== e || s.height !== i,
                        r = this.updateOrientationState();
                    (o || r) && (this.onResize && this.onResize.call(this.onResizeContext, this, s), this.updateLayout(), this.signalSizeChange());
                    var a = 2 * this._updateThrottle;
                    this._updateThrottle < t && (a = Math.min(t, this._updateThrottleReset)), this._updateThrottle = n.Math.clamp(a, 25, this.trackParentInterval), this._lastUpdate = this.game.time.time
                }
            },
            pauseUpdate: function() {
                this.preUpdate(), this._updateThrottle = this.trackParentInterval
            },
            updateDimensions: function(t, e, i) {
                this.width = t * this.parentScaleFactor.x, this.height = e * this.parentScaleFactor.y, this.game.width = this.width, this.game.height = this.height, this.sourceAspectRatio = this.width / this.height, this.updateScalingAndBounds(), i && (this.game.renderer.resize(this.width, this.height), this.game.camera.setSize(this.width, this.height), this.game.world.resize(this.width, this.height))
            },
            updateScalingAndBounds: function() {
                this.scaleFactor.x = this.game.width / this.width, this.scaleFactor.y = this.game.height / this.height, this.scaleFactorInversed.x = this.width / this.game.width, this.scaleFactorInversed.y = this.height / this.game.height, this.aspectRatio = this.width / this.height, this.game.canvas && this.dom.getOffset(this.game.canvas, this.offset), this.bounds.setTo(this.offset.x, this.offset.y, this.width, this.height), this.game.input && this.game.input.scale && this.game.input.scale.setTo(this.scaleFactor.x, this.scaleFactor.y)
            },
            forceOrientation: function(t, e) {
                void 0 === e && (e = !1), this.forceLandscape = t, this.forcePortrait = e, this.queueUpdate(!0)
            },
            classifyOrientation: function(t) {
                return "portrait-primary" === t || "portrait-secondary" === t ? "portrait" : "landscape-primary" === t || "landscape-secondary" === t ? "landscape" : null
            },
            updateOrientationState: function() {
                var t = this.screenOrientation,
                    e = this.incorrectOrientation;
                this.screenOrientation = this.dom.getScreenOrientation(this.compatibility.orientationFallback), this.incorrectOrientation = this.forceLandscape && !this.isLandscape || this.forcePortrait && !this.isPortrait;
                var i = t !== this.screenOrientation,
                    s = e !== this.incorrectOrientation;
                return s && (this.incorrectOrientation ? this.enterIncorrectOrientation.dispatch() : this.leaveIncorrectOrientation.dispatch()), (i || s) && this.onOrientationChange.dispatch(this, t, e), i || s
            },
            orientationChange: function(t) {
                this.event = t, this.queueUpdate(!0)
            },
            windowResize: function(t) {
                this.event = t, this.queueUpdate(!0)
            },
            scrollTop: function() {
                var t = this.compatibility.scrollTo;
                t && window.scrollTo(t.x, t.y)
            },
            refresh: function() {
                this.scrollTop(), this.queueUpdate(!0)
            },
            updateLayout: function() {
                var t = this.currentScaleMode;
                if (t !== n.ScaleManager.RESIZE) {
                    if (this.scrollTop(), this.compatibility.forceMinimumDocumentHeight && (document.documentElement.style.minHeight = window.innerHeight + "px"), this.incorrectOrientation ? this.setMaximum() : t === n.ScaleManager.EXACT_FIT ? this.setExactFit() : t === n.ScaleManager.SHOW_ALL ? !this.isFullScreen && this.boundingParent && this.compatibility.canExpandParent ? (this.setShowAll(!0), this.resetCanvas(), this.setShowAll()) : this.setShowAll() : t === n.ScaleManager.NO_SCALE ? (this.width = this.game.width, this.height = this.game.height) : t === n.ScaleManager.USER_SCALE && (this.width = this.game.width * this._userScaleFactor.x - this._userScaleTrim.x, this.height = this.game.height * this._userScaleFactor.y - this._userScaleTrim.y), !this.compatibility.canExpandParent && (t === n.ScaleManager.SHOW_ALL || t === n.ScaleManager.USER_SCALE)) {
                        var e = this.getParentBounds(this._tempBounds);
                        this.width = Math.min(this.width, e.width), this.height = Math.min(this.height, e.height)
                    }
                    this.width = 0 | this.width, this.height = 0 | this.height, this.reflowCanvas()
                } else this.reflowGame()
            },
            getParentBounds: function(t) {
                var e = t || new n.Rectangle,
                    i = this.boundingParent,
                    s = this.dom.visualBounds,
                    o = this.dom.layoutBounds;
                if (i) {
                    var r = i.getBoundingClientRect(),
                        a = i.offsetParent ? i.offsetParent.getBoundingClientRect() : i.getBoundingClientRect();
                    e.setTo(r.left - a.left, r.top - a.top, r.width, r.height);
                    var h = this.windowConstraints;
                    if (h.right) {
                        var l = "layout" === h.right ? o : s;
                        e.right = Math.min(e.right, l.width)
                    }
                    if (h.bottom) {
                        l = "layout" === h.bottom ? o : s;
                        e.bottom = Math.min(e.bottom, l.height)
                    }
                } else e.setTo(0, 0, s.width, s.height);
                return e.setTo(Math.round(e.x), Math.round(e.y), Math.round(e.width), Math.round(e.height)), e
            },
            alignCanvas: function(t, e) {
                var i = this.getParentBounds(this._tempBounds),
                    s = this.game.canvas,
                    n = this.margin;
                if (t) {
                    n.left = n.right = 0;
                    var o = s.getBoundingClientRect();
                    if (this.width < i.width && !this.incorrectOrientation) {
                        var r = o.left - i.x,
                            a = i.width / 2 - this.width / 2,
                            h = (a = Math.max(a, 0)) - r;
                        n.left = Math.round(h)
                    }
                    s.style.marginLeft = n.left + "px", 0 !== n.left && (n.right = -(i.width - o.width - n.left), s.style.marginRight = n.right + "px")
                }
                if (e) {
                    n.top = n.bottom = 0;
                    o = s.getBoundingClientRect();
                    if (this.height < i.height && !this.incorrectOrientation) {
                        r = o.top - i.y, a = i.height / 2 - this.height / 2, h = (a = Math.max(a, 0)) - r;
                        n.top = Math.round(h)
                    }
                    s.style.marginTop = n.top + "px", 0 !== n.top && (n.bottom = -(i.height - o.height - n.top), s.style.marginBottom = n.bottom + "px")
                }
                n.x = n.left, n.y = n.top
            },
            reflowGame: function() {
                this.resetCanvas("", "");
                var t = this.getParentBounds(this._tempBounds);
                this.updateDimensions(t.width, t.height, !0)
            },
            reflowCanvas: function() {
                this.incorrectOrientation || (this.width = n.Math.clamp(this.width, this.minWidth || 0, this.maxWidth || this.width), this.height = n.Math.clamp(this.height, this.minHeight || 0, this.maxHeight || this.height)), this.resetCanvas(), this.compatibility.noMargins || (this.isFullScreen && this._createdFullScreenTarget ? this.alignCanvas(!0, !0) : this.alignCanvas(this.pageAlignHorizontally, this.pageAlignVertically)), this.updateScalingAndBounds()
            },
            resetCanvas: function(t, e) {
                void 0 === t && (t = this.width + "px"), void 0 === e && (e = this.height + "px");
                var i = this.game.canvas;
                this.compatibility.noMargins || (i.style.marginLeft = "", i.style.marginTop = "", i.style.marginRight = "", i.style.marginBottom = ""), i.style.width = t, i.style.height = e
            },
            queueUpdate: function(t) {
                t && (this._parentBounds.width = 0, this._parentBounds.height = 0), this._updateThrottle = this._updateThrottleReset
            },
            reset: function(t) {
                t && this.grid && this.grid.reset()
            },
            setMaximum: function() {
                this.width = this.dom.visualBounds.width, this.height = this.dom.visualBounds.height
            },
            setShowAll: function(t) {
                var e, i = this.getParentBounds(this._tempBounds),
                    s = i.width,
                    n = i.height;
                e = t ? Math.max(n / this.game.height, s / this.game.width) : Math.min(n / this.game.height, s / this.game.width), this.width = Math.round(this.game.width * e), this.height = Math.round(this.game.height * e)
            },
            setExactFit: function() {
                var t = this.getParentBounds(this._tempBounds);
                this.width = t.width, this.height = t.height, this.isFullScreen || (this.maxWidth && (this.width = Math.min(this.width, this.maxWidth)), this.maxHeight && (this.height = Math.min(this.height, this.maxHeight)))
            },
            createFullScreenTarget: function() {
                var t = document.createElement("div");
                return t.style.margin = "0", t.style.padding = "0", t.style.background = "#000", t
            },
            startFullScreen: function(t, e) {
                if (this.isFullScreen) return !1;
                if (this.compatibility.supportsFullScreen) {
                    if ("when-not-mouse" === this.compatibility.clickTrampoline) {
                        var i = this.game.input;
                        if (i.activePointer && i.activePointer !== i.mousePointer && (e || !1 !== e)) return void i.activePointer.addClickTrampoline("startFullScreen", this.startFullScreen, this, [t, !1])
                    }
                    void 0 !== t && this.game.renderType === n.CANVAS && (this.game.stage.smoothed = t);
                    var s = this.fullScreenTarget;
                    s || (this.cleanupCreatedTarget(), this._createdFullScreenTarget = this.createFullScreenTarget(), s = this._createdFullScreenTarget);
                    var o = {
                        targetElement: s
                    };
                    if (this.hasPhaserSetFullScreen = !0, this.onFullScreenInit.dispatch(this, o), this._createdFullScreenTarget) {
                        var r = this.game.canvas;
                        r.parentNode.insertBefore(s, r), s.appendChild(r)
                    }
                    return this.game.device.fullscreenKeyboard ? s[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT) : s[this.game.device.requestFullscreen](), !0
                }
                var a = this;
                setTimeout(function() {
                    a.fullScreenError()
                }, 10)
            },
            stopFullScreen: function() {
                return !(!this.isFullScreen || !this.compatibility.supportsFullScreen || (this.hasPhaserSetFullScreen = !1, document[this.game.device.cancelFullscreen](), 0))
            },
            cleanupCreatedTarget: function() {
                var t = this._createdFullScreenTarget;
                if (t && t.parentNode) {
                    var e = t.parentNode;
                    e.insertBefore(this.game.canvas, t), e.removeChild(t)
                }
                this._createdFullScreenTarget = null
            },
            prepScreenMode: function(t) {
                var e = !!this._createdFullScreenTarget,
                    i = this._createdFullScreenTarget || this.fullScreenTarget;
                t ? (e || this.fullScreenScaleMode === n.ScaleManager.EXACT_FIT) && i !== this.game.canvas && (this._fullScreenRestore = {
                    targetWidth: i.style.width,
                    targetHeight: i.style.height
                }, i.style.width = "100%", i.style.height = "100%") : (this._fullScreenRestore && (i.style.width = this._fullScreenRestore.targetWidth, i.style.height = this._fullScreenRestore.targetHeight, this._fullScreenRestore = null), this.updateDimensions(this._gameSize.width, this._gameSize.height, !0), this.resetCanvas())
            },
            fullScreenChange: function(t) {
                this.event = t, this.isFullScreen ? (this.prepScreenMode(!0), this.updateLayout(), this.queueUpdate(!0)) : (this.prepScreenMode(!1), this.cleanupCreatedTarget(), this.updateLayout(), this.queueUpdate(!0)), this.onFullScreenChange.dispatch(this, this.width, this.height)
            },
            fullScreenError: function(t) {
                this.event = t, this.cleanupCreatedTarget(), console.warn("Phaser.ScaleManager: requestFullscreen failed or device does not support the Fullscreen API"), this.onFullScreenError.dispatch(this)
            },
            scaleSprite: function(t, e, i, s) {
                if (void 0 === e && (e = this.width), void 0 === i && (i = this.height), void 0 === s && (s = !1), !t || !t.scale) return t;
                if (t.scale.x = 1, t.scale.y = 1, t.width <= 0 || t.height <= 0 || e <= 0 || i <= 0) return t;
                var n = e,
                    o = t.height * e / t.width,
                    r = t.width * i / t.height,
                    a = i,
                    h = r > e;
                return (h = h ? s : !s) ? (t.width = Math.floor(n), t.height = Math.floor(o)) : (t.width = Math.floor(r), t.height = Math.floor(a)), t
            },
            destroy: function() {
                this.game.onResume.remove(this._gameResumed, this), window.removeEventListener("orientationchange", this._orientationChange, !1), window.removeEventListener("resize", this._windowResize, !1), this.compatibility.supportsFullScreen && (document.removeEventListener("webkitfullscreenchange", this._fullScreenChange, !1), document.removeEventListener("mozfullscreenchange", this._fullScreenChange, !1), document.removeEventListener("MSFullscreenChange", this._fullScreenChange, !1), document.removeEventListener("fullscreenchange", this._fullScreenChange, !1), document.removeEventListener("webkitfullscreenerror", this._fullScreenError, !1), document.removeEventListener("mozfullscreenerror", this._fullScreenError, !1), document.removeEventListener("MSFullscreenError", this._fullScreenError, !1), document.removeEventListener("fullscreenerror", this._fullScreenError, !1))
            }
        }, n.ScaleManager.prototype.constructor = n.ScaleManager, Object.defineProperty(n.ScaleManager.prototype, "boundingParent", {
            get: function() {
                return this.parentIsWindow || this.isFullScreen && this.hasPhaserSetFullScreen && !this._createdFullScreenTarget ? null : this.game.canvas && this.game.canvas.parentNode || null
            }
        }), Object.defineProperty(n.ScaleManager.prototype, "scaleMode", {
            get: function() {
                return this._scaleMode
            },
            set: function(t) {
                return t !== this._scaleMode && (this.isFullScreen || (this.updateDimensions(this._gameSize.width, this._gameSize.height, !0), this.queueUpdate(!0)), this._scaleMode = t), this._scaleMode
            }
        }), Object.defineProperty(n.ScaleManager.prototype, "fullScreenScaleMode", {
            get: function() {
                return this._fullScreenScaleMode
            },
            set: function(t) {
                return t !== this._fullScreenScaleMode && (this.isFullScreen ? (this.prepScreenMode(!1), this._fullScreenScaleMode = t, this.prepScreenMode(!0), this.queueUpdate(!0)) : this._fullScreenScaleMode = t), this._fullScreenScaleMode
            }
        }), Object.defineProperty(n.ScaleManager.prototype, "currentScaleMode", {
            get: function() {
                return this.isFullScreen ? this._fullScreenScaleMode : this._scaleMode
            }
        }), Object.defineProperty(n.ScaleManager.prototype, "pageAlignHorizontally", {
            get: function() {
                return this._pageAlignHorizontally
            },
            set: function(t) {
                t !== this._pageAlignHorizontally && (this._pageAlignHorizontally = t, this.queueUpdate(!0))
            }
        }), Object.defineProperty(n.ScaleManager.prototype, "pageAlignVertically", {
            get: function() {
                return this._pageAlignVertically
            },
            set: function(t) {
                t !== this._pageAlignVertically && (this._pageAlignVertically = t, this.queueUpdate(!0))
            }
        }), Object.defineProperty(n.ScaleManager.prototype, "isFullScreen", {
            get: function() {
                return !!(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)
            }
        }), Object.defineProperty(n.ScaleManager.prototype, "isPortrait", {
            get: function() {
                return "portrait" === this.classifyOrientation(this.screenOrientation)
            }
        }), Object.defineProperty(n.ScaleManager.prototype, "isLandscape", {
            get: function() {
                return "landscape" === this.classifyOrientation(this.screenOrientation)
            }
        }), Object.defineProperty(n.ScaleManager.prototype, "isGamePortrait", {
            get: function() {
                return this.height > this.width
            }
        }), Object.defineProperty(n.ScaleManager.prototype, "isGameLandscape", {
            get: function() {
                return this.width > this.height
            }
        }), n.Utils.Debug = function(t) {
            this.game = t, this.sprite = null, this.bmd = null, this.canvas = null, this.context = null, this.font = "14px Courier", this.columnWidth = 100, this.lineHeight = 16, this.renderShadow = !0, this.currentX = 0, this.currentY = 0, this.currentAlpha = 1, this.dirty = !1
        }, n.Utils.Debug.prototype = {
            boot: function() {
                this.game.renderType === n.CANVAS ? this.context = this.game.context : (this.bmd = new n.BitmapData(this.game, "__DEBUG", this.game.width, this.game.height, !0), this.sprite = this.game.make.image(0, 0, this.bmd), this.game.stage.addChild(this.sprite), this.game.scale.onSizeChange.add(this.resize, this), this.canvas = n.CanvasPool.create(this, this.game.width, this.game.height), this.context = this.canvas.getContext("2d"))
            },
            resize: function(t, e, i) {
                this.bmd.resize(e, i), this.canvas.width = e, this.canvas.height = i
            },
            preUpdate: function() {
                this.dirty && this.sprite && (this.bmd.clear(), this.bmd.draw(this.canvas, 0, 0), this.context.clearRect(0, 0, this.game.width, this.game.height), this.dirty = !1)
            },
            reset: function() {
                this.context && this.context.clearRect(0, 0, this.game.width, this.game.height), this.sprite && this.bmd.clear()
            },
            start: function(t, e, i, s) {
                "number" != typeof t && (t = 0), "number" != typeof e && (e = 0), i = i || "rgb(255,255,255)", void 0 === s && (s = 0), this.currentX = t, this.currentY = e, this.currentColor = i, this.columnWidth = s, this.dirty = !0, this.context.save(), this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.strokeStyle = i, this.context.fillStyle = i, this.context.font = this.font, this.context.globalAlpha = this.currentAlpha
            },
            stop: function() {
                this.context.restore()
            },
            line: function() {
                for (var t = this.currentX, e = 0; e < arguments.length; e++) this.renderShadow && (this.context.fillStyle = "rgb(0,0,0)", this.context.fillText(arguments[e], t + 1, this.currentY + 1), this.context.fillStyle = this.currentColor), this.context.fillText(arguments[e], t, this.currentY), t += this.columnWidth;
                this.currentY += this.lineHeight
            },
            soundInfo: function(t, e, i, s) {
                this.start(e, i, s), this.line("Sound: " + t.key + " Locked: " + t.game.sound.touchLocked), this.line("Is Ready?: " + this.game.cache.isSoundReady(t.key) + " Pending Playback: " + t.pendingPlayback), this.line("Decoded: " + t.isDecoded + " Decoding: " + t.isDecoding), this.line("Total Duration: " + t.totalDuration + " Playing: " + t.isPlaying), this.line("Time: " + t.currentTime), this.line("Volume: " + t.volume + " Muted: " + t.mute), this.line("WebAudio: " + t.usingWebAudio + " Audio: " + t.usingAudioTag), "" !== t.currentMarker && (this.line("Marker: " + t.currentMarker + " Duration: " + t.duration + " (ms: " + t.durationMS + ")"), this.line("Start: " + t.markers[t.currentMarker].start + " Stop: " + t.markers[t.currentMarker].stop), this.line("Position: " + t.position)), this.stop()
            },
            cameraInfo: function(t, e, i, s) {
                this.start(e, i, s), this.line("Camera (" + t.width + " x " + t.height + ")"), this.line("X: " + t.x + " Y: " + t.y), t.bounds && this.line("Bounds x: " + t.bounds.x + " Y: " + t.bounds.y + " w: " + t.bounds.width + " h: " + t.bounds.height), this.line("View x: " + t.view.x + " Y: " + t.view.y + " w: " + t.view.width + " h: " + t.view.height), this.line("Total in view: " + t.totalInView), this.stop()
            },
            timer: function(t, e, i, s) {
                this.start(e, i, s), this.line("Timer (running: " + t.running + " expired: " + t.expired + ")"), this.line("Next Tick: " + t.next + " Duration: " + t.duration), this.line("Paused: " + t.paused + " Length: " + t.length), this.stop()
            },
            pointer: function(t, e, i, s, n) {
                null != t && (void 0 === e && (e = !1), i = i || "rgba(0,255,0,0.5)", s = s || "rgba(255,0,0,0.5)", !0 === e && !0 === t.isUp || (this.start(t.x, t.y - 100, n), this.context.beginPath(), this.context.arc(t.x, t.y, t.circle.radius, 0, 2 * Math.PI), t.active ? this.context.fillStyle = i : this.context.fillStyle = s, this.context.fill(), this.context.closePath(), this.context.beginPath(), this.context.moveTo(t.positionDown.x, t.positionDown.y), this.context.lineTo(t.position.x, t.position.y), this.context.lineWidth = 2, this.context.stroke(), this.context.closePath(), this.line("ID: " + t.id + " Active: " + t.active), this.line("World X: " + t.worldX + " World Y: " + t.worldY), this.line("Screen X: " + t.x + " Screen Y: " + t.y + " In: " + t.withinGame), this.line("Duration: " + t.duration + " ms"), this.line("is Down: " + t.isDown + " is Up: " + t.isUp), this.stop()))
            },
            spriteInputInfo: function(t, e, i, s) {
                this.start(e, i, s), this.line("Sprite Input: (" + t.width + " x " + t.height + ")"), this.line("x: " + t.input.pointerX().toFixed(1) + " y: " + t.input.pointerY().toFixed(1)), this.line("over: " + t.input.pointerOver() + " duration: " + t.input.overDuration().toFixed(0)), this.line("down: " + t.input.pointerDown() + " duration: " + t.input.downDuration().toFixed(0)), this.line("just over: " + t.input.justOver() + " just out: " + t.input.justOut()), this.stop()
            },
            key: function(t, e, i, s) {
                this.start(e, i, s, 150), this.line("Key:", t.keyCode, "isDown:", t.isDown), this.line("justDown:", t.justDown, "justUp:", t.justUp), this.line("Time Down:", t.timeDown.toFixed(0), "duration:", t.duration.toFixed(0)), this.stop()
            },
            inputInfo: function(t, e, i) {
                this.start(t, e, i), this.line("Input"), this.line("X: " + this.game.input.x + " Y: " + this.game.input.y), this.line("World X: " + this.game.input.worldX + " World Y: " + this.game.input.worldY), this.line("Scale X: " + this.game.input.scale.x.toFixed(1) + " Scale Y: " + this.game.input.scale.x.toFixed(1)), this.line("Screen X: " + this.game.input.activePointer.screenX + " Screen Y: " + this.game.input.activePointer.screenY), this.stop()
            },
            spriteBounds: function(t, e, i) {
                var s = t.getBounds();
                s.x += this.game.camera.x, s.y += this.game.camera.y, this.rectangle(s, e, i)
            },
            ropeSegments: function(t, e, i) {
                var s = this;
                t.segments.forEach(function(t) {
                    s.rectangle(t, e, i)
                }, this)
            },
            spriteInfo: function(t, e, i, s) {
                this.start(e, i, s), this.line("Sprite:  (" + t.width + " x " + t.height + ") anchor: " + t.anchor.x + " x " + t.anchor.y), this.line("x: " + t.x.toFixed(1) + " y: " + t.y.toFixed(1)), this.line("angle: " + t.angle.toFixed(1) + " rotation: " + t.rotation.toFixed(1)), this.line("visible: " + t.visible + " in camera: " + t.inCamera), this.line("bounds x: " + t._bounds.x.toFixed(1) + " y: " + t._bounds.y.toFixed(1) + " w: " + t._bounds.width.toFixed(1) + " h: " + t._bounds.height.toFixed(1)), this.stop()
            },
            spriteCoords: function(t, e, i, s) {
                this.start(e, i, s, 100), t.name && this.line(t.name), this.line("x:", t.x.toFixed(2), "y:", t.y.toFixed(2)), this.line("pos x:", t.position.x.toFixed(2), "pos y:", t.position.y.toFixed(2)), this.line("world x:", t.world.x.toFixed(2), "world y:", t.world.y.toFixed(2)), this.stop()
            },
            lineInfo: function(t, e, i, s) {
                this.start(e, i, s, 80), this.line("start.x:", t.start.x.toFixed(2), "start.y:", t.start.y.toFixed(2)), this.line("end.x:", t.end.x.toFixed(2), "end.y:", t.end.y.toFixed(2)), this.line("length:", t.length.toFixed(2), "angle:", t.angle), this.stop()
            },
            pixel: function(t, e, i, s) {
                s = s || 2, this.start(), this.context.fillStyle = i, this.context.fillRect(t, e, s, s), this.stop()
            },
            geom: function(t, e, i, s) {
                void 0 === i && (i = !0), void 0 === s && (s = 0), e = e || "rgba(0,255,0,0.4)", this.start(), this.context.fillStyle = e, this.context.strokeStyle = e, t instanceof n.Rectangle || 1 === s ? i ? this.context.fillRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height) : this.context.strokeRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height) : t instanceof n.Circle || 2 === s ? (this.context.beginPath(), this.context.arc(t.x - this.game.camera.x, t.y - this.game.camera.y, t.radius, 0, 2 * Math.PI, !1), this.context.closePath(), i ? this.context.fill() : this.context.stroke()) : t instanceof n.Point || 3 === s ? this.context.fillRect(t.x - this.game.camera.x, t.y - this.game.camera.y, 4, 4) : (t instanceof n.Line || 4 === s) && (this.context.lineWidth = 1, this.context.beginPath(), this.context.moveTo(t.start.x + .5 - this.game.camera.x, t.start.y + .5 - this.game.camera.y), this.context.lineTo(t.end.x + .5 - this.game.camera.x, t.end.y + .5 - this.game.camera.y), this.context.closePath(), this.context.stroke()), this.stop()
            },
            rectangle: function(t, e, i) {
                void 0 === i && (i = !0), e = e || "rgba(0, 255, 0, 0.4)", this.start(), i ? (this.context.fillStyle = e, this.context.fillRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height)) : (this.context.strokeStyle = e, this.context.strokeRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height)), this.stop()
            },
            text: function(t, e, i, s, n) {
                s = s || "rgb(255,255,255)", n = n || "16px Courier", this.start(), this.context.font = n, this.renderShadow && (this.context.fillStyle = "rgb(0,0,0)", this.context.fillText(t, e + 1, i + 1)), this.context.fillStyle = s, this.context.fillText(t, e, i), this.stop()
            },
            quadTree: function(t, e) {
                e = e || "rgba(255,0,0,0.3)", this.start();
                var i = t.bounds;
                if (0 === t.nodes.length) {
                    this.context.strokeStyle = e, this.context.strokeRect(i.x, i.y, i.width, i.height), this.text("size: " + t.objects.length, i.x + 4, i.y + 16, "rgb(0,200,0)", "12px Courier"), this.context.strokeStyle = "rgb(0,255,0)";
                    for (var s = 0; s < t.objects.length; s++) this.context.strokeRect(t.objects[s].x, t.objects[s].y, t.objects[s].width, t.objects[s].height)
                } else
                    for (s = 0; s < t.nodes.length; s++) this.quadTree(t.nodes[s]);
                this.stop()
            },
            body: function(t, e, i) {
                t.body && (this.start(), t.body.type === n.Physics.ARCADE ? n.Physics.Arcade.Body.render(this.context, t.body, e, i) : t.body.type === n.Physics.NINJA ? n.Physics.Ninja.Body.render(this.context, t.body, e, i) : t.body.type === n.Physics.BOX2D && n.Physics.Box2D.renderBody(this.context, t.body, e), this.stop())
            },
            bodyInfo: function(t, e, i, s) {
                t.body && (this.start(e, i, s, 210), t.body.type === n.Physics.ARCADE ? n.Physics.Arcade.Body.renderBodyInfo(this, t.body) : t.body.type === n.Physics.BOX2D && this.game.physics.box2d.renderBodyInfo(this, t.body), this.stop())
            },
            box2dWorld: function() {
                this.start(), this.context.translate(-this.game.camera.view.x, -this.game.camera.view.y, 0), this.game.physics.box2d.renderDebugDraw(this.context), this.stop()
            },
            box2dBody: function(t, e) {
                this.start(), n.Physics.Box2D.renderBody(this.context, t, e), this.stop()
            },
            displayList: function(t) {
                if (void 0 === t && (t = this.game.world), t.hasOwnProperty("renderOrderID") ? console.log("[" + t.renderOrderID + "]", t) : console.log("[]", t), t.children && t.children.length > 0)
                    for (var e = 0; e < t.children.length; e++) this.game.debug.displayList(t.children[e])
            },
            destroy: function() {
                n.CanvasPool.remove(this)
            }
        }, n.Utils.Debug.prototype.constructor = n.Utils.Debug, n.DOM = {
            getOffset: function(t, e) {
                e = e || new n.Point;
                var i = t.getBoundingClientRect(),
                    s = n.DOM.scrollY,
                    o = n.DOM.scrollX,
                    r = document.documentElement.clientTop,
                    a = document.documentElement.clientLeft;
                return e.x = i.left + o - a, e.y = i.top + s - r, e
            },
            getBounds: function(t, e) {
                return void 0 === e && (e = 0), !(!(t = t && !t.nodeType ? t[0] : t) || 1 !== t.nodeType) && this.calibrate(t.getBoundingClientRect(), e)
            },
            calibrate: function(t, e) {
                e = +e || 0;
                var i = {
                    width: 0,
                    height: 0,
                    left: 0,
                    right: 0,
                    top: 0,
                    bottom: 0
                };
                return i.width = (i.right = t.right + e) - (i.left = t.left - e), i.height = (i.bottom = t.bottom + e) - (i.top = t.top - e), i
            },
            getAspectRatio: function(t) {
                var e = (t = null == t ? this.visualBounds : 1 === t.nodeType ? this.getBounds(t) : t).width,
                    i = t.height;
                return "function" == typeof e && (e = e.call(t)), "function" == typeof i && (i = i.call(t)), e / i
            },
            inLayoutViewport: function(t, e) {
                var i = this.getBounds(t, e);
                return !!i && i.bottom >= 0 && i.right >= 0 && i.top <= this.layoutBounds.width && i.left <= this.layoutBounds.height
            },
            getScreenOrientation: function(t) {
                var e = window.screen,
                    i = e.orientation || e.mozOrientation || e.msOrientation;
                if (i && "string" == typeof i.type) return i.type;
                if ("string" == typeof i) return i;
                var s = "portrait-primary",
                    n = "landscape-primary";
                if ("screen" === t) return e.height > e.width ? s : n;
                if ("viewport" === t) return this.visualBounds.height > this.visualBounds.width ? s : n;
                if ("window.orientation" === t && "number" == typeof window.orientation) return 0 === window.orientation || 180 === window.orientation ? s : n;
                if (window.matchMedia) {
                    if (window.matchMedia("(orientation: portrait)").matches) return s;
                    if (window.matchMedia("(orientation: landscape)").matches) return n
                }
                return this.visualBounds.height > this.visualBounds.width ? s : n
            },
            visualBounds: new n.Rectangle,
            layoutBounds: new n.Rectangle,
            documentBounds: new n.Rectangle
        }, n.Device.whenReady(function(t) {
            var e = window && "pageXOffset" in window ? function() {
                    return window.pageXOffset
                } : function() {
                    return document.documentElement.scrollLeft
                },
                i = window && "pageYOffset" in window ? function() {
                    return window.pageYOffset
                } : function() {
                    return document.documentElement.scrollTop
                };
            if (Object.defineProperty(n.DOM, "scrollX", {
                    get: e
                }), Object.defineProperty(n.DOM, "scrollY", {
                    get: i
                }), Object.defineProperty(n.DOM.visualBounds, "x", {
                    get: e
                }), Object.defineProperty(n.DOM.visualBounds, "y", {
                    get: i
                }), Object.defineProperty(n.DOM.layoutBounds, "x", {
                    value: 0
                }), Object.defineProperty(n.DOM.layoutBounds, "y", {
                    value: 0
                }), t.desktop && document.documentElement.clientWidth <= window.innerWidth && document.documentElement.clientHeight <= window.innerHeight) {
                var s = function() {
                        return Math.max(window.innerWidth, document.documentElement.clientWidth)
                    },
                    o = function() {
                        return Math.max(window.innerHeight, document.documentElement.clientHeight)
                    };
                Object.defineProperty(n.DOM.visualBounds, "width", {
                    get: s
                }), Object.defineProperty(n.DOM.visualBounds, "height", {
                    get: o
                }), Object.defineProperty(n.DOM.layoutBounds, "width", {
                    get: s
                }), Object.defineProperty(n.DOM.layoutBounds, "height", {
                    get: o
                })
            } else Object.defineProperty(n.DOM.visualBounds, "width", {
                get: function() {
                    return window.innerWidth
                }
            }), Object.defineProperty(n.DOM.visualBounds, "height", {
                get: function() {
                    return window.innerHeight
                }
            }), Object.defineProperty(n.DOM.layoutBounds, "width", {
                get: function() {
                    var t = document.documentElement.clientWidth,
                        e = window.innerWidth;
                    return t < e ? e : t
                }
            }), Object.defineProperty(n.DOM.layoutBounds, "height", {
                get: function() {
                    var t = document.documentElement.clientHeight,
                        e = window.innerHeight;
                    return t < e ? e : t
                }
            });
            Object.defineProperty(n.DOM.documentBounds, "x", {
                value: 0
            }), Object.defineProperty(n.DOM.documentBounds, "y", {
                value: 0
            }), Object.defineProperty(n.DOM.documentBounds, "width", {
                get: function() {
                    var t = document.documentElement;
                    return Math.max(t.clientWidth, t.offsetWidth, t.scrollWidth)
                }
            }), Object.defineProperty(n.DOM.documentBounds, "height", {
                get: function() {
                    var t = document.documentElement;
                    return Math.max(t.clientHeight, t.offsetHeight, t.scrollHeight)
                }
            })
        }, null, !0), n.ArraySet = function(t) {
            this.position = 0, this.list = t || []
        }, n.ArraySet.prototype = {
            add: function(t) {
                return this.exists(t) || this.list.push(t), t
            },
            getIndex: function(t) {
                return this.list.indexOf(t)
            },
            getByKey: function(t, e) {
                for (var i = this.list.length; i--;)
                    if (this.list[i][t] === e) return this.list[i];
                return null
            },
            exists: function(t) {
                return this.list.indexOf(t) > -1
            },
            reset: function() {
                this.list.length = 0
            },
            remove: function(t) {
                var e = this.list.indexOf(t);
                if (e > -1) return this.list.splice(e, 1), t
            },
            setAll: function(t, e) {
                for (var i = this.list.length; i--;) this.list[i] && (this.list[i][t] = e)
            },
            callAll: function(t) {
                for (var e = Array.prototype.slice.call(arguments, 1), i = this.list.length; i--;) this.list[i] && this.list[i][t] && this.list[i][t].apply(this.list[i], e)
            },
            removeAll: function(t) {
                void 0 === t && (t = !1);
                for (var e = this.list.length; e--;)
                    if (this.list[e]) {
                        var i = this.remove(this.list[e]);
                        t && i.destroy()
                    } this.position = 0, this.list = []
            }
        }, Object.defineProperty(n.ArraySet.prototype, "total", {
            get: function() {
                return this.list.length
            }
        }), Object.defineProperty(n.ArraySet.prototype, "first", {
            get: function() {
                return this.position = 0, this.list.length > 0 ? this.list[0] : null
            }
        }), Object.defineProperty(n.ArraySet.prototype, "next", {
            get: function() {
                return this.position < this.list.length ? (this.position++, this.list[this.position]) : null
            }
        }), n.ArraySet.prototype.constructor = n.ArraySet, n.ArrayUtils = {
            getRandomItem: function(t, e, i) {
                if (null === t) return null;
                void 0 === e && (e = 0), void 0 === i && (i = t.length);
                var s = e + Math.floor(Math.random() * i);
                return void 0 === t[s] ? null : t[s]
            },
            removeRandomItem: function(t, e, i) {
                if (null == t) return null;
                void 0 === e && (e = 0), void 0 === i && (i = t.length);
                var s = e + Math.floor(Math.random() * i);
                if (s < t.length) {
                    var n = t.splice(s, 1);
                    return void 0 === n[0] ? null : n[0]
                }
                return null
            },
            shuffle: function(t) {
                for (var e = t.length - 1; e > 0; e--) {
                    var i = Math.floor(Math.random() * (e + 1)),
                        s = t[e];
                    t[e] = t[i], t[i] = s
                }
                return t
            },
            transposeMatrix: function(t) {
                for (var e = t.length, i = t[0].length, s = new Array(i), n = 0; n < i; n++) {
                    s[n] = new Array(e);
                    for (var o = e - 1; o > -1; o--) s[n][o] = t[o][n]
                }
                return s
            },
            rotateMatrix: function(t, e) {
                if ("string" != typeof e && (e = (e % 360 + 360) % 360), 90 === e || -270 === e || "rotateLeft" === e) t = (t = n.ArrayUtils.transposeMatrix(t)).reverse();
                else if (-90 === e || 270 === e || "rotateRight" === e) t = t.reverse(), t = n.ArrayUtils.transposeMatrix(t);
                else if (180 === Math.abs(e) || "rotate180" === e) {
                    for (var i = 0; i < t.length; i++) t[i].reverse();
                    t = t.reverse()
                }
                return t
            },
            findClosest: function(t, e) {
                if (!e.length) return NaN;
                if (1 === e.length || t < e[0]) return e[0];
                for (var i = 1; e[i] < t;) i++;
                var s = e[i - 1],
                    n = i < e.length ? e[i] : Number.POSITIVE_INFINITY;
                return n - t <= t - s ? n : s
            },
            rotateRight: function(t) {
                var e = t.pop();
                return t.unshift(e), e
            },
            rotateLeft: function(t) {
                var e = t.shift();
                return t.push(e), e
            },
            rotate: function(t) {
                var e = t.shift();
                return t.push(e), e
            },
            numberArray: function(t, e) {
                for (var i = [], s = t; s <= e; s++) i.push(s);
                return i
            },
            numberArrayStep: function(t, e, i) {
                null != t || (t = 0), null != e || (e = t, t = 0), void 0 === i && (i = 1);
                for (var s = [], o = Math.max(n.Math.roundAwayFromZero((e - t) / (i || 1)), 0), r = 0; r < o; r++) s.push(t), t += i;
                return s
            }
        }, n.LinkedList = function() {
            this.next = null, this.prev = null, this.first = null, this.last = null, this.total = 0
        }, n.LinkedList.prototype = {
            add: function(t) {
                return 0 === this.total && null === this.first && null === this.last ? (this.first = t, this.last = t, this.next = t, t.prev = this, this.total++, t) : (this.last.next = t, t.prev = this.last, this.last = t, this.total++, t)
            },
            reset: function() {
                this.first = null, this.last = null, this.next = null, this.prev = null, this.total = 0
            },
            remove: function(t) {
                if (1 === this.total) return this.reset(), void(t.next = t.prev = null);
                t === this.first ? this.first = this.first.next : t === this.last && (this.last = this.last.prev), t.prev && (t.prev.next = t.next), t.next && (t.next.prev = t.prev), t.next = t.prev = null, null === this.first && (this.last = null), this.total--
            },
            callAll: function(t) {
                if (this.first && this.last) {
                    var e = this.first;
                    do {
                        e && e[t] && e[t].call(e), e = e.next
                    } while (e !== this.last.next)
                }
            }
        }, n.LinkedList.prototype.constructor = n.LinkedList, n.Create = function(t) {
            this.game = t, this.bmd = null, this.canvas = null, this.ctx = null, this.palettes = [{
                0: "#000",
                1: "#9D9D9D",
                2: "#FFF",
                3: "#BE2633",
                4: "#E06F8B",
                5: "#493C2B",
                6: "#A46422",
                7: "#EB8931",
                8: "#F7E26B",
                9: "#2F484E",
                A: "#44891A",
                B: "#A3CE27",
                C: "#1B2632",
                D: "#005784",
                E: "#31A2F2",
                F: "#B2DCEF"
            }, {
                0: "#000",
                1: "#191028",
                2: "#46af45",
                3: "#a1d685",
                4: "#453e78",
                5: "#7664fe",
                6: "#833129",
                7: "#9ec2e8",
                8: "#dc534b",
                9: "#e18d79",
                A: "#d6b97b",
                B: "#e9d8a1",
                C: "#216c4b",
                D: "#d365c8",
                E: "#afaab9",
                F: "#f5f4eb"
            }, {
                0: "#000",
                1: "#2234d1",
                2: "#0c7e45",
                3: "#44aacc",
                4: "#8a3622",
                5: "#5c2e78",
                6: "#aa5c3d",
                7: "#b5b5b5",
                8: "#5e606e",
                9: "#4c81fb",
                A: "#6cd947",
                B: "#7be2f9",
                C: "#eb8a60",
                D: "#e23d69",
                E: "#ffd93f",
                F: "#fff"
            }, {
                0: "#000",
                1: "#fff",
                2: "#8b4131",
                3: "#7bbdc5",
                4: "#8b41ac",
                5: "#6aac41",
                6: "#3931a4",
                7: "#d5de73",
                8: "#945a20",
                9: "#5a4100",
                A: "#bd736a",
                B: "#525252",
                C: "#838383",
                D: "#acee8b",
                E: "#7b73de",
                F: "#acacac"
            }, {
                0: "#000",
                1: "#191028",
                2: "#46af45",
                3: "#a1d685",
                4: "#453e78",
                5: "#7664fe",
                6: "#833129",
                7: "#9ec2e8",
                8: "#dc534b",
                9: "#e18d79",
                A: "#d6b97b",
                B: "#e9d8a1",
                C: "#216c4b",
                D: "#d365c8",
                E: "#afaab9",
                F: "#fff"
            }]
        }, n.Create.PALETTE_ARNE = 0, n.Create.PALETTE_JMP = 1, n.Create.PALETTE_CGA = 2, n.Create.PALETTE_C64 = 3, n.Create.PALETTE_JAPANESE_MACHINE = 4, n.Create.prototype = {
            texture: function(t, e, i, s, n) {
                void 0 === i && (i = 8), void 0 === s && (s = i), void 0 === n && (n = 0);
                var o = e[0].length * i,
                    r = e.length * s;
                null === this.bmd && (this.bmd = this.game.make.bitmapData(), this.canvas = this.bmd.canvas, this.ctx = this.bmd.context), this.bmd.resize(o, r), this.bmd.clear();
                for (var a = 0; a < e.length; a++)
                    for (var h = e[a], l = 0; l < h.length; l++) {
                        var c = h[l];
                        "." !== c && " " !== c && (this.ctx.fillStyle = this.palettes[n][c], this.ctx.fillRect(l * i, a * s, i, s))
                    }
                return this.bmd.generateTexture(t)
            },
            grid: function(t, e, i, s, n, o) {
                null === this.bmd && (this.bmd = this.game.make.bitmapData(), this.canvas = this.bmd.canvas, this.ctx = this.bmd.context), this.bmd.resize(e, i), this.ctx.fillStyle = o;
                for (var r = 0; r < i; r += n) this.ctx.fillRect(0, r, e, 1);
                for (var a = 0; a < e; a += s) this.ctx.fillRect(a, 0, 1, i);
                return this.bmd.generateTexture(t)
            }
        }, n.Create.prototype.constructor = n.Create, n.FlexGrid = function(t, e, i) {
            this.game = t.game, this.manager = t, this.width = e, this.height = i, this.boundsCustom = new n.Rectangle(0, 0, e, i), this.boundsFluid = new n.Rectangle(0, 0, e, i), this.boundsFull = new n.Rectangle(0, 0, e, i), this.boundsNone = new n.Rectangle(0, 0, e, i), this.positionCustom = new n.Point(0, 0), this.positionFluid = new n.Point(0, 0), this.positionFull = new n.Point(0, 0), this.positionNone = new n.Point(0, 0), this.scaleCustom = new n.Point(1, 1), this.scaleFluid = new n.Point(1, 1), this.scaleFluidInversed = new n.Point(1, 1), this.scaleFull = new n.Point(1, 1), this.scaleNone = new n.Point(1, 1), this.customWidth = 0, this.customHeight = 0, this.customOffsetX = 0, this.customOffsetY = 0, this.ratioH = e / i, this.ratioV = i / e, this.multiplier = 0, this.layers = []
        }, n.FlexGrid.prototype = {
            setSize: function(t, e) {
                this.width = t, this.height = e, this.ratioH = t / e, this.ratioV = e / t, this.scaleNone = new n.Point(1, 1), this.boundsNone.width = this.width, this.boundsNone.height = this.height, this.refresh()
            },
            createCustomLayer: function(t, e, i, s) {
                void 0 === s && (s = !0), this.customWidth = t, this.customHeight = e, this.boundsCustom.width = t, this.boundsCustom.height = e;
                var o = new n.FlexLayer(this, this.positionCustom, this.boundsCustom, this.scaleCustom);
                return s && this.game.world.add(o), this.layers.push(o), void 0 !== i && null !== typeof i && o.addMultiple(i), o
            },
            createFluidLayer: function(t, e) {
                void 0 === e && (e = !0);
                var i = new n.FlexLayer(this, this.positionFluid, this.boundsFluid, this.scaleFluid);
                return e && this.game.world.add(i), this.layers.push(i), void 0 !== t && null !== typeof t && i.addMultiple(t), i
            },
            createFullLayer: function(t) {
                var e = new n.FlexLayer(this, this.positionFull, this.boundsFull, this.scaleFluid);
                return this.game.world.add(e), this.layers.push(e), void 0 !== t && e.addMultiple(t), e
            },
            createFixedLayer: function(t) {
                var e = new n.FlexLayer(this, this.positionNone, this.boundsNone, this.scaleNone);
                return this.game.world.add(e), this.layers.push(e), void 0 !== t && e.addMultiple(t), e
            },
            reset: function() {
                for (var t = this.layers.length; t--;) this.layers[t].persist || (this.layers[t].position = null, this.layers[t].scale = null, this.layers.slice(t, 1))
            },
            onResize: function(t, e) {
                this.ratioH = t / e, this.ratioV = e / t, this.refresh(t, e)
            },
            refresh: function() {
                this.multiplier = Math.min(this.manager.height / this.height, this.manager.width / this.width), this.boundsFluid.width = Math.round(this.width * this.multiplier), this.boundsFluid.height = Math.round(this.height * this.multiplier), this.scaleFluid.set(this.boundsFluid.width / this.width, this.boundsFluid.height / this.height), this.scaleFluidInversed.set(this.width / this.boundsFluid.width, this.height / this.boundsFluid.height), this.scaleFull.set(this.boundsFull.width / this.width, this.boundsFull.height / this.height), this.boundsFull.width = Math.round(this.manager.width * this.scaleFluidInversed.x), this.boundsFull.height = Math.round(this.manager.height * this.scaleFluidInversed.y), this.boundsFluid.centerOn(this.manager.bounds.centerX, this.manager.bounds.centerY), this.boundsNone.centerOn(this.manager.bounds.centerX, this.manager.bounds.centerY), this.positionFluid.set(this.boundsFluid.x, this.boundsFluid.y), this.positionNone.set(this.boundsNone.x, this.boundsNone.y)
            },
            fitSprite: function(t) {
                this.manager.scaleSprite(t), t.x = this.manager.bounds.centerX, t.y = this.manager.bounds.centerY
            },
            debug: function() {
                this.game.debug.text(this.boundsFluid.width + " x " + this.boundsFluid.height, this.boundsFluid.x + 4, this.boundsFluid.y + 16), this.game.debug.geom(this.boundsFluid, "rgba(255,0,0,0.9", !1)
            }
        }, n.FlexGrid.prototype.constructor = n.FlexGrid, n.FlexLayer = function(t, e, i, s) {
            n.Group.call(this, t.game, null, "__flexLayer" + t.game.rnd.uuid(), !1), this.manager = t.manager, this.grid = t, this.persist = !1, this.position = e, this.bounds = i, this.scale = s, this.topLeft = i.topLeft, this.topMiddle = new n.Point(i.halfWidth, 0), this.topRight = i.topRight, this.bottomLeft = i.bottomLeft, this.bottomMiddle = new n.Point(i.halfWidth, i.bottom), this.bottomRight = i.bottomRight
        }, n.FlexLayer.prototype = Object.create(n.Group.prototype), n.FlexLayer.prototype.constructor = n.FlexLayer, n.FlexLayer.prototype.resize = function() {}, n.FlexLayer.prototype.debug = function() {
            this.game.debug.text(this.bounds.width + " x " + this.bounds.height, this.bounds.x + 4, this.bounds.y + 16), this.game.debug.geom(this.bounds, "rgba(0,0,255,0.9", !1), this.game.debug.geom(this.topLeft, "rgba(255,255,255,0.9"), this.game.debug.geom(this.topMiddle, "rgba(255,255,255,0.9"), this.game.debug.geom(this.topRight, "rgba(255,255,255,0.9")
        }, n.Color = {
            packPixel: function(t, e, i, s) {
                return n.Device.LITTLE_ENDIAN ? (s << 24 | i << 16 | e << 8 | t) >>> 0 : (t << 24 | e << 16 | i << 8 | s) >>> 0
            },
            unpackPixel: function(t, e, i, s) {
                return null != e || (e = n.Color.createColor()), null != i || (i = !1), null != s || (s = !1), n.Device.LITTLE_ENDIAN ? (e.a = (4278190080 & t) >>> 24, e.b = (16711680 & t) >>> 16, e.g = (65280 & t) >>> 8, e.r = 255 & t) : (e.r = (4278190080 & t) >>> 24, e.g = (16711680 & t) >>> 16, e.b = (65280 & t) >>> 8, e.a = 255 & t), e.color = t, e.rgba = "rgba(" + e.r + "," + e.g + "," + e.b + "," + e.a / 255 + ")", i && n.Color.RGBtoHSL(e.r, e.g, e.b, e), s && n.Color.RGBtoHSV(e.r, e.g, e.b, e), e
            },
            fromRGBA: function(t, e) {
                return e || (e = n.Color.createColor()), e.r = (4278190080 & t) >>> 24, e.g = (16711680 & t) >>> 16, e.b = (65280 & t) >>> 8, e.a = 255 & t, e.rgba = "rgba(" + e.r + "," + e.g + "," + e.b + "," + e.a + ")", e
            },
            toRGBA: function(t, e, i, s) {
                return t << 24 | e << 16 | i << 8 | s
            },
            toABGR: function(t, e, i, s) {
                return (s << 24 | i << 16 | e << 8 | t) >>> 0
            },
            hexToRGBArray: function(t) {
                return [(t >> 16 & 255) / 255, (t >> 8 & 255) / 255, (255 & t) / 255]
            },
            RGBArrayToHex: function(t) {
                return (255 * t[0] << 16) + (255 * t[1] << 8) + 255 * t[2]
            },
            RGBtoHSL: function(t, e, i, s) {
                s || (s = n.Color.createColor(t, e, i, 1)), t /= 255, e /= 255, i /= 255;
                var o = Math.min(t, e, i),
                    r = Math.max(t, e, i);
                if (s.h = 0, s.s = 0, s.l = (r + o) / 2, r !== o) {
                    var a = r - o;
                    s.s = s.l > .5 ? a / (2 - r - o) : a / (r + o), r === t ? s.h = (e - i) / a + (e < i ? 6 : 0) : r === e ? s.h = (i - t) / a + 2 : r === i && (s.h = (t - e) / a + 4), s.h /= 6
                }
                return s
            },
            HSLtoRGB: function(t, e, i, s) {
                if (s ? (s.r = i, s.g = i, s.b = i) : s = n.Color.createColor(i, i, i), 0 !== e) {
                    var o = i < .5 ? i * (1 + e) : i + e - i * e,
                        r = 2 * i - o;
                    s.r = n.Color.hueToColor(r, o, t + 1 / 3), s.g = n.Color.hueToColor(r, o, t), s.b = n.Color.hueToColor(r, o, t - 1 / 3)
                }
                return s.r = Math.floor(255 * s.r | 0), s.g = Math.floor(255 * s.g | 0), s.b = Math.floor(255 * s.b | 0), n.Color.updateColor(s), s
            },
            RGBtoHSV: function(t, e, i, s) {
                s || (s = n.Color.createColor(t, e, i, 255)), t /= 255, e /= 255, i /= 255;
                var o = Math.min(t, e, i),
                    r = Math.max(t, e, i),
                    a = r - o;
                return s.h = 0, s.s = 0 === r ? 0 : a / r, s.v = r, r !== o && (r === t ? s.h = (e - i) / a + (e < i ? 6 : 0) : r === e ? s.h = (i - t) / a + 2 : r === i && (s.h = (t - e) / a + 4), s.h /= 6), s
            },
            HSVtoRGB: function(t, e, i, s) {
                void 0 === s && (s = n.Color.createColor(0, 0, 0, 1, t, e, 0, i));
                var o, r, a, h = Math.floor(6 * t),
                    l = 6 * t - h,
                    c = i * (1 - e),
                    u = i * (1 - l * e),
                    d = i * (1 - (1 - l) * e);
                switch (h % 6) {
                    case 0:
                        o = i, r = d, a = c;
                        break;
                    case 1:
                        o = u, r = i, a = c;
                        break;
                    case 2:
                        o = c, r = i, a = d;
                        break;
                    case 3:
                        o = c, r = u, a = i;
                        break;
                    case 4:
                        o = d, r = c, a = i;
                        break;
                    case 5:
                        o = i, r = c, a = u
                }
                return s.r = Math.floor(255 * o), s.g = Math.floor(255 * r), s.b = Math.floor(255 * a), n.Color.updateColor(s), s
            },
            hueToColor: function(t, e, i) {
                return i < 0 && (i += 1), i > 1 && (i -= 1), i < 1 / 6 ? t + 6 * (e - t) * i : i < .5 ? e : i < 2 / 3 ? t + (e - t) * (2 / 3 - i) * 6 : t
            },
            createColor: function(t, e, i, s, o, r, a, h) {
                var l = {
                    r: t || 0,
                    g: e || 0,
                    b: i || 0,
                    a: s || 1,
                    h: o || 0,
                    s: r || 0,
                    l: a || 0,
                    v: h || 0,
                    color: 0,
                    color32: 0,
                    rgba: ""
                };
                return n.Color.updateColor(l)
            },
            updateColor: function(t) {
                return t.rgba = "rgba(" + t.r.toString() + "," + t.g.toString() + "," + t.b.toString() + "," + t.a.toString() + ")", t.color = n.Color.getColor(t.r, t.g, t.b), t.color32 = n.Color.getColor32(255 * t.a, t.r, t.g, t.b), t
            },
            getColor32: function(t, e, i, s) {
                return t << 24 | e << 16 | i << 8 | s
            },
            getColor: function(t, e, i) {
                return t << 16 | e << 8 | i
            },
            RGBtoString: function(t, e, i, s, o) {
                return void 0 === s && (s = 255), void 0 === o && (o = "#"), "#" === o ? "#" + ((1 << 24) + (t << 16) + (e << 8) + i).toString(16).slice(1) : "0x" + n.Color.componentToHex(s) + n.Color.componentToHex(t) + n.Color.componentToHex(e) + n.Color.componentToHex(i)
            },
            hexToRGB: function(t) {
                var e = n.Color.hexToColor(t);
                if (e) return n.Color.getColor32(e.a, e.r, e.g, e.b)
            },
            hexToColor: function(t, e) {
                t = t.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i, function(t, e, i, s) {
                    return e + e + i + i + s + s
                });
                var i = /^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);
                if (i) {
                    var s = parseInt(i[1], 16),
                        o = parseInt(i[2], 16),
                        r = parseInt(i[3], 16);
                    e ? (e.r = s, e.g = o, e.b = r) : e = n.Color.createColor(s, o, r)
                }
                return e
            },
            webToColor: function(t, e) {
                e || (e = n.Color.createColor());
                var i = /^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(t);
                return i && (e.r = parseInt(i[1], 10), e.g = parseInt(i[2], 10), e.b = parseInt(i[3], 10), e.a = void 0 !== i[4] ? parseFloat(i[4]) : 1, n.Color.updateColor(e)), e
            },
            valueToColor: function(t, e) {
                if (e || (e = n.Color.createColor()), "string" == typeof t) return 0 === t.indexOf("rgb") ? n.Color.webToColor(t, e) : (e.a = 1, n.Color.hexToColor(t, e));
                if ("number" == typeof t) {
                    var i = n.Color.getRGB(t);
                    return e.r = i.r, e.g = i.g, e.b = i.b, e.a = i.a / 255, e
                }
                return e
            },
            componentToHex: function(t) {
                var e = t.toString(16);
                return 1 === e.length ? "0" + e : e
            },
            HSVColorWheel: function(t, e) {
                void 0 === t && (t = 1), void 0 === e && (e = 1);
                for (var i = [], s = 0; s <= 359; s++) i.push(n.Color.HSVtoRGB(s / 359, t, e));
                return i
            },
            HSLColorWheel: function(t, e) {
                void 0 === t && (t = .5), void 0 === e && (e = .5);
                for (var i = [], s = 0; s <= 359; s++) i.push(n.Color.HSLtoRGB(s / 359, t, e));
                return i
            },
            interpolateColor: function(t, e, i, s, o) {
                void 0 === o && (o = 255);
                var r = n.Color.getRGB(t),
                    a = n.Color.getRGB(e),
                    h = (a.red - r.red) * s / i + r.red,
                    l = (a.green - r.green) * s / i + r.green,
                    c = (a.blue - r.blue) * s / i + r.blue;
                return n.Color.getColor32(o, h, l, c)
            },
            interpolateColorWithRGB: function(t, e, i, s, o, r) {
                var a = n.Color.getRGB(t),
                    h = (e - a.red) * r / o + a.red,
                    l = (i - a.green) * r / o + a.green,
                    c = (s - a.blue) * r / o + a.blue;
                return n.Color.getColor(h, l, c)
            },
            interpolateRGB: function(t, e, i, s, o, r, a, h) {
                var l = (s - t) * h / a + t,
                    c = (o - e) * h / a + e,
                    u = (r - i) * h / a + i;
                return n.Color.getColor(l, c, u)
            },
            getRandomColor: function(t, e, i) {
                if (void 0 === t && (t = 0), void 0 === e && (e = 255), void 0 === i && (i = 255), e > 255 || t > e) return n.Color.getColor(255, 255, 255);
                var s = t + Math.round(Math.random() * (e - t)),
                    o = t + Math.round(Math.random() * (e - t)),
                    r = t + Math.round(Math.random() * (e - t));
                return n.Color.getColor32(i, s, o, r)
            },
            getRGB: function(t) {
                return t > 16777215 ? {
                    alpha: t >>> 24,
                    red: t >> 16 & 255,
                    green: t >> 8 & 255,
                    blue: 255 & t,
                    a: t >>> 24,
                    r: t >> 16 & 255,
                    g: t >> 8 & 255,
                    b: 255 & t
                } : {
                    alpha: 255,
                    red: t >> 16 & 255,
                    green: t >> 8 & 255,
                    blue: 255 & t,
                    a: 255,
                    r: t >> 16 & 255,
                    g: t >> 8 & 255,
                    b: 255 & t
                }
            },
            getWebRGB: function(t) {
                if ("object" == typeof t) return "rgba(" + t.r.toString() + "," + t.g.toString() + "," + t.b.toString() + "," + (t.a / 255).toString() + ")";
                var e = n.Color.getRGB(t);
                return "rgba(" + e.r.toString() + "," + e.g.toString() + "," + e.b.toString() + "," + (e.a / 255).toString() + ")"
            },
            getAlpha: function(t) {
                return t >>> 24
            },
            getAlphaFloat: function(t) {
                return (t >>> 24) / 255
            },
            getRed: function(t) {
                return t >> 16 & 255
            },
            getGreen: function(t) {
                return t >> 8 & 255
            },
            getBlue: function(t) {
                return 255 & t
            },
            blendNormal: function(t) {
                return t
            },
            blendLighten: function(t, e) {
                return e > t ? e : t
            },
            blendDarken: function(t, e) {
                return e > t ? t : e
            },
            blendMultiply: function(t, e) {
                return t * e / 255
            },
            blendAverage: function(t, e) {
                return (t + e) / 2
            },
            blendAdd: function(t, e) {
                return Math.min(255, t + e)
            },
            blendSubtract: function(t, e) {
                return Math.max(0, t + e - 255)
            },
            blendDifference: function(t, e) {
                return Math.abs(t - e)
            },
            blendNegation: function(t, e) {
                return 255 - Math.abs(255 - t - e)
            },
            blendScreen: function(t, e) {
                return 255 - ((255 - t) * (255 - e) >> 8)
            },
            blendExclusion: function(t, e) {
                return t + e - 2 * t * e / 255
            },
            blendOverlay: function(t, e) {
                return e < 128 ? 2 * t * e / 255 : 255 - 2 * (255 - t) * (255 - e) / 255
            },
            blendSoftLight: function(t, e) {
                return e < 128 ? 2 * (64 + (t >> 1)) * (e / 255) : 255 - 2 * (255 - (64 + (t >> 1))) * (255 - e) / 255
            },
            blendHardLight: function(t, e) {
                return n.Color.blendOverlay(e, t)
            },
            blendColorDodge: function(t, e) {
                return 255 === e ? e : Math.min(255, (t << 8) / (255 - e))
            },
            blendColorBurn: function(t, e) {
                return 0 === e ? e : Math.max(0, 255 - (255 - t << 8) / e)
            },
            blendLinearDodge: function(t, e) {
                return n.Color.blendAdd(t, e)
            },
            blendLinearBurn: function(t, e) {
                return n.Color.blendSubtract(t, e)
            },
            blendLinearLight: function(t, e) {
                return e < 128 ? n.Color.blendLinearBurn(t, 2 * e) : n.Color.blendLinearDodge(t, 2 * (e - 128))
            },
            blendVividLight: function(t, e) {
                return e < 128 ? n.Color.blendColorBurn(t, 2 * e) : n.Color.blendColorDodge(t, 2 * (e - 128))
            },
            blendPinLight: function(t, e) {
                return e < 128 ? n.Color.blendDarken(t, 2 * e) : n.Color.blendLighten(t, 2 * (e - 128))
            },
            blendHardMix: function(t, e) {
                return n.Color.blendVividLight(t, e) < 128 ? 0 : 255
            },
            blendReflect: function(t, e) {
                return 255 === e ? e : Math.min(255, t * t / (255 - e))
            },
            blendGlow: function(t, e) {
                return n.Color.blendReflect(e, t)
            },
            blendPhoenix: function(t, e) {
                return Math.min(t, e) - Math.max(t, e) + 255
            }
        }, n.Physics = function(t, e) {
            e = e || {}, this.game = t, this.config = e, this.arcade = null, this.p2 = null, this.ninja = null, this.box2d = null, this.chipmunk = null, this.matter = null, this.parseConfig()
        }, n.Physics.ARCADE = 0, n.Physics.P2JS = 1, n.Physics.NINJA = 2, n.Physics.BOX2D = 3, n.Physics.CHIPMUNK = 4, n.Physics.MATTERJS = 5, n.Physics.prototype = {
            parseConfig: function() {
                this.config.hasOwnProperty("arcade") && !0 !== this.config.arcade || !n.Physics.hasOwnProperty("Arcade") || (this.arcade = new n.Physics.Arcade(this.game)), this.config.hasOwnProperty("ninja") && !0 === this.config.ninja && n.Physics.hasOwnProperty("Ninja") && (this.ninja = new n.Physics.Ninja(this.game)), this.config.hasOwnProperty("p2") && !0 === this.config.p2 && n.Physics.hasOwnProperty("P2") && (this.p2 = new n.Physics.P2(this.game, this.config)), this.config.hasOwnProperty("box2d") && !0 === this.config.box2d && n.Physics.hasOwnProperty("BOX2D") && (this.box2d = new n.Physics.BOX2D(this.game, this.config)), this.config.hasOwnProperty("matter") && !0 === this.config.matter && n.Physics.hasOwnProperty("Matter") && (this.matter = new n.Physics.Matter(this.game, this.config))
            },
            startSystem: function(t) {
                t === n.Physics.ARCADE ? this.arcade = new n.Physics.Arcade(this.game) : t === n.Physics.P2JS ? null === this.p2 ? this.p2 = new n.Physics.P2(this.game, this.config) : this.p2.reset() : t === n.Physics.NINJA ? this.ninja = new n.Physics.Ninja(this.game) : t === n.Physics.BOX2D ? null === this.box2d ? this.box2d = new n.Physics.Box2D(this.game, this.config) : this.box2d.reset() : t === n.Physics.MATTERJS && (null === this.matter ? this.matter = new n.Physics.Matter(this.game, this.config) : this.matter.reset())
            },
            enable: function(t, e, i) {
                void 0 === e && (e = n.Physics.ARCADE), void 0 === i && (i = !1), e === n.Physics.ARCADE ? this.arcade.enable(t) : e === n.Physics.P2JS && this.p2 ? this.p2.enable(t, i) : e === n.Physics.NINJA && this.ninja ? this.ninja.enableAABB(t) : e === n.Physics.BOX2D && this.box2d ? this.box2d.enable(t) : e === n.Physics.MATTERJS && this.matter ? this.matter.enable(t) : console.warn(t.key + " is attempting to enable a physics body using an unknown physics system.")
            },
            preUpdate: function() {
                this.p2 && this.p2.preUpdate(), this.box2d && this.box2d.preUpdate(), this.matter && this.matter.preUpdate()
            },
            update: function() {
                this.p2 && this.p2.update(), this.box2d && this.box2d.update(), this.matter && this.matter.update()
            },
            setBoundsToWorld: function() {
                this.arcade && this.arcade.setBoundsToWorld(), this.ninja && this.ninja.setBoundsToWorld(), this.p2 && this.p2.setBoundsToWorld(), this.box2d && this.box2d.setBoundsToWorld(), this.matter && this.matter.setBoundsToWorld()
            },
            clear: function() {
                this.p2 && this.p2.clear(), this.box2d && this.box2d.clear(), this.matter && this.matter.clear()
            },
            reset: function() {
                this.p2 && this.p2.reset(), this.box2d && this.box2d.reset(), this.matter && this.matter.reset()
            },
            destroy: function() {
                this.p2 && this.p2.destroy(), this.box2d && this.box2d.destroy(), this.matter && this.matter.destroy(), this.arcade = null, this.ninja = null, this.p2 = null, this.box2d = null, this.matter = null
            }
        }, n.Physics.prototype.constructor = n.Physics, n.Physics.Arcade = function(t) {
            this.game = t, this.gravity = new n.Point, this.bounds = new n.Rectangle(0, 0, t.world.width, t.world.height), this.checkCollision = {
                up: !0,
                down: !0,
                left: !0,
                right: !0
            }, this.maxObjects = 10, this.maxLevels = 4, this.OVERLAP_BIAS = 4, this.forceX = !1, this.sortDirection = n.Physics.Arcade.LEFT_RIGHT, this.skipQuadTree = !0, this.isPaused = !1, this.quadTree = new n.QuadTree(this.game.world.bounds.x, this.game.world.bounds.y, this.game.world.bounds.width, this.game.world.bounds.height, this.maxObjects, this.maxLevels), this._total = 0, this.setBoundsToWorld()
        }, n.Physics.Arcade.prototype.constructor = n.Physics.Arcade, n.Physics.Arcade.SORT_NONE = 0, n.Physics.Arcade.LEFT_RIGHT = 1, n.Physics.Arcade.RIGHT_LEFT = 2, n.Physics.Arcade.TOP_BOTTOM = 3, n.Physics.Arcade.BOTTOM_TOP = 4, n.Physics.Arcade.prototype = {
            setBounds: function(t, e, i, s) {
                this.bounds.setTo(t, e, i, s)
            },
            setBoundsToWorld: function() {
                this.bounds.copyFrom(this.game.world.bounds)
            },
            enable: function(t, e) {
                void 0 === e && (e = !0);
                var i = 1;
                if (Array.isArray(t))
                    for (i = t.length; i--;) t[i] instanceof n.Group ? this.enable(t[i].children, e) : (this.enableBody(t[i]), e && t[i].hasOwnProperty("children") && t[i].children.length > 0 && this.enable(t[i], !0));
                else t instanceof n.Group ? this.enable(t.children, e) : (this.enableBody(t), e && t.hasOwnProperty("children") && t.children.length > 0 && this.enable(t.children, !0))
            },
            enableBody: function(t) {
                t.hasOwnProperty("body") && null === t.body && (t.body = new n.Physics.Arcade.Body(t), t.parent && t.parent instanceof n.Group && t.parent.addToHash(t))
            },
            updateMotion: function(t) {
                var e = this.computeVelocity(0, t, t.angularVelocity, t.angularAcceleration, t.angularDrag, t.maxAngular) - t.angularVelocity;
                t.angularVelocity += e, t.rotation += t.angularVelocity * this.game.time.physicsElapsed, t.velocity.x = this.computeVelocity(1, t, t.velocity.x, t.acceleration.x, t.drag.x, t.maxVelocity.x), t.velocity.y = this.computeVelocity(2, t, t.velocity.y, t.acceleration.y, t.drag.y, t.maxVelocity.y)
            },
            computeVelocity: function(t, e, i, s, n, o) {
                return void 0 === o && (o = 1e4), 1 === t && e.allowGravity ? i += (this.gravity.x + e.gravity.x) * this.game.time.physicsElapsed : 2 === t && e.allowGravity && (i += (this.gravity.y + e.gravity.y) * this.game.time.physicsElapsed), s ? i += s * this.game.time.physicsElapsed : n && (i - (n *= this.game.time.physicsElapsed) > 0 ? i -= n : i + n < 0 ? i += n : i = 0), i > o ? i = o : i < -o && (i = -o), i
            },
            overlap: function(t, e, i, s, n) {
                if (i = i || null, s = s || null, n = n || i, this._total = 0, !Array.isArray(t) && Array.isArray(e))
                    for (var o = 0; o < e.length; o++) this.collideHandler(t, e[o], i, s, n, !0);
                else if (Array.isArray(t) && !Array.isArray(e))
                    for (o = 0; o < t.length; o++) this.collideHandler(t[o], e, i, s, n, !0);
                else if (Array.isArray(t) && Array.isArray(e))
                    for (o = 0; o < t.length; o++)
                        for (var r = 0; r < e.length; r++) this.collideHandler(t[o], e[r], i, s, n, !0);
                else this.collideHandler(t, e, i, s, n, !0);
                return this._total > 0
            },
            collide: function(t, e, i, s, n) {
                if (i = i || null, s = s || null, n = n || i, this._total = 0, !Array.isArray(t) && Array.isArray(e))
                    for (var o = 0; o < e.length; o++) this.collideHandler(t, e[o], i, s, n, !1);
                else if (Array.isArray(t) && !Array.isArray(e))
                    for (o = 0; o < t.length; o++) this.collideHandler(t[o], e, i, s, n, !1);
                else if (Array.isArray(t) && Array.isArray(e))
                    for (o = 0; o < t.length; o++)
                        for (var r = 0; r < e.length; r++) this.collideHandler(t[o], e[r], i, s, n, !1);
                else this.collideHandler(t, e, i, s, n, !1);
                return this._total > 0
            },
            sortLeftRight: function(t, e) {
                return t.body && e.body ? t.body.x - e.body.x : 0
            },
            sortRightLeft: function(t, e) {
                return t.body && e.body ? e.body.x - t.body.x : 0
            },
            sortTopBottom: function(t, e) {
                return t.body && e.body ? t.body.y - e.body.y : 0
            },
            sortBottomTop: function(t, e) {
                return t.body && e.body ? e.body.y - t.body.y : 0
            },
            sort: function(t, e) {
                null !== t.physicsSortDirection ? e = t.physicsSortDirection : void 0 === e && (e = this.sortDirection), e === n.Physics.Arcade.LEFT_RIGHT ? t.hash.sort(this.sortLeftRight) : e === n.Physics.Arcade.RIGHT_LEFT ? t.hash.sort(this.sortRightLeft) : e === n.Physics.Arcade.TOP_BOTTOM ? t.hash.sort(this.sortTopBottom) : e === n.Physics.Arcade.BOTTOM_TOP && t.hash.sort(this.sortBottomTop)
            },
            collideHandler: function(t, e, i, s, o, r) {
                if (void 0 === e && t.physicsType === n.GROUP) return this.sort(t), void this.collideGroupVsSelf(t, i, s, o, r);
                t && e && t.exists && e.exists && (this.sortDirection !== n.Physics.Arcade.SORT_NONE && (t.physicsType === n.GROUP && this.sort(t), e.physicsType === n.GROUP && this.sort(e)), t.physicsType === n.SPRITE ? e.physicsType === n.SPRITE ? this.collideSpriteVsSprite(t, e, i, s, o, r) : e.physicsType === n.GROUP ? this.collideSpriteVsGroup(t, e, i, s, o, r) : e.physicsType === n.TILEMAPLAYER && this.collideSpriteVsTilemapLayer(t, e, i, s, o, r) : t.physicsType === n.GROUP ? e.physicsType === n.SPRITE ? this.collideSpriteVsGroup(e, t, i, s, o, r) : e.physicsType === n.GROUP ? this.collideGroupVsGroup(t, e, i, s, o, r) : e.physicsType === n.TILEMAPLAYER && this.collideGroupVsTilemapLayer(t, e, i, s, o, r) : t.physicsType === n.TILEMAPLAYER && (e.physicsType === n.SPRITE ? this.collideSpriteVsTilemapLayer(e, t, i, s, o, r) : e.physicsType === n.GROUP && this.collideGroupVsTilemapLayer(e, t, i, s, o, r)))
            },
            collideSpriteVsSprite: function(t, e, i, s, n, o) {
                return !(!t.body || !e.body || (this.separate(t.body, e.body, s, n, o) && (i && i.call(n, t, e), this._total++), 0))
            },
            collideSpriteVsGroup: function(t, e, i, s, o, r) {
                if (0 !== e.length && t.body)
                    if (this.skipQuadTree || t.body.skipQuadTree)
                        for (var a = {}, h = 0; h < e.hash.length; h++) {
                            var l = e.hash[h];
                            if (l && l.exists && l.body) {
                                if (a = l.body.getBounds(a), this.sortDirection === n.Physics.Arcade.LEFT_RIGHT) {
                                    if (t.body.right < a.x) break;
                                    if (a.right < t.body.x) continue
                                } else if (this.sortDirection === n.Physics.Arcade.RIGHT_LEFT) {
                                    if (t.body.x > a.right) break;
                                    if (a.x > t.body.right) continue
                                } else if (this.sortDirection === n.Physics.Arcade.TOP_BOTTOM) {
                                    if (t.body.bottom < a.y) break;
                                    if (a.bottom < t.body.y) continue
                                } else if (this.sortDirection === n.Physics.Arcade.BOTTOM_TOP) {
                                    if (t.body.y > a.bottom) break;
                                    if (a.y > t.body.bottom) continue
                                }
                                this.collideSpriteVsSprite(t, l, i, s, o, r)
                            }
                        } else {
                            this.quadTree.clear(), this.quadTree.reset(this.game.world.bounds.x, this.game.world.bounds.y, this.game.world.bounds.width, this.game.world.bounds.height, this.maxObjects, this.maxLevels), this.quadTree.populate(e);
                            var c = this.quadTree.retrieve(t);
                            for (h = 0; h < c.length; h++) this.separate(t.body, c[h], s, o, r) && (i && i.call(o, t, c[h].sprite), this._total++)
                        }
            },
            collideGroupVsSelf: function(t, e, i, s, o) {
                if (0 !== t.length)
                    for (var r = 0; r < t.hash.length; r++) {
                        var a = {},
                            h = t.hash[r];
                        if (h && h.exists && h.body) {
                            a = h.body.getBounds(a);
                            for (var l = r + 1; l < t.hash.length; l++) {
                                var c = {},
                                    u = t.hash[l];
                                if (u && u.exists && u.body) {
                                    if (c = u.body.getBounds(c), this.sortDirection === n.Physics.Arcade.LEFT_RIGHT) {
                                        if (a.right < c.x) break;
                                        if (c.right < a.x) continue
                                    } else if (this.sortDirection === n.Physics.Arcade.RIGHT_LEFT) {
                                        if (a.x > c.right) continue;
                                        if (c.x > a.right) break
                                    } else if (this.sortDirection === n.Physics.Arcade.TOP_BOTTOM) {
                                        if (a.bottom < c.y) continue;
                                        if (c.bottom < a.y) break
                                    } else if (this.sortDirection === n.Physics.Arcade.BOTTOM_TOP) {
                                        if (a.y > c.bottom) continue;
                                        if (c.y > h.body.bottom) break
                                    }
                                    this.collideSpriteVsSprite(h, u, e, i, s, o)
                                }
                            }
                        }
                    }
            },
            collideGroupVsGroup: function(t, e, i, s, o, r) {
                if (0 !== t.length && 0 !== e.length)
                    for (var a = 0; a < t.children.length; a++) t.children[a].exists && (t.children[a].physicsType === n.GROUP ? this.collideGroupVsGroup(t.children[a], e, i, s, o, r) : this.collideSpriteVsGroup(t.children[a], e, i, s, o, r))
            },
            separate: function(t, e, i, s, n) {
                if (!t.enable || !e.enable || t.checkCollision.none || e.checkCollision.none || !this.intersects(t, e)) return !1;
                if (i && !1 === i.call(s, t.sprite, e.sprite)) return !1;
                if (t.isCircle && e.isCircle) return this.separateCircle(t, e, n);
                if (t.isCircle !== e.isCircle) {
                    var o = t.isCircle ? e : t,
                        r = t.isCircle ? t : e,
                        a = {
                            x: o.x,
                            y: o.y,
                            right: o.right,
                            bottom: o.bottom
                        },
                        h = {
                            x: r.x + r.radius,
                            y: r.y + r.radius
                        };
                    if ((h.y < a.y || h.y > a.bottom) && (h.x < a.x || h.x > a.right)) return this.separateCircle(t, e, n)
                }
                var l = !1,
                    c = !1;
                this.forceX || Math.abs(this.gravity.y + t.gravity.y) < Math.abs(this.gravity.x + t.gravity.x) ? (l = this.separateX(t, e, n), this.intersects(t, e) && (c = this.separateY(t, e, n))) : (c = this.separateY(t, e, n), this.intersects(t, e) && (l = this.separateX(t, e, n)));
                var u = l || c;
                return u && (n ? (t.onOverlap && t.onOverlap.dispatch(t.sprite, e.sprite), e.onOverlap && e.onOverlap.dispatch(e.sprite, t.sprite)) : (t.onCollide && t.onCollide.dispatch(t.sprite, e.sprite), e.onCollide && e.onCollide.dispatch(e.sprite, t.sprite))), u
            },
            intersects: function(t, e) {
                return t !== e && (t.isCircle ? e.isCircle ? n.Math.distance(t.center.x, t.center.y, e.center.x, e.center.y) <= t.radius + e.radius : this.circleBodyIntersects(t, e) : e.isCircle ? this.circleBodyIntersects(e, t) : !(t.right <= e.position.x || t.bottom <= e.position.y || t.position.x >= e.right || t.position.y >= e.bottom))
            },
            circleBodyIntersects: function(t, e) {
                var i = n.Math.clamp(t.center.x, e.left, e.right),
                    s = n.Math.clamp(t.center.y, e.top, e.bottom);
                return (t.center.x - i) * (t.center.x - i) + (t.center.y - s) * (t.center.y - s) <= t.radius * t.radius
            },
            separateCircle: function(t, e, i) {
                this.getOverlapX(t, e), this.getOverlapY(t, e);
                var s = e.center.x - t.center.x,
                    o = e.center.y - t.center.y,
                    r = Math.atan2(o, s),
                    a = 0;
                if (t.isCircle !== e.isCircle) {
                    var h = {
                            x: e.isCircle ? t.position.x : e.position.x,
                            y: e.isCircle ? t.position.y : e.position.y,
                            right: e.isCircle ? t.right : e.right,
                            bottom: e.isCircle ? t.bottom : e.bottom
                        },
                        l = {
                            x: t.isCircle ? t.position.x + t.radius : e.position.x + e.radius,
                            y: t.isCircle ? t.position.y + t.radius : e.position.y + e.radius,
                            radius: t.isCircle ? t.radius : e.radius
                        };
                    l.y < h.y ? l.x < h.x ? a = n.Math.distance(l.x, l.y, h.x, h.y) - l.radius : l.x > h.right && (a = n.Math.distance(l.x, l.y, h.right, h.y) - l.radius) : l.y > h.bottom && (l.x < h.x ? a = n.Math.distance(l.x, l.y, h.x, h.bottom) - l.radius : l.x > h.right && (a = n.Math.distance(l.x, l.y, h.right, h.bottom) - l.radius)), a *= -1
                } else a = t.radius + e.radius - n.Math.distance(t.center.x, t.center.y, e.center.x, e.center.y);
                if (i || 0 === a || t.immovable && e.immovable || t.customSeparateX || e.customSeparateX) return 0 !== a && (t.onOverlap && t.onOverlap.dispatch(t.sprite, e.sprite), e.onOverlap && e.onOverlap.dispatch(e.sprite, t.sprite)), 0 !== a;
                var c = t.velocity.x * Math.cos(r) + t.velocity.y * Math.sin(r),
                    u = t.velocity.x * Math.sin(r) - t.velocity.y * Math.cos(r),
                    d = e.velocity.x * Math.cos(r) + e.velocity.y * Math.sin(r),
                    p = e.velocity.x * Math.sin(r) - e.velocity.y * Math.cos(r),
                    f = ((t.mass - e.mass) * c + 2 * e.mass * d) / (t.mass + e.mass),
                    m = (2 * t.mass * c + (e.mass - t.mass) * d) / (t.mass + e.mass);
                return t.immovable || (t.velocity.x = (f * Math.cos(r) - u * Math.sin(r)) * t.bounce.x, t.velocity.y = (u * Math.cos(r) + f * Math.sin(r)) * t.bounce.y), e.immovable || (e.velocity.x = (m * Math.cos(r) - p * Math.sin(r)) * e.bounce.x, e.velocity.y = (p * Math.cos(r) + m * Math.sin(r)) * e.bounce.y), Math.abs(r) < Math.PI / 2 ? t.velocity.x > 0 && !t.immovable && e.velocity.x > t.velocity.x ? t.velocity.x *= -1 : e.velocity.x < 0 && !e.immovable && t.velocity.x < e.velocity.x ? e.velocity.x *= -1 : t.velocity.y > 0 && !t.immovable && e.velocity.y > t.velocity.y ? t.velocity.y *= -1 : e.velocity.y < 0 && !e.immovable && t.velocity.y < e.velocity.y && (e.velocity.y *= -1) : Math.abs(r) > Math.PI / 2 && (t.velocity.x < 0 && !t.immovable && e.velocity.x < t.velocity.x ? t.velocity.x *= -1 : e.velocity.x > 0 && !e.immovable && t.velocity.x > e.velocity.x ? e.velocity.x *= -1 : t.velocity.y < 0 && !t.immovable && e.velocity.y < t.velocity.y ? t.velocity.y *= -1 : e.velocity.y > 0 && !e.immovable && t.velocity.x > e.velocity.y && (e.velocity.y *= -1)), t.immovable || (t.x += t.velocity.x * this.game.time.physicsElapsed - a * Math.cos(r), t.y += t.velocity.y * this.game.time.physicsElapsed - a * Math.sin(r)), e.immovable || (e.x += e.velocity.x * this.game.time.physicsElapsed + a * Math.cos(r), e.y += e.velocity.y * this.game.time.physicsElapsed + a * Math.sin(r)), t.onCollide && t.onCollide.dispatch(t.sprite, e.sprite), e.onCollide && e.onCollide.dispatch(e.sprite, t.sprite), !0
            },
            getOverlapX: function(t, e, i) {
                var s = 0,
                    n = t.deltaAbsX() + e.deltaAbsX() + this.OVERLAP_BIAS;
                return 0 === t.deltaX() && 0 === e.deltaX() ? (t.embedded = !0, e.embedded = !0) : t.deltaX() > e.deltaX() ? (s = t.right - e.x) > n && !i || !1 === t.checkCollision.right || !1 === e.checkCollision.left ? s = 0 : (t.touching.none = !1, t.touching.right = !0, e.touching.none = !1, e.touching.left = !0) : t.deltaX() < e.deltaX() && (-(s = t.x - e.width - e.x) > n && !i || !1 === t.checkCollision.left || !1 === e.checkCollision.right ? s = 0 : (t.touching.none = !1, t.touching.left = !0, e.touching.none = !1, e.touching.right = !0)), t.overlapX = s, e.overlapX = s, s
            },
            getOverlapY: function(t, e, i) {
                var s = 0,
                    n = t.deltaAbsY() + e.deltaAbsY() + this.OVERLAP_BIAS;
                return 0 === t.deltaY() && 0 === e.deltaY() ? (t.embedded = !0, e.embedded = !0) : t.deltaY() > e.deltaY() ? (s = t.bottom - e.y) > n && !i || !1 === t.checkCollision.down || !1 === e.checkCollision.up ? s = 0 : (t.touching.none = !1, t.touching.down = !0, e.touching.none = !1, e.touching.up = !0) : t.deltaY() < e.deltaY() && (-(s = t.y - e.bottom) > n && !i || !1 === t.checkCollision.up || !1 === e.checkCollision.down ? s = 0 : (t.touching.none = !1, t.touching.up = !0, e.touching.none = !1, e.touching.down = !0)), t.overlapY = s, e.overlapY = s, s
            },
            separateX: function(t, e, i) {
                var s = this.getOverlapX(t, e, i);
                if (i || 0 === s || t.immovable && e.immovable || t.customSeparateX || e.customSeparateX) return 0 !== s || t.embedded && e.embedded;
                var n = t.velocity.x,
                    o = e.velocity.x;
                if (t.immovable || e.immovable) t.immovable ? (e.x += s, e.velocity.x = n - o * e.bounce.x, t.moves && (e.y += (t.y - t.prev.y) * t.friction.y)) : (t.x -= s, t.velocity.x = o - n * t.bounce.x, e.moves && (t.y += (e.y - e.prev.y) * e.friction.y));
                else {
                    s *= .5, t.x -= s, e.x += s;
                    var r = Math.sqrt(o * o * e.mass / t.mass) * (o > 0 ? 1 : -1),
                        a = Math.sqrt(n * n * t.mass / e.mass) * (n > 0 ? 1 : -1),
                        h = .5 * (r + a);
                    r -= h, a -= h, t.velocity.x = h + r * t.bounce.x, e.velocity.x = h + a * e.bounce.x
                }
                return !0
            },
            separateY: function(t, e, i) {
                var s = this.getOverlapY(t, e, i);
                if (i || 0 === s || t.immovable && e.immovable || t.customSeparateY || e.customSeparateY) return 0 !== s || t.embedded && e.embedded;
                var n = t.velocity.y,
                    o = e.velocity.y;
                if (t.immovable || e.immovable) t.immovable ? (e.y += s, e.velocity.y = n - o * e.bounce.y, t.moves && (e.x += (t.x - t.prev.x) * t.friction.x)) : (t.y -= s, t.velocity.y = o - n * t.bounce.y, e.moves && (t.x += (e.x - e.prev.x) * e.friction.x));
                else {
                    s *= .5, t.y -= s, e.y += s;
                    var r = Math.sqrt(o * o * e.mass / t.mass) * (o > 0 ? 1 : -1),
                        a = Math.sqrt(n * n * t.mass / e.mass) * (n > 0 ? 1 : -1),
                        h = .5 * (r + a);
                    r -= h, a -= h, t.velocity.y = h + r * t.bounce.y, e.velocity.y = h + a * e.bounce.y
                }
                return !0
            },
            getObjectsUnderPointer: function(t, e, i, s) {
                if (0 !== e.length && t.exists) return this.getObjectsAtLocation(t.x, t.y, e, i, s, t)
            },
            getObjectsAtLocation: function(t, e, i, s, o, r) {
                this.quadTree.clear(), this.quadTree.reset(this.game.world.bounds.x, this.game.world.bounds.y, this.game.world.bounds.width, this.game.world.bounds.height, this.maxObjects, this.maxLevels), this.quadTree.populate(i);
                for (var a = new n.Rectangle(t, e, 1, 1), h = [], l = this.quadTree.retrieve(a), c = 0; c < l.length; c++) l[c].hitTest(t, e) && (s && s.call(o, r, l[c].sprite), h.push(l[c].sprite));
                return h
            },
            moveToObject: function(t, e, i, s) {
                void 0 === i && (i = 60), void 0 === s && (s = 0);
                var n = Math.atan2(e.y - t.y, e.x - t.x);
                return s > 0 && (i = this.distanceBetween(t, e) / (s / 1e3)), t.body.velocity.x = Math.cos(n) * i, t.body.velocity.y = Math.sin(n) * i, n
            },
            moveToPointer: function(t, e, i, s) {
                void 0 === e && (e = 60), i = i || this.game.input.activePointer, void 0 === s && (s = 0);
                var n = this.angleToPointer(t, i);
                return s > 0 && (e = this.distanceToPointer(t, i) / (s / 1e3)), t.body.velocity.x = Math.cos(n) * e, t.body.velocity.y = Math.sin(n) * e, n
            },
            moveToXY: function(t, e, i, s, n) {
                void 0 === s && (s = 60), void 0 === n && (n = 0);
                var o = Math.atan2(i - t.y, e - t.x);
                return n > 0 && (s = this.distanceToXY(t, e, i) / (n / 1e3)), t.body.velocity.x = Math.cos(o) * s, t.body.velocity.y = Math.sin(o) * s, o
            },
            velocityFromAngle: function(t, e, i) {
                return void 0 === e && (e = 60), (i = i || new n.Point).setTo(Math.cos(this.game.math.degToRad(t)) * e, Math.sin(this.game.math.degToRad(t)) * e)
            },
            velocityFromRotation: function(t, e, i) {
                return void 0 === e && (e = 60), (i = i || new n.Point).setTo(Math.cos(t) * e, Math.sin(t) * e)
            },
            accelerationFromRotation: function(t, e, i) {
                return void 0 === e && (e = 60), (i = i || new n.Point).setTo(Math.cos(t) * e, Math.sin(t) * e)
            },
            accelerateToObject: function(t, e, i, s, n) {
                void 0 === i && (i = 60), void 0 === s && (s = 1e3), void 0 === n && (n = 1e3);
                var o = this.angleBetween(t, e);
                return t.body.acceleration.setTo(Math.cos(o) * i, Math.sin(o) * i), t.body.maxVelocity.setTo(s, n), o
            },
            accelerateToPointer: function(t, e, i, s, n) {
                void 0 === i && (i = 60), void 0 === e && (e = this.game.input.activePointer), void 0 === s && (s = 1e3), void 0 === n && (n = 1e3);
                var o = this.angleToPointer(t, e);
                return t.body.acceleration.setTo(Math.cos(o) * i, Math.sin(o) * i), t.body.maxVelocity.setTo(s, n), o
            },
            accelerateToXY: function(t, e, i, s, n, o) {
                void 0 === s && (s = 60), void 0 === n && (n = 1e3), void 0 === o && (o = 1e3);
                var r = this.angleToXY(t, e, i);
                return t.body.acceleration.setTo(Math.cos(r) * s, Math.sin(r) * s), t.body.maxVelocity.setTo(n, o), r
            },
            distanceBetween: function(t, e, i) {
                void 0 === i && (i = !1);
                var s = i ? t.world.x - e.world.x : t.x - e.x,
                    n = i ? t.world.y - e.world.y : t.y - e.y;
                return Math.sqrt(s * s + n * n)
            },
            distanceToXY: function(t, e, i, s) {
                void 0 === s && (s = !1);
                var n = s ? t.world.x - e : t.x - e,
                    o = s ? t.world.y - i : t.y - i;
                return Math.sqrt(n * n + o * o)
            },
            distanceToPointer: function(t, e, i) {
                void 0 === e && (e = this.game.input.activePointer), void 0 === i && (i = !1);
                var s = i ? t.world.x - e.worldX : t.x - e.worldX,
                    n = i ? t.world.y - e.worldY : t.y - e.worldY;
                return Math.sqrt(s * s + n * n)
            },
            angleBetween: function(t, e, i) {
                return void 0 === i && (i = !1), i ? Math.atan2(e.world.y - t.world.y, e.world.x - t.world.x) : Math.atan2(e.y - t.y, e.x - t.x)
            },
            angleBetweenCenters: function(t, e) {
                var i = e.centerX - t.centerX,
                    s = e.centerY - t.centerY;
                return Math.atan2(s, i)
            },
            angleToXY: function(t, e, i, s) {
                return void 0 === s && (s = !1), s ? Math.atan2(i - t.world.y, e - t.world.x) : Math.atan2(i - t.y, e - t.x)
            },
            angleToPointer: function(t, e, i) {
                return void 0 === e && (e = this.game.input.activePointer), void 0 === i && (i = !1), i ? Math.atan2(e.worldY - t.world.y, e.worldX - t.world.x) : Math.atan2(e.worldY - t.y, e.worldX - t.x)
            },
            worldAngleToPointer: function(t, e) {
                return this.angleToPointer(t, e, !0)
            }
        }, n.Physics.Arcade.Body = function(t) {
            this.sprite = t, this.game = t.game, this.type = n.Physics.ARCADE, this.enable = !0, this.isCircle = !1, this.radius = 0, this.offset = new n.Point, this.position = new n.Point(t.x, t.y), this.prev = new n.Point(this.position.x, this.position.y), this.allowRotation = !0, this.rotation = t.angle, this.preRotation = t.angle, this.width = t.width, this.height = t.height, this.sourceWidth = t.width, this.sourceHeight = t.height, t.texture && (this.sourceWidth = t.texture.frame.width, this.sourceHeight = t.texture.frame.height), this.halfWidth = Math.abs(t.width / 2), this.halfHeight = Math.abs(t.height / 2), this.center = new n.Point(t.x + this.halfWidth, t.y + this.halfHeight), this.velocity = new n.Point, this.newVelocity = new n.Point, this.deltaMax = new n.Point, this.acceleration = new n.Point, this.drag = new n.Point, this.allowGravity = !0, this.gravity = new n.Point, this.bounce = new n.Point, this.worldBounce = null, this.onWorldBounds = null, this.onCollide = null, this.onOverlap = null, this.maxVelocity = new n.Point(1e4, 1e4), this.friction = new n.Point(1, 0), this.angularVelocity = 0, this.angularAcceleration = 0, this.angularDrag = 0, this.maxAngular = 1e3, this.mass = 1, this.angle = 0, this.speed = 0, this.facing = n.NONE, this.immovable = !1, this.moves = !0, this.customSeparateX = !1, this.customSeparateY = !1, this.overlapX = 0, this.overlapY = 0, this.overlapR = 0, this.embedded = !1, this.collideWorldBounds = !1, this.checkCollision = {
                none: !1,
                any: !0,
                up: !0,
                down: !0,
                left: !0,
                right: !0
            }, this.touching = {
                none: !0,
                up: !1,
                down: !1,
                left: !1,
                right: !1
            }, this.wasTouching = {
                none: !0,
                up: !1,
                down: !1,
                left: !1,
                right: !1
            }, this.blocked = {
                up: !1,
                down: !1,
                left: !1,
                right: !1
            }, this.tilePadding = new n.Point, this.dirty = !1, this.skipQuadTree = !1, this.syncBounds = !1, this.isMoving = !1, this.stopVelocityOnCollide = !0, this.moveTimer = 0, this.moveDistance = 0, this.moveDuration = 0, this.moveTarget = null, this.moveEnd = null, this.onMoveComplete = new n.Signal, this.movementCallback = null, this.movementCallbackContext = null, this._reset = !0, this._sx = t.scale.x, this._sy = t.scale.y, this._dx = 0, this._dy = 0
        }, n.Physics.Arcade.Body.prototype = {
            updateBounds: function() {
                if (this.syncBounds) {
                    var t = this.sprite.getBounds();
                    t.ceilAll(), t.width === this.width && t.height === this.height || (this.width = t.width, this.height = t.height, this._reset = !0)
                } else {
                    var e = Math.abs(this.sprite.scale.x),
                        i = Math.abs(this.sprite.scale.y);
                    e === this._sx && i === this._sy || (this.width = this.sourceWidth * e, this.height = this.sourceHeight * i, this._sx = e, this._sy = i, this._reset = !0)
                }
                this._reset && (this.halfWidth = Math.floor(this.width / 2), this.halfHeight = Math.floor(this.height / 2), this.center.setTo(this.position.x + this.halfWidth, this.position.y + this.halfHeight))
            },
            preUpdate: function() {
                this.enable && !this.game.physics.arcade.isPaused && (this.dirty = !0, this.wasTouching.none = this.touching.none, this.wasTouching.up = this.touching.up, this.wasTouching.down = this.touching.down, this.wasTouching.left = this.touching.left, this.wasTouching.right = this.touching.right, this.touching.none = !0, this.touching.up = !1, this.touching.down = !1, this.touching.left = !1, this.touching.right = !1, this.blocked.up = !1, this.blocked.down = !1, this.blocked.left = !1, this.blocked.right = !1, this.embedded = !1, this.updateBounds(), this.position.x = this.sprite.world.x - this.sprite.anchor.x * this.sprite.width + this.sprite.scale.x * this.offset.x, this.position.x -= this.sprite.scale.x < 0 ? this.width : 0, this.position.y = this.sprite.world.y - this.sprite.anchor.y * this.sprite.height + this.sprite.scale.y * this.offset.y, this.position.y -= this.sprite.scale.y < 0 ? this.height : 0, this.rotation = this.sprite.angle, this.preRotation = this.rotation, (this._reset || this.sprite.fresh) && (this.prev.x = this.position.x, this.prev.y = this.position.y), this.moves && (this.game.physics.arcade.updateMotion(this), this.newVelocity.set(this.velocity.x * this.game.time.physicsElapsed, this.velocity.y * this.game.time.physicsElapsed), this.position.x += this.newVelocity.x, this.position.y += this.newVelocity.y, this.position.x === this.prev.x && this.position.y === this.prev.y || (this.angle = Math.atan2(this.velocity.y, this.velocity.x)), this.speed = Math.sqrt(this.velocity.x * this.velocity.x + this.velocity.y * this.velocity.y), this.collideWorldBounds && this.checkWorldBounds() && this.onWorldBounds && this.onWorldBounds.dispatch(this.sprite, this.blocked.up, this.blocked.down, this.blocked.left, this.blocked.right)), this._dx = this.deltaX(), this._dy = this.deltaY(), this._reset = !1)
            },
            updateMovement: function() {
                var t = 0,
                    e = 0 !== this.overlapX || 0 !== this.overlapY;
                if (this.moveDuration > 0 ? (this.moveTimer += this.game.time.elapsedMS, t = this.moveTimer / this.moveDuration) : (this.moveTarget.end.set(this.position.x, this.position.y), t = this.moveTarget.length / this.moveDistance), this.movementCallback) var i = this.movementCallback.call(this.movementCallbackContext, this, this.velocity, t);
                return !(e || t >= 1 || void 0 !== i && !0 !== i) || (this.stopMovement(t >= 1 || this.stopVelocityOnCollide && e), !1)
            },
            stopMovement: function(t) {
                this.isMoving && (this.isMoving = !1, t && this.velocity.set(0), this.onMoveComplete.dispatch(this.sprite, 0 !== this.overlapX || 0 !== this.overlapY))
            },
            postUpdate: function() {
                this.enable && this.dirty && (this.isMoving && this.updateMovement(), this.dirty = !1, this.deltaX() < 0 ? this.facing = n.LEFT : this.deltaX() > 0 && (this.facing = n.RIGHT), this.deltaY() < 0 ? this.facing = n.UP : this.deltaY() > 0 && (this.facing = n.DOWN), this.moves && (this._dx = this.deltaX(), this._dy = this.deltaY(), 0 !== this.deltaMax.x && 0 !== this._dx && (this._dx < 0 && this._dx < -this.deltaMax.x ? this._dx = -this.deltaMax.x : this._dx > 0 && this._dx > this.deltaMax.x && (this._dx = this.deltaMax.x)), 0 !== this.deltaMax.y && 0 !== this._dy && (this._dy < 0 && this._dy < -this.deltaMax.y ? this._dy = -this.deltaMax.y : this._dy > 0 && this._dy > this.deltaMax.y && (this._dy = this.deltaMax.y)), this.sprite.position.x += this._dx, this.sprite.position.y += this._dy, this._reset = !0), this.center.setTo(this.position.x + this.halfWidth, this.position.y + this.halfHeight), this.allowRotation && (this.sprite.angle += this.deltaZ()), this.prev.x = this.position.x, this.prev.y = this.position.y)
            },
            checkWorldBounds: function() {
                var t = this.position,
                    e = this.game.physics.arcade.bounds,
                    i = this.game.physics.arcade.checkCollision,
                    s = this.worldBounce ? -this.worldBounce.x : -this.bounce.x,
                    n = this.worldBounce ? -this.worldBounce.y : -this.bounce.y;
                if (this.isCircle) {
                    var o = {
                        x: this.center.x - this.radius,
                        y: this.center.y - this.radius,
                        right: this.center.x + this.radius,
                        bottom: this.center.y + this.radius
                    };
                    o.x < e.x && i.left ? (t.x = e.x - this.halfWidth + this.radius, this.velocity.x *= s, this.blocked.left = !0) : o.right > e.right && i.right && (t.x = e.right - this.halfWidth - this.radius, this.velocity.x *= s, this.blocked.right = !0), o.y < e.y && i.up ? (t.y = e.y - this.halfHeight + this.radius, this.velocity.y *= n, this.blocked.up = !0) : o.bottom > e.bottom && i.down && (t.y = e.bottom - this.halfHeight - this.radius, this.velocity.y *= n, this.blocked.down = !0)
                } else t.x < e.x && i.left ? (t.x = e.x, this.velocity.x *= s, this.blocked.left = !0) : this.right > e.right && i.right && (t.x = e.right - this.width, this.velocity.x *= s, this.blocked.right = !0), t.y < e.y && i.up ? (t.y = e.y, this.velocity.y *= n, this.blocked.up = !0) : this.bottom > e.bottom && i.down && (t.y = e.bottom - this.height, this.velocity.y *= n, this.blocked.down = !0);
                return this.blocked.up || this.blocked.down || this.blocked.left || this.blocked.right
            },
            moveFrom: function(t, e, i) {
                return void 0 === e && (e = this.speed), 0 !== e && (void 0 === i ? (s = this.angle, i = this.game.math.radToDeg(s)) : s = this.game.math.degToRad(i), this.moveTimer = 0, this.moveDuration = t, 0 === i || 180 === i ? this.velocity.set(Math.cos(s) * e, 0) : 90 === i || 270 === i ? this.velocity.set(0, Math.sin(s) * e) : this.velocity.set(Math.cos(s) * e, Math.sin(s) * e), this.isMoving = !0, !0);
                var s
            },
            moveTo: function(t, e, i) {
                var s, o = e / (t / 1e3);
                return 0 !== o && (void 0 === i ? (s = this.angle, i = this.game.math.radToDeg(s)) : s = this.game.math.degToRad(i), e = Math.abs(e), this.moveDuration = 0, this.moveDistance = e, null === this.moveTarget && (this.moveTarget = new n.Line, this.moveEnd = new n.Point), this.moveTarget.fromAngle(this.x, this.y, s, e), this.moveEnd.set(this.moveTarget.end.x, this.moveTarget.end.y), this.moveTarget.setTo(this.x, this.y, this.x, this.y), 0 === i || 180 === i ? this.velocity.set(Math.cos(s) * o, 0) : 90 === i || 270 === i ? this.velocity.set(0, Math.sin(s) * o) : this.velocity.set(Math.cos(s) * o, Math.sin(s) * o), this.isMoving = !0, !0)
            },
            setSize: function(t, e, i, s) {
                void 0 === i && (i = this.offset.x), void 0 === s && (s = this.offset.y), this.sourceWidth = t, this.sourceHeight = e, this.width = this.sourceWidth * this._sx, this.height = this.sourceHeight * this._sy, this.halfWidth = Math.floor(this.width / 2), this.halfHeight = Math.floor(this.height / 2), this.offset.setTo(i, s), this.center.setTo(this.position.x + this.halfWidth, this.position.y + this.halfHeight), this.isCircle = !1, this.radius = 0
            },
            setCircle: function(t, e, i) {
                void 0 === e && (e = this.offset.x), void 0 === i && (i = this.offset.y), t > 0 ? (this.isCircle = !0, this.radius = t, this.sourceWidth = 2 * t, this.sourceHeight = 2 * t, this.width = this.sourceWidth * this._sx, this.height = this.sourceHeight * this._sy, this.halfWidth = Math.floor(this.width / 2), this.halfHeight = Math.floor(this.height / 2), this.offset.setTo(e, i), this.center.setTo(this.position.x + this.halfWidth, this.position.y + this.halfHeight)) : this.isCircle = !1
            },
            reset: function(t, e) {
                this.velocity.set(0), this.acceleration.set(0), this.speed = 0, this.angularVelocity = 0, this.angularAcceleration = 0, this.position.x = t - this.sprite.anchor.x * this.sprite.width + this.sprite.scale.x * this.offset.x, this.position.x -= this.sprite.scale.x < 0 ? this.width : 0, this.position.y = e - this.sprite.anchor.y * this.sprite.height + this.sprite.scale.y * this.offset.y, this.position.y -= this.sprite.scale.y < 0 ? this.height : 0, this.prev.x = this.position.x, this.prev.y = this.position.y, this.rotation = this.sprite.angle, this.preRotation = this.rotation, this._sx = this.sprite.scale.x, this._sy = this.sprite.scale.y, this.center.setTo(this.position.x + this.halfWidth, this.position.y + this.halfHeight)
            },
            getBounds: function(t) {
                return this.isCircle ? (t.x = this.center.x - this.radius, t.y = this.center.y - this.radius, t.right = this.center.x + this.radius, t.bottom = this.center.y + this.radius) : (t.x = this.x, t.y = this.y, t.right = this.right, t.bottom = this.bottom), t
            },
            hitTest: function(t, e) {
                return this.isCircle ? n.Circle.contains(this, t, e) : n.Rectangle.contains(this, t, e)
            },
            onFloor: function() {
                return this.blocked.down
            },
            onCeiling: function() {
                return this.blocked.up
            },
            onWall: function() {
                return this.blocked.left || this.blocked.right
            },
            deltaAbsX: function() {
                return this.deltaX() > 0 ? this.deltaX() : -this.deltaX()
            },
            deltaAbsY: function() {
                return this.deltaY() > 0 ? this.deltaY() : -this.deltaY()
            },
            deltaX: function() {
                return this.position.x - this.prev.x
            },
            deltaY: function() {
                return this.position.y - this.prev.y
            },
            deltaZ: function() {
                return this.rotation - this.preRotation
            },
            destroy: function() {
                this.sprite.parent && this.sprite.parent instanceof n.Group && this.sprite.parent.removeFromHash(this.sprite), this.sprite.body = null, this.sprite = null
            }
        }, Object.defineProperty(n.Physics.Arcade.Body.prototype, "left", {
            get: function() {
                return this.position.x
            }
        }), Object.defineProperty(n.Physics.Arcade.Body.prototype, "right", {
            get: function() {
                return this.position.x + this.width
            }
        }), Object.defineProperty(n.Physics.Arcade.Body.prototype, "top", {
            get: function() {
                return this.position.y
            }
        }), Object.defineProperty(n.Physics.Arcade.Body.prototype, "bottom", {
            get: function() {
                return this.position.y + this.height
            }
        }), Object.defineProperty(n.Physics.Arcade.Body.prototype, "x", {
            get: function() {
                return this.position.x
            },
            set: function(t) {
                this.position.x = t
            }
        }), Object.defineProperty(n.Physics.Arcade.Body.prototype, "y", {
            get: function() {
                return this.position.y
            },
            set: function(t) {
                this.position.y = t
            }
        }), n.Physics.Arcade.Body.render = function(t, e, i, s) {
            void 0 === s && (s = !0), i = i || "rgba(0,255,0,0.4)", t.fillStyle = i, t.strokeStyle = i, e.isCircle ? (t.beginPath(), t.arc(e.center.x - e.game.camera.x, e.center.y - e.game.camera.y, e.radius, 0, 2 * Math.PI), s ? t.fill() : t.stroke()) : s ? t.fillRect(e.position.x - e.game.camera.x, e.position.y - e.game.camera.y, e.width, e.height) : t.strokeRect(e.position.x - e.game.camera.x, e.position.y - e.game.camera.y, e.width, e.height)
        }, n.Physics.Arcade.Body.renderBodyInfo = function(t, e) {
            t.line("x: " + e.x.toFixed(2), "y: " + e.y.toFixed(2), "width: " + e.width, "height: " + e.height), t.line("velocity x: " + e.velocity.x.toFixed(2), "y: " + e.velocity.y.toFixed(2), "deltaX: " + e._dx.toFixed(2), "deltaY: " + e._dy.toFixed(2)), t.line("acceleration x: " + e.acceleration.x.toFixed(2), "y: " + e.acceleration.y.toFixed(2), "speed: " + e.speed.toFixed(2), "angle: " + e.angle.toFixed(2)), t.line("gravity x: " + e.gravity.x, "y: " + e.gravity.y, "bounce x: " + e.bounce.x.toFixed(2), "y: " + e.bounce.y.toFixed(2)), t.line("touching left: " + e.touching.left, "right: " + e.touching.right, "up: " + e.touching.up, "down: " + e.touching.down), t.line("blocked left: " + e.blocked.left, "right: " + e.blocked.right, "up: " + e.blocked.up, "down: " + e.blocked.down)
        }, n.Physics.Arcade.Body.prototype.constructor = n.Physics.Arcade.Body, n.Physics.Arcade.TilemapCollision = function() {}, n.Physics.Arcade.TilemapCollision.prototype = {
            TILE_BIAS: 16,
            collideSpriteVsTilemapLayer: function(t, e, i, s, n, o) {
                if (t.body) {
                    var r = e.getTiles(t.body.position.x - t.body.tilePadding.x, t.body.position.y - t.body.tilePadding.y, t.body.width + t.body.tilePadding.x, t.body.height + t.body.tilePadding.y, !1, !1);
                    if (0 !== r.length)
                        for (var a = 0; a < r.length; a++) s ? s.call(n, t, r[a]) && this.separateTile(a, t.body, r[a], e, o) && (this._total++, i && i.call(n, t, r[a])) : this.separateTile(a, t.body, r[a], e, o) && (this._total++, i && i.call(n, t, r[a]))
                }
            },
            collideGroupVsTilemapLayer: function(t, e, i, s, n, o) {
                if (0 !== t.length)
                    for (var r = 0; r < t.children.length; r++) t.children[r].exists && this.collideSpriteVsTilemapLayer(t.children[r], e, i, s, n, o)
            },
            separateTile: function(t, e, i, s, n) {
                if (!e.enable) return !1;
                var o = s.fixedToCamera ? 0 : s.position.x,
                    r = s.fixedToCamera ? 0 : s.position.y;
                if (!i.intersects(e.position.x - o, e.position.y - r, e.right - o, e.bottom - r)) return !1;
                if (n) return !0;
                if (i.collisionCallback && !i.collisionCallback.call(i.collisionCallbackContext, e.sprite, i)) return !1;
                if (void 0 !== i.layer.callbacks && i.layer.callbacks[i.index] && !i.layer.callbacks[i.index].callback.call(i.layer.callbacks[i.index].callbackContext, e.sprite, i)) return !1;
                if (!(i.faceLeft || i.faceRight || i.faceTop || i.faceBottom)) return !1;
                var a = 0,
                    h = 0,
                    l = 0,
                    c = 1;
                if (e.deltaAbsX() > e.deltaAbsY() ? l = -1 : e.deltaAbsX() < e.deltaAbsY() && (c = -1), 0 !== e.deltaX() && 0 !== e.deltaY() && (i.faceLeft || i.faceRight) && (i.faceTop || i.faceBottom) && (l = Math.min(Math.abs(e.position.x - o - i.right), Math.abs(e.right - o - i.left)), c = Math.min(Math.abs(e.position.y - r - i.bottom), Math.abs(e.bottom - r - i.top))), l < c) {
                    if ((i.faceLeft || i.faceRight) && 0 !== (a = this.tileCheckX(e, i, s)) && !i.intersects(e.position.x - o, e.position.y - r, e.right - o, e.bottom - r)) return !0;
                    (i.faceTop || i.faceBottom) && (h = this.tileCheckY(e, i, s))
                } else {
                    if ((i.faceTop || i.faceBottom) && 0 !== (h = this.tileCheckY(e, i, s)) && !i.intersects(e.position.x - o, e.position.y - r, e.right - o, e.bottom - r)) return !0;
                    (i.faceLeft || i.faceRight) && (a = this.tileCheckX(e, i, s))
                }
                return 0 !== a || 0 !== h
            },
            tileCheckX: function(t, e, i) {
                var s = 0,
                    n = i.fixedToCamera ? 0 : i.position.x;
                return t.deltaX() < 0 && !t.blocked.left && e.collideRight && t.checkCollision.left ? e.faceRight && t.x - n < e.right && (s = t.x - n - e.right) < -this.TILE_BIAS && (s = 0) : t.deltaX() > 0 && !t.blocked.right && e.collideLeft && t.checkCollision.right && e.faceLeft && t.right - n > e.left && (s = t.right - n - e.left) > this.TILE_BIAS && (s = 0), 0 !== s && (t.customSeparateX ? t.overlapX = s : this.processTileSeparationX(t, s)), s
            },
            tileCheckY: function(t, e, i) {
                var s = 0,
                    n = i.fixedToCamera ? 0 : i.position.y;
                return t.deltaY() < 0 && !t.blocked.up && e.collideDown && t.checkCollision.up ? e.faceBottom && t.y - n < e.bottom && (s = t.y - n - e.bottom) < -this.TILE_BIAS && (s = 0) : t.deltaY() > 0 && !t.blocked.down && e.collideUp && t.checkCollision.down && e.faceTop && t.bottom - n > e.top && (s = t.bottom - n - e.top) > this.TILE_BIAS && (s = 0), 0 !== s && (t.customSeparateY ? t.overlapY = s : this.processTileSeparationY(t, s)), s
            },
            processTileSeparationX: function(t, e) {
                e < 0 ? t.blocked.left = !0 : e > 0 && (t.blocked.right = !0), t.position.x -= e, 0 === t.bounce.x ? t.velocity.x = 0 : t.velocity.x = -t.velocity.x * t.bounce.x
            },
            processTileSeparationY: function(t, e) {
                e < 0 ? t.blocked.up = !0 : e > 0 && (t.blocked.down = !0), t.position.y -= e, 0 === t.bounce.y ? t.velocity.y = 0 : t.velocity.y = -t.velocity.y * t.bounce.y
            }
        }, n.Utils.mixinPrototype(n.Physics.Arcade.prototype, n.Physics.Arcade.TilemapCollision.prototype), p2.Body.prototype.parent = null, p2.Spring.prototype.parent = null, n.Physics.P2 = function(t, e) {
            this.game = t, void 0 === e ? e = {
                gravity: [0, 0],
                broadphase: new p2.SAPBroadphase
            } : (e.hasOwnProperty("gravity") || (e.gravity = [0, 0]), e.hasOwnProperty("broadphase") || (e.broadphase = new p2.SAPBroadphase)), this.config = e, this.world = new p2.World(this.config), this.frameRate = 1 / 60, this.useElapsedTime = !1, this.paused = !1, this.materials = [], this.gravity = new n.Physics.P2.InversePointProxy(this, this.world.gravity), this.walls = {
                left: null,
                right: null,
                top: null,
                bottom: null
            }, this.onBodyAdded = new n.Signal, this.onBodyRemoved = new n.Signal, this.onSpringAdded = new n.Signal, this.onSpringRemoved = new n.Signal, this.onConstraintAdded = new n.Signal, this.onConstraintRemoved = new n.Signal, this.onContactMaterialAdded = new n.Signal, this.onContactMaterialRemoved = new n.Signal, this.postBroadphaseCallback = null, this.callbackContext = null, this.onBeginContact = new n.Signal, this.onEndContact = new n.Signal, e.hasOwnProperty("mpx") && e.hasOwnProperty("pxm") && e.hasOwnProperty("mpxi") && e.hasOwnProperty("pxmi") && (this.mpx = e.mpx, this.mpxi = e.mpxi, this.pxm = e.pxm, this.pxmi = e.pxmi), this.world.on("beginContact", this.beginContactHandler, this), this.world.on("endContact", this.endContactHandler, this), this.collisionGroups = [], this.nothingCollisionGroup = new n.Physics.P2.CollisionGroup(1), this.boundsCollisionGroup = new n.Physics.P2.CollisionGroup(2), this.everythingCollisionGroup = new n.Physics.P2.CollisionGroup(2147483648), this.boundsCollidesWith = [], this._toRemove = [], this._collisionGroupID = 2, this._boundsLeft = !0, this._boundsRight = !0, this._boundsTop = !0, this._boundsBottom = !0, this._boundsOwnGroup = !1, this.setBoundsToWorld(!0, !0, !0, !0, !1)
        }, n.Physics.P2.prototype = {
            removeBodyNextStep: function(t) {
                this._toRemove.push(t)
            },
            preUpdate: function() {
                for (var t = this._toRemove.length; t--;) this.removeBody(this._toRemove[t]);
                this._toRemove.length = 0
            },
            enable: function(t, e, i) {
                void 0 === e && (e = !1), void 0 === i && (i = !0);
                var s = 1;
                if (Array.isArray(t))
                    for (s = t.length; s--;) t[s] instanceof n.Group ? this.enable(t[s].children, e, i) : (this.enableBody(t[s], e), i && t[s].hasOwnProperty("children") && t[s].children.length > 0 && this.enable(t[s], e, !0));
                else t instanceof n.Group ? this.enable(t.children, e, i) : (this.enableBody(t, e), i && t.hasOwnProperty("children") && t.children.length > 0 && this.enable(t.children, e, !0))
            },
            enableBody: function(t, e) {
                t.hasOwnProperty("body") && null === t.body && (t.body = new n.Physics.P2.Body(this.game, t, t.x, t.y, 1), t.body.debug = e, void 0 !== t.anchor && t.anchor.set(.5))
            },
            setImpactEvents: function(t) {
                t ? this.world.on("impact", this.impactHandler, this) : this.world.off("impact", this.impactHandler, this)
            },
            setPostBroadphaseCallback: function(t, e) {
                this.postBroadphaseCallback = t, this.callbackContext = e, null !== t ? this.world.on("postBroadphase", this.postBroadphaseHandler, this) : this.world.off("postBroadphase", this.postBroadphaseHandler, this)
            },
            postBroadphaseHandler: function(t) {
                if (this.postBroadphaseCallback && 0 !== t.pairs.length)
                    for (var e = t.pairs.length - 2; e >= 0; e -= 2) t.pairs[e].parent && t.pairs[e + 1].parent && !this.postBroadphaseCallback.call(this.callbackContext, t.pairs[e].parent, t.pairs[e + 1].parent) && t.pairs.splice(e, 2)
            },
            impactHandler: function(t) {
                if (t.bodyA.parent && t.bodyB.parent) {
                    var e = t.bodyA.parent,
                        i = t.bodyB.parent;
                    e._bodyCallbacks[t.bodyB.id] && e._bodyCallbacks[t.bodyB.id].call(e._bodyCallbackContext[t.bodyB.id], e, i, t.shapeA, t.shapeB), i._bodyCallbacks[t.bodyA.id] && i._bodyCallbacks[t.bodyA.id].call(i._bodyCallbackContext[t.bodyA.id], i, e, t.shapeB, t.shapeA), e._groupCallbacks[t.shapeB.collisionGroup] && e._groupCallbacks[t.shapeB.collisionGroup].call(e._groupCallbackContext[t.shapeB.collisionGroup], e, i, t.shapeA, t.shapeB), i._groupCallbacks[t.shapeA.collisionGroup] && i._groupCallbacks[t.shapeA.collisionGroup].call(i._groupCallbackContext[t.shapeA.collisionGroup], i, e, t.shapeB, t.shapeA)
                }
            },
            beginContactHandler: function(t) {
                t.bodyA && t.bodyB && (this.onBeginContact.dispatch(t.bodyA, t.bodyB, t.shapeA, t.shapeB, t.contactEquations), t.bodyA.parent && t.bodyA.parent.onBeginContact.dispatch(t.bodyB.parent, t.bodyB, t.shapeA, t.shapeB, t.contactEquations), t.bodyB.parent && t.bodyB.parent.onBeginContact.dispatch(t.bodyA.parent, t.bodyA, t.shapeB, t.shapeA, t.contactEquations))
            },
            endContactHandler: function(t) {
                t.bodyA && t.bodyB && (this.onEndContact.dispatch(t.bodyA, t.bodyB, t.shapeA, t.shapeB), t.bodyA.parent && t.bodyA.parent.onEndContact.dispatch(t.bodyB.parent, t.bodyB, t.shapeA, t.shapeB), t.bodyB.parent && t.bodyB.parent.onEndContact.dispatch(t.bodyA.parent, t.bodyA, t.shapeB, t.shapeA))
            },
            setBoundsToWorld: function(t, e, i, s, n) {
                this.setBounds(this.game.world.bounds.x, this.game.world.bounds.y, this.game.world.bounds.width, this.game.world.bounds.height, t, e, i, s, n)
            },
            setWorldMaterial: function(t, e, i, s, n) {
                void 0 === e && (e = !0), void 0 === i && (i = !0), void 0 === s && (s = !0), void 0 === n && (n = !0), e && this.walls.left && (this.walls.left.shapes[0].material = t), i && this.walls.right && (this.walls.right.shapes[0].material = t), s && this.walls.top && (this.walls.top.shapes[0].material = t), n && this.walls.bottom && (this.walls.bottom.shapes[0].material = t)
            },
            updateBoundsCollisionGroup: function(t) {
                void 0 === t && (t = !0);
                var e = t ? this.boundsCollisionGroup.mask : this.everythingCollisionGroup.mask;
                this.walls.left && (this.walls.left.shapes[0].collisionGroup = e), this.walls.right && (this.walls.right.shapes[0].collisionGroup = e), this.walls.top && (this.walls.top.shapes[0].collisionGroup = e), this.walls.bottom && (this.walls.bottom.shapes[0].collisionGroup = e), this._boundsOwnGroup = t
            },
            setBounds: function(t, e, i, s, n, o, r, a, h) {
                void 0 === n && (n = this._boundsLeft), void 0 === o && (o = this._boundsRight), void 0 === r && (r = this._boundsTop), void 0 === a && (a = this._boundsBottom), void 0 === h && (h = this._boundsOwnGroup), this.setupWall(n, "left", t, e, 1.5707963267948966, h), this.setupWall(o, "right", t + i, e, -1.5707963267948966, h), this.setupWall(r, "top", t, e, -3.141592653589793, h), this.setupWall(a, "bottom", t, e + s, 0, h), this._boundsLeft = n, this._boundsRight = o, this._boundsTop = r, this._boundsBottom = a, this._boundsOwnGroup = h
            },
            setupWall: function(t, e, i, s, n, o) {
                t ? (this.walls[e] ? this.walls[e].position = [this.pxmi(i), this.pxmi(s)] : (this.walls[e] = new p2.Body({
                    mass: 0,
                    position: [this.pxmi(i), this.pxmi(s)],
                    angle: n
                }), this.walls[e].addShape(new p2.Plane), this.world.addBody(this.walls[e])), o && (this.walls[e].shapes[0].collisionGroup = this.boundsCollisionGroup.mask)) : this.walls[e] && (this.world.removeBody(this.walls[e]), this.walls[e] = null)
            },
            pause: function() {
                this.paused = !0
            },
            resume: function() {
                this.paused = !1
            },
            update: function() {
                this.paused || (this.useElapsedTime ? this.world.step(this.game.time.physicsElapsed) : this.world.step(this.frameRate))
            },
            reset: function() {
                this.world.on("beginContact", this.beginContactHandler, this), this.world.on("endContact", this.endContactHandler, this), this.nothingCollisionGroup = new n.Physics.P2.CollisionGroup(1), this.boundsCollisionGroup = new n.Physics.P2.CollisionGroup(2), this.everythingCollisionGroup = new n.Physics.P2.CollisionGroup(2147483648), this._collisionGroupID = 2, this.setBoundsToWorld(!0, !0, !0, !0, !1)
            },
            clear: function() {
                this.world.time = 0, this.world.fixedStepTime = 0, this.world.solver && this.world.solver.equations.length && this.world.solver.removeAllEquations();
                for (var t = this.world.constraints, e = t.length - 1; e >= 0; e--) this.world.removeConstraint(t[e]);
                var i = this.world.bodies;
                for (e = i.length - 1; e >= 0; e--) this.world.removeBody(i[e]);
                var s = this.world.springs;
                for (e = s.length - 1; e >= 0; e--) this.world.removeSpring(s[e]);
                var n = this.world.contactMaterials;
                for (e = n.length - 1; e >= 0; e--) this.world.removeContactMaterial(n[e]);
                this.world.off("beginContact", this.beginContactHandler, this), this.world.off("endContact", this.endContactHandler, this), this.postBroadphaseCallback = null, this.callbackContext = null, this.impactCallback = null, this.collisionGroups = [], this._toRemove = [], this.boundsCollidesWith = [], this.walls = {
                    left: null,
                    right: null,
                    top: null,
                    bottom: null
                }
            },
            destroy: function() {
                this.clear(), this.game = null
            },
            addBody: function(t) {
                return !t.data.world && (this.world.addBody(t.data), this.onBodyAdded.dispatch(t), !0)
            },
            removeBody: function(t) {
                return t.data.world === this.world && (this.world.removeBody(t.data), this.onBodyRemoved.dispatch(t)), t
            },
            addSpring: function(t) {
                return t instanceof n.Physics.P2.Spring || t instanceof n.Physics.P2.RotationalSpring ? this.world.addSpring(t.data) : this.world.addSpring(t), this.onSpringAdded.dispatch(t), t
            },
            removeSpring: function(t) {
                return t instanceof n.Physics.P2.Spring || t instanceof n.Physics.P2.RotationalSpring ? this.world.removeSpring(t.data) : this.world.removeSpring(t), this.onSpringRemoved.dispatch(t), t
            },
            createDistanceConstraint: function(t, e, i, s, o, r) {
                if (t = this.getBody(t), e = this.getBody(e), t && e) return this.addConstraint(new n.Physics.P2.DistanceConstraint(this, t, e, i, s, o, r));
                console.warn("Cannot create Constraint, invalid body objects given")
            },
            createGearConstraint: function(t, e, i, s) {
                if (t = this.getBody(t), e = this.getBody(e), t && e) return this.addConstraint(new n.Physics.P2.GearConstraint(this, t, e, i, s));
                console.warn("Cannot create Constraint, invalid body objects given")
            },
            createRevoluteConstraint: function(t, e, i, s, o, r) {
                if (t = this.getBody(t), i = this.getBody(i), t && i) return this.addConstraint(new n.Physics.P2.RevoluteConstraint(this, t, e, i, s, o, r));
                console.warn("Cannot create Constraint, invalid body objects given")
            },
            createLockConstraint: function(t, e, i, s, o) {
                if (t = this.getBody(t), e = this.getBody(e), t && e) return this.addConstraint(new n.Physics.P2.LockConstraint(this, t, e, i, s, o));
                console.warn("Cannot create Constraint, invalid body objects given")
            },
            createPrismaticConstraint: function(t, e, i, s, o, r, a) {
                if (t = this.getBody(t), e = this.getBody(e), t && e) return this.addConstraint(new n.Physics.P2.PrismaticConstraint(this, t, e, i, s, o, r, a));
                console.warn("Cannot create Constraint, invalid body objects given")
            },
            addConstraint: function(t) {
                return this.world.addConstraint(t), this.onConstraintAdded.dispatch(t), t
            },
            removeConstraint: function(t) {
                return this.world.removeConstraint(t), this.onConstraintRemoved.dispatch(t), t
            },
            addContactMaterial: function(t) {
                return this.world.addContactMaterial(t), this.onContactMaterialAdded.dispatch(t), t
            },
            removeContactMaterial: function(t) {
                return this.world.removeContactMaterial(t), this.onContactMaterialRemoved.dispatch(t), t
            },
            getContactMaterial: function(t, e) {
                return this.world.getContactMaterial(t, e)
            },
            setMaterial: function(t, e) {
                for (var i = e.length; i--;) e[i].setMaterial(t)
            },
            createMaterial: function(t, e) {
                t = t || "";
                var i = new n.Physics.P2.Material(t);
                return this.materials.push(i), void 0 !== e && e.setMaterial(i), i
            },
            createContactMaterial: function(t, e, i) {
                void 0 === t && (t = this.createMaterial()), void 0 === e && (e = this.createMaterial());
                var s = new n.Physics.P2.ContactMaterial(t, e, i);
                return this.addContactMaterial(s)
            },
            getBodies: function() {
                for (var t = [], e = this.world.bodies.length; e--;) t.push(this.world.bodies[e].parent);
                return t
            },
            getBody: function(t) {
                return t instanceof p2.Body ? t : t instanceof n.Physics.P2.Body ? t.data : t.body && t.body.type === n.Physics.P2JS ? t.body.data : null
            },
            getSprings: function() {
                for (var t = [], e = this.world.springs.length; e--;) t.push(this.world.springs[e].parent);
                return t
            },
            getConstraints: function() {
                for (var t = [], e = this.world.constraints.length; e--;) t.push(this.world.constraints[e]);
                return t
            },
            hitTest: function(t, e, i, s) {
                void 0 === e && (e = this.world.bodies), void 0 === i && (i = 5), void 0 === s && (s = !1);
                for (var o = [this.pxmi(t.x), this.pxmi(t.y)], r = [], a = e.length; a--;) e[a] instanceof n.Physics.P2.Body && (!s || e[a].data.type !== p2.Body.STATIC) ? r.push(e[a].data) : e[a] instanceof p2.Body && e[a].parent && (!s || e[a].type !== p2.Body.STATIC) ? r.push(e[a]) : e[a] instanceof n.Sprite && e[a].hasOwnProperty("body") && (!s || e[a].body.data.type !== p2.Body.STATIC) && r.push(e[a].body.data);
                return this.world.hitTest(o, r, i)
            },
            toJSON: function() {
                return this.world.toJSON()
            },
            createCollisionGroup: function(t) {
                var e = Math.pow(2, this._collisionGroupID);
                this.walls.left && (this.walls.left.shapes[0].collisionMask = this.walls.left.shapes[0].collisionMask | e), this.walls.right && (this.walls.right.shapes[0].collisionMask = this.walls.right.shapes[0].collisionMask | e), this.walls.top && (this.walls.top.shapes[0].collisionMask = this.walls.top.shapes[0].collisionMask | e), this.walls.bottom && (this.walls.bottom.shapes[0].collisionMask = this.walls.bottom.shapes[0].collisionMask | e), this._collisionGroupID++;
                var i = new n.Physics.P2.CollisionGroup(e);
                return this.collisionGroups.push(i), t && this.setCollisionGroup(t, i), i
            },
            setCollisionGroup: function(t, e) {
                if (t instanceof n.Group)
                    for (var i = 0; i < t.total; i++) t.children[i].body && t.children[i].body.type === n.Physics.P2JS && t.children[i].body.setCollisionGroup(e);
                else t.body.setCollisionGroup(e)
            },
            createSpring: function(t, e, i, s, o, r, a, h, l) {
                if (t = this.getBody(t), e = this.getBody(e), t && e) return this.addSpring(new n.Physics.P2.Spring(this, t, e, i, s, o, r, a, h, l));
                console.warn("Cannot create Spring, invalid body objects given")
            },
            createRotationalSpring: function(t, e, i, s, o) {
                if (t = this.getBody(t), e = this.getBody(e), t && e) return this.addSpring(new n.Physics.P2.RotationalSpring(this, t, e, i, s, o));
                console.warn("Cannot create Rotational Spring, invalid body objects given")
            },
            createBody: function(t, e, i, s, o, r) {
                void 0 === s && (s = !1);
                var a = new n.Physics.P2.Body(this.game, null, t, e, i);
                return !(r && !a.addPolygon(o, r)) && (s && this.world.addBody(a.data), a)
            },
            createParticle: function(t, e, i, s, o, r) {
                void 0 === s && (s = !1);
                var a = new n.Physics.P2.Body(this.game, null, t, e, i);
                return !(r && !a.addPolygon(o, r)) && (s && this.world.addBody(a.data), a)
            },
            convertCollisionObjects: function(t, e, i) {
                void 0 === i && (i = !0);
                for (var s = [], n = 0, o = t.collision[e].length; n < o; n++) {
                    var r = t.collision[e][n],
                        a = this.createBody(r.x, r.y, 0, i, {}, r.polyline);
                    a && s.push(a)
                }
                return s
            },
            clearTilemapLayerBodies: function(t, e) {
                e = t.getLayer(e);
                for (var i = t.layers[e].bodies.length; i--;) t.layers[e].bodies[i].destroy();
                t.layers[e].bodies.length = 0
            },
            convertTilemap: function(t, e, i, s) {
                e = t.getLayer(e), void 0 === i && (i = !0), void 0 === s && (s = !0), this.clearTilemapLayerBodies(t, e);
                for (var n = 0, o = 0, r = 0, a = 0, h = t.layers[e].height; a < h; a++) {
                    n = 0;
                    for (var l = 0, c = t.layers[e].width; l < c; l++) {
                        var u = t.layers[e].data[a][l];
                        if (u && u.index > -1 && u.collides)
                            if (s) {
                                var d = t.getTileRight(e, l, a);
                                if (0 === n && (o = u.x * u.width, r = u.y * u.height, n = u.width), d && d.collides) n += u.width;
                                else(p = this.createBody(o, r, 0, !1)).addRectangle(n, u.height, n / 2, u.height / 2, 0), i && this.addBody(p), t.layers[e].bodies.push(p), n = 0
                            } else {
                                var p;
                                (p = this.createBody(u.x * u.width, u.y * u.height, 0, !1)).addRectangle(u.width, u.height, u.width / 2, u.height / 2, 0), i && this.addBody(p), t.layers[e].bodies.push(p)
                            }
                    }
                }
                return t.layers[e].bodies
            },
            mpx: function(t) {
                return 20 * t
            },
            pxm: function(t) {
                return .05 * t
            },
            mpxi: function(t) {
                return -20 * t
            },
            pxmi: function(t) {
                return -.05 * t
            }
        }, Object.defineProperty(n.Physics.P2.prototype, "friction", {
            get: function() {
                return this.world.defaultContactMaterial.friction
            },
            set: function(t) {
                this.world.defaultContactMaterial.friction = t
            }
        }), Object.defineProperty(n.Physics.P2.prototype, "restitution", {
            get: function() {
                return this.world.defaultContactMaterial.restitution
            },
            set: function(t) {
                this.world.defaultContactMaterial.restitution = t
            }
        }), Object.defineProperty(n.Physics.P2.prototype, "contactMaterial", {
            get: function() {
                return this.world.defaultContactMaterial
            },
            set: function(t) {
                this.world.defaultContactMaterial = t
            }
        }), Object.defineProperty(n.Physics.P2.prototype, "applySpringForces", {
            get: function() {
                return this.world.applySpringForces
            },
            set: function(t) {
                this.world.applySpringForces = t
            }
        }), Object.defineProperty(n.Physics.P2.prototype, "applyDamping", {
            get: function() {
                return this.world.applyDamping
            },
            set: function(t) {
                this.world.applyDamping = t
            }
        }), Object.defineProperty(n.Physics.P2.prototype, "applyGravity", {
            get: function() {
                return this.world.applyGravity
            },
            set: function(t) {
                this.world.applyGravity = t
            }
        }), Object.defineProperty(n.Physics.P2.prototype, "solveConstraints", {
            get: function() {
                return this.world.solveConstraints
            },
            set: function(t) {
                this.world.solveConstraints = t
            }
        }), Object.defineProperty(n.Physics.P2.prototype, "time", {
            get: function() {
                return this.world.time
            }
        }), Object.defineProperty(n.Physics.P2.prototype, "emitImpactEvent", {
            get: function() {
                return this.world.emitImpactEvent
            },
            set: function(t) {
                this.world.emitImpactEvent = t
            }
        }), Object.defineProperty(n.Physics.P2.prototype, "sleepMode", {
            get: function() {
                return this.world.sleepMode
            },
            set: function(t) {
                this.world.sleepMode = t
            }
        }), Object.defineProperty(n.Physics.P2.prototype, "total", {
            get: function() {
                return this.world.bodies.length
            }
        }), n.Physics.P2.FixtureList = function(t) {
            Array.isArray(t) || (t = [t]), this.rawList = t, this.init(), this.parse(this.rawList)
        }, n.Physics.P2.FixtureList.prototype = {
            init: function() {
                this.namedFixtures = {}, this.groupedFixtures = [], this.allFixtures = []
            },
            setCategory: function(t, e) {
                this.getFixtures(e).forEach(function(e) {
                    e.collisionGroup = t
                })
            },
            setMask: function(t, e) {
                this.getFixtures(e).forEach(function(e) {
                    e.collisionMask = t
                })
            },
            setSensor: function(t, e) {
                this.getFixtures(e).forEach(function(e) {
                    e.sensor = t
                })
            },
            setMaterial: function(t, e) {
                this.getFixtures(e).forEach(function(e) {
                    e.material = t
                })
            },
            getFixtures: function(t) {
                var e = [];
                if (t) {
                    t instanceof Array || (t = [t]);
                    var i = this;
                    return t.forEach(function(t) {
                        i.namedFixtures[t] && e.push(i.namedFixtures[t])
                    }), this.flatten(e)
                }
                return this.allFixtures
            },
            getFixtureByKey: function(t) {
                return this.namedFixtures[t]
            },
            getGroup: function(t) {
                return this.groupedFixtures[t]
            },
            parse: function() {
                var t, e, i, s;
                for (t in s = [], i = this.rawList) e = i[t], isNaN(t - 0) ? this.namedFixtures[t] = this.flatten(e) : (this.groupedFixtures[t] = this.groupedFixtures[t] || [], this.groupedFixtures[t] = this.groupedFixtures[t].concat(e)), s.push(this.allFixtures = this.flatten(this.groupedFixtures))
            },
            flatten: function(t) {
                var e, i;
                return e = [], i = arguments.callee, t.forEach(function(t) {
                    return Array.prototype.push.apply(e, Array.isArray(t) ? i(t) : [t])
                }), e
            }
        }, n.Physics.P2.PointProxy = function(t, e) {
            this.world = t, this.destination = e
        }, n.Physics.P2.PointProxy.prototype.constructor = n.Physics.P2.PointProxy, Object.defineProperty(n.Physics.P2.PointProxy.prototype, "x", {
            get: function() {
                return this.world.mpx(this.destination[0])
            },
            set: function(t) {
                this.destination[0] = this.world.pxm(t)
            }
        }), Object.defineProperty(n.Physics.P2.PointProxy.prototype, "y", {
            get: function() {
                return this.world.mpx(this.destination[1])
            },
            set: function(t) {
                this.destination[1] = this.world.pxm(t)
            }
        }), Object.defineProperty(n.Physics.P2.PointProxy.prototype, "mx", {
            get: function() {
                return this.destination[0]
            },
            set: function(t) {
                this.destination[0] = t
            }
        }), Object.defineProperty(n.Physics.P2.PointProxy.prototype, "my", {
            get: function() {
                return this.destination[1]
            },
            set: function(t) {
                this.destination[1] = t
            }
        }), n.Physics.P2.InversePointProxy = function(t, e) {
            this.world = t, this.destination = e
        }, n.Physics.P2.InversePointProxy.prototype.constructor = n.Physics.P2.InversePointProxy, Object.defineProperty(n.Physics.P2.InversePointProxy.prototype, "x", {
            get: function() {
                return this.world.mpxi(this.destination[0])
            },
            set: function(t) {
                this.destination[0] = this.world.pxmi(t)
            }
        }), Object.defineProperty(n.Physics.P2.InversePointProxy.prototype, "y", {
            get: function() {
                return this.world.mpxi(this.destination[1])
            },
            set: function(t) {
                this.destination[1] = this.world.pxmi(t)
            }
        }), Object.defineProperty(n.Physics.P2.InversePointProxy.prototype, "mx", {
            get: function() {
                return this.destination[0]
            },
            set: function(t) {
                this.destination[0] = -t
            }
        }), Object.defineProperty(n.Physics.P2.InversePointProxy.prototype, "my", {
            get: function() {
                return this.destination[1]
            },
            set: function(t) {
                this.destination[1] = -t
            }
        }), n.Physics.P2.Body = function(t, e, i, s, o) {
            e = e || null, i = i || 0, s = s || 0, void 0 === o && (o = 1), this.game = t, this.world = t.physics.p2, this.sprite = e, this.type = n.Physics.P2JS, this.offset = new n.Point, this.data = new p2.Body({
                position: [this.world.pxmi(i), this.world.pxmi(s)],
                mass: o
            }), this.data.parent = this, this.velocity = new n.Physics.P2.InversePointProxy(this.world, this.data.velocity), this.force = new n.Physics.P2.InversePointProxy(this.world, this.data.force), this.gravity = new n.Point, this.onBeginContact = new n.Signal, this.onEndContact = new n.Signal, this.collidesWith = [], this.removeNextStep = !1, this.debugBody = null, this.dirty = !1, this._collideWorldBounds = !0, this._bodyCallbacks = {}, this._bodyCallbackContext = {}, this._groupCallbacks = {}, this._groupCallbackContext = {}, this._reset = !1, e && (this.setRectangleFromSprite(e), e.exists && this.game.physics.p2.addBody(this))
        }, n.Physics.P2.Body.prototype = {
            createBodyCallback: function(t, e, i) {
                var s = -1;
                t.id ? s = t.id : t.body && (s = t.body.id), s > -1 && (null === e ? (delete this._bodyCallbacks[s], delete this._bodyCallbackContext[s]) : (this._bodyCallbacks[s] = e, this._bodyCallbackContext[s] = i))
            },
            createGroupCallback: function(t, e, i) {
                null === e ? (delete this._groupCallbacks[t.mask], delete this._groupCallbackContext[t.mask]) : (this._groupCallbacks[t.mask] = e, this._groupCallbackContext[t.mask] = i)
            },
            getCollisionMask: function() {
                var t = 0;
                this._collideWorldBounds && (t = this.game.physics.p2.boundsCollisionGroup.mask);
                for (var e = 0; e < this.collidesWith.length; e++) t |= this.collidesWith[e].mask;
                return t
            },
            updateCollisionMask: function(t) {
                var e = this.getCollisionMask();
                if (void 0 === t)
                    for (var i = this.data.shapes.length - 1; i >= 0; i--) this.data.shapes[i].collisionMask = e;
                else t.collisionMask = e
            },
            setCollisionGroup: function(t, e) {
                var i = this.getCollisionMask();
                if (void 0 === e)
                    for (var s = this.data.shapes.length - 1; s >= 0; s--) this.data.shapes[s].collisionGroup = t.mask, this.data.shapes[s].collisionMask = i;
                else e.collisionGroup = t.mask, e.collisionMask = i
            },
            clearCollision: function(t, e, i) {
                if (void 0 === t && (t = !0), void 0 === e && (e = !0), void 0 === i)
                    for (var s = this.data.shapes.length - 1; s >= 0; s--) t && (this.data.shapes[s].collisionGroup = null), e && (this.data.shapes[s].collisionMask = null);
                else t && (i.collisionGroup = null), e && (i.collisionMask = null);
                t && (this.collidesWith.length = 0)
            },
            removeCollisionGroup: function(t, e, i) {
                var s;
                if (void 0 === e && (e = !0), Array.isArray(t))
                    for (var n = 0; n < t.length; n++)(s = this.collidesWith.indexOf(t[n])) > -1 && (this.collidesWith.splice(s, 1), e && (delete this._groupCallbacks[t.mask], delete this._groupCallbackContext[t.mask]));
                else(s = this.collidesWith.indexOf(t)) > -1 && (this.collidesWith.splice(s, 1), e && (delete this._groupCallbacks[t.mask], delete this._groupCallbackContext[t.mask]));
                var o = this.getCollisionMask();
                if (void 0 === i)
                    for (n = this.data.shapes.length - 1; n >= 0; n--) this.data.shapes[n].collisionMask = o;
                else i.collisionMask = o
            },
            collides: function(t, e, i, s) {
                if (Array.isArray(t))
                    for (var n = 0; n < t.length; n++) - 1 === this.collidesWith.indexOf(t[n]) && (this.collidesWith.push(t[n]), e && this.createGroupCallback(t[n], e, i));
                else -1 === this.collidesWith.indexOf(t) && (this.collidesWith.push(t), e && this.createGroupCallback(t, e, i));
                var o = this.getCollisionMask();
                if (void 0 === s)
                    for (n = this.data.shapes.length - 1; n >= 0; n--) this.data.shapes[n].collisionMask = o;
                else s.collisionMask = o
            },
            adjustCenterOfMass: function() {
                this.data.adjustCenterOfMass(), this.shapeChanged()
            },
            getVelocityAtPoint: function(t, e) {
                return this.data.getVelocityAtPoint(t, e)
            },
            applyDamping: function(t) {
                this.data.applyDamping(t)
            },
            applyImpulse: function(t, e, i) {
                this.data.applyImpulse(t, [this.world.pxmi(e), this.world.pxmi(i)])
            },
            applyImpulseLocal: function(t, e, i) {
                this.data.applyImpulseLocal(t, [this.world.pxmi(e), this.world.pxmi(i)])
            },
            applyForce: function(t, e, i) {
                this.data.applyForce(t, [this.world.pxmi(e), this.world.pxmi(i)])
            },
            setZeroForce: function() {
                this.data.setZeroForce()
            },
            setZeroRotation: function() {
                this.data.angularVelocity = 0
            },
            setZeroVelocity: function() {
                this.data.velocity[0] = 0, this.data.velocity[1] = 0
            },
            setZeroDamping: function() {
                this.data.damping = 0, this.data.angularDamping = 0
            },
            toLocalFrame: function(t, e) {
                return this.data.toLocalFrame(t, e)
            },
            toWorldFrame: function(t, e) {
                return this.data.toWorldFrame(t, e)
            },
            rotateLeft: function(t) {
                this.data.angularVelocity = this.world.pxm(-t)
            },
            rotateRight: function(t) {
                this.data.angularVelocity = this.world.pxm(t)
            },
            moveForward: function(t) {
                var e = this.world.pxmi(-t),
                    i = this.data.angle + Math.PI / 2;
                this.data.velocity[0] = e * Math.cos(i), this.data.velocity[1] = e * Math.sin(i)
            },
            moveBackward: function(t) {
                var e = this.world.pxmi(-t),
                    i = this.data.angle + Math.PI / 2;
                this.data.velocity[0] = -e * Math.cos(i), this.data.velocity[1] = -e * Math.sin(i)
            },
            thrust: function(t) {
                var e = this.world.pxmi(-t),
                    i = this.data.angle + Math.PI / 2;
                this.data.force[0] += e * Math.cos(i), this.data.force[1] += e * Math.sin(i)
            },
            thrustLeft: function(t) {
                var e = this.world.pxmi(-t),
                    i = this.data.angle;
                this.data.force[0] += e * Math.cos(i), this.data.force[1] += e * Math.sin(i)
            },
            thrustRight: function(t) {
                var e = this.world.pxmi(-t),
                    i = this.data.angle;
                this.data.force[0] -= e * Math.cos(i), this.data.force[1] -= e * Math.sin(i)
            },
            reverse: function(t) {
                var e = this.world.pxmi(-t),
                    i = this.data.angle + Math.PI / 2;
                this.data.force[0] -= e * Math.cos(i), this.data.force[1] -= e * Math.sin(i)
            },
            moveLeft: function(t) {
                this.data.velocity[0] = this.world.pxmi(-t)
            },
            moveRight: function(t) {
                this.data.velocity[0] = this.world.pxmi(t)
            },
            moveUp: function(t) {
                this.data.velocity[1] = this.world.pxmi(-t)
            },
            moveDown: function(t) {
                this.data.velocity[1] = this.world.pxmi(t)
            },
            preUpdate: function() {
                this.dirty = !0, this.removeNextStep && (this.removeFromWorld(), this.removeNextStep = !1)
            },
            postUpdate: function() {
                this.sprite.x = this.world.mpxi(this.data.position[0]) + this.offset.x, this.sprite.y = this.world.mpxi(this.data.position[1]) + this.offset.y, this.fixedRotation || (this.sprite.rotation = this.data.angle), this.debugBody && this.debugBody.updateSpriteTransform(), this.dirty = !1
            },
            reset: function(t, e, i, s) {
                void 0 === i && (i = !1), void 0 === s && (s = !1), this.setZeroForce(), this.setZeroVelocity(), this.setZeroRotation(), i && this.setZeroDamping(), s && (this.mass = 1), this.x = t, this.y = e
            },
            addToWorld: function() {
                if (this.game.physics.p2._toRemove)
                    for (var t = 0; t < this.game.physics.p2._toRemove.length; t++) this.game.physics.p2._toRemove[t] === this && this.game.physics.p2._toRemove.splice(t, 1);
                this.data.world !== this.game.physics.p2.world && this.game.physics.p2.addBody(this)
            },
            removeFromWorld: function() {
                this.data.world === this.game.physics.p2.world && this.game.physics.p2.removeBodyNextStep(this)
            },
            destroy: function() {
                this.removeFromWorld(), this.clearShapes(), this._bodyCallbacks = {}, this._bodyCallbackContext = {}, this._groupCallbacks = {}, this._groupCallbackContext = {}, this.debugBody && this.debugBody.destroy(!0, !0), this.debugBody = null, this.sprite && (this.sprite.body = null, this.sprite = null)
            },
            clearShapes: function() {
                for (var t = this.data.shapes.length; t--;) this.data.removeShape(this.data.shapes[t]);
                this.shapeChanged()
            },
            addShape: function(t, e, i, s) {
                return void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === s && (s = 0), this.data.addShape(t, [this.world.pxmi(e), this.world.pxmi(i)], s), this.shapeChanged(), t
            },
            addCircle: function(t, e, i, s) {
                var n = new p2.Circle({
                    radius: this.world.pxm(t)
                });
                return this.addShape(n, e, i, s)
            },
            addRectangle: function(t, e, i, s, n) {
                var o = new p2.Box({
                    width: this.world.pxm(t),
                    height: this.world.pxm(e)
                });
                return this.addShape(o, i, s, n)
            },
            addPlane: function(t, e, i) {
                var s = new p2.Plane;
                return this.addShape(s, t, e, i)
            },
            addParticle: function(t, e, i) {
                var s = new p2.Particle;
                return this.addShape(s, t, e, i)
            },
            addLine: function(t, e, i, s) {
                var n = new p2.Line({
                    length: this.world.pxm(t)
                });
                return this.addShape(n, e, i, s)
            },
            addCapsule: function(t, e, i, s, n) {
                var o = new p2.Capsule({
                    length: this.world.pxm(t),
                    radius: this.world.pxm(e)
                });
                return this.addShape(o, i, s, n)
            },
            addPolygon: function(t, e) {
                t = t || {}, Array.isArray(e) || (e = Array.prototype.slice.call(arguments, 1));
                var i = [];
                if (1 === e.length && Array.isArray(e[0])) i = e[0].slice(0);
                else if (Array.isArray(e[0])) i = e.slice();
                else if ("number" == typeof e[0])
                    for (var s = 0, n = e.length; s < n; s += 2) i.push([e[s], e[s + 1]]);
                var o = i.length - 1;
                i[o][0] === i[0][0] && i[o][1] === i[0][1] && i.pop();
                for (var r = 0; r < i.length; r++) i[r][0] = this.world.pxmi(i[r][0]), i[r][1] = this.world.pxmi(i[r][1]);
                var a = this.data.fromPolygon(i, t);
                return this.shapeChanged(), a
            },
            removeShape: function(t) {
                var e = this.data.removeShape(t);
                return this.shapeChanged(), e
            },
            setCircle: function(t, e, i, s) {
                return this.clearShapes(), this.addCircle(t, e, i, s)
            },
            setRectangle: function(t, e, i, s, n) {
                return void 0 === t && (t = 16), void 0 === e && (e = 16), this.clearShapes(), this.addRectangle(t, e, i, s, n)
            },
            setRectangleFromSprite: function(t) {
                return void 0 === t && (t = this.sprite), this.clearShapes(), this.addRectangle(t.width, t.height, 0, 0, t.rotation)
            },
            setMaterial: function(t, e) {
                if (void 0 === e)
                    for (var i = this.data.shapes.length - 1; i >= 0; i--) this.data.shapes[i].material = t;
                else e.material = t
            },
            shapeChanged: function() {
                this.debugBody && this.debugBody.draw()
            },
            addPhaserPolygon: function(t, e) {
                for (var i = this.game.cache.getPhysicsData(t, e), s = [], n = 0; n < i.length; n++) {
                    var o = i[n],
                        r = this.addFixture(o);
                    s[o.filter.group] = s[o.filter.group] || [], s[o.filter.group] = s[o.filter.group].concat(r), o.fixtureKey && (s[o.fixtureKey] = r)
                }
                return this.data.aabbNeedsUpdate = !0, this.shapeChanged(), s
            },
            addFixture: function(t) {
                var e = [];
                if (t.circle) {
                    (l = new p2.Circle({
                        radius: this.world.pxm(t.circle.radius)
                    })).collisionGroup = t.filter.categoryBits, l.collisionMask = t.filter.maskBits, l.sensor = t.isSensor;
                    var i = p2.vec2.create();
                    i[0] = this.world.pxmi(t.circle.position[0] - this.sprite.width / 2), i[1] = this.world.pxmi(t.circle.position[1] - this.sprite.height / 2), this.data.addShape(l, i), e.push(l)
                } else
                    for (var s = t.polygons, n = p2.vec2.create(), o = 0; o < s.length; o++) {
                        for (var r = s[o], a = [], h = 0; h < r.length; h += 2) a.push([this.world.pxmi(r[h]), this.world.pxmi(r[h + 1])]);
                        for (var l = new p2.Convex({
                                vertices: a
                            }), c = 0; c !== l.vertices.length; c++) {
                            var u = l.vertices[c];
                            p2.vec2.sub(u, u, l.centerOfMass)
                        }
                        p2.vec2.scale(n, l.centerOfMass, 1), n[0] -= this.world.pxmi(this.sprite.width / 2), n[1] -= this.world.pxmi(this.sprite.height / 2), l.updateTriangles(), l.updateCenterOfMass(), l.updateBoundingRadius(), l.collisionGroup = t.filter.categoryBits, l.collisionMask = t.filter.maskBits, l.sensor = t.isSensor, this.data.addShape(l, n), e.push(l)
                    }
                return e
            },
            loadPolygon: function(t, e) {
                if (null === t) var i = e;
                else i = this.game.cache.getPhysicsData(t, e);
                for (var s = p2.vec2.create(), n = 0; n < i.length; n++) {
                    for (var o = [], r = 0; r < i[n].shape.length; r += 2) o.push([this.world.pxmi(i[n].shape[r]), this.world.pxmi(i[n].shape[r + 1])]);
                    for (var a = new p2.Convex({
                            vertices: o
                        }), h = 0; h !== a.vertices.length; h++) {
                        var l = a.vertices[h];
                        p2.vec2.sub(l, l, a.centerOfMass)
                    }
                    p2.vec2.scale(s, a.centerOfMass, 1), s[0] -= this.world.pxmi(this.sprite.width / 2), s[1] -= this.world.pxmi(this.sprite.height / 2), a.updateTriangles(), a.updateCenterOfMass(), a.updateBoundingRadius(), this.data.addShape(a, s)
                }
                return this.data.aabbNeedsUpdate = !0, this.shapeChanged(), !0
            }
        }, n.Physics.P2.Body.prototype.constructor = n.Physics.P2.Body, n.Physics.P2.Body.DYNAMIC = 1, n.Physics.P2.Body.STATIC = 2, n.Physics.P2.Body.KINEMATIC = 4, Object.defineProperty(n.Physics.P2.Body.prototype, "static", {
            get: function() {
                return this.data.type === n.Physics.P2.Body.STATIC
            },
            set: function(t) {
                t && this.data.type !== n.Physics.P2.Body.STATIC ? (this.data.type = n.Physics.P2.Body.STATIC, this.mass = 0) : t || this.data.type !== n.Physics.P2.Body.STATIC || (this.data.type = n.Physics.P2.Body.DYNAMIC, this.mass = 1)
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "dynamic", {
            get: function() {
                return this.data.type === n.Physics.P2.Body.DYNAMIC
            },
            set: function(t) {
                t && this.data.type !== n.Physics.P2.Body.DYNAMIC ? (this.data.type = n.Physics.P2.Body.DYNAMIC, this.mass = 1) : t || this.data.type !== n.Physics.P2.Body.DYNAMIC || (this.data.type = n.Physics.P2.Body.STATIC, this.mass = 0)
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "kinematic", {
            get: function() {
                return this.data.type === n.Physics.P2.Body.KINEMATIC
            },
            set: function(t) {
                t && this.data.type !== n.Physics.P2.Body.KINEMATIC ? (this.data.type = n.Physics.P2.Body.KINEMATIC, this.mass = 4) : t || this.data.type !== n.Physics.P2.Body.KINEMATIC || (this.data.type = n.Physics.P2.Body.STATIC, this.mass = 0)
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "allowSleep", {
            get: function() {
                return this.data.allowSleep
            },
            set: function(t) {
                t !== this.data.allowSleep && (this.data.allowSleep = t)
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "angle", {
            get: function() {
                return n.Math.wrapAngle(n.Math.radToDeg(this.data.angle))
            },
            set: function(t) {
                this.data.angle = n.Math.degToRad(n.Math.wrapAngle(t))
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "angularDamping", {
            get: function() {
                return this.data.angularDamping
            },
            set: function(t) {
                this.data.angularDamping = t
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "angularForce", {
            get: function() {
                return this.data.angularForce
            },
            set: function(t) {
                this.data.angularForce = t
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "angularVelocity", {
            get: function() {
                return this.data.angularVelocity
            },
            set: function(t) {
                this.data.angularVelocity = t
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "damping", {
            get: function() {
                return this.data.damping
            },
            set: function(t) {
                this.data.damping = t
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "fixedRotation", {
            get: function() {
                return this.data.fixedRotation
            },
            set: function(t) {
                t !== this.data.fixedRotation && (this.data.fixedRotation = t)
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "inertia", {
            get: function() {
                return this.data.inertia
            },
            set: function(t) {
                this.data.inertia = t
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "mass", {
            get: function() {
                return this.data.mass
            },
            set: function(t) {
                t !== this.data.mass && (this.data.mass = t, this.data.updateMassProperties())
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "motionState", {
            get: function() {
                return this.data.type
            },
            set: function(t) {
                t !== this.data.type && (this.data.type = t)
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "rotation", {
            get: function() {
                return this.data.angle
            },
            set: function(t) {
                this.data.angle = t
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "sleepSpeedLimit", {
            get: function() {
                return this.data.sleepSpeedLimit
            },
            set: function(t) {
                this.data.sleepSpeedLimit = t
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "x", {
            get: function() {
                return this.world.mpxi(this.data.position[0])
            },
            set: function(t) {
                this.data.position[0] = this.world.pxmi(t)
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "y", {
            get: function() {
                return this.world.mpxi(this.data.position[1])
            },
            set: function(t) {
                this.data.position[1] = this.world.pxmi(t)
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "id", {
            get: function() {
                return this.data.id
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "debug", {
            get: function() {
                return null !== this.debugBody
            },
            set: function(t) {
                t && !this.debugBody ? this.debugBody = new n.Physics.P2.BodyDebug(this.game, this.data) : !t && this.debugBody && (this.debugBody.destroy(), this.debugBody = null)
            }
        }), Object.defineProperty(n.Physics.P2.Body.prototype, "collideWorldBounds", {
            get: function() {
                return this._collideWorldBounds
            },
            set: function(t) {
                t && !this._collideWorldBounds ? (this._collideWorldBounds = !0, this.updateCollisionMask()) : !t && this._collideWorldBounds && (this._collideWorldBounds = !1, this.updateCollisionMask())
            }
        }), n.Physics.P2.BodyDebug = function(t, e, i) {
            n.Group.call(this, t);
            var s = {
                pixelsPerLengthUnit: t.physics.p2.mpx(1),
                debugPolygons: !1,
                lineWidth: 1,
                alpha: .5
            };
            this.settings = n.Utils.extend(s, i), this.ppu = this.settings.pixelsPerLengthUnit, this.ppu = -1 * this.ppu, this.body = e, this.canvas = new n.Graphics(t), this.canvas.alpha = this.settings.alpha, this.add(this.canvas), this.draw(), this.updateSpriteTransform()
        }, n.Physics.P2.BodyDebug.prototype = Object.create(n.Group.prototype), n.Physics.P2.BodyDebug.prototype.constructor = n.Physics.P2.BodyDebug, n.Utils.extend(n.Physics.P2.BodyDebug.prototype, {
            updateSpriteTransform: function() {
                this.position.x = this.body.position[0] * this.ppu, this.position.y = this.body.position[1] * this.ppu, this.rotation = this.body.angle
            },
            draw: function() {
                var t, e, i, s, n, o, r, a, h, l, c, u, d, p, f;
                if (a = this.body, (l = this.canvas).clear(), i = parseInt(this.randomPastelHex(), 16), o = 16711680, r = this.lineWidth, a instanceof p2.Body && a.shapes.length) {
                    var m = a.shapes.length;
                    for (s = 0; s !== m;) {
                        if (h = (e = a.shapes[s]).position || 0, t = e.angle || 0, e instanceof p2.Circle) this.drawCircle(l, h[0] * this.ppu, h[1] * this.ppu, t, e.radius * this.ppu, i, r);
                        else if (e instanceof p2.Capsule) this.drawCapsule(l, h[0] * this.ppu, h[1] * this.ppu, t, e.length * this.ppu, e.radius * this.ppu, o, i, r);
                        else if (e instanceof p2.Plane) this.drawPlane(l, h[0] * this.ppu, -h[1] * this.ppu, i, o, 5 * r, 10 * r, 10 * r, 100 * this.ppu, t);
                        else if (e instanceof p2.Line) this.drawLine(l, e.length * this.ppu, o, r);
                        else if (e instanceof p2.Box) this.drawRectangle(l, h[0] * this.ppu, h[1] * this.ppu, t, e.width * this.ppu, e.height * this.ppu, o, i, r);
                        else if (e instanceof p2.Convex) {
                            for (u = [], d = p2.vec2.create(), n = p = 0, f = e.vertices.length; 0 <= f ? p < f : p > f; n = 0 <= f ? ++p : --p) c = e.vertices[n], p2.vec2.rotate(d, c, t), u.push([(d[0] + h[0]) * this.ppu, -(d[1] + h[1]) * this.ppu]);
                            this.drawConvex(l, u, e.triangles, o, i, r, this.settings.debugPolygons, [h[0] * this.ppu, -h[1] * this.ppu])
                        }
                        s++
                    }
                }
            },
            drawRectangle: function(t, e, i, s, n, o, r, a, h) {
                void 0 === h && (h = 1), void 0 === r && (r = 0), t.lineStyle(h, r, 1), t.beginFill(a), t.drawRect(e - n / 2, i - o / 2, n, o)
            },
            drawCircle: function(t, e, i, s, n, o, r) {
                void 0 === r && (r = 1), void 0 === o && (o = 16777215), t.lineStyle(r, 0, 1), t.beginFill(o, 1), t.drawCircle(e, i, 2 * -n), t.endFill(), t.moveTo(e, i), t.lineTo(e + n * Math.cos(-s), i + n * Math.sin(-s))
            },
            drawLine: function(t, e, i, s) {
                void 0 === s && (s = 1), void 0 === i && (i = 0), t.lineStyle(5 * s, i, 1), t.moveTo(-e / 2, 0), t.lineTo(e / 2, 0)
            },
            drawConvex: function(t, e, i, s, n, o, r, a) {
                var h, l, c, u, d, p, f, m, g, y, v;
                if (void 0 === o && (o = 1), void 0 === s && (s = 0), r) {
                    for (h = [16711680, 65280, 255], l = 0; l !== e.length + 1;) u = e[l % e.length], d = e[(l + 1) % e.length], f = u[0], y = u[1], m = d[0], v = d[1], t.lineStyle(o, h[l % h.length], 1), t.moveTo(f, -y), t.lineTo(m, -v), t.drawCircle(f, -y, 2 * o), l++;
                    return t.lineStyle(o, 0, 1), t.drawCircle(a[0], a[1], 2 * o)
                }
                for (t.lineStyle(o, s, 1), t.beginFill(n), l = 0; l !== e.length;) p = (c = e[l])[0], g = c[1], 0 === l ? t.moveTo(p, -g) : t.lineTo(p, -g), l++;
                if (t.endFill(), e.length > 2) return t.moveTo(e[e.length - 1][0], -e[e.length - 1][1]), t.lineTo(e[0][0], -e[0][1])
            },
            drawPath: function(t, e, i, s, n) {
                var o, r, a, h, l, c, u, d, p, f, m;
                for (void 0 === n && (n = 1), void 0 === i && (i = 0), t.lineStyle(n, i, 1), "number" == typeof s && t.beginFill(s), r = null, a = null, o = 0; o < e.length;) f = (p = e[o])[0], m = p[1], f === r && m === a || (0 === o ? t.moveTo(f, m) : (h = r, l = a, c = f, u = m, d = e[(o + 1) % e.length][0], 0 != (c - h) * (e[(o + 1) % e.length][1] - l) - (d - h) * (u - l) && t.lineTo(f, m)), r = f, a = m), o++;
                "number" == typeof s && t.endFill(), e.length > 2 && "number" == typeof s && (t.moveTo(e[e.length - 1][0], e[e.length - 1][1]), t.lineTo(e[0][0], e[0][1]))
            },
            drawPlane: function(t, e, i, s, n, o, r, a, h, l) {
                var c, u;
                void 0 === o && (o = 1), void 0 === s && (s = 16777215), t.lineStyle(o, n, 11), t.beginFill(s), t.moveTo(e, -i), c = e + Math.cos(l) * this.game.width, u = i + Math.sin(l) * this.game.height, t.lineTo(c, -u), t.moveTo(e, -i), c = e + Math.cos(l) * -this.game.width, u = i + Math.sin(l) * -this.game.height, t.lineTo(c, -u)
            },
            drawCapsule: function(t, e, i, s, n, o, r, a, h) {
                void 0 === h && (h = 1), void 0 === r && (r = 0), t.lineStyle(h, r, 1);
                var l = Math.cos(s),
                    c = Math.sin(s);
                t.beginFill(a, 1), t.drawCircle(-n / 2 * l + e, -n / 2 * c + i, 2 * -o), t.drawCircle(n / 2 * l + e, n / 2 * c + i, 2 * -o), t.endFill(), t.lineStyle(h, r, 0), t.beginFill(a, 1), t.moveTo(-n / 2 * l + o * c + e, -n / 2 * c + o * l + i), t.lineTo(n / 2 * l + o * c + e, n / 2 * c + o * l + i), t.lineTo(n / 2 * l - o * c + e, n / 2 * c - o * l + i), t.lineTo(-n / 2 * l - o * c + e, -n / 2 * c - o * l + i), t.endFill(), t.lineStyle(h, r, 1), t.moveTo(-n / 2 * l + o * c + e, -n / 2 * c + o * l + i), t.lineTo(n / 2 * l + o * c + e, n / 2 * c + o * l + i), t.moveTo(-n / 2 * l - o * c + e, -n / 2 * c - o * l + i), t.lineTo(n / 2 * l - o * c + e, n / 2 * c - o * l + i)
            },
            randomPastelHex: function() {
                var t, e, i, s;
                return i = [255, 255, 255], s = Math.floor(256 * Math.random()), e = Math.floor(256 * Math.random()), t = Math.floor(256 * Math.random()), s = Math.floor((s + 3 * i[0]) / 4), e = Math.floor((e + 3 * i[1]) / 4), t = Math.floor((t + 3 * i[2]) / 4), this.rgbToHex(s, e, t)
            },
            rgbToHex: function(t, e, i) {
                return this.componentToHex(t) + this.componentToHex(e) + this.componentToHex(i)
            },
            componentToHex: function(t) {
                var e;
                return 2 === (e = t.toString(16)).length ? e : e + "0"
            }
        }), n.Physics.P2.Spring = function(t, e, i, s, n, o, r, a, h, l) {
            this.game = t.game, this.world = t, void 0 === s && (s = 1), void 0 === n && (n = 100), void 0 === o && (o = 1);
            var c = {
                restLength: s = t.pxm(s),
                stiffness: n,
                damping: o
            };
            null != r && (c.worldAnchorA = [t.pxm(r[0]), t.pxm(r[1])]), null != a && (c.worldAnchorB = [t.pxm(a[0]), t.pxm(a[1])]), null != h && (c.localAnchorA = [t.pxm(h[0]), t.pxm(h[1])]), null != l && (c.localAnchorB = [t.pxm(l[0]), t.pxm(l[1])]), this.data = new p2.LinearSpring(e, i, c), this.data.parent = this
        }, n.Physics.P2.Spring.prototype.constructor = n.Physics.P2.Spring, n.Physics.P2.RotationalSpring = function(t, e, i, s, n, o) {
            this.game = t.game, this.world = t, void 0 === s && (s = null), void 0 === n && (n = 100), void 0 === o && (o = 1), s && (s = t.pxm(s));
            var r = {
                restAngle: s,
                stiffness: n,
                damping: o
            };
            this.data = new p2.RotationalSpring(e, i, r), this.data.parent = this
        }, n.Physics.P2.Spring.prototype.constructor = n.Physics.P2.Spring, n.Physics.P2.Material = function(t) {
            this.name = t, p2.Material.call(this)
        }, n.Physics.P2.Material.prototype = Object.create(p2.Material.prototype), n.Physics.P2.Material.prototype.constructor = n.Physics.P2.Material, n.Physics.P2.ContactMaterial = function(t, e, i) {
            p2.ContactMaterial.call(this, t, e, i)
        }, n.Physics.P2.ContactMaterial.prototype = Object.create(p2.ContactMaterial.prototype), n.Physics.P2.ContactMaterial.prototype.constructor = n.Physics.P2.ContactMaterial, n.Physics.P2.CollisionGroup = function(t) {
            this.mask = t
        }, n.Physics.P2.DistanceConstraint = function(t, e, i, s, n, o, r) {
            void 0 === s && (s = 100), void 0 === n && (n = [0, 0]), void 0 === o && (o = [0, 0]), void 0 === r && (r = Number.MAX_VALUE), this.game = t.game, this.world = t;
            var a = {
                distance: s = t.pxm(s),
                localAnchorA: n = [t.pxmi(n[0]), t.pxmi(n[1])],
                localAnchorB: o = [t.pxmi(o[0]), t.pxmi(o[1])],
                maxForce: r
            };
            p2.DistanceConstraint.call(this, e, i, a)
        }, n.Physics.P2.DistanceConstraint.prototype = Object.create(p2.DistanceConstraint.prototype), n.Physics.P2.DistanceConstraint.prototype.constructor = n.Physics.P2.DistanceConstraint, n.Physics.P2.GearConstraint = function(t, e, i, s, n) {
            void 0 === s && (s = 0), void 0 === n && (n = 1), this.game = t.game, this.world = t;
            var o = {
                angle: s,
                ratio: n
            };
            p2.GearConstraint.call(this, e, i, o)
        }, n.Physics.P2.GearConstraint.prototype = Object.create(p2.GearConstraint.prototype), n.Physics.P2.GearConstraint.prototype.constructor = n.Physics.P2.GearConstraint, n.Physics.P2.LockConstraint = function(t, e, i, s, n, o) {
            void 0 === s && (s = [0, 0]), void 0 === n && (n = 0), void 0 === o && (o = Number.MAX_VALUE), this.game = t.game, this.world = t;
            var r = {
                localOffsetB: s = [t.pxm(s[0]), t.pxm(s[1])],
                localAngleB: n,
                maxForce: o
            };
            p2.LockConstraint.call(this, e, i, r)
        }, n.Physics.P2.LockConstraint.prototype = Object.create(p2.LockConstraint.prototype), n.Physics.P2.LockConstraint.prototype.constructor = n.Physics.P2.LockConstraint, n.Physics.P2.PrismaticConstraint = function(t, e, i, s, n, o, r, a) {
            void 0 === s && (s = !0), void 0 === n && (n = [0, 0]), void 0 === o && (o = [0, 0]), void 0 === r && (r = [0, 0]), void 0 === a && (a = Number.MAX_VALUE), this.game = t.game, this.world = t;
            var h = {
                localAnchorA: n = [t.pxmi(n[0]), t.pxmi(n[1])],
                localAnchorB: o = [t.pxmi(o[0]), t.pxmi(o[1])],
                localAxisA: r,
                maxForce: a,
                disableRotationalLock: !s
            };
            p2.PrismaticConstraint.call(this, e, i, h)
        }, n.Physics.P2.PrismaticConstraint.prototype = Object.create(p2.PrismaticConstraint.prototype), n.Physics.P2.PrismaticConstraint.prototype.constructor = n.Physics.P2.PrismaticConstraint, n.Physics.P2.RevoluteConstraint = function(t, e, i, s, n, o, r) {
            void 0 === o && (o = Number.MAX_VALUE), void 0 === r && (r = null), this.game = t.game, this.world = t, i = [t.pxmi(i[0]), t.pxmi(i[1])], n = [t.pxmi(n[0]), t.pxmi(n[1])], r && (r = [t.pxmi(r[0]), t.pxmi(r[1])]);
            var a = {
                worldPivot: r,
                localPivotA: i,
                localPivotB: n,
                maxForce: o
            };
            p2.RevoluteConstraint.call(this, e, s, a)
        }, n.Physics.P2.RevoluteConstraint.prototype = Object.create(p2.RevoluteConstraint.prototype), n.Physics.P2.RevoluteConstraint.prototype.constructor = n.Physics.P2.RevoluteConstraint, n.ImageCollection = function(t, e, i, s, n, o, r) {
            (void 0 === i || i <= 0) && (i = 32), (void 0 === s || s <= 0) && (s = 32), void 0 === n && (n = 0), void 0 === o && (o = 0), this.name = t, this.firstgid = 0 | e, this.imageWidth = 0 | i, this.imageHeight = 0 | s, this.imageMargin = 0 | n, this.imageSpacing = 0 | o, this.properties = r || {}, this.images = [], this.total = 0
        }, n.ImageCollection.prototype = {
            containsImageIndex: function(t) {
                return t >= this.firstgid && t < this.firstgid + this.total
            },
            addImage: function(t, e) {
                this.images.push({
                    gid: t,
                    image: e
                }), this.total++
            }
        }, n.ImageCollection.prototype.constructor = n.ImageCollection, n.Tile = function(t, e, i, s, n, o) {
            this.layer = t, this.index = e, this.x = i, this.y = s, this.rotation = 0, this.flipped = !1, this.worldX = i * n, this.worldY = s * o, this.width = n, this.height = o, this.centerX = Math.abs(n / 2), this.centerY = Math.abs(o / 2), this.alpha = 1, this.properties = {}, this.scanned = !1, this.faceTop = !1, this.faceBottom = !1, this.faceLeft = !1, this.faceRight = !1, this.collideLeft = !1, this.collideRight = !1, this.collideUp = !1, this.collideDown = !1, this.collisionCallback = null, this.collisionCallbackContext = this
        }, n.Tile.prototype = {
            containsPoint: function(t, e) {
                return !(t < this.worldX || e < this.worldY || t > this.right || e > this.bottom)
            },
            intersects: function(t, e, i, s) {
                return !(i <= this.worldX || s <= this.worldY || t >= this.worldX + this.width || e >= this.worldY + this.height)
            },
            setCollisionCallback: function(t, e) {
                this.collisionCallback = t, this.collisionCallbackContext = e
            },
            destroy: function() {
                this.collisionCallback = null, this.collisionCallbackContext = null, this.properties = null
            },
            setCollision: function(t, e, i, s) {
                this.collideLeft = t, this.collideRight = e, this.collideUp = i, this.collideDown = s, this.faceLeft = t, this.faceRight = e, this.faceTop = i, this.faceBottom = s
            },
            resetCollision: function() {
                this.collideLeft = !1, this.collideRight = !1, this.collideUp = !1, this.collideDown = !1, this.faceTop = !1, this.faceBottom = !1, this.faceLeft = !1, this.faceRight = !1
            },
            isInteresting: function(t, e) {
                return t && e ? this.collideLeft || this.collideRight || this.collideUp || this.collideDown || this.faceTop || this.faceBottom || this.faceLeft || this.faceRight || this.collisionCallback : t ? this.collideLeft || this.collideRight || this.collideUp || this.collideDown : !!e && (this.faceTop || this.faceBottom || this.faceLeft || this.faceRight)
            },
            copy: function(t) {
                this.index = t.index, this.alpha = t.alpha, this.properties = t.properties, this.collideUp = t.collideUp, this.collideDown = t.collideDown, this.collideLeft = t.collideLeft, this.collideRight = t.collideRight, this.collisionCallback = t.collisionCallback, this.collisionCallbackContext = t.collisionCallbackContext
            }
        }, n.Tile.prototype.constructor = n.Tile, Object.defineProperty(n.Tile.prototype, "collides", {
            get: function() {
                return this.collideLeft || this.collideRight || this.collideUp || this.collideDown
            }
        }), Object.defineProperty(n.Tile.prototype, "canCollide", {
            get: function() {
                return this.collideLeft || this.collideRight || this.collideUp || this.collideDown || this.collisionCallback
            }
        }), Object.defineProperty(n.Tile.prototype, "left", {
            get: function() {
                return this.worldX
            }
        }), Object.defineProperty(n.Tile.prototype, "right", {
            get: function() {
                return this.worldX + this.width
            }
        }), Object.defineProperty(n.Tile.prototype, "top", {
            get: function() {
                return this.worldY
            }
        }), Object.defineProperty(n.Tile.prototype, "bottom", {
            get: function() {
                return this.worldY + this.height
            }
        }), n.Tilemap = function(t, e, i, s, o, r) {
            this.game = t, this.key = e;
            var a = n.TilemapParser.parse(this.game, e, i, s, o, r);
            null !== a && (this.width = a.width, this.height = a.height, this.tileWidth = a.tileWidth, this.tileHeight = a.tileHeight, this.orientation = a.orientation, this.format = a.format, this.version = a.version, this.properties = a.properties, this.widthInPixels = a.widthInPixels, this.heightInPixels = a.heightInPixels, this.layers = a.layers, this.tilesets = a.tilesets, this.imagecollections = a.imagecollections, this.tiles = a.tiles, this.objects = a.objects, this.collideIndexes = [], this.collision = a.collision, this.images = a.images, this.enableDebug = !1, this.currentLayer = 0, this.debugMap = [], this._results = [], this._tempA = 0, this._tempB = 0)
        }, n.Tilemap.CSV = 0, n.Tilemap.TILED_JSON = 1, n.Tilemap.NORTH = 0, n.Tilemap.EAST = 1, n.Tilemap.SOUTH = 2, n.Tilemap.WEST = 3, n.Tilemap.prototype = {
            create: function(t, e, i, s, n, o) {
                return void 0 === o && (o = this.game.world), this.width = e, this.height = i, this.setTileSize(s, n), this.layers.length = 0, this.createBlankLayer(t, e, i, s, n, o)
            },
            setTileSize: function(t, e) {
                this.tileWidth = t, this.tileHeight = e, this.widthInPixels = this.width * t, this.heightInPixels = this.height * e
            },
            addTilesetImage: function(t, e, i, s, o, r, a) {
                if (void 0 === t) return null;
                void 0 === i && (i = this.tileWidth), void 0 === s && (s = this.tileHeight), void 0 === o && (o = 0), void 0 === r && (r = 0), void 0 === a && (a = 0), 0 === i && (i = 32), 0 === s && (s = 32);
                var h = null;
                if (null != e || (e = t), e instanceof n.BitmapData) h = e.canvas;
                else {
                    if (!this.game.cache.checkImageKey(e)) return console.warn('Phaser.Tilemap.addTilesetImage: Invalid image key given: "' + e + '"'), null;
                    h = this.game.cache.getImage(e)
                }
                var l = this.getTilesetIndex(t);
                if (null === l && this.format === n.Tilemap.TILED_JSON) return console.warn('Phaser.Tilemap.addTilesetImage: No data found in the JSON matching the tileset name: "' + t + '"'), null;
                if (this.tilesets[l]) return this.tilesets[l].setImage(h), this.tilesets[l];
                var c = new n.Tileset(t, a, i, s, o, r, {});
                c.setImage(h), this.tilesets.push(c);
                for (var u = this.tilesets.length - 1, d = o, p = o, f = 0, m = 0, g = 0, y = a; y < a + c.total && (this.tiles[y] = [d, p, u], d += i + r, ++f !== c.total) && (++m !== c.columns || (d = o, p += s + r, m = 0, ++g !== c.rows)); y++);
                return c
            },
            createFromObjects: function(t, e, i, s, o, r, a, h, l) {
                if (void 0 === o && (o = !0), void 0 === r && (r = !1), void 0 === a && (a = this.game.world), void 0 === h && (h = n.Sprite), void 0 === l && (l = !0), this.objects[t])
                    for (var c = 0; c < this.objects[t].length; c++) {
                        var u = !1,
                            d = this.objects[t][c];
                        if (void 0 !== d.gid && "number" == typeof e && d.gid === e ? u = !0 : void 0 !== d.id && "number" == typeof e && d.id === e ? u = !0 : void 0 !== d.name && "string" == typeof e && d.name === e && (u = !0), u) {
                            var p = new h(this.game, parseFloat(d.x, 10), parseFloat(d.y, 10), i, s);
                            for (var f in p.name = d.name, p.visible = d.visible, p.autoCull = r, p.exists = o, d.width && (p.width = d.width), d.height && (p.height = d.height), d.rotation && (p.angle = d.rotation), l && (p.y -= p.height), a.add(p), d.properties) a.set(p, f, d.properties[f], !1, !1, 0, !0)
                        }
                    } else console.warn("Tilemap.createFromObjects: Invalid objectgroup name given: " + t)
            },
            createFromTiles: function(t, e, i, s, o, r) {
                "number" == typeof t && (t = [t]), null == e ? e = [] : "number" == typeof e && (e = [e]), s = this.getLayer(s), void 0 === o && (o = this.game.world), void 0 === r && (r = {}), void 0 === r.customClass && (r.customClass = n.Sprite), void 0 === r.adjustY && (r.adjustY = !0);
                var a = this.layers[s].width,
                    h = this.layers[s].height;
                if (this.copy(0, 0, a, h, s), this._results.length < 2) return 0;
                for (var l, c = 0, u = 1, d = this._results.length; u < d; u++)
                    if (-1 !== t.indexOf(this._results[u].index)) {
                        for (var p in l = new r.customClass(this.game, this._results[u].worldX, this._results[u].worldY, i), r) l[p] = r[p];
                        o.add(l), c++
                    } if (1 === e.length)
                    for (u = 0; u < t.length; u++) this.replace(t[u], e[0], 0, 0, a, h, s);
                else if (e.length > 1)
                    for (u = 0; u < t.length; u++) this.replace(t[u], e[u], 0, 0, a, h, s);
                return c
            },
            createLayer: function(t, e, i, s) {
                void 0 === e && (e = this.game.width), void 0 === i && (i = this.game.height), void 0 === s && (s = this.game.world);
                var o = t;
                if ("string" == typeof t && (o = this.getLayerIndex(t)), !(null === o || o > this.layers.length)) {
                    void 0 === e || e <= 0 ? e = Math.min(this.game.width, this.layers[o].widthInPixels) : e > this.game.width && (e = this.game.width), void 0 === i || i <= 0 ? i = Math.min(this.game.height, this.layers[o].heightInPixels) : i > this.game.height && (i = this.game.height), this.enableDebug && (console.group("Tilemap.createLayer"), console.log("Name:", this.layers[o].name), console.log("Size:", e, "x", i), console.log("Tileset:", this.tilesets[0].name, "index:", o));
                    var r = s.add(new n.TilemapLayer(this.game, this, o, e, i));
                    return this.enableDebug && console.groupEnd(), r
                }
                console.warn("Tilemap.createLayer: Invalid layer ID given: " + o)
            },
            createBlankLayer: function(t, e, i, s, o, r) {
                if (void 0 === r && (r = this.game.world), null === this.getLayerIndex(t)) {
                    for (var a, h = {
                            name: t,
                            x: 0,
                            y: 0,
                            width: e,
                            height: i,
                            widthInPixels: e * s,
                            heightInPixels: i * o,
                            alpha: 1,
                            visible: !0,
                            properties: {},
                            indexes: [],
                            callbacks: [],
                            bodies: [],
                            data: null
                        }, l = [], c = 0; c < i; c++) {
                        a = [];
                        for (var u = 0; u < e; u++) a.push(new n.Tile(h, -1, u, c, s, o));
                        l.push(a)
                    }
                    h.data = l, this.layers.push(h), this.currentLayer = this.layers.length - 1;
                    var d = h.widthInPixels,
                        p = h.heightInPixels;
                    return d > this.game.width && (d = this.game.width), p > this.game.height && (p = this.game.height), (l = new n.TilemapLayer(this.game, this, this.layers.length - 1, d, p)).name = t, r.add(l)
                }
                console.warn("Tilemap.createBlankLayer: Layer with matching name already exists: " + t)
            },
            getIndex: function(t, e) {
                for (var i = 0; i < t.length; i++)
                    if (t[i].name === e) return i;
                return null
            },
            getLayerIndex: function(t) {
                return this.getIndex(this.layers, t)
            },
            getTilesetIndex: function(t) {
                return this.getIndex(this.tilesets, t)
            },
            getImageIndex: function(t) {
                return this.getIndex(this.images, t)
            },
            setTileIndexCallback: function(t, e, i, s) {
                if (s = this.getLayer(s), "number" == typeof t) this.layers[s].callbacks[t] = {
                    callback: e,
                    callbackContext: i
                };
                else
                    for (var n = 0, o = t.length; n < o; n++) this.layers[s].callbacks[t[n]] = {
                        callback: e,
                        callbackContext: i
                    }
            },
            setTileLocationCallback: function(t, e, i, s, n, o, r) {
                if (r = this.getLayer(r), this.copy(t, e, i, s, r), !(this._results.length < 2))
                    for (var a = 1; a < this._results.length; a++) this._results[a].setCollisionCallback(n, o)
            },
            setCollision: function(t, e, i, s) {
                if (void 0 === e && (e = !0), void 0 === s && (s = !0), i = this.getLayer(i), "number" == typeof t) return this.setCollisionByIndex(t, e, i, !0);
                if (Array.isArray(t)) {
                    for (var n = 0; n < t.length; n++) this.setCollisionByIndex(t[n], e, i, !1);
                    s && this.calculateFaces(i)
                }
            },
            setCollisionBetween: function(t, e, i, s, n) {
                if (void 0 === i && (i = !0), void 0 === n && (n = !0), s = this.getLayer(s), !(t > e)) {
                    for (var o = t; o <= e; o++) this.setCollisionByIndex(o, i, s, !1);
                    n && this.calculateFaces(s)
                }
            },
            setCollisionByExclusion: function(t, e, i, s) {
                void 0 === e && (e = !0), void 0 === s && (s = !0), i = this.getLayer(i);
                for (var n = 0, o = this.tiles.length; n < o; n++) - 1 === t.indexOf(n) && this.setCollisionByIndex(n, e, i, !1);
                s && this.calculateFaces(i)
            },
            setCollisionByIndex: function(t, e, i, s) {
                if (void 0 === e && (e = !0), void 0 === i && (i = this.currentLayer), void 0 === s && (s = !0), e) this.collideIndexes.push(t);
                else {
                    var n = this.collideIndexes.indexOf(t);
                    n > -1 && this.collideIndexes.splice(n, 1)
                }
                for (var o = 0; o < this.layers[i].height; o++)
                    for (var r = 0; r < this.layers[i].width; r++) {
                        var a = this.layers[i].data[o][r];
                        a && a.index === t && (e ? a.setCollision(!0, !0, !0, !0) : a.resetCollision(), a.faceTop = e, a.faceBottom = e, a.faceLeft = e, a.faceRight = e)
                    }
                return s && this.calculateFaces(i), i
            },
            getLayer: function(t) {
                return void 0 === t ? t = this.currentLayer : "string" == typeof t ? t = this.getLayerIndex(t) : t instanceof n.TilemapLayer && (t = t.index), t
            },
            setPreventRecalculate: function(t) {
                if (!0 === t && !0 !== this.preventingRecalculate && (this.preventingRecalculate = !0, this.needToRecalculate = {}), !1 === t && !0 === this.preventingRecalculate) {
                    for (var e in this.preventingRecalculate = !1, this.needToRecalculate) this.calculateFaces(e);
                    this.needToRecalculate = !1
                }
            },
            calculateFaces: function(t) {
                if (this.preventingRecalculate) this.needToRecalculate[t] = !0;
                else
                    for (var e = null, i = null, s = null, n = null, o = 0, r = this.layers[t].height; o < r; o++)
                        for (var a = 0, h = this.layers[t].width; a < h; a++) {
                            var l = this.layers[t].data[o][a];
                            l && (e = this.getTileAbove(t, a, o), i = this.getTileBelow(t, a, o), s = this.getTileLeft(t, a, o), n = this.getTileRight(t, a, o), l.collides && (l.faceTop = !0, l.faceBottom = !0, l.faceLeft = !0, l.faceRight = !0), e && e.collides && (l.faceTop = !1), i && i.collides && (l.faceBottom = !1), s && s.collides && (l.faceLeft = !1), n && n.collides && (l.faceRight = !1))
                        }
            },
            getTileAbove: function(t, e, i) {
                return i > 0 ? this.layers[t].data[i - 1][e] : null
            },
            getTileBelow: function(t, e, i) {
                return i < this.layers[t].height - 1 ? this.layers[t].data[i + 1][e] : null
            },
            getTileLeft: function(t, e, i) {
                return e > 0 ? this.layers[t].data[i][e - 1] : null
            },
            getTileRight: function(t, e, i) {
                return e < this.layers[t].width - 1 ? this.layers[t].data[i][e + 1] : null
            },
            setLayer: function(t) {
                t = this.getLayer(t), this.layers[t] && (this.currentLayer = t)
            },
            hasTile: function(t, e, i) {
                return i = this.getLayer(i), void 0 !== this.layers[i].data[e] && void 0 !== this.layers[i].data[e][t] && this.layers[i].data[e][t].index > -1
            },
            removeTile: function(t, e, i) {
                if (i = this.getLayer(i), t >= 0 && t < this.layers[i].width && e >= 0 && e < this.layers[i].height && this.hasTile(t, e, i)) {
                    var s = this.layers[i].data[e][t];
                    return this.layers[i].data[e][t] = new n.Tile(this.layers[i], -1, t, e, this.tileWidth, this.tileHeight), this.layers[i].dirty = !0, this.calculateFaces(i), s
                }
            },
            removeTileWorldXY: function(t, e, i, s, n) {
                return n = this.getLayer(n), t = this.game.math.snapToFloor(t, i) / i, e = this.game.math.snapToFloor(e, s) / s, this.removeTile(t, e, n)
            },
            putTile: function(t, e, i, s) {
                return null === t ? this.removeTile(e, i, s) : (s = this.getLayer(s), e >= 0 && e < this.layers[s].width && i >= 0 && i < this.layers[s].height ? (t instanceof n.Tile ? (o = t.index, this.hasTile(e, i, s) ? this.layers[s].data[i][e].copy(t) : this.layers[s].data[i][e] = new n.Tile(s, o, e, i, t.width, t.height)) : (o = t, this.hasTile(e, i, s) ? this.layers[s].data[i][e].index = o : this.layers[s].data[i][e] = new n.Tile(this.layers[s], o, e, i, this.tileWidth, this.tileHeight)), this.collideIndexes.indexOf(o) > -1 ? this.layers[s].data[i][e].setCollision(!0, !0, !0, !0) : this.layers[s].data[i][e].resetCollision(), this.layers[s].dirty = !0, this.calculateFaces(s), this.layers[s].data[i][e]) : null);
                var o
            },
            putTileWorldXY: function(t, e, i, s, n, o) {
                return o = this.getLayer(o), e = this.game.math.snapToFloor(e, s) / s, i = this.game.math.snapToFloor(i, n) / n, this.putTile(t, e, i, o)
            },
            searchTileIndex: function(t, e, i, s) {
                void 0 === e && (e = 0), void 0 === i && (i = !1), s = this.getLayer(s);
                var n = 0;
                if (i) {
                    for (var o = this.layers[s].height - 1; o >= 0; o--)
                        for (var r = this.layers[s].width - 1; r >= 0; r--)
                            if (this.layers[s].data[o][r].index === t) {
                                if (n === e) return this.layers[s].data[o][r];
                                n++
                            }
                } else
                    for (o = 0; o < this.layers[s].height; o++)
                        for (r = 0; r < this.layers[s].width; r++)
                            if (this.layers[s].data[o][r].index === t) {
                                if (n === e) return this.layers[s].data[o][r];
                                n++
                            } return null
            },
            getTile: function(t, e, i, s) {
                return void 0 === s && (s = !1), i = this.getLayer(i), t >= 0 && t < this.layers[i].width && e >= 0 && e < this.layers[i].height ? -1 === this.layers[i].data[e][t].index ? s ? this.layers[i].data[e][t] : null : this.layers[i].data[e][t] : null
            },
            getTileWorldXY: function(t, e, i, s, n, o) {
                return void 0 === i && (i = this.tileWidth), void 0 === s && (s = this.tileHeight), n = this.getLayer(n), t = this.game.math.snapToFloor(t, i) / i, e = this.game.math.snapToFloor(e, s) / s, this.getTile(t, e, n, o)
            },
            copy: function(t, e, i, s, n) {
                if (n = this.getLayer(n), this.layers[n]) {
                    void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = this.layers[n].width), void 0 === s && (s = this.layers[n].height), t < 0 && (t = 0), e < 0 && (e = 0), i > this.layers[n].width && (i = this.layers[n].width), s > this.layers[n].height && (s = this.layers[n].height), this._results.length = 0, this._results.push({
                        x: t,
                        y: e,
                        width: i,
                        height: s,
                        layer: n
                    });
                    for (var o = e; o < e + s; o++)
                        for (var r = t; r < t + i; r++) this._results.push(this.layers[n].data[o][r]);
                    return this._results
                }
                this._results.length = 0
            },
            paste: function(t, e, i, s) {
                if (void 0 === t && (t = 0), void 0 === e && (e = 0), s = this.getLayer(s), i && !(i.length < 2)) {
                    for (var n = t - i[1].x, o = e - i[1].y, r = 1; r < i.length; r++) this.layers[s].data[o + i[r].y][n + i[r].x].copy(i[r]);
                    this.layers[s].dirty = !0, this.calculateFaces(s)
                }
            },
            swap: function(t, e, i, s, n, o, r) {
                r = this.getLayer(r), this.copy(i, s, n, o, r), this._results.length < 2 || (this._tempA = t, this._tempB = e, this._results.forEach(this.swapHandler, this), this.paste(i, s, this._results, r))
            },
            swapHandler: function(t) {
                t.index === this._tempA ? t.index = this._tempB : t.index === this._tempB && (t.index = this._tempA)
            },
            forEach: function(t, e, i, s, n, o, r) {
                r = this.getLayer(r), this.copy(i, s, n, o, r), this._results.length < 2 || (this._results.forEach(t, e), this.paste(i, s, this._results, r))
            },
            replace: function(t, e, i, s, n, o, r) {
                if (r = this.getLayer(r), this.copy(i, s, n, o, r), !(this._results.length < 2)) {
                    for (var a = 1; a < this._results.length; a++) this._results[a].index === t && (this._results[a].index = e);
                    this.paste(i, s, this._results, r)
                }
            },
            random: function(t, e, i, s, n) {
                if (n = this.getLayer(n), this.copy(t, e, i, s, n), !(this._results.length < 2)) {
                    for (var o = [], r = 1; r < this._results.length; r++)
                        if (this._results[r].index) {
                            var a = this._results[r].index; - 1 === o.indexOf(a) && o.push(a)
                        } for (var h = 1; h < this._results.length; h++) this._results[h].index = this.game.rnd.pick(o);
                    this.paste(t, e, this._results, n)
                }
            },
            shuffle: function(t, e, i, s, o) {
                if (o = this.getLayer(o), this.copy(t, e, i, s, o), !(this._results.length < 2)) {
                    for (var r = [], a = 1; a < this._results.length; a++) this._results[a].index && r.push(this._results[a].index);
                    n.ArrayUtils.shuffle(r);
                    for (var h = 1; h < this._results.length; h++) this._results[h].index = r[h - 1];
                    this.paste(t, e, this._results, o)
                }
            },
            fill: function(t, e, i, s, n, o) {
                if (o = this.getLayer(o), this.copy(e, i, s, n, o), !(this._results.length < 2)) {
                    for (var r = 1; r < this._results.length; r++) this._results[r].index = t;
                    this.paste(e, i, this._results, o)
                }
            },
            removeAllLayers: function() {
                this.layers.length = 0, this.currentLayer = 0
            },
            dump: function() {
                for (var t = "", e = [""], i = 0; i < this.layers[this.currentLayer].height; i++) {
                    for (var s = 0; s < this.layers[this.currentLayer].width; s++) t += "%c  ", this.layers[this.currentLayer].data[i][s] > 1 ? this.debugMap[this.layers[this.currentLayer].data[i][s]] ? e.push("background: " + this.debugMap[this.layers[this.currentLayer].data[i][s]]) : e.push("background: #ffffff") : e.push("background: rgb(0, 0, 0)");
                    t += "\n"
                }
                e[0] = t, console.log.apply(console, e)
            },
            destroy: function() {
                this.removeAllLayers(), this.data = [], this.game = null
            }
        }, n.Tilemap.prototype.constructor = n.Tilemap, Object.defineProperty(n.Tilemap.prototype, "layer", {
            get: function() {
                return this.layers[this.currentLayer]
            },
            set: function(t) {
                t !== this.currentLayer && this.setLayer(t)
            }
        }), n.TilemapLayer = function(t, e, i, s, o) {
            s |= 0, o |= 0, n.Sprite.call(this, t, 0, 0), this.map = e, this.index = i, this.layer = e.layers[i], this.canvas = n.CanvasPool.create(this, s, o), this.context = this.canvas.getContext("2d"), this.setTexture(new PIXI.Texture(new PIXI.BaseTexture(this.canvas, null, this.game.resolution))), this.type = n.TILEMAPLAYER, this.physicsType = n.TILEMAPLAYER, this.renderSettings = {
                enableScrollDelta: !0,
                overdrawRatio: .2,
                copyCanvas: null
            }, this.debug = !1, this.exists = !0, this.debugSettings = {
                missingImageFill: "rgb(255,255,255)",
                debuggedTileOverfill: "rgba(0,255,0,0.4)",
                forceFullRedraw: !0,
                debugAlpha: .5,
                facingEdgeStroke: "rgba(0,255,0,1)",
                collidingTileOverfill: "rgba(0,255,0,0.2)"
            }, this.scrollFactorX = 1, this.scrollFactorY = 1, this.dirty = !0, this.rayStepRate = 4, this._wrap = !1, this._mc = {
                scrollX: 0,
                scrollY: 0,
                renderWidth: 0,
                renderHeight: 0,
                tileWidth: e.tileWidth,
                tileHeight: e.tileHeight,
                cw: e.tileWidth,
                ch: e.tileHeight,
                tilesets: []
            }, this._scrollX = 0, this._scrollY = 0, this._results = [], t.device.canvasBitBltShift || (this.renderSettings.copyCanvas = n.TilemapLayer.ensureSharedCopyCanvas()), this.fixedToCamera = !0
        }, n.TilemapLayer.prototype = Object.create(n.Sprite.prototype), n.TilemapLayer.prototype.constructor = n.TilemapLayer, n.TilemapLayer.prototype.preUpdateCore = n.Component.Core.preUpdate, n.TilemapLayer.sharedCopyCanvas = null, n.TilemapLayer.ensureSharedCopyCanvas = function() {
            return this.sharedCopyCanvas || (this.sharedCopyCanvas = n.CanvasPool.create(this, 2, 2)), this.sharedCopyCanvas
        }, n.TilemapLayer.prototype.preUpdate = function() {
            return this.preUpdateCore()
        }, n.TilemapLayer.prototype.postUpdate = function() {
            this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y), this._scrollX = this.game.camera.view.x * this.scrollFactorX / this.scale.x, this._scrollY = this.game.camera.view.y * this.scrollFactorY / this.scale.y
        }, n.TilemapLayer.prototype._renderCanvas = function(t) {
            this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y), this._scrollX = this.game.camera.view.x * this.scrollFactorX / this.scale.x, this._scrollY = this.game.camera.view.y * this.scrollFactorY / this.scale.y, this.render(), PIXI.Sprite.prototype._renderCanvas.call(this, t)
        }, n.TilemapLayer.prototype._renderWebGL = function(t) {
            this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y), this._scrollX = this.game.camera.view.x * this.scrollFactorX / this.scale.x, this._scrollY = this.game.camera.view.y * this.scrollFactorY / this.scale.y, this.render(), PIXI.Sprite.prototype._renderWebGL.call(this, t)
        }, n.TilemapLayer.prototype.destroy = function() {
            n.CanvasPool.remove(this), n.Component.Destroy.prototype.destroy.call(this)
        }, n.TilemapLayer.prototype.resize = function(t, e) {
            this.canvas.width = t, this.canvas.height = e, this.texture.frame.resize(t, e), this.texture.width = t, this.texture.height = e, this.texture.crop.width = t, this.texture.crop.height = e, this.texture.baseTexture.width = t, this.texture.baseTexture.height = e, this.texture.baseTexture.dirty(), this.texture.requiresUpdate = !0, this.texture._updateUvs(), this.dirty = !0
        }, n.TilemapLayer.prototype.resizeWorld = function() {
            this.game.world.setBounds(0, 0, this.layer.widthInPixels * this.scale.x, this.layer.heightInPixels * this.scale.y)
        }, n.TilemapLayer.prototype._fixX = function(t) {
            return 1 === this.scrollFactorX || 0 === this.scrollFactorX && 0 === this.position.x ? t : 0 === this.scrollFactorX && 0 !== this.position.x ? t - this.position.x : this._scrollX + (t - this._scrollX / this.scrollFactorX)
        }, n.TilemapLayer.prototype._unfixX = function(t) {
            return 1 === this.scrollFactorX ? t : this._scrollX / this.scrollFactorX + (t - this._scrollX)
        }, n.TilemapLayer.prototype._fixY = function(t) {
            return 1 === this.scrollFactorY || 0 === this.scrollFactorY && 0 === this.position.y ? t : 0 === this.scrollFactorY && 0 !== this.position.y ? t - this.position.y : this._scrollY + (t - this._scrollY / this.scrollFactorY)
        }, n.TilemapLayer.prototype._unfixY = function(t) {
            return 1 === this.scrollFactorY ? t : this._scrollY / this.scrollFactorY + (t - this._scrollY)
        }, n.TilemapLayer.prototype.getTileX = function(t) {
            return Math.floor(this._fixX(t) / this._mc.tileWidth)
        }, n.TilemapLayer.prototype.getTileY = function(t) {
            return Math.floor(this._fixY(t) / this._mc.tileHeight)
        }, n.TilemapLayer.prototype.getTileXY = function(t, e, i) {
            return i.x = this.getTileX(t), i.y = this.getTileY(e), i
        }, n.TilemapLayer.prototype.getRayCastTiles = function(t, e, i, s) {
            e || (e = this.rayStepRate), void 0 === i && (i = !1), void 0 === s && (s = !1);
            var n = this.getTiles(t.x, t.y, t.width, t.height, i, s);
            if (0 === n.length) return [];
            for (var o = t.coordinatesOnLine(e), r = [], a = 0; a < n.length; a++)
                for (var h = 0; h < o.length; h++) {
                    var l = n[a],
                        c = o[h];
                    if (l.containsPoint(c[0], c[1])) {
                        r.push(l);
                        break
                    }
                }
            return r
        }, n.TilemapLayer.prototype.getTiles = function(t, e, i, s, n, o) {
            void 0 === n && (n = !1), void 0 === o && (o = !1);
            var r = !(n || o);
            t = this._fixX(t), e = this._fixY(e);
            for (var a = Math.floor(t / (this._mc.cw * this.scale.x)), h = Math.floor(e / (this._mc.ch * this.scale.y)), l = Math.ceil((t + i) / (this._mc.cw * this.scale.x)) - a, c = Math.ceil((e + s) / (this._mc.ch * this.scale.y)) - h; this._results.length;) this._results.pop();
            for (var u = h; u < h + c; u++)
                for (var d = a; d < a + l; d++) {
                    var p = this.layer.data[u];
                    p && p[d] && (r || p[d].isInteresting(n, o)) && this._results.push(p[d])
                }
            return this._results.slice()
        }, n.TilemapLayer.prototype.resolveTileset = function(t) {
            var e = this._mc.tilesets;
            if (t < 2e3)
                for (; e.length < t;) e.push(void 0);
            var i = this.map.tiles[t] && this.map.tiles[t][2];
            if (null !== i) {
                var s = this.map.tilesets[i];
                if (s && s.containsTileIndex(t)) return e[t] = s
            }
            return e[t] = null
        }, n.TilemapLayer.prototype.resetTilesetCache = function() {
            for (var t = this._mc.tilesets; t.length;) t.pop()
        }, n.TilemapLayer.prototype.setScale = function(t, e) {
            t = t || 1, e = e || t;
            for (var i = 0; i < this.layer.data.length; i++)
                for (var s = this.layer.data[i], n = 0; n < s.length; n++) {
                    var o = s[n];
                    o.width = this.map.tileWidth * t, o.height = this.map.tileHeight * e, o.worldX = o.x * o.width, o.worldY = o.y * o.height
                }
            this.scale.setTo(t, e)
        }, n.TilemapLayer.prototype.shiftCanvas = function(t, e, i) {
            var s = t.canvas,
                n = s.width - Math.abs(e),
                o = s.height - Math.abs(i),
                r = 0,
                a = 0,
                h = e,
                l = i;
            e < 0 && (r = -e, h = 0), i < 0 && (a = -i, l = 0);
            var c = this.renderSettings.copyCanvas;
            if (c) {
                (c.width < n || c.height < o) && (c.width = n, c.height = o);
                var u = c.getContext("2d");
                u.clearRect(0, 0, n, o), u.drawImage(s, r, a, n, o, 0, 0, n, o), t.clearRect(h, l, n, o), t.drawImage(c, 0, 0, n, o, h, l, n, o)
            } else t.save(), t.globalCompositeOperation = "copy", t.drawImage(s, r, a, n, o, h, l, n, o), t.restore()
        }, n.TilemapLayer.prototype.renderRegion = function(t, e, i, s, n, o) {
            var r = this.context,
                a = this.layer.width,
                h = this.layer.height,
                l = this._mc.tileWidth,
                c = this._mc.tileHeight,
                u = this._mc.tilesets,
                d = NaN;
            this._wrap || (i <= n && (i = Math.max(0, i), n = Math.min(a - 1, n)), s <= o && (s = Math.max(0, s), o = Math.min(h - 1, o)));
            var p, f, m, g, y, v, b = i * l - t,
                _ = (i + (1 << 20) * a) % a;
            for (g = (s + (1 << 20) * h) % h, v = o - s, f = s * c - e; v >= 0; g++, v--, f += c) {
                g >= h && (g -= h);
                var w = this.layer.data[g];
                for (m = _, y = n - i, p = b; y >= 0; m++, y--, p += l) {
                    m >= a && (m -= a);
                    var x = w[m];
                    if (x && !(x.index < 0)) {
                        var P = x.index,
                            T = u[P];
                        void 0 === T && (T = this.resolveTileset(P)), x.alpha === d || this.debug || (r.globalAlpha = x.alpha, d = x.alpha), T ? x.rotation || x.flipped ? (r.save(), r.translate(p + x.centerX, f + x.centerY), r.rotate(x.rotation), x.flipped && r.scale(-1, 1), T.draw(r, -x.centerX, -x.centerY, P), r.restore()) : T.draw(r, p, f, P) : this.debugSettings.missingImageFill && (r.fillStyle = this.debugSettings.missingImageFill, r.fillRect(p, f, l, c)), x.debug && this.debugSettings.debuggedTileOverfill && (r.fillStyle = this.debugSettings.debuggedTileOverfill, r.fillRect(p, f, l, c))
                    }
                }
            }
        }, n.TilemapLayer.prototype.renderDeltaScroll = function(t, e) {
            var i = this._mc.scrollX,
                s = this._mc.scrollY,
                n = this.canvas.width,
                o = this.canvas.height,
                r = this._mc.tileWidth,
                a = this._mc.tileHeight,
                h = 0,
                l = -r,
                c = 0,
                u = -a;
            if (t < 0 ? (h = n + t, l = n - 1) : t > 0 && (l = t), e < 0 ? (c = o + e, u = o - 1) : e > 0 && (u = e), this.shiftCanvas(this.context, t, e), h = Math.floor((h + i) / r), l = Math.floor((l + i) / r), c = Math.floor((c + s) / a), u = Math.floor((u + s) / a), h <= l) {
                this.context.clearRect(h * r - i, 0, (l - h + 1) * r, o);
                var d = Math.floor((0 + s) / a),
                    p = Math.floor((o - 1 + s) / a);
                this.renderRegion(i, s, h, d, l, p)
            }
            if (c <= u) {
                this.context.clearRect(0, c * a - s, n, (u - c + 1) * a);
                var f = Math.floor((0 + i) / r),
                    m = Math.floor((n - 1 + i) / r);
                this.renderRegion(i, s, f, c, m, u)
            }
        }, n.TilemapLayer.prototype.renderFull = function() {
            var t = this._mc.scrollX,
                e = this._mc.scrollY,
                i = this.canvas.width,
                s = this.canvas.height,
                n = this._mc.tileWidth,
                o = this._mc.tileHeight,
                r = Math.floor(t / n),
                a = Math.floor((i - 1 + t) / n),
                h = Math.floor(e / o),
                l = Math.floor((s - 1 + e) / o);
            this.context.clearRect(0, 0, i, s), this.renderRegion(t, e, r, h, a, l)
        }, n.TilemapLayer.prototype.render = function() {
            var t = !1;
            if (this.visible) {
                (this.dirty || this.layer.dirty) && (this.layer.dirty = !1, t = !0);
                var e = this.canvas.width,
                    i = this.canvas.height,
                    s = 0 | this._scrollX,
                    n = 0 | this._scrollY,
                    o = this._mc,
                    r = o.scrollX - s,
                    a = o.scrollY - n;
                if (t || 0 !== r || 0 !== a || o.renderWidth !== e || o.renderHeight !== i) return this.context.save(), o.scrollX = s, o.scrollY = n, o.renderWidth === e && o.renderHeight === i || (o.renderWidth = e, o.renderHeight = i), this.debug && (this.context.globalAlpha = this.debugSettings.debugAlpha, this.debugSettings.forceFullRedraw && (t = !0)), !t && this.renderSettings.enableScrollDelta && Math.abs(r) + Math.abs(a) < Math.min(e, i) ? this.renderDeltaScroll(r, a) : this.renderFull(), this.debug && (this.context.globalAlpha = 1, this.renderDebug()), this.texture.baseTexture.dirty(), this.dirty = !1, this.context.restore(), !0
            }
        }, n.TilemapLayer.prototype.renderDebug = function() {
            var t, e, i, s, n, o, r = this._mc.scrollX,
                a = this._mc.scrollY,
                h = this.context,
                l = this.canvas.width,
                c = this.canvas.height,
                u = this.layer.width,
                d = this.layer.height,
                p = this._mc.tileWidth,
                f = this._mc.tileHeight,
                m = Math.floor(r / p),
                g = Math.floor((l - 1 + r) / p),
                y = Math.floor(a / f),
                v = Math.floor((c - 1 + a) / f),
                b = m * p - r,
                _ = y * f - a,
                w = (m + (1 << 20) * u) % u,
                x = (y + (1 << 20) * d) % d;
            for (h.strokeStyle = this.debugSettings.facingEdgeStroke, s = x, o = v - y, e = _; o >= 0; s++, o--, e += f) {
                s >= d && (s -= d);
                var P = this.layer.data[s];
                for (i = w, n = g - m, t = b; n >= 0; i++, n--, t += p) {
                    i >= u && (i -= u);
                    var T = P[i];
                    !T || T.index < 0 || !T.collides || (this.debugSettings.collidingTileOverfill && (h.fillStyle = this.debugSettings.collidingTileOverfill, h.fillRect(t, e, this._mc.cw, this._mc.ch)), this.debugSettings.facingEdgeStroke && (h.beginPath(), T.faceTop && (h.moveTo(t, e), h.lineTo(t + this._mc.cw, e)), T.faceBottom && (h.moveTo(t, e + this._mc.ch), h.lineTo(t + this._mc.cw, e + this._mc.ch)), T.faceLeft && (h.moveTo(t, e), h.lineTo(t, e + this._mc.ch)), T.faceRight && (h.moveTo(t + this._mc.cw, e), h.lineTo(t + this._mc.cw, e + this._mc.ch)), h.closePath(), h.stroke()))
                }
            }
        }, Object.defineProperty(n.TilemapLayer.prototype, "wrap", {
            get: function() {
                return this._wrap
            },
            set: function(t) {
                this._wrap = t, this.dirty = !0
            }
        }), Object.defineProperty(n.TilemapLayer.prototype, "scrollX", {
            get: function() {
                return this._scrollX
            },
            set: function(t) {
                this._scrollX = t
            }
        }), Object.defineProperty(n.TilemapLayer.prototype, "scrollY", {
            get: function() {
                return this._scrollY
            },
            set: function(t) {
                this._scrollY = t
            }
        }), Object.defineProperty(n.TilemapLayer.prototype, "collisionWidth", {
            get: function() {
                return this._mc.cw
            },
            set: function(t) {
                this._mc.cw = 0 | t, this.dirty = !0
            }
        }), Object.defineProperty(n.TilemapLayer.prototype, "collisionHeight", {
            get: function() {
                return this._mc.ch
            },
            set: function(t) {
                this._mc.ch = 0 | t, this.dirty = !0
            }
        }), n.TilemapParser = {
            INSERT_NULL: !1,
            parse: function(t, e, i, s, o, r) {
                if (void 0 === i && (i = 32), void 0 === s && (s = 32), void 0 === o && (o = 10), void 0 === r && (r = 10), void 0 === e) return this.getEmptyData();
                if (null === e) return this.getEmptyData(i, s, o, r);
                var a = t.cache.getTilemapData(e);
                if (a) {
                    if (a.format === n.Tilemap.CSV) return this.parseCSV(e, a.data, i, s);
                    if (!a.format || a.format === n.Tilemap.TILED_JSON) return this.parseTiledJSON(a.data)
                } else console.warn("Phaser.TilemapParser.parse - No map data found for key " + e)
            },
            parseCSV: function(t, e, i, s) {
                for (var o = this.getEmptyData(), r = [], a = (e = e.trim()).split("\n"), h = a.length, l = 0, c = 0; c < a.length; c++) {
                    r[c] = [];
                    for (var u = a[c].split(","), d = 0; d < u.length; d++) r[c][d] = new n.Tile(o.layers[0], parseInt(u[d], 10), d, c, i, s);
                    0 === l && (l = u.length)
                }
                return o.format = n.Tilemap.CSV, o.name = t, o.width = l, o.height = h, o.tileWidth = i, o.tileHeight = s, o.widthInPixels = l * i, o.heightInPixels = h * s, o.layers[0].width = l, o.layers[0].height = h, o.layers[0].widthInPixels = o.widthInPixels, o.layers[0].heightInPixels = o.heightInPixels, o.layers[0].data = r, o
            },
            getEmptyData: function(t, e, i, s) {
                return {
                    width: null != i ? i : 0,
                    height: null != s ? s : 0,
                    tileWidth: null != t ? t : 0,
                    tileHeight: null != e ? e : 0,
                    orientation: "orthogonal",
                    version: "1",
                    properties: {},
                    widthInPixels: 0,
                    heightInPixels: 0,
                    layers: [{
                        name: "layer",
                        x: 0,
                        y: 0,
                        width: 0,
                        height: 0,
                        widthInPixels: 0,
                        heightInPixels: 0,
                        alpha: 1,
                        visible: !0,
                        properties: {},
                        indexes: [],
                        callbacks: [],
                        bodies: [],
                        data: []
                    }],
                    images: [],
                    objects: {},
                    collision: {},
                    tilesets: [],
                    tiles: []
                }
            },
            parseTiledJSON: function(t) {
                function e(t, e) {
                    var i = {};
                    for (var s in e) {
                        var n = e[s];
                        void 0 !== t[n] && (i[n] = t[n])
                    }
                    return i
                }
                if ("orthogonal" !== t.orientation) return console.warn("TilemapParser.parseTiledJSON - Only orthogonal map types are supported in this version of Phaser"), null;
                for (var i = {
                        width: t.width,
                        height: t.height,
                        tileWidth: t.tilewidth,
                        tileHeight: t.tileheight,
                        orientation: t.orientation,
                        format: n.Tilemap.TILED_JSON,
                        version: t.version,
                        properties: t.properties,
                        widthInPixels: t.width * t.tilewidth,
                        heightInPixels: t.height * t.tileheight
                    }, s = [], o = 0; o < t.layers.length; o++)
                    if ("tilelayer" === t.layers[o].type) {
                        var r = t.layers[o];
                        if (!r.compression && r.encoding && "base64" === r.encoding) {
                            for (var a = window.atob(r.data), h = a.length, l = new Array(h), c = 0; c < h; c += 4) l[c / 4] = (a.charCodeAt(c) | a.charCodeAt(c + 1) << 8 | a.charCodeAt(c + 2) << 16 | a.charCodeAt(c + 3) << 24) >>> 0;
                            r.data = l, delete r.encoding
                        } else if (r.compression) {
                            console.warn("TilemapParser.parseTiledJSON - Layer compression is unsupported, skipping layer '" + r.name + "'");
                            continue
                        }
                        var u = {
                            name: r.name,
                            x: r.x,
                            y: r.y,
                            width: r.width,
                            height: r.height,
                            widthInPixels: r.width * t.tilewidth,
                            heightInPixels: r.height * t.tileheight,
                            alpha: r.opacity,
                            visible: r.visible,
                            properties: {},
                            indexes: [],
                            callbacks: [],
                            bodies: []
                        };
                        r.properties && (u.properties = r.properties);
                        var d, p, f, m = 0,
                            g = [],
                            y = [],
                            v = 0;
                        for (h = r.data.length; v < h; v++) {
                            if (d = 0, p = !1, f = 0, (E = r.data[v]) > 536870912) switch (E > 2147483648 && (E -= 2147483648, f += 4), E > 1073741824 && (E -= 1073741824, f += 2), E > 536870912 && (E -= 536870912, f += 1), f) {
                                case 5:
                                    d = Math.PI / 2;
                                    break;
                                case 6:
                                    d = Math.PI;
                                    break;
                                case 3:
                                    d = 3 * Math.PI / 2;
                                    break;
                                case 4:
                                    d = 0, p = !0;
                                    break;
                                case 7:
                                    d = Math.PI / 2, p = !0;
                                    break;
                                case 2:
                                    d = Math.PI, p = !0;
                                    break;
                                case 1:
                                    d = 3 * Math.PI / 2, p = !0
                            }
                            if (E > 0)(N = new n.Tile(u, E, m, y.length, t.tilewidth, t.tileheight)).rotation = d, N.flipped = p, 0 !== f && (N.flippedVal = f), g.push(N);
                            else n.TilemapParser.INSERT_NULL ? g.push(null) : g.push(new n.Tile(u, -1, m, y.length, t.tilewidth, t.tileheight));
                            ++m === r.width && (y.push(g), m = 0, g = [])
                        }
                        u.data = y, s.push(u)
                    } i.layers = s;
                var b = [];
                for (o = 0; o < t.layers.length; o++)
                    if ("imagelayer" === t.layers[o].type) {
                        var _ = t.layers[o],
                            w = {
                                name: _.name,
                                image: _.image,
                                x: _.x,
                                y: _.y,
                                alpha: _.opacity,
                                visible: _.visible,
                                properties: {}
                            };
                        _.properties && (w.properties = _.properties), b.push(w)
                    } i.images = b;
                var x = [],
                    P = [],
                    T = null;
                for (o = 0; o < t.tilesets.length; o++) {
                    if ((j = t.tilesets[o]).image) {
                        var C = new n.Tileset(j.name, j.firstgid, j.tilewidth, j.tileheight, j.margin, j.spacing, j.properties);
                        j.tileproperties && (C.tileProperties = j.tileproperties), C.updateTileData(j.imagewidth, j.imageheight), x.push(C)
                    } else {
                        var S = new n.ImageCollection(j.name, j.firstgid, j.tilewidth, j.tileheight, j.margin, j.spacing, j.properties);
                        for (var A in j.tiles) {
                            w = j.tiles[A].image;
                            var E = j.firstgid + parseInt(A, 10);
                            S.addImage(E, w)
                        }
                        P.push(S)
                    }
                    T && (T.lastgid = j.firstgid - 1), T = j
                }
                i.tilesets = x, i.imagecollections = P;
                var k = {},
                    M = {};
                for (o = 0; o < t.layers.length; o++)
                    if ("objectgroup" === t.layers[o].type) {
                        var O = t.layers[o];
                        k[O.name] = [], M[O.name] = [];
                        var R = 0;
                        for (h = O.objects.length; R < h; R++)
                            if (O.objects[R].gid) {
                                var B = {
                                    gid: O.objects[R].gid,
                                    name: O.objects[R].name,
                                    type: O.objects[R].hasOwnProperty("type") ? O.objects[R].type : "",
                                    x: O.objects[R].x,
                                    y: O.objects[R].y,
                                    visible: O.objects[R].visible,
                                    properties: O.objects[R].properties
                                };
                                O.objects[R].rotation && (B.rotation = O.objects[R].rotation), k[O.name].push(B)
                            } else if (O.objects[R].polyline) {
                            B = {
                                name: O.objects[R].name,
                                type: O.objects[R].type,
                                x: O.objects[R].x,
                                y: O.objects[R].y,
                                width: O.objects[R].width,
                                height: O.objects[R].height,
                                visible: O.objects[R].visible,
                                properties: O.objects[R].properties
                            };
                            O.objects[R].rotation && (B.rotation = O.objects[R].rotation), B.polyline = [];
                            for (var I = 0; I < O.objects[R].polyline.length; I++) B.polyline.push([O.objects[R].polyline[I].x, O.objects[R].polyline[I].y]);
                            M[O.name].push(B), k[O.name].push(B)
                        } else if (O.objects[R].polygon) {
                            (B = e(O.objects[R], ["name", "type", "x", "y", "visible", "rotation", "properties"])).polygon = [];
                            for (I = 0; I < O.objects[R].polygon.length; I++) B.polygon.push([O.objects[R].polygon[I].x, O.objects[R].polygon[I].y]);
                            k[O.name].push(B)
                        } else if (O.objects[R].ellipse) {
                            B = e(O.objects[R], ["name", "type", "ellipse", "x", "y", "width", "height", "visible", "rotation", "properties"]);
                            k[O.name].push(B)
                        } else {
                            (B = e(O.objects[R], ["name", "type", "x", "y", "width", "height", "visible", "rotation", "properties"])).rectangle = !0, k[O.name].push(B)
                        }
                    } i.objects = k, i.collision = M, i.tiles = [];
                for (o = 0; o < i.tilesets.length; o++) {
                    m = (j = i.tilesets[o]).tileMargin;
                    var L = j.tileMargin,
                        D = 0,
                        F = 0,
                        U = 0;
                    for (v = j.firstgid; v < j.firstgid + j.total && (i.tiles[v] = [m, L, o], m += j.tileWidth + j.tileSpacing, ++D !== j.total) && (++F !== j.columns || (m = j.tileMargin, L += j.tileHeight + j.tileSpacing, F = 0, ++U !== j.rows)); v++);
                }
                var N, G, j;
                for (o = 0; o < i.layers.length; o++) {
                    u = i.layers[o], j = null;
                    for (c = 0; c < u.data.length; c++) {
                        g = u.data[c];
                        for (var W = 0; W < g.length; W++) null === (N = g[W]) || N.index < 0 || (G = i.tiles[N.index][2], (j = i.tilesets[G]).tileProperties && j.tileProperties[N.index - j.firstgid] && (N.properties = n.Utils.mixin(j.tileProperties[N.index - j.firstgid], N.properties)))
                    }
                }
                return i
            }
        }, n.Tileset = function(t, e, i, s, n, o, r) {
            (void 0 === i || i <= 0) && (i = 32), (void 0 === s || s <= 0) && (s = 32), void 0 === n && (n = 0), void 0 === o && (o = 0), this.name = t, this.firstgid = 0 | e, this.tileWidth = 0 | i, this.tileHeight = 0 | s, this.tileMargin = 0 | n, this.tileSpacing = 0 | o, this.properties = r || {}, this.image = null, this.rows = 0, this.columns = 0, this.total = 0, this.drawCoords = []
        }, n.Tileset.prototype = {
            draw: function(t, e, i, s) {
                var n = s - this.firstgid << 1;
                n >= 0 && n + 1 < this.drawCoords.length && t.drawImage(this.image, this.drawCoords[n], this.drawCoords[n + 1], this.tileWidth, this.tileHeight, e, i, this.tileWidth, this.tileHeight)
            },
            containsTileIndex: function(t) {
                return t >= this.firstgid && t < this.firstgid + this.total
            },
            setImage: function(t) {
                this.image = t, this.updateTileData(t.width, t.height)
            },
            setSpacing: function(t, e) {
                this.tileMargin = 0 | t, this.tileSpacing = 0 | e, this.image && this.updateTileData(this.image.width, this.image.height)
            },
            updateTileData: function(t, e) {
                var i = (e - 2 * this.tileMargin + this.tileSpacing) / (this.tileHeight + this.tileSpacing),
                    s = (t - 2 * this.tileMargin + this.tileSpacing) / (this.tileWidth + this.tileSpacing);
                i % 1 == 0 && s % 1 == 0 || console.warn("Phaser.Tileset - " + this.name + " image tile area is not an even multiple of tile size"), i = Math.floor(i), s = Math.floor(s), (this.rows && this.rows !== i || this.columns && this.columns !== s) && console.warn("Phaser.Tileset - actual and expected number of tile rows and columns differ"), this.rows = i, this.columns = s, this.total = i * s, this.drawCoords.length = 0;
                for (var n = this.tileMargin, o = this.tileMargin, r = 0; r < this.rows; r++) {
                    for (var a = 0; a < this.columns; a++) this.drawCoords.push(n), this.drawCoords.push(o), n += this.tileWidth + this.tileSpacing;
                    n = this.tileMargin, o += this.tileHeight + this.tileSpacing
                }
            }
        }, n.Tileset.prototype.constructor = n.Tileset, n.Particle = function(t, e, i, s, o) {
            n.Sprite.call(this, t, e, i, s, o), this.autoScale = !1, this.scaleData = null, this._s = 0, this.autoAlpha = !1, this.alphaData = null, this._a = 0
        }, n.Particle.prototype = Object.create(n.Sprite.prototype), n.Particle.prototype.constructor = n.Particle, n.Particle.prototype.update = function() {
            this.autoScale && (this._s--, this._s ? this.scale.set(this.scaleData[this._s].x, this.scaleData[this._s].y) : this.autoScale = !1), this.autoAlpha && (this._a--, this._a ? this.alpha = this.alphaData[this._a].v : this.autoAlpha = !1)
        }, n.Particle.prototype.onEmit = function() {}, n.Particle.prototype.setAlphaData = function(t) {
            this.alphaData = t, this._a = t.length - 1, this.alpha = this.alphaData[this._a].v, this.autoAlpha = !0
        }, n.Particle.prototype.setScaleData = function(t) {
            this.scaleData = t, this._s = t.length - 1, this.scale.set(this.scaleData[this._s].x, this.scaleData[this._s].y), this.autoScale = !0
        }, n.Particle.prototype.reset = function(t, e, i) {
            return n.Component.Reset.prototype.reset.call(this, t, e, i), this.alpha = 1, this.scale.set(1), this.autoScale = !1, this.autoAlpha = !1, this
        }, n.Particles = function(t) {
            this.game = t, this.emitters = {}, this.ID = 0
        }, n.Particles.prototype = {
            add: function(t) {
                return this.emitters[t.id] = t, t
            },
            remove: function(t) {
                delete this.emitters[t.id]
            },
            update: function() {
                for (var t in this.emitters) this.emitters[t].exists && this.emitters[t].update()
            }
        }, n.Particles.prototype.constructor = n.Particles, n.Particles.Arcade = {}, n.Particles.Arcade.Emitter = function(t, e, i, s) {
            this.maxParticles = s || 50, n.Group.call(this, t), this._id = this.game.particles.ID++, this.name = "emitter" + this.id, this.type = n.EMITTER, this.physicsType = n.GROUP, this.area = new n.Rectangle(e, i, 1, 1), this.minParticleSpeed = new n.Point(-100, -100), this.maxParticleSpeed = new n.Point(100, 100), this.minParticleScale = 1, this.maxParticleScale = 1, this.scaleData = null, this.minRotation = -360, this.maxRotation = 360, this.minParticleAlpha = 1, this.maxParticleAlpha = 1, this.alphaData = null, this.gravity = new n.Point(0, 100), this.particleClass = n.Particle, this.particleDrag = new n.Point, this.angularDrag = 0, this.frequency = 100, this.lifespan = 2e3, this.bounce = new n.Point, this.on = !1, this.particleAnchor = new n.Point(.5, .5), this.blendMode = n.blendModes.NORMAL, this.emitX = e, this.emitY = i, this.autoScale = !1, this.autoAlpha = !1, this.particleBringToTop = !1, this.particleSendToBack = !1, this._minParticleScale = new n.Point(1, 1), this._maxParticleScale = new n.Point(1, 1), this._quantity = 0, this._timer = 0, this._counter = 0, this._flowQuantity = 0, this._flowTotal = 0, this._explode = !0, this._frames = null
        }, n.Particles.Arcade.Emitter.prototype = Object.create(n.Group.prototype), n.Particles.Arcade.Emitter.prototype.constructor = n.Particles.Arcade.Emitter, n.Particles.Arcade.Emitter.prototype.update = function() {
            if (this.on && this.game.time.time >= this._timer)
                if (this._timer = this.game.time.time + this.frequency * this.game.time.slowMotion, 0 !== this._flowTotal)
                    if (this._flowQuantity > 0) {
                        for (var t = 0; t < this._flowQuantity; t++)
                            if (this.emitParticle() && (this._counter++, -1 !== this._flowTotal && this._counter >= this._flowTotal)) {
                                this.on = !1;
                                break
                            }
                    } else this.emitParticle() && (this._counter++, -1 !== this._flowTotal && this._counter >= this._flowTotal && (this.on = !1));
            else this.emitParticle() && (this._counter++, this._quantity > 0 && this._counter >= this._quantity && (this.on = !1));
            for (t = this.children.length; t--;) this.children[t].exists && this.children[t].update()
        }, n.Particles.Arcade.Emitter.prototype.makeParticles = function(t, e, i, s, n) {
            void 0 === e && (e = 0), void 0 === i && (i = this.maxParticles), void 0 === s && (s = !1), void 0 === n && (n = !1);
            var o, r = 0,
                a = t,
                h = e;
            for (this._frames = e, i > this.maxParticles && (this.maxParticles = i); r < i;) Array.isArray(t) && (a = this.game.rnd.pick(t)), Array.isArray(e) && (h = this.game.rnd.pick(e)), o = new this.particleClass(this.game, 0, 0, a, h), this.game.physics.arcade.enable(o, !1), s ? (o.body.checkCollision.any = !0, o.body.checkCollision.none = !1) : o.body.checkCollision.none = !0, o.body.collideWorldBounds = n, o.body.skipQuadTree = !0, o.exists = !1, o.visible = !1, o.anchor.copyFrom(this.particleAnchor), this.add(o), r++;
            return this
        }, n.Particles.Arcade.Emitter.prototype.kill = function() {
            return this.on = !1, this.alive = !1, this.exists = !1, this
        }, n.Particles.Arcade.Emitter.prototype.revive = function() {
            return this.alive = !0, this.exists = !0, this
        }, n.Particles.Arcade.Emitter.prototype.explode = function(t, e) {
            return this._flowTotal = 0, this.start(!0, t, 0, e, !1), this
        }, n.Particles.Arcade.Emitter.prototype.flow = function(t, e, i, s, n) {
            return null != e || (e = 250), void 0 !== i && 0 !== i || (i = 1), void 0 === s && (s = -1), void 0 === n && (n = !0), i > this.maxParticles && (i = this.maxParticles), this._counter = 0, this._flowQuantity = i, this._flowTotal = s, n ? (this.start(!0, t, e, i), this._counter += i, this.on = !0, this._timer = this.game.time.time + e * this.game.time.slowMotion) : this.start(!1, t, e, i), this
        }, n.Particles.Arcade.Emitter.prototype.start = function(t, e, i, s, n) {
            if (void 0 === t && (t = !0), void 0 === e && (e = 0), null != i || (i = 250), void 0 === s && (s = 0), void 0 === n && (n = !1), s > this.maxParticles && (s = this.maxParticles), this.revive(), this.visible = !0, this.lifespan = e, this.frequency = i, t || n)
                for (var o = 0; o < s; o++) this.emitParticle();
            else this.on = !0, this._quantity = s, this._counter = 0, this._timer = this.game.time.time + i * this.game.time.slowMotion;
            return this
        }, n.Particles.Arcade.Emitter.prototype.emitParticle = function(t, e, i, s) {
            void 0 === t && (t = null), void 0 === e && (e = null);
            var n = this.getFirstExists(!1);
            if (null === n) return !1;
            var o = this.game.rnd;
            void 0 !== i && void 0 !== s ? n.loadTexture(i, s) : void 0 !== i && n.loadTexture(i);
            var r = this.emitX,
                a = this.emitY;
            null !== t ? r = t : this.width > 1 && (r = o.between(this.left, this.right)), null !== e ? a = e : this.height > 1 && (a = o.between(this.top, this.bottom)), n.reset(r, a), n.angle = 0, n.lifespan = this.lifespan, this.particleBringToTop ? this.bringToTop(n) : this.particleSendToBack && this.sendToBack(n), this.autoScale ? n.setScaleData(this.scaleData) : 1 !== this.minParticleScale || 1 !== this.maxParticleScale ? n.scale.set(o.realInRange(this.minParticleScale, this.maxParticleScale)) : this._minParticleScale.x === this._maxParticleScale.x && this._minParticleScale.y === this._maxParticleScale.y || n.scale.set(o.realInRange(this._minParticleScale.x, this._maxParticleScale.x), o.realInRange(this._minParticleScale.y, this._maxParticleScale.y)), void 0 === s && (Array.isArray(this._frames) ? n.frame = this.game.rnd.pick(this._frames) : n.frame = this._frames), this.autoAlpha ? n.setAlphaData(this.alphaData) : n.alpha = o.realInRange(this.minParticleAlpha, this.maxParticleAlpha), n.blendMode = this.blendMode;
            var h = n.body;
            return h.updateBounds(), h.bounce.copyFrom(this.bounce), h.drag.copyFrom(this.particleDrag), h.velocity.x = o.between(this.minParticleSpeed.x, this.maxParticleSpeed.x), h.velocity.y = o.between(this.minParticleSpeed.y, this.maxParticleSpeed.y), h.angularVelocity = o.between(this.minRotation, this.maxRotation), h.gravity = this.gravity, h.angularDrag = this.angularDrag, n.onEmit(), !0
        }, n.Particles.Arcade.Emitter.prototype.destroy = function() {
            this.game.particles.remove(this), n.Group.prototype.destroy.call(this, !0, !1)
        }, n.Particles.Arcade.Emitter.prototype.setSize = function(t, e) {
            return this.area.width = t, this.area.height = e, this
        }, n.Particles.Arcade.Emitter.prototype.setXSpeed = function(t, e) {
            return t = t || 0, e = e || 0, this.minParticleSpeed.x = t, this.maxParticleSpeed.x = e, this
        }, n.Particles.Arcade.Emitter.prototype.setYSpeed = function(t, e) {
            return t = t || 0, e = e || 0, this.minParticleSpeed.y = t, this.maxParticleSpeed.y = e, this
        }, n.Particles.Arcade.Emitter.prototype.setRotation = function(t, e) {
            return t = t || 0, e = e || 0, this.minRotation = t, this.maxRotation = e, this
        }, n.Particles.Arcade.Emitter.prototype.setAlpha = function(t, e, i, s, o) {
            if (void 0 === t && (t = 1), void 0 === e && (e = 1), void 0 === i && (i = 0), void 0 === s && (s = n.Easing.Linear.None), void 0 === o && (o = !1), this.minParticleAlpha = t, this.maxParticleAlpha = e, this.autoAlpha = !1, i > 0 && t !== e) {
                var r = {
                        v: t
                    },
                    a = this.game.make.tween(r).to({
                        v: e
                    }, i, s);
                a.yoyo(o), this.alphaData = a.generateData(60), this.alphaData.reverse(), this.autoAlpha = !0
            }
            return this
        }, n.Particles.Arcade.Emitter.prototype.setScale = function(t, e, i, s, o, r, a) {
            if (void 0 === t && (t = 1), void 0 === e && (e = 1), void 0 === i && (i = 1), void 0 === s && (s = 1), void 0 === o && (o = 0), void 0 === r && (r = n.Easing.Linear.None), void 0 === a && (a = !1), this.minParticleScale = 1, this.maxParticleScale = 1, this._minParticleScale.set(t, i), this._maxParticleScale.set(e, s), this.autoScale = !1, o > 0 && (t !== e || i !== s)) {
                var h = {
                        x: t,
                        y: i
                    },
                    l = this.game.make.tween(h).to({
                        x: e,
                        y: s
                    }, o, r);
                l.yoyo(a), this.scaleData = l.generateData(60), this.scaleData.reverse(), this.autoScale = !0
            }
            return this
        }, n.Particles.Arcade.Emitter.prototype.at = function(t) {
            return t.center ? (this.emitX = t.center.x, this.emitY = t.center.y) : (this.emitX = t.world.x + t.anchor.x * t.width, this.emitY = t.world.y + t.anchor.y * t.height), this
        }, Object.defineProperty(n.Particles.Arcade.Emitter.prototype, "id", {
            get: function() {
                return this._id
            }
        }), Object.defineProperty(n.Particles.Arcade.Emitter.prototype, "width", {
            get: function() {
                return this.area.width
            },
            set: function(t) {
                this.area.width = t
            }
        }), Object.defineProperty(n.Particles.Arcade.Emitter.prototype, "height", {
            get: function() {
                return this.area.height
            },
            set: function(t) {
                this.area.height = t
            }
        }), Object.defineProperty(n.Particles.Arcade.Emitter.prototype, "x", {
            get: function() {
                return this.emitX
            },
            set: function(t) {
                this.emitX = t
            }
        }), Object.defineProperty(n.Particles.Arcade.Emitter.prototype, "y", {
            get: function() {
                return this.emitY
            },
            set: function(t) {
                this.emitY = t
            }
        }), Object.defineProperty(n.Particles.Arcade.Emitter.prototype, "left", {
            get: function() {
                return Math.floor(this.x - this.area.width / 2)
            }
        }), Object.defineProperty(n.Particles.Arcade.Emitter.prototype, "right", {
            get: function() {
                return Math.floor(this.x + this.area.width / 2)
            }
        }), Object.defineProperty(n.Particles.Arcade.Emitter.prototype, "top", {
            get: function() {
                return Math.floor(this.y - this.area.height / 2)
            }
        }), Object.defineProperty(n.Particles.Arcade.Emitter.prototype, "bottom", {
            get: function() {
                return Math.floor(this.y + this.area.height / 2)
            }
        }), n.Weapon = function(t, e) {
            n.Plugin.call(this, t, e), this.bullets = null, this.autoExpandBulletsGroup = !1, this.autofire = !1, this.shots = 0, this.fireLimit = 0, this.fireRate = 100, this.fireRateVariance = 0, this.fireFrom = new n.Rectangle(0, 0, 1, 1), this.fireAngle = n.ANGLE_UP, this.bulletInheritSpriteSpeed = !1, this.bulletAnimation = "", this.bulletFrameRandom = !1, this.bulletFrameCycle = !1, this.bulletWorldWrap = !1, this.bulletWorldWrapPadding = 0, this.bulletAngleOffset = 0, this.bulletAngleVariance = 0, this.bulletSpeed = 200, this.bulletSpeedVariance = 0, this.bulletLifespan = 0, this.bulletKillDistance = 0, this.bulletGravity = new n.Point(0, 0), this.bulletRotateToVelocity = !1, this.bulletKey = "", this.bulletFrame = "", this._bulletClass = n.Bullet, this._bulletCollideWorldBounds = !1, this._bulletKillType = n.Weapon.KILL_WORLD_BOUNDS, this._data = {
                customBody: !1,
                width: 0,
                height: 0,
                offsetX: 0,
                offsetY: 0
            }, this.bounds = new n.Rectangle, this.bulletBounds = t.world.bounds, this.bulletFrames = [], this.bulletFrameIndex = 0, this.anims = {}, this.onFire = new n.Signal, this.onKill = new n.Signal, this.onFireLimit = new n.Signal, this.trackedSprite = null, this.trackedPointer = null, this.multiFire = !1, this._hasFired = !1, this.trackRotation = !1, this.trackOffset = new n.Point, this._nextFire = 0, this._tempNextFire = 0, this._rotatedPoint = new n.Point
        }, n.Weapon.prototype = Object.create(n.Plugin.prototype), n.Weapon.prototype.constructor = n.Weapon, n.Weapon.KILL_NEVER = 0, n.Weapon.KILL_LIFESPAN = 1, n.Weapon.KILL_DISTANCE = 2, n.Weapon.KILL_WEAPON_BOUNDS = 3, n.Weapon.KILL_CAMERA_BOUNDS = 4, n.Weapon.KILL_WORLD_BOUNDS = 5, n.Weapon.KILL_STATIC_BOUNDS = 6, n.Weapon.prototype.createBullets = function(t, e, i, s) {
            return void 0 === t && (t = 1), void 0 === s && (s = this.game.world), this.bullets || (this.bullets = this.game.add.physicsGroup(n.Physics.ARCADE, s), this.bullets.classType = this._bulletClass), 0 !== t && (-1 === t && (this.autoExpandBulletsGroup = !0, t = 1), this.bullets.createMultiple(t, e, i), this.bullets.setAll("data.bulletManager", this), this.bulletKey = e, this.bulletFrame = i), this
        }, n.Weapon.prototype.forEach = function(t, e) {
            return this.bullets.forEachExists(t, e, arguments), this
        }, n.Weapon.prototype.pauseAll = function() {
            return this.bullets.setAll("body.enable", !1), this
        }, n.Weapon.prototype.resumeAll = function() {
            return this.bullets.setAll("body.enable", !0), this
        }, n.Weapon.prototype.killAll = function() {
            return this.bullets.callAllExists("kill", !0), this.bullets.setAll("body.enable", !0), this
        }, n.Weapon.prototype.resetShots = function(t) {
            return this.shots = 0, void 0 !== t && (this.fireLimit = t), this
        }, n.Weapon.prototype.destroy = function() {
            this.parent.remove(this, !1), this.bullets.destroy(), this.game = null, this.parent = null, this.active = !1, this.visible = !1
        }, n.Weapon.prototype.update = function() {
            this._bulletKillType === n.Weapon.KILL_WEAPON_BOUNDS && (this.trackedSprite ? (this.trackedSprite.updateTransform(), this.bounds.centerOn(this.trackedSprite.worldPosition.x, this.trackedSprite.worldPosition.y)) : this.trackedPointer && this.bounds.centerOn(this.trackedPointer.worldX, this.trackedPointer.worldY)), this.autofire && this.fire()
        }, n.Weapon.prototype.postRender = function() {
            this.multiFire && this._hasFired && (this._hasFired = !1, this._nextFire = this._tempNextFire)
        }, n.Weapon.prototype.trackSprite = function(t, e, i, s) {
            return void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === s && (s = !1), this.trackedPointer = null, this.trackedSprite = t, this.trackRotation = s, this.trackOffset.set(e, i), this
        }, n.Weapon.prototype.trackPointer = function(t, e, i) {
            return void 0 === t && (t = this.game.input.activePointer), void 0 === e && (e = 0), void 0 === i && (i = 0), this.trackedPointer = t, this.trackedSprite = null, this.trackRotation = !1, this.trackOffset.set(e, i), this
        }, n.Weapon.prototype.fireMany = function(t, e) {
            this.multiFire = !0;
            var i = [],
                s = this;
            return e || this.trackedSprite || this.trackedPointer ? t.forEach(function(t) {
                i.push(s.fire(e, null, null, t.x, t.y))
            }) : t.forEach(function(t) {
                i.push(s.fire(t))
            }), i
        }, n.Weapon.prototype.fireOffset = function(t, e) {
            return void 0 === t && (t = 0), void 0 === e && (e = 0), this.fire(null, null, null, t, e)
        }, n.Weapon.prototype.fire = function(t, e, i, s, o) {
            if (void 0 === e && (e = null), void 0 === i && (i = null), this.game.time.now < this._nextFire || this.fireLimit > 0 && this.shots === this.fireLimit) return null;
            var r = this.bulletSpeed;
            0 !== this.bulletSpeedVariance && (r += n.Math.between(-this.bulletSpeedVariance, this.bulletSpeedVariance)), t ? this.fireFrom.width > 1 ? this.fireFrom.centerOn(t.x, t.y) : (this.fireFrom.x = t.x, this.fireFrom.y = t.y) : this.trackedSprite ? (this.trackRotation ? (this._rotatedPoint.set(this.trackedSprite.world.x + this.trackOffset.x, this.trackedSprite.world.y + this.trackOffset.y), this._rotatedPoint.rotate(this.trackedSprite.world.x, this.trackedSprite.world.y, this.trackedSprite.rotation), this.fireFrom.width > 1 ? this.fireFrom.centerOn(this._rotatedPoint.x, this._rotatedPoint.y) : (this.fireFrom.x = this._rotatedPoint.x, this.fireFrom.y = this._rotatedPoint.y)) : this.fireFrom.width > 1 ? this.fireFrom.centerOn(this.trackedSprite.world.x + this.trackOffset.x, this.trackedSprite.world.y + this.trackOffset.y) : (this.fireFrom.x = this.trackedSprite.world.x + this.trackOffset.x, this.fireFrom.y = this.trackedSprite.world.y + this.trackOffset.y), this.bulletInheritSpriteSpeed && (r += this.trackedSprite.body.speed)) : this.trackedPointer && (this.fireFrom.width > 1 ? this.fireFrom.centerOn(this.trackedPointer.world.x + this.trackOffset.x, this.trackedPointer.world.y + this.trackOffset.y) : (this.fireFrom.x = this.trackedPointer.world.x + this.trackOffset.x, this.fireFrom.y = this.trackedPointer.world.y + this.trackOffset.y)), void 0 !== s && (this.fireFrom.x += s), void 0 !== o && (this.fireFrom.y += o);
            var a = this.fireFrom.width > 1 ? this.fireFrom.randomX : this.fireFrom.x,
                h = this.fireFrom.height > 1 ? this.fireFrom.randomY : this.fireFrom.y,
                l = this.trackRotation ? this.trackedSprite.angle : this.fireAngle;
            null !== e && null !== i && (l = this.game.math.radToDeg(Math.atan2(i - h, e - a))), 0 !== this.bulletAngleVariance && (l += n.Math.between(-this.bulletAngleVariance, this.bulletAngleVariance));
            var c = 0,
                u = 0;
            0 === l || 180 === l ? c = Math.cos(this.game.math.degToRad(l)) * r : 90 === l || 270 === l ? u = Math.sin(this.game.math.degToRad(l)) * r : (c = Math.cos(this.game.math.degToRad(l)) * r, u = Math.sin(this.game.math.degToRad(l)) * r);
            var d = null;
            if (this.autoExpandBulletsGroup ? (d = this.bullets.getFirstExists(!1, !0, a, h, this.bulletKey, this.bulletFrame)).data.bulletManager = this : d = this.bullets.getFirstExists(!1), d) {
                if (d.reset(a, h), d.data.fromX = a, d.data.fromY = h, d.data.killType = this.bulletKillType, d.data.killDistance = this.bulletKillDistance, d.data.rotateToVelocity = this.bulletRotateToVelocity, this.bulletKillType === n.Weapon.KILL_LIFESPAN && (d.lifespan = this.bulletLifespan), d.angle = l + this.bulletAngleOffset, "" !== this.bulletAnimation) {
                    if (null === d.animations.getAnimation(this.bulletAnimation)) {
                        var p = this.anims[this.bulletAnimation];
                        d.animations.add(p.name, p.frames, p.frameRate, p.loop, p.useNumericIndex)
                    }
                    d.animations.play(this.bulletAnimation)
                } else this.bulletFrameCycle ? (d.frame = this.bulletFrames[this.bulletFrameIndex], ++this.bulletFrameIndex >= this.bulletFrames.length && (this.bulletFrameIndex = 0)) : this.bulletFrameRandom && (d.frame = this.bulletFrames[Math.floor(Math.random() * this.bulletFrames.length)]);
                d.data.bodyDirty && (this._data.customBody && d.body.setSize(this._data.width, this._data.height, this._data.offsetX, this._data.offsetY), d.body.collideWorldBounds = this.bulletCollideWorldBounds, d.data.bodyDirty = !1), d.body.velocity.set(c, u), d.body.gravity.set(this.bulletGravity.x, this.bulletGravity.y);
                var f = 0;
                if (0 !== this.bulletSpeedVariance) {
                    var m = this.fireRate;
                    (m += n.Math.between(-this.fireRateVariance, this.fireRateVariance)) < 0 && (m = 0), f = this.game.time.now + m
                } else f = this.game.time.now + this.fireRate;
                this.multiFire ? this._hasFired || (this._hasFired = !0, this._tempNextFire = f, this.shots++) : (this._nextFire = f, this.shots++), this.onFire.dispatch(d, this, r), this.fireLimit > 0 && this.shots === this.fireLimit && this.onFireLimit.dispatch(this, this.fireLimit)
            }
            return d
        }, n.Weapon.prototype.fireAtPointer = function(t) {
            return void 0 === t && (t = this.game.input.activePointer), this.fire(null, t.worldX, t.worldY)
        }, n.Weapon.prototype.fireAtSprite = function(t) {
            return this.fire(null, t.world.x, t.world.y)
        }, n.Weapon.prototype.fireAtXY = function(t, e) {
            return this.fire(null, t, e)
        }, n.Weapon.prototype.setBulletBodyOffset = function(t, e, i, s) {
            return void 0 === i && (i = 0), void 0 === s && (s = 0), this._data.customBody = !0, this._data.width = t, this._data.height = e, this._data.offsetX = i, this._data.offsetY = s, this.bullets.callAll("body.setSize", "body", t, e, i, s), this.bullets.setAll("data.bodyDirty", !1), this
        }, n.Weapon.prototype.setBulletFrames = function(t, e, i, s) {
            return void 0 === i && (i = !0), void 0 === s && (s = !1), this.bulletFrames = n.ArrayUtils.numberArray(t, e), this.bulletFrameIndex = 0, this.bulletFrameCycle = i, this.bulletFrameRandom = s, this
        }, n.Weapon.prototype.addBulletAnimation = function(t, e, i, s, n) {
            return this.anims[t] = {
                name: t,
                frames: e,
                frameRate: i,
                loop: s,
                useNumericIndex: n
            }, this.bullets.callAll("animations.add", "animations", t, e, i, s, n), this.bulletAnimation = t, this
        }, n.Weapon.prototype.debug = function(t, e, i) {
            void 0 === t && (t = 16), void 0 === e && (e = 32), void 0 === i && (i = !1), this.game.debug.text("Weapon Plugin", t, e), this.game.debug.text("Bullets Alive: " + this.bullets.total + " - Total: " + this.bullets.length, t, e + 24), i && this.bullets.forEachExists(this.game.debug.body, this.game.debug, "rgba(255, 0, 255, 0.8)")
        }, Object.defineProperty(n.Weapon.prototype, "bulletClass", {
            get: function() {
                return this._bulletClass
            },
            set: function(t) {
                this._bulletClass = t, this.bullets && (this.bullets.classType = this._bulletClass)
            }
        }), Object.defineProperty(n.Weapon.prototype, "bulletKillType", {
            get: function() {
                return this._bulletKillType
            },
            set: function(t) {
                switch (t) {
                    case n.Weapon.KILL_STATIC_BOUNDS:
                    case n.Weapon.KILL_WEAPON_BOUNDS:
                        this.bulletBounds = this.bounds;
                        break;
                    case n.Weapon.KILL_CAMERA_BOUNDS:
                        this.bulletBounds = this.game.camera.view;
                        break;
                    case n.Weapon.KILL_WORLD_BOUNDS:
                        this.bulletBounds = this.game.world.bounds
                }
                this._bulletKillType = t
            }
        }), Object.defineProperty(n.Weapon.prototype, "bulletCollideWorldBounds", {
            get: function() {
                return this._bulletCollideWorldBounds
            },
            set: function(t) {
                this._bulletCollideWorldBounds = t, this.bullets.setAll("body.collideWorldBounds", t), this.bullets.setAll("data.bodyDirty", !1)
            }
        }), Object.defineProperty(n.Weapon.prototype, "x", {
            get: function() {
                return this.fireFrom.x
            },
            set: function(t) {
                this.fireFrom.x = t
            }
        }), Object.defineProperty(n.Weapon.prototype, "y", {
            get: function() {
                return this.fireFrom.y
            },
            set: function(t) {
                this.fireFrom.y = t
            }
        }), n.Bullet = function(t, e, i, s, o) {
            n.Sprite.call(this, t, e, i, s, o), this.anchor.set(.5), this.data = {
                bulletManager: null,
                fromX: 0,
                fromY: 0,
                bodyDirty: !0,
                rotateToVelocity: !1,
                killType: 0,
                killDistance: 0
            }
        }, n.Bullet.prototype = Object.create(n.Sprite.prototype), n.Bullet.prototype.constructor = n.Bullet, n.Bullet.prototype.kill = function() {
            return this.alive = !1, this.exists = !1, this.visible = !1, this.data.bulletManager.onKill.dispatch(this), this
        }, n.Bullet.prototype.update = function() {
            this.exists && (this.data.killType > n.Weapon.KILL_LIFESPAN && (this.data.killType === n.Weapon.KILL_DISTANCE ? this.game.physics.arcade.distanceToXY(this, this.data.fromX, this.data.fromY, !0) > this.data.killDistance && this.kill() : this.data.bulletManager.bulletBounds.intersects(this) || this.kill()), this.data.rotateToVelocity && (this.rotation = Math.atan2(this.body.velocity.y, this.body.velocity.x)), this.data.bulletManager.bulletWorldWrap && this.game.world.wrap(this, this.data.bulletManager.bulletWorldWrapPadding))
        }, n.Video = function(t, e, i) {
            if (void 0 === e && (e = null), void 0 === i && (i = null), this.game = t, this.key = e, this.width = 0, this.height = 0, this.type = n.VIDEO, this.disableTextureUpload = !1, this.touchLocked = !1, this.onPlay = new n.Signal, this.onChangeSource = new n.Signal, this.onComplete = new n.Signal, this.onAccess = new n.Signal, this.onError = new n.Signal, this.onTimeout = new n.Signal, this.timeout = 15e3, this._timeOutID = null, this.video = null, this.videoStream = null, this.isStreaming = !1, this.retryLimit = 20, this.retry = 0, this.retryInterval = 500, this._retryID = null, this._codeMuted = !1, this._muted = !1, this._codePaused = !1, this._paused = !1, this._pending = !1, this._pendingChangeSource = !1, this._autoplay = !1, this._endCallback = null, this._playCallback = null, e && this.game.cache.checkVideoKey(e)) {
                var s = this.game.cache.getVideo(e);
                s.isBlob ? this.createVideoFromBlob(s.data) : this.video = s.data, this.width = this.video.videoWidth, this.height = this.video.videoHeight
            } else i && this.createVideoFromURL(i, !1);
            this.video && !i ? (this.baseTexture = new PIXI.BaseTexture(this.video, null, this.game.resolution), this.baseTexture.forceLoaded(this.width, this.height)) : (this.baseTexture = new PIXI.BaseTexture(n.Cache.DEFAULT.baseTexture.source, null, this.game.resolution), this.baseTexture.forceLoaded(this.width, this.height)), this.texture = new PIXI.Texture(this.baseTexture), this.textureFrame = new n.Frame(0, 0, 0, this.width, this.height, "video"), this.texture.setFrame(this.textureFrame), this.texture.valid = !1, null !== e && this.video && (this.texture.valid = this.video.canplay), this.snapshot = null, n.BitmapData && (this.snapshot = new n.BitmapData(this.game, "", this.width, this.height)), !this.game.device.cocoonJS && (this.game.device.iOS || this.game.device.android) || window.PhaserGlobal && window.PhaserGlobal.fakeiOSTouchLock ? this.setTouchLock() : s && (s.locked = !1)
        }, n.Video.prototype = {
            connectToMediaStream: function(t, e) {
                return t && e && (this.video = t, this.videoStream = e, this.isStreaming = !0, this.baseTexture.source = this.video, this.updateTexture(null, this.video.videoWidth, this.video.videoHeight), this.onAccess.dispatch(this)), this
            },
            startMediaStream: function(t, e, i) {
                if (void 0 === t && (t = !1), void 0 === e && (e = null), void 0 === i && (i = null), !this.game.device.getUserMedia) return this.onError.dispatch(this, "No getUserMedia"), !1;
                null !== this.videoStream && (this.videoStream.active ? this.videoStream.active = !1 : this.videoStream.stop()), this.removeVideoElement(), this.video = document.createElement("video"), this.video.setAttribute("autoplay", "autoplay"), null !== e && (this.video.width = e), null !== i && (this.video.height = i), this._timeOutID = window.setTimeout(this.getUserMediaTimeout.bind(this), this.timeout);
                try {
                    navigator.getUserMedia({
                        audio: t,
                        video: !0
                    }, this.getUserMediaSuccess.bind(this), this.getUserMediaError.bind(this))
                } catch (t) {
                    this.getUserMediaError(t)
                }
                return this
            },
            getUserMediaTimeout: function() {
                clearTimeout(this._timeOutID), this.onTimeout.dispatch(this)
            },
            getUserMediaError: function(t) {
                clearTimeout(this._timeOutID), this.onError.dispatch(this, t)
            },
            getUserMediaSuccess: function(t) {
                clearTimeout(this._timeOutID), this.videoStream = t, void 0 !== this.video.mozSrcObject ? this.video.mozSrcObject = t : this.video.src = window.URL && window.URL.createObjectURL(t) || t;
                var e = this;
                this.video.onloadeddata = function() {
                    var t = 10;
                    ! function i() {
                        if (t > 0)
                            if (e.video.videoWidth > 0) {
                                var s = e.video.videoWidth,
                                    n = e.video.videoHeight;
                                isNaN(e.video.videoHeight) && (n = s / (4 / 3)), e.video.play(), e.isStreaming = !0, e.baseTexture.source = e.video, e.updateTexture(null, s, n), e.onAccess.dispatch(e)
                            } else window.setTimeout(i, 500);
                        else console.warn("Unable to connect to video stream. Webcam error?");
                        t--
                    }()
                }
            },
            createVideoFromBlob: function(t) {
                var e = this;
                return this.video = document.createElement("video"), this.video.controls = !1, this.video.setAttribute("autoplay", "autoplay"), this.video.addEventListener("loadeddata", function(t) {
                    e.updateTexture(t)
                }, !0), this.video.src = window.URL.createObjectURL(t), this.video.canplay = !0, this
            },
            createVideoFromURL: function(t, e) {
                return void 0 === e && (e = !1), this.texture && (this.texture.valid = !1), this.video = document.createElement("video"), this.video.controls = !1, e && this.video.setAttribute("autoplay", "autoplay"), this.video.src = t, this.video.canplay = !0, this.video.load(), this.retry = this.retryLimit, this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval), this.key = t, this
            },
            updateTexture: function(t, e, i) {
                var s = !1;
                null != e || (e = this.video.videoWidth, s = !0), null != i || (i = this.video.videoHeight), this.width = e, this.height = i, this.baseTexture.source !== this.video && (this.baseTexture.source = this.video), this.baseTexture.forceLoaded(e, i), this.texture.frame.resize(e, i), this.texture.width = e, this.texture.height = i, this.texture.valid = !0, this.snapshot && this.snapshot.resize(e, i), s && null !== this.key && (this.onChangeSource.dispatch(this, e, i), this._autoplay && (this.video.play(), this.onPlay.dispatch(this, this.loop, this.playbackRate)))
            },
            complete: function() {
                this.onComplete.dispatch(this)
            },
            play: function(t, e) {
                return this._pendingChangeSource ? this : (void 0 === t && (t = !1), void 0 === e && (e = 1), this.game.sound.onMute && (this.game.sound.onMute.add(this.setMute, this), this.game.sound.onUnMute.add(this.unsetMute, this), this.game.sound.mute && this.setMute()), this.game.onPause.add(this.setPause, this), this.game.onResume.add(this.setResume, this), this._endCallback = this.complete.bind(this), this.video.addEventListener("ended", this._endCallback, !0), this.video.addEventListener("webkitendfullscreen", this._endCallback, !0), this.video.loop = t ? "loop" : "", this.video.playbackRate = e, this.touchLocked ? this._pending = !0 : (this._pending = !1, null !== this.key && (4 !== this.video.readyState ? (this.retry = this.retryLimit, this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval)) : (this._playCallback = this.playHandler.bind(this), this.video.addEventListener("playing", this._playCallback, !0))), this.video.play(), this.onPlay.dispatch(this, t, e)), this)
            },
            playHandler: function() {
                this.video.removeEventListener("playing", this._playCallback, !0), this.updateTexture()
            },
            stop: function() {
                return this.game.sound.onMute && (this.game.sound.onMute.remove(this.setMute, this), this.game.sound.onUnMute.remove(this.unsetMute, this)), this.game.onPause.remove(this.setPause, this), this.game.onResume.remove(this.setResume, this), this.isStreaming ? (this.video.mozSrcObject ? (this.video.mozSrcObject.stop(), this.video.src = null) : (this.video.src = "", this.videoStream.active ? this.videoStream.active = !1 : this.videoStream.getTracks ? this.videoStream.getTracks().forEach(function(t) {
                    t.stop()
                }) : this.videoStream.stop()), this.videoStream = null, this.isStreaming = !1) : (this.video.removeEventListener("ended", this._endCallback, !0), this.video.removeEventListener("webkitendfullscreen", this._endCallback, !0), this.video.removeEventListener("playing", this._playCallback, !0), this.touchLocked ? this._pending = !1 : this.video.pause()), this
            },
            add: function(t) {
                if (Array.isArray(t))
                    for (var e = 0; e < t.length; e++) t[e].loadTexture && t[e].loadTexture(this);
                else t.loadTexture(this);
                return this
            },
            addToWorld: function(t, e, i, s, n, o) {
                n = n || 1, o = o || 1;
                var r = this.game.add.image(t, e, this);
                return r.anchor.set(i, s), r.scale.set(n, o), r
            },
            render: function() {
                !this.disableTextureUpload && this.playing && this.baseTexture.dirty()
            },
            setMute: function() {
                this._muted || (this._muted = !0, this.video.muted = !0)
            },
            unsetMute: function() {
                this._muted && !this._codeMuted && (this._muted = !1, this.video.muted = !1)
            },
            setPause: function() {
                this._paused || this.touchLocked || (this._paused = !0, this.video.pause())
            },
            setResume: function() {
                !this._paused || this._codePaused || this.touchLocked || (this._paused = !1, this.video.ended || this.video.play())
            },
            changeSource: function(t, e) {
                return void 0 === e && (e = !0), this.texture.valid = !1, this.video.pause(), this._pendingChangeSource = !0, this.retry = this.retryLimit, this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval), this.video.src = t, this.video.load(), this._autoplay = e, e || (this.paused = !0), this
            },
            checkVideoProgress: function() {
                4 === this.video.readyState ? (this._pendingChangeSource = !1, this.updateTexture()) : (this.retry--, this.retry > 0 ? this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval) : console.warn("Phaser.Video: Unable to start downloading video in time", this.isStreaming))
            },
            setTouchLock: function() {
                this.game.input.touch.addTouchLockCallback(this.unlock, this), this.touchLocked = !0
            },
            unlock: function() {
                if (this.touchLocked = !1, this.video.play(), this.onPlay.dispatch(this, this.loop, this.playbackRate), this.key) {
                    var t = this.game.cache.getVideo(this.key);
                    t && !t.isBlob && (t.locked = !1)
                }
                return !0
            },
            grab: function(t, e, i) {
                return void 0 === t && (t = !1), void 0 === e && (e = 1), void 0 === i && (i = null), null === this.snapshot ? void console.warn("Video.grab cannot run because Phaser.BitmapData is unavailable") : (t && this.snapshot.cls(), this.snapshot.copy(this.video, 0, 0, this.width, this.height, 0, 0, this.width, this.height, 0, 0, 0, 1, 1, e, i), this.snapshot)
            },
            removeVideoElement: function() {
                if (this.video) {
                    for (this.video.parentNode && this.video.parentNode.removeChild(this.video); this.video.hasChildNodes();) this.video.removeChild(this.video.firstChild);
                    this.video.removeAttribute("autoplay"), this.video.removeAttribute("src"), this.video = null
                }
            },
            destroy: function() {
                this.stop(), this.removeVideoElement(), this.touchLocked && this.game.input.touch.removeTouchLockCallback(this.unlock, this), this._retryID && window.clearTimeout(this._retryID)
            }
        }, Object.defineProperty(n.Video.prototype, "currentTime", {
            get: function() {
                return this.video ? this.video.currentTime : 0
            },
            set: function(t) {
                this.video.currentTime = t
            }
        }), Object.defineProperty(n.Video.prototype, "duration", {
            get: function() {
                return this.video ? this.video.duration : 0
            }
        }), Object.defineProperty(n.Video.prototype, "progress", {
            get: function() {
                return this.video ? this.video.currentTime / this.video.duration : 0
            }
        }), Object.defineProperty(n.Video.prototype, "mute", {
            get: function() {
                return this._muted
            },
            set: function(t) {
                if (t = t || null) {
                    if (this._muted) return;
                    this._codeMuted = !0, this.setMute()
                } else {
                    if (!this._muted) return;
                    this._codeMuted = !1, this.unsetMute()
                }
            }
        }), Object.defineProperty(n.Video.prototype, "paused", {
            get: function() {
                return this._paused
            },
            set: function(t) {
                if (t = t || null, !this.touchLocked)
                    if (t) {
                        if (this._paused) return;
                        this._codePaused = !0, this.setPause()
                    } else {
                        if (!this._paused) return;
                        this._codePaused = !1, this.setResume()
                    }
            }
        }), Object.defineProperty(n.Video.prototype, "volume", {
            get: function() {
                return this.video ? this.video.volume : 1
            },
            set: function(t) {
                t < 0 ? t = 0 : t > 1 && (t = 1), this.video && (this.video.volume = t)
            }
        }), Object.defineProperty(n.Video.prototype, "playbackRate", {
            get: function() {
                return this.video ? this.video.playbackRate : 1
            },
            set: function(t) {
                this.video && (this.video.playbackRate = t)
            }
        }), Object.defineProperty(n.Video.prototype, "loop", {
            get: function() {
                return !!this.video && this.video.loop
            },
            set: function(t) {
                t && this.video ? this.video.loop = "loop" : this.video && (this.video.loop = "")
            }
        }), Object.defineProperty(n.Video.prototype, "playing", {
            get: function() {
                return !(!this.video || this.video.paused && this.video.ended)
            }
        }), n.Video.prototype.constructor = n.Video, void 0 === PIXI.blendModes && (PIXI.blendModes = n.blendModes), void 0 === PIXI.scaleModes && (PIXI.scaleModes = n.scaleModes), void 0 === PIXI.Texture.emptyTexture && (PIXI.Texture.emptyTexture = new PIXI.Texture(new PIXI.BaseTexture)), void 0 === PIXI.DisplayObject._tempMatrix && (PIXI.DisplayObject._tempMatrix = new PIXI.Matrix), PIXI.TextureSilentFail = !0, void 0 !== e ? (void 0 !== t && t.exports && (e = t.exports = n), e.Phaser = n) : "undefined" != typeof define && define.amd ? define("Phaser", s.Phaser = n) : s.Phaser = n, n
    }).call(this)
}, function(t, e) {
    (function() {
        function i(t, e, i, s) {
            var n = t.createTexture();
            return t.bindTexture(t.TEXTURE_2D, n), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_S, t.CLAMP_TO_EDGE), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_T, t.CLAMP_TO_EDGE), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MAG_FILTER, s === o.scaleModes.LINEAR ? t.LINEAR : t.NEAREST), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MIN_FILTER, s === o.scaleModes.LINEAR ? t.LINEAR : t.NEAREST), t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, e, i, 0, t.RGBA, t.UNSIGNED_BYTE, null), n
        }

        function s(t, e, s, n, o) {
            var a, h, l = t.createFramebuffer(),
                c = t.createRenderbuffer();
            return t.activeTexture(t.TEXTURE0 + o), t.bindFramebuffer(t.FRAMEBUFFER, l), t.bindRenderbuffer(t.RENDERBUFFER, c), t.framebufferRenderbuffer(t.FRAMEBUFFER, t.DEPTH_STENCIL_ATTACHMENT, t.RENDERBUFFER, this.renderBuffer), a = i(t, e, s, n), t.framebufferTexture2D(t.FRAMEBUFFER, t.COLOR_ATTACHMENT0, t.TEXTURE_2D, a, 0), (h = t.checkFramebufferStatus(t.FRAMEBUFFER)) !== t.FRAMEBUFFER_COMPLETE && console.error("Incomplete GL framebuffer. ", r[h]), l.width = e, l.height = s, l.targetTexture = a, l.renderBuffer = c, l
        }
        var n = this,
            o = o || {};
        o.DisplayObject = function() {
            this.position = new o.Point(0, 0), this.scale = new o.Point(1, 1), this.pivot = new o.Point(0, 0), this.rotation = 0, this.alpha = 1, this.visible = !0, this.hitArea = null, this.renderable = !1, this.parent = null, this.worldAlpha = 1, this.worldTransform = new o.Matrix, this.worldPosition = new o.Point(0, 0), this.worldScale = new o.Point(1, 1), this.worldRotation = 0, this.filterArea = null, this._sr = 0, this._cr = 1, this._bounds = new o.Rectangle(0, 0, 0, 0), this._currentBounds = null, this._mask = null, this._cacheAsBitmap = !1, this._cacheIsDirty = !1
        }, o.DisplayObject.prototype.constructor = o.DisplayObject, o.DisplayObject.prototype = {
            destroy: function() {
                if (this.children) {
                    for (var t = this.children.length; t--;) this.children[t].destroy();
                    this.children = []
                }
                this.hitArea = null, this.parent = null, this.worldTransform = null, this.filterArea = null, this.renderable = !1, this._bounds = null, this._currentBounds = null, this._mask = null, this._destroyCachedSprite()
            },
            updateTransform: function(t) {
                if (!t && !this.parent && !this.game) return this;
                var e = this.parent;
                t ? e = t : this.parent || (e = this.game.world);
                var i, s, n, o, r, a, h = e.worldTransform,
                    l = this.worldTransform;
                return this.rotation % Phaser.Math.PI2 ? (this.rotation !== this.rotationCache && (this.rotationCache = this.rotation, this._sr = Math.sin(this.rotation), this._cr = Math.cos(this.rotation)), i = this._cr * this.scale.x, s = this._sr * this.scale.x, n = -this._sr * this.scale.y, o = this._cr * this.scale.y, r = this.position.x, a = this.position.y, (this.pivot.x || this.pivot.y) && (r -= this.pivot.x * i + this.pivot.y * n, a -= this.pivot.x * s + this.pivot.y * o), l.a = i * h.a + s * h.c, l.b = i * h.b + s * h.d, l.c = n * h.a + o * h.c, l.d = n * h.b + o * h.d, l.tx = r * h.a + a * h.c + h.tx, l.ty = r * h.b + a * h.d + h.ty) : (i = this.scale.x, o = this.scale.y, r = this.position.x - this.pivot.x * i, a = this.position.y - this.pivot.y * o, l.a = i * h.a, l.b = i * h.b, l.c = o * h.c, l.d = o * h.d, l.tx = r * h.a + a * h.c + h.tx, l.ty = r * h.b + a * h.d + h.ty), this.worldAlpha = this.alpha * e.worldAlpha, this.worldPosition.set(l.tx, l.ty), this.worldScale.set(this.scale.x * Math.sqrt(l.a * l.a + l.c * l.c), this.scale.y * Math.sqrt(l.b * l.b + l.d * l.d)), this.worldRotation = Math.atan2(-l.c, l.d), this._currentBounds = null, this.transformCallback && this.transformCallback.call(this.transformCallbackContext, l, h), this
            },
            preUpdate: function() {},
            generateTexture: function(t, e, i) {
                var s = this.getLocalBounds(),
                    n = new Phaser.RenderTexture(this.game, 0 | s.width, 0 | s.height, i, e, t);
                return o.DisplayObject._tempMatrix.tx = -s.x, o.DisplayObject._tempMatrix.ty = -s.y, n.render(this, o.DisplayObject._tempMatrix), n
            },
            updateCache: function() {
                return this._generateCachedSprite(), this
            },
            toGlobal: function(t) {
                return this.updateTransform(), this.worldTransform.apply(t)
            },
            toLocal: function(t, e) {
                return e && (t = e.toGlobal(t)), this.updateTransform(), this.worldTransform.applyInverse(t)
            },
            _renderCachedSprite: function(t) {
                this._cachedSprite.worldAlpha = this.worldAlpha, t.gl ? o.Sprite.prototype._renderWebGL.call(this._cachedSprite, t) : o.Sprite.prototype._renderCanvas.call(this._cachedSprite, t)
            },
            _generateCachedSprite: function() {
                this._cacheAsBitmap = !1;
                var t = this.getLocalBounds();
                if (t.width = Math.max(1, Math.ceil(t.width)), t.height = Math.max(1, Math.ceil(t.height)), this.updateTransform(), this._cachedSprite) this._cachedSprite.texture.resize(t.width, t.height);
                else {
                    var e = 0;
                    this.texture && this.texture.baseTexture && o._enableMultiTextureToggle && (e = this.texture.baseTexture.textureIndex);
                    var i = new Phaser.RenderTexture(t.width, t.height, null, null, null, e);
                    this._cachedSprite = new o.Sprite(i), this._cachedSprite.worldTransform = this.worldTransform
                }
                var s = this._filters;
                this._filters = null, this._cachedSprite.filters = s, o.DisplayObject._tempMatrix.tx = -t.x, o.DisplayObject._tempMatrix.ty = -t.y, this._cachedSprite.texture.render(this, o.DisplayObject._tempMatrix, !0), this._cachedSprite.anchor.x = -t.x / t.width, this._cachedSprite.anchor.y = -t.y / t.height, this._filters = s, this._cacheAsBitmap = !0
            },
            _destroyCachedSprite: function() {
                this._cachedSprite && (this._cachedSprite.texture.destroy(!0), this._cachedSprite = null)
            }
        }, o.DisplayObject.prototype.displayObjectUpdateTransform = o.DisplayObject.prototype.updateTransform, Object.defineProperties(o.DisplayObject.prototype, {
            x: {
                get: function() {
                    return this.position.x
                },
                set: function(t) {
                    this.position.x = t
                }
            },
            y: {
                get: function() {
                    return this.position.y
                },
                set: function(t) {
                    this.position.y = t
                }
            },
            worldVisible: {
                get: function() {
                    if (this.visible) {
                        var t = this.parent;
                        if (!t) return this.visible;
                        do {
                            if (!t.visible) return !1;
                            t = t.parent
                        } while (t);
                        return !0
                    }
                    return !1
                }
            },
            mask: {
                get: function() {
                    return this._mask
                },
                set: function(t) {
                    this._mask && (this._mask.isMask = !1), this._mask = t, t && (this._mask.isMask = !0)
                }
            },
            filters: {
                get: function() {
                    return this._filters
                },
                set: function(t) {
                    if (Array.isArray(t)) {
                        for (var e = [], i = 0; i < t.length; i++)
                            for (var s = t[i].passes, n = 0; n < s.length; n++) e.push(s[n]);
                        this._filterBlock = {
                            target: this,
                            filterPasses: e
                        }
                    }
                    this._filters = t, this.blendMode && this.blendMode === o.blendModes.MULTIPLY && (this.blendMode = o.blendModes.NORMAL)
                }
            },
            cacheAsBitmap: {
                get: function() {
                    return this._cacheAsBitmap
                },
                set: function(t) {
                    this._cacheAsBitmap !== t && (t ? this._generateCachedSprite() : this._destroyCachedSprite(), this._cacheAsBitmap = t)
                }
            }
        }), o.DisplayObjectContainer = function() {
            o.DisplayObject.call(this), this.children = [], this.ignoreChildInput = !1
        }, o.DisplayObjectContainer.prototype = Object.create(o.DisplayObject.prototype), o.DisplayObjectContainer.prototype.constructor = o.DisplayObjectContainer, o.DisplayObjectContainer.prototype.addChild = function(t) {
            return this.addChildAt(t, this.children.length)
        }, o.DisplayObjectContainer.prototype.addChildAt = function(t, e) {
            if (e >= 0 && e <= this.children.length) return t.parent && t.parent.removeChild(t), t.parent = this, this.children.splice(e, 0, t), t;
            throw new Error(t + "addChildAt: The index " + e + " supplied is out of bounds " + this.children.length)
        }, o.DisplayObjectContainer.prototype.swapChildren = function(t, e) {
            if (t !== e) {
                var i = this.getChildIndex(t),
                    s = this.getChildIndex(e);
                if (i < 0 || s < 0) throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");
                this.children[i] = e, this.children[s] = t
            }
        }, o.DisplayObjectContainer.prototype.getChildIndex = function(t) {
            var e = this.children.indexOf(t);
            if (-1 === e) throw new Error("The supplied DisplayObject must be a child of the caller");
            return e
        }, o.DisplayObjectContainer.prototype.setChildIndex = function(t, e) {
            if (e < 0 || e >= this.children.length) throw new Error("The supplied index is out of bounds");
            var i = this.getChildIndex(t);
            this.children.splice(i, 1), this.children.splice(e, 0, t)
        }, o.DisplayObjectContainer.prototype.getChildAt = function(t) {
            if (t < 0 || t >= this.children.length) throw new Error("getChildAt: Supplied index " + t + " does not exist in the child list, or the supplied DisplayObject must be a child of the caller");
            return this.children[t]
        }, o.DisplayObjectContainer.prototype.removeChild = function(t) {
            var e = this.children.indexOf(t);
            if (-1 !== e) return this.removeChildAt(e)
        }, o.DisplayObjectContainer.prototype.removeChildAt = function(t) {
            var e = this.getChildAt(t);
            return e && (e.parent = void 0, this.children.splice(t, 1)), e
        }, o.DisplayObjectContainer.prototype.removeChildren = function(t, e) {
            void 0 === t && (t = 0), void 0 === e && (e = this.children.length);
            var i = e - t;
            if (i > 0 && i <= e) {
                for (var s = this.children.splice(t, i), n = 0; n < s.length; n++) s[n].parent = void 0;
                return s
            }
            if (0 === i && 0 === this.children.length) return [];
            throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")
        }, o.DisplayObjectContainer.prototype.updateTransform = function() {
            if (this.visible && (this.displayObjectUpdateTransform(), !this._cacheAsBitmap))
                for (var t = 0; t < this.children.length; t++) this.children[t].updateTransform()
        }, o.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform = o.DisplayObjectContainer.prototype.updateTransform, o.DisplayObjectContainer.prototype.getBounds = function(t) {
            var e, i = t && t instanceof o.DisplayObject,
                s = !0;
            if (i ? s = t instanceof o.DisplayObjectContainer && t.contains(this) : t = this, i) {
                var n = t.worldTransform;
                for (t.worldTransform = o.identityMatrix, e = 0; e < t.children.length; e++) t.children[e].updateTransform()
            }
            var r, a, h, l = 1 / 0,
                c = 1 / 0,
                u = -1 / 0,
                d = -1 / 0,
                p = !1;
            for (e = 0; e < this.children.length; e++) this.children[e].visible && (p = !0, l = l < (r = this.children[e].getBounds()).x ? l : r.x, c = c < r.y ? c : r.y, u = u > (a = r.width + r.x) ? u : a, d = d > (h = r.height + r.y) ? d : h);
            var f = this._bounds;
            if (!p) {
                var m = (f = new o.Rectangle).x,
                    g = f.width + f.x,
                    y = f.y,
                    v = f.height + f.y,
                    b = this.worldTransform,
                    _ = b.a,
                    w = b.b,
                    x = b.c,
                    P = b.d,
                    T = b.tx,
                    C = b.ty,
                    S = _ * g + x * v + T,
                    A = P * v + w * g + C,
                    E = _ * m + x * v + T,
                    k = P * v + w * m + C,
                    M = _ * m + x * y + T,
                    O = P * y + w * m + C,
                    R = _ * g + x * y + T,
                    B = P * y + w * g + C;
                l = R < (l = M < (l = E < (l = S) ? E : l) ? M : l) ? R : l, c = B < (c = O < (c = k < (c = A) ? k : c) ? O : c) ? B : c, u = R > (u = M > (u = E > (u = S) ? E : u) ? M : u) ? R : u, d = B > (d = O > (d = k > (d = A) ? k : d) ? O : d) ? B : d
            }
            if (f.x = l, f.y = c, f.width = u - l, f.height = d - c, i)
                for (t.worldTransform = n, e = 0; e < t.children.length; e++) t.children[e].updateTransform();
            if (!s) {
                var I = t.getBounds();
                f.x -= I.x, f.y -= I.y
            }
            return f
        }, o.DisplayObjectContainer.prototype.getLocalBounds = function() {
            return this.getBounds(this)
        }, o.DisplayObjectContainer.prototype.contains = function(t) {
            return !!t && (t === this || this.contains(t.parent))
        }, o.DisplayObjectContainer.prototype._renderWebGL = function(t) {
            if (this.visible && !(this.alpha <= 0)) {
                if (this._cacheAsBitmap) return void this._renderCachedSprite(t);
                var e;
                if (this._mask || this._filters) {
                    for (this._filters && (t.spriteBatch.flush(), t.filterManager.pushFilter(this._filterBlock)), this._mask && (t.spriteBatch.stop(), t.maskManager.pushMask(this.mask, t), t.spriteBatch.start()), e = 0; e < this.children.length; e++) this.children[e]._renderWebGL(t);
                    t.spriteBatch.stop(), this._mask && t.maskManager.popMask(this._mask, t), this._filters && t.filterManager.popFilter(), t.spriteBatch.start()
                } else
                    for (e = 0; e < this.children.length; e++) this.children[e]._renderWebGL(t)
            }
        }, o.DisplayObjectContainer.prototype._renderCanvas = function(t) {
            if (!1 !== this.visible && 0 !== this.alpha) {
                if (this._cacheAsBitmap) return void this._renderCachedSprite(t);
                this._mask && t.maskManager.pushMask(this._mask, t);
                for (var e = 0; e < this.children.length; e++) this.children[e]._renderCanvas(t);
                this._mask && t.maskManager.popMask(t)
            }
        }, Object.defineProperty(o.DisplayObjectContainer.prototype, "width", {
            get: function() {
                return this.getLocalBounds().width * this.scale.x
            },
            set: function(t) {
                var e = this.getLocalBounds().width;
                this.scale.x = 0 !== e ? t / e : 1, this._width = t
            }
        }), Object.defineProperty(o.DisplayObjectContainer.prototype, "height", {
            get: function() {
                return this.getLocalBounds().height * this.scale.y
            },
            set: function(t) {
                var e = this.getLocalBounds().height;
                this.scale.y = 0 !== e ? t / e : 1, this._height = t
            }
        }), o.Sprite = function(t) {
            o.DisplayObjectContainer.call(this), this.anchor = new o.Point, this.texture = t || o.Texture.emptyTexture, this._width = 0, this._height = 0, this.tint = 16777215, this.cachedTint = -1, this.tintedTexture = null, this.blendMode = o.blendModes.NORMAL, this.shader = null, this.exists = !0, this.texture.baseTexture.hasLoaded && this.onTextureUpdate(), this.renderable = !0
        }, o.Sprite.prototype = Object.create(o.DisplayObjectContainer.prototype), o.Sprite.prototype.constructor = o.Sprite, Object.defineProperty(o.Sprite.prototype, "width", {
            get: function() {
                return this.scale.x * this.texture.frame.width
            },
            set: function(t) {
                this.scale.x = t / this.texture.frame.width, this._width = t
            }
        }), Object.defineProperty(o.Sprite.prototype, "height", {
            get: function() {
                return this.scale.y * this.texture.frame.height
            },
            set: function(t) {
                this.scale.y = t / this.texture.frame.height, this._height = t
            }
        }), o.Sprite.prototype.setTexture = function(t, e) {
            void 0 !== e && this.texture.baseTexture.destroy(), this.texture.baseTexture.skipRender = !1, this.texture = t, this.texture.valid = !0, this.cachedTint = -1
        }, o.Sprite.prototype.onTextureUpdate = function() {
            this._width && (this.scale.x = this._width / this.texture.frame.width), this._height && (this.scale.y = this._height / this.texture.frame.height)
        }, o.Sprite.prototype.getBounds = function(t) {
            var e = this.texture.frame.width,
                i = this.texture.frame.height,
                s = e * (1 - this.anchor.x),
                n = e * -this.anchor.x,
                o = i * (1 - this.anchor.y),
                r = i * -this.anchor.y,
                a = t || this.worldTransform,
                h = a.a,
                l = a.b,
                c = a.c,
                u = a.d,
                d = a.tx,
                p = a.ty,
                f = -1 / 0,
                m = -1 / 0,
                g = 1 / 0,
                y = 1 / 0;
            if (0 === l && 0 === c) {
                if (h < 0) {
                    h *= -1;
                    var v = s;
                    s = -n, n = -v
                }
                if (u < 0) {
                    u *= -1;
                    v = o;
                    o = -r, r = -v
                }
                g = h * n + d, f = h * s + d, y = u * r + p, m = u * o + p
            } else {
                var b = h * n + c * r + d,
                    _ = u * r + l * n + p,
                    w = h * s + c * r + d,
                    x = u * r + l * s + p,
                    P = h * s + c * o + d,
                    T = u * o + l * s + p,
                    C = h * n + c * o + d,
                    S = u * o + l * n + p;
                g = C < (g = P < (g = w < (g = b < g ? b : g) ? w : g) ? P : g) ? C : g, y = S < (y = T < (y = x < (y = _ < y ? _ : y) ? x : y) ? T : y) ? S : y, f = C > (f = P > (f = w > (f = b > f ? b : f) ? w : f) ? P : f) ? C : f, m = S > (m = T > (m = x > (m = _ > m ? _ : m) ? x : m) ? T : m) ? S : m
            }
            var A = this._bounds;
            return A.x = g, A.width = f - g, A.y = y, A.height = m - y, this._currentBounds = A, A
        }, o.Sprite.prototype.getLocalBounds = function() {
            var t = this.worldTransform;
            this.worldTransform = o.identityMatrix;
            for (var e = 0; e < this.children.length; e++) this.children[e].updateTransform();
            var i = this.getBounds();
            for (this.worldTransform = t, e = 0; e < this.children.length; e++) this.children[e].updateTransform();
            return i
        }, o.Sprite.prototype._renderWebGL = function(t, e) {
            if (this.visible && !(this.alpha <= 0) && this.renderable) {
                var i = this.worldTransform;
                if (e && (i = e), this._mask || this._filters) {
                    var s = t.spriteBatch;
                    this._filters && (s.flush(), t.filterManager.pushFilter(this._filterBlock)), this._mask && (s.stop(), t.maskManager.pushMask(this.mask, t), s.start()), s.render(this);
                    for (var n = 0; n < this.children.length; n++) this.children[n]._renderWebGL(t);
                    s.stop(), this._mask && t.maskManager.popMask(this._mask, t), this._filters && t.filterManager.popFilter(), s.start()
                } else {
                    t.spriteBatch.render(this);
                    for (n = 0; n < this.children.length; n++) this.children[n]._renderWebGL(t, i)
                }
            }
        }, o.Sprite.prototype._renderCanvas = function(t, e) {
            if (!(!this.visible || 0 === this.alpha || !this.renderable || this.texture.crop.width <= 0 || this.texture.crop.height <= 0)) {
                var i = this.worldTransform;
                if (e && (i = e), this.blendMode !== t.currentBlendMode && (t.currentBlendMode = this.blendMode, t.context.globalCompositeOperation = o.blendModesCanvas[t.currentBlendMode]), this._mask && t.maskManager.pushMask(this._mask, t), !this.texture.valid) {
                    for (var s = 0; s < this.children.length; s++) this.children[s]._renderCanvas(t);
                    return void(this._mask && t.maskManager.popMask(t))
                }
                var n = this.texture.baseTexture.resolution / t.resolution;
                t.context.globalAlpha = this.worldAlpha, t.smoothProperty && t.scaleMode !== this.texture.baseTexture.scaleMode && (t.scaleMode = this.texture.baseTexture.scaleMode, t.context[t.smoothProperty] = t.scaleMode === o.scaleModes.LINEAR);
                var r = this.texture.trim ? this.texture.trim.x - this.anchor.x * this.texture.trim.width : this.anchor.x * -this.texture.frame.width,
                    a = this.texture.trim ? this.texture.trim.y - this.anchor.y * this.texture.trim.height : this.anchor.y * -this.texture.frame.height,
                    h = i.tx * t.resolution + t.shakeX,
                    l = i.ty * t.resolution + t.shakeY,
                    c = this.texture.crop.width,
                    u = this.texture.crop.height;
                if (this.texture.rotated) {
                    var d = i.a,
                        p = i.b,
                        f = i.c,
                        m = i.d,
                        g = c;
                    h = i.c * u + h, l = i.d * u + l, i.a = 6.123233995736766e-17 * d - f, i.b = 6.123233995736766e-17 * p - m, i.c = d + 6.123233995736766e-17 * f, i.d = p + 6.123233995736766e-17 * m, c = u, u = g
                }
                if (t.roundPixels ? (t.context.setTransform(i.a, i.b, i.c, i.d, 0 | h, 0 | l), r |= 0, a |= 0) : t.context.setTransform(i.a, i.b, i.c, i.d, h, l), r /= n, a /= n, 16777215 !== this.tint)(this.texture.requiresReTint || this.cachedTint !== this.tint) && (this.tintedTexture = o.CanvasTinter.getTintedTexture(this, this.tint), this.cachedTint = this.tint, this.texture.requiresReTint = !1), t.context.drawImage(this.tintedTexture, 0, 0, c, u, r, a, c / n, u / n);
                else {
                    var y = this.texture.crop.x,
                        v = this.texture.crop.y;
                    t.context.drawImage(this.texture.baseTexture.source, y, v, c, u, r, a, c / n, u / n)
                }
                for (s = 0; s < this.children.length; s++) this.children[s]._renderCanvas(t);
                this._mask && t.maskManager.popMask(t)
            }
        }, o.initDefaultShaders = function() {}, o.CompileVertexShader = function(t, e) {
            return o._CompileShader(t, e, t.VERTEX_SHADER)
        }, o.CompileFragmentShader = function(t, e) {
            return o._CompileShader(t, e, t.FRAGMENT_SHADER)
        }, o._CompileShader = function(t, e, i) {
            var s = e;
            Array.isArray(e) && (s = e.join("\n"));
            var n = t.createShader(i);
            return t.shaderSource(n, s), t.compileShader(n), t.getShaderParameter(n, t.COMPILE_STATUS) ? n : (window.console.log(t.getShaderInfoLog(n)), null)
        }, o.compileProgram = function(t, e, i) {
            var s = o.CompileFragmentShader(t, i),
                n = o.CompileVertexShader(t, e),
                r = t.createProgram();
            return t.attachShader(r, n), t.attachShader(r, s), t.linkProgram(r), t.getProgramParameter(r, t.LINK_STATUS) || (window.console.log(t.getProgramInfoLog(r)), window.console.log("Could not initialise shaders")), r
        }, o.PixiShader = function(t) {
            this._UID = Phaser._UID++, this.gl = t, this.program = null, this.fragmentSrc = null, this.textureCount = 0, this.firstRun = !0, this.dirty = !0, this.attributes = [], this.init()
        }, o.PixiShader.prototype.constructor = o.PixiShader, o.PixiShader.prototype.initMultitexShader = function() {
            var t = this.gl;
            this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);
            for (var e = "\tif (vTextureIndex == 0.0) gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;\n", i = 1; i < this.MAX_TEXTURES; ++i) e += "\telse if (vTextureIndex == " + i + ".0) gl_FragColor = texture2D(uSamplerArray[" + i + "], vTextureCoord) * vColor;\n";
            this.fragmentSrc = ["// PixiShader Fragment Shader.", "precision lowp float;", "bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);", "const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);", "void main(void) {", e, "   else if(vTextureIndex >= " + this.MAX_TEXTURES + ".0) gl_FragColor = BLUE;", "   else if(isnan(vTextureIndex)) gl_FragColor = RED;", "}"];
            var s = o.compileProgram(t, this.vertexSrc || o.PixiShader.defaultVertexSrc, this.fragmentSrc);
            t.useProgram(s), this.uSamplerArray = t.getUniformLocation(s, "uSamplerArray[0]"), this.projectionVector = t.getUniformLocation(s, "projectionVector"), this.offsetVector = t.getUniformLocation(s, "offsetVector"), this.dimensions = t.getUniformLocation(s, "dimensions"), this.aVertexPosition = t.getAttribLocation(s, "aVertexPosition"), this.aTextureCoord = t.getAttribLocation(s, "aTextureCoord"), this.colorAttribute = t.getAttribLocation(s, "aColor"), this.aTextureIndex = t.getAttribLocation(s, "aTextureIndex");
            var n = [],
                r = t.createTexture();
            t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, r), t.texImage2D(t.TEXTURE_2D, 0, t.RGB, 1, 1, 0, t.RGB, t.UNSIGNED_BYTE, null);
            for (var a = 0; a < this.MAX_TEXTURES; ++a) t.activeTexture(t.TEXTURE0 + a), t.bindTexture(t.TEXTURE_2D, r), n.push(a);
            for (var h in t.activeTexture(t.TEXTURE0), t.uniform1iv(this.uSamplerArray, n), -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [this.aVertexPosition, this.aTextureCoord, this.colorAttribute, this.aTextureIndex], this.uniforms) this.uniforms[h].uniformLocation = t.getUniformLocation(s, h);
            this.initUniforms(), this.program = s
        }, o.PixiShader.prototype.initDefaultShader = function() {
            null === this.fragmentSrc && (this.fragmentSrc = ["precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;", "}"]);
            var t = this.gl,
                e = o.compileProgram(t, this.vertexSrc || o.PixiShader.defaultVertexSrc, this.fragmentSrc);
            for (var i in t.useProgram(e), this.uSampler = t.getUniformLocation(e, "uSampler"), this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.dimensions = t.getUniformLocation(e, "dimensions"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"), this.colorAttribute = t.getAttribLocation(e, "aColor"), this.aTextureIndex = t.getAttribLocation(e, "aTextureIndex"), -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [this.aVertexPosition, this.aTextureCoord, this.colorAttribute, this.aTextureIndex], this.uniforms) this.uniforms[i].uniformLocation = t.getUniformLocation(e, i);
            this.initUniforms(), this.program = e
        }, o.PixiShader.prototype.init = function(t) {
            o._enableMultiTextureToggle && !t ? this.initMultitexShader() : this.initDefaultShader()
        }, o.PixiShader.prototype.initUniforms = function() {
            this.textureCount = 1;
            var t, e = this.gl;
            for (var i in this.uniforms) {
                var s = (t = this.uniforms[i]).type;
                "sampler2D" === s ? (t._init = !1, null !== t.value && this.initSampler2D(t)) : "mat2" === s || "mat3" === s || "mat4" === s ? (t.glMatrix = !0, t.glValueLength = 1, "mat2" === s ? t.glFunc = e.uniformMatrix2fv : "mat3" === s ? t.glFunc = e.uniformMatrix3fv : "mat4" === s && (t.glFunc = e.uniformMatrix4fv)) : (t.glFunc = e["uniform" + s], t.glValueLength = "2f" === s || "2i" === s ? 2 : "3f" === s || "3i" === s ? 3 : "4f" === s || "4i" === s ? 4 : 1)
            }
        }, o.PixiShader.prototype.initSampler2D = function(t) {
            if (t.value && t.value.baseTexture && t.value.baseTexture.hasLoaded) {
                var e = this.gl;
                if (e.activeTexture(e.TEXTURE0 + this.textureCount), e.bindTexture(e.TEXTURE_2D, t.value.baseTexture._glTextures[e.id]), t.textureData) {
                    var i = t.textureData,
                        s = i.magFilter ? i.magFilter : e.LINEAR,
                        n = i.minFilter ? i.minFilter : e.LINEAR,
                        o = i.wrapS ? i.wrapS : e.CLAMP_TO_EDGE,
                        r = i.wrapT ? i.wrapT : e.CLAMP_TO_EDGE,
                        a = i.luminance ? e.LUMINANCE : e.RGBA;
                    if (i.repeat && (o = e.REPEAT, r = e.REPEAT), e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL, !!i.flipY), i.width) {
                        var h = i.width ? i.width : 512,
                            l = i.height ? i.height : 2,
                            c = i.border ? i.border : 0;
                        e.texImage2D(e.TEXTURE_2D, 0, a, h, l, c, a, e.UNSIGNED_BYTE, null)
                    } else e.texImage2D(e.TEXTURE_2D, 0, a, e.RGBA, e.UNSIGNED_BYTE, t.value.baseTexture.source);
                    e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, s), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, n), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, o), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, r)
                }
                e.uniform1i(t.uniformLocation, this.textureCount), t._init = !0, this.textureCount++
            }
        }, o.PixiShader.prototype.syncUniforms = function() {
            this.textureCount = 1;
            var t, e = this.gl;
            for (var i in this.uniforms) 1 === (t = this.uniforms[i]).glValueLength ? !0 === t.glMatrix ? t.glFunc.call(e, t.uniformLocation, t.transpose, t.value) : t.glFunc.call(e, t.uniformLocation, t.value) : 2 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y) : 3 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y, t.value.z) : 4 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y, t.value.z, t.value.w) : "sampler2D" === t.type && (t._init ? (e.activeTexture(e["TEXTURE" + this.textureCount]), t.value.baseTexture._dirty[e.id] ? o.instances[e.id].updateTexture(t.value.baseTexture) : e.bindTexture(e.TEXTURE_2D, t.value.baseTexture._glTextures[e.id]), e.uniform1i(t.uniformLocation, this.textureCount), this.textureCount++) : this.initSampler2D(t))
        }, o.PixiShader.prototype.destroy = function() {
            this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null
        }, o.PixiShader.defaultVertexSrc = ["// PixiShader Vertex Shader", "// With multi-texture rendering", "attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "attribute vec4 aColor;", "attribute float aTextureIndex;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   if (aTextureIndex > 0.0) gl_Position = vec4(0.0);", "   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vColor = vec4(aColor.rgb * aColor.a, aColor.a);", "   vTextureIndex = aTextureIndex;", "}"], o.PixiFastShader = function(t) {
            if (this._UID = Phaser._UID++, this.gl = t, this.program = null, o._enableMultiTextureToggle) {
                t = this.gl;
                this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);
                for (var e = "\tif (vTextureIndex == 0.0) gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;\n", i = 1; i < this.MAX_TEXTURES; ++i) e += "\telse if (vTextureIndex == " + i + ".0) gl_FragColor = texture2D(uSamplerArray[" + i + "], vTextureCoord) * vColor;\n";
                this.fragmentSrc = ["// PixiFastShader Fragment Shader.", "precision lowp float;", "bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }", "varying vec2 vTextureCoord;", "varying float vColor;", "varying float vTextureIndex;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);", "const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);", "void main(void) {", e, "   else if(vTextureIndex >= " + this.MAX_TEXTURES + ".0) gl_FragColor = BLUE;", "   else if(isnan(vTextureIndex)) gl_FragColor = RED;", "}"]
            } else this.fragmentSrc = ["// PixiFastShader Fragment Shader.", "precision lowp float;", "varying vec2 vTextureCoord;", "varying float vColor;", "varying float vTextureIndex;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;", "}"];
            this.vertexSrc = ["// PixiFastShader Vertex Shader.", "attribute vec2 aVertexPosition;", "attribute vec2 aPositionCoord;", "attribute vec2 aScale;", "attribute float aRotation;", "attribute vec2 aTextureCoord;", "attribute float aColor;", "attribute float aTextureIndex;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform mat3 uMatrix;", "varying vec2 vTextureCoord;", "varying float vColor;", "varying float vTextureIndex;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   vec2 v;", "   vec2 sv = aVertexPosition * aScale;", "   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);", "   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);", "   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;", "   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vTextureIndex = aTextureIndex;", "   vColor = aColor;", "}"], this.textureCount = 0, this.init()
        }, o.PixiFastShader.prototype.constructor = o.PixiFastShader, o.PixiFastShader.prototype.init = function() {
            var t = this.gl,
                e = o.compileProgram(t, this.vertexSrc, this.fragmentSrc);
            if (t.useProgram(e), this.uSampler = o._enableMultiTextureToggle ? t.getUniformLocation(e, "uSamplerArray[0]") : t.getUniformLocation(e, "uSampler"), o._enableMultiTextureToggle) {
                var i = [],
                    s = t.createTexture();
                t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, s), t.texImage2D(t.TEXTURE_2D, 0, t.RGB, 1, 1, 0, t.RGB, t.UNSIGNED_BYTE, null);
                for (var n = 0; n < this.MAX_TEXTURES; ++n) t.activeTexture(t.TEXTURE0 + n), t.bindTexture(t.TEXTURE_2D, s), i.push(n);
                t.activeTexture(t.TEXTURE0), t.uniform1iv(this.uSampler, i)
            }
            this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.dimensions = t.getUniformLocation(e, "dimensions"), this.uMatrix = t.getUniformLocation(e, "uMatrix"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.aPositionCoord = t.getAttribLocation(e, "aPositionCoord"), this.aScale = t.getAttribLocation(e, "aScale"), this.aRotation = t.getAttribLocation(e, "aRotation"), this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"), this.colorAttribute = t.getAttribLocation(e, "aColor"), this.aTextureIndex = t.getAttribLocation(e, "aTextureIndex"), -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [this.aVertexPosition, this.aPositionCoord, this.aScale, this.aRotation, this.aTextureCoord, this.colorAttribute, this.aTextureIndex], this.program = e
        }, o.PixiFastShader.prototype.destroy = function() {
            this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null
        }, o.StripShader = function(t) {
            if (this._UID = Phaser._UID++, this.gl = t, this.program = null, o._enableMultiTextureToggle) {
                t = this.gl;
                this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);
                for (var e = "\tif (vTextureIndex == 0.0) gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord);\n", i = 1; i < this.MAX_TEXTURES; ++i) e += "\telse if (vTextureIndex == " + i + ".0) gl_FragColor = texture2D(uSamplerArray[" + i + "], vTextureCoord) ;\n";
                this.fragmentSrc = ["//StripShader Fragment Shader.", "precision mediump float;", "bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }", "varying vec2 vTextureCoord;", "varying float vTextureIndex;", "uniform float alpha;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);", "const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);", "void main(void) {", e, "   else if(vTextureIndex >= " + this.MAX_TEXTURES + ".0) gl_FragColor = BLUE;", "   else if(isnan(vTextureIndex)) gl_FragColor = RED;", "}"]
            } else this.fragmentSrc = ["//StripShader Fragment Shader.", "precision mediump float;", "varying vec2 vTextureCoord;", "varying float vTextureIndex;", "uniform float alpha;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord);", "}"];
            this.vertexSrc = ["//StripShader Vertex Shader.", "attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "attribute float aTextureIndex;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "varying float vTextureIndex;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vTextureIndex = aTextureIndex;", "}"], this.init()
        }, o.StripShader.prototype.constructor = o.StripShader, o.StripShader.prototype.init = function() {
            var t = this.gl,
                e = o.compileProgram(t, this.vertexSrc, this.fragmentSrc);
            if (t.useProgram(e), this.uSampler = o._enableMultiTextureToggle ? t.getUniformLocation(e, "uSamplerArray[0]") : t.getUniformLocation(e, "uSampler"), o._enableMultiTextureToggle) {
                var i = [],
                    s = t.createTexture();
                t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, s), t.texImage2D(t.TEXTURE_2D, 0, t.RGB, 1, 1, 0, t.RGB, t.UNSIGNED_BYTE, null);
                for (var n = 0; n < this.MAX_TEXTURES; ++n) t.activeTexture(t.TEXTURE0 + n), t.bindTexture(t.TEXTURE_2D, s), i.push(n);
                t.activeTexture(t.TEXTURE0), t.uniform1iv(this.uSampler, i)
            }
            this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.colorAttribute = t.getAttribLocation(e, "aColor"), this.aTextureIndex = t.getAttribLocation(e, "aTextureIndex"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"), this.attributes = [this.aVertexPosition, this.aTextureCoord, this.aTextureIndex], this.translationMatrix = t.getUniformLocation(e, "translationMatrix"), this.alpha = t.getUniformLocation(e, "alpha"), this.program = e
        }, o.StripShader.prototype.destroy = function() {
            this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attribute = null
        }, o.PrimitiveShader = function(t) {
            this._UID = Phaser._UID++, this.gl = t, this.program = null, this.fragmentSrc = ["precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec4 aColor;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform float alpha;", "uniform float flipY;", "uniform vec3 tint;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);", "   vColor = aColor * vec4(tint * alpha, alpha);", "}"], this.init()
        }, o.PrimitiveShader.prototype.constructor = o.PrimitiveShader, o.PrimitiveShader.prototype.init = function() {
            var t = this.gl,
                e = o.compileProgram(t, this.vertexSrc, this.fragmentSrc);
            t.useProgram(e), this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.tintColor = t.getUniformLocation(e, "tint"), this.flipY = t.getUniformLocation(e, "flipY"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.colorAttribute = t.getAttribLocation(e, "aColor"), this.attributes = [this.aVertexPosition, this.colorAttribute], this.translationMatrix = t.getUniformLocation(e, "translationMatrix"), this.alpha = t.getUniformLocation(e, "alpha"), this.program = e
        }, o.PrimitiveShader.prototype.destroy = function() {
            this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null
        }, o.ComplexPrimitiveShader = function(t) {
            this._UID = Phaser._UID++, this.gl = t, this.program = null, this.fragmentSrc = ["precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform vec3 tint;", "uniform float alpha;", "uniform vec3 color;", "uniform float flipY;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);", "   vColor = vec4(color * alpha * tint, alpha);", "}"], this.init()
        }, o.ComplexPrimitiveShader.prototype.constructor = o.ComplexPrimitiveShader, o.ComplexPrimitiveShader.prototype.init = function() {
            var t = this.gl,
                e = o.compileProgram(t, this.vertexSrc, this.fragmentSrc);
            t.useProgram(e), this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.tintColor = t.getUniformLocation(e, "tint"), this.color = t.getUniformLocation(e, "color"), this.flipY = t.getUniformLocation(e, "flipY"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.attributes = [this.aVertexPosition, this.colorAttribute], this.translationMatrix = t.getUniformLocation(e, "translationMatrix"), this.alpha = t.getUniformLocation(e, "alpha"), this.program = e
        }, o.ComplexPrimitiveShader.prototype.destroy = function() {
            this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attribute = null
        }, o.glContexts = [], o.instances = [], o._enableMultiTextureToggle = !1, o.WebGLRenderer = function(t) {
            this.game = t, o.defaultRenderer || (o.defaultRenderer = this), this.extensions = {}, this.type = Phaser.WEBGL, this.resolution = t.resolution, this.transparent = t.transparent, this.autoResize = !1, this.preserveDrawingBuffer = t.preserveDrawingBuffer, this.clearBeforeRender = t.clearBeforeRender, this.width = t.width, this.height = t.height, this.view = t.canvas, this._contextOptions = {
                alpha: this.transparent,
                antialias: t.antialias,
                premultipliedAlpha: this.transparent && "notMultiplied" !== this.transparent,
                stencil: !0,
                preserveDrawingBuffer: this.preserveDrawingBuffer
            }, this.projection = new o.Point, this.offset = new o.Point, this.shaderManager = new o.WebGLShaderManager, this.spriteBatch = new o.WebGLSpriteBatch(t), this.maskManager = new o.WebGLMaskManager, this.filterManager = new o.WebGLFilterManager, this.stencilManager = new o.WebGLStencilManager, this.blendModeManager = new o.WebGLBlendModeManager, this.renderSession = {}, this.currentBatchedTextures = [], this.renderSession.game = this.game, this.renderSession.gl = this.gl, this.renderSession.drawCount = 0, this.renderSession.shaderManager = this.shaderManager, this.renderSession.maskManager = this.maskManager, this.renderSession.filterManager = this.filterManager, this.renderSession.blendModeManager = this.blendModeManager, this.renderSession.spriteBatch = this.spriteBatch, this.renderSession.stencilManager = this.stencilManager, this.renderSession.renderer = this, this.renderSession.resolution = this.resolution, this.initContext(), this.mapBlendModes()
        }, o.WebGLRenderer.prototype.constructor = o.WebGLRenderer, o.WebGLRenderer.prototype.initContext = function() {
            var t = this.view.getContext("webgl", this._contextOptions) || this.view.getContext("experimental-webgl", this._contextOptions);
            if (this.gl = t, !t) throw new Error("This browser does not support webGL. Try using the canvas renderer");
            this.maxTextures = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS), this.glContextId = t.id = o.WebGLRenderer.glContextId++, o.glContexts[this.glContextId] = t, o.instances[this.glContextId] = this, t.disable(t.DEPTH_TEST), t.disable(t.CULL_FACE), t.enable(t.BLEND), this.shaderManager.setContext(t), this.spriteBatch.setContext(t), this.maskManager.setContext(t), this.filterManager.setContext(t), this.blendModeManager.setContext(t), this.stencilManager.setContext(t), this.renderSession.gl = this.gl, this.resize(this.width, this.height), this.extensions.compression = {}, etc1 = t.getExtension("WEBGL_compressed_texture_etc1") || t.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"), pvrtc = t.getExtension("WEBGL_compressed_texture_pvrtc") || t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"), s3tc = t.getExtension("WEBGL_compressed_texture_s3tc") || t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"), etc1 && (this.extensions.compression.ETC1 = etc1), pvrtc && (this.extensions.compression.PVRTC = pvrtc), s3tc && (this.extensions.compression.S3TC = s3tc)
        }, o.WebGLRenderer.prototype.setTexturePriority = function(t) {
            if (o._enableMultiTextureToggle) {
                for (var e = function(t) {
                        return --t, t |= t >> 1, t |= t >> 2, t |= t >> 4, t |= t >> 8, t |= t >> 16, ++t
                    }, i = this.gl, s = i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS), n = i.getParameter(i.MAX_TEXTURE_SIZE), r = this.game.cache._cache.image, a = null, h = 0; h < this.currentBatchedTextures.length; h++)(a = t[c]) in r && (r[a].base.textureIndex = 0);
                var l = n - e(Math.max(this.width, this.height));
                this.currentBatchedTextures.length = 0;
                for (var c = 0; c < t.length; ++c)
                    if ((a = t[c]) in r) {
                        var u = r[a].base;
                        l -= e(Math.max(u.width, u.height)), u.textureIndex = l <= 0 ? 0 : 1 + c % (s - 1), this.currentBatchedTextures.push(a)
                    } return this.currentBatchedTextures
            }
            console.warn("setTexturePriority error: Multi Texture support hasn't been enabled in the Phaser Game Config.")
        }, o.WebGLRenderer.prototype.render = function(t) {
            if (!this.contextLost) {
                var e = this.gl;
                e.viewport(0, 0, this.width, this.height), e.bindFramebuffer(e.FRAMEBUFFER, null), this.game.clearBeforeRender && (e.clearColor(t._bgColor.r, t._bgColor.g, t._bgColor.b, t._bgColor.a), e.clear(e.COLOR_BUFFER_BIT)), this.offset.x = this.game.camera._shake.x, this.offset.y = this.game.camera._shake.y, this.renderDisplayObject(t, this.projection)
            }
        }, o.WebGLRenderer.prototype.renderDisplayObject = function(t, e, i, s) {
            this.renderSession.blendModeManager.setBlendMode(o.blendModes.NORMAL), this.renderSession.drawCount = 0, this.renderSession.flipY = i ? -1 : 1, this.renderSession.projection = e, this.renderSession.offset = this.offset, this.spriteBatch.begin(this.renderSession), this.filterManager.begin(this.renderSession, i), t._renderWebGL(this.renderSession, s), this.spriteBatch.end()
        }, o.WebGLRenderer.prototype.resize = function(t, e) {
            this.width = t * this.resolution, this.height = e * this.resolution, this.view.width = this.width, this.view.height = this.height, this.autoResize && (this.view.style.width = this.width / this.resolution + "px", this.view.style.height = this.height / this.resolution + "px"), this.gl.viewport(0, 0, this.width, this.height), this.projection.x = this.width / 2 / this.resolution, this.projection.y = -this.height / 2 / this.resolution
        }, o.WebGLRenderer.prototype.updateCompressedTexture = function(t) {
            if (!t.hasLoaded) return !1;
            var e = this.gl,
                i = t.source;
            return t._glTextures[e.id] || (t._glTextures[e.id] = e.createTexture()), e.activeTexture(e.TEXTURE0 + t.textureIndex), e.bindTexture(e.TEXTURE_2D, t._glTextures[e.id]), e.compressedTexImage2D(e.TEXTURE_2D, 0, i.glExtensionFormat, i.width, i.height, 0, i.textureData), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, t.scaleMode === o.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), t.mipmap && Phaser.Math.isPowerOfTwo(t.width, t.height) ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === o.scaleModes.LINEAR ? e.LINEAR_MIPMAP_LINEAR : e.NEAREST_MIPMAP_NEAREST), e.generateMipmap(e.TEXTURE_2D)) : e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === o.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), t._powerOf2 ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.REPEAT), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.REPEAT)) : (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE)), t._dirty[e.id] = !1, !0
        }, o.WebGLRenderer.prototype.updateTexture = function(t) {
            if (!t.hasLoaded) return !1;
            if (t.source.compressionAlgorithm) return this.updateCompressedTexture(t);
            var e = this.gl;
            return t._glTextures[e.id] || (t._glTextures[e.id] = e.createTexture()), e.activeTexture(e.TEXTURE0 + t.textureIndex), e.bindTexture(e.TEXTURE_2D, t._glTextures[e.id]), e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL, t.premultipliedAlpha), e.texImage2D(e.TEXTURE_2D, 0, e.RGBA, e.RGBA, e.UNSIGNED_BYTE, t.source), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, t.scaleMode === o.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), t.mipmap && Phaser.Math.isPowerOfTwo(t.width, t.height) ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === o.scaleModes.LINEAR ? e.LINEAR_MIPMAP_LINEAR : e.NEAREST_MIPMAP_NEAREST), e.generateMipmap(e.TEXTURE_2D)) : e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === o.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), t._powerOf2 ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.REPEAT), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.REPEAT)) : (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE)), t._dirty[e.id] = !1, !0
        }, o.WebGLRenderer.prototype.destroy = function() {
            o.glContexts[this.glContextId] = null, this.projection = null, this.offset = null, this.shaderManager.destroy(), this.spriteBatch.destroy(), this.maskManager.destroy(), this.filterManager.destroy(), this.shaderManager = null, this.spriteBatch = null, this.maskManager = null, this.filterManager = null, this.gl = null, this.renderSession = null, Phaser.CanvasPool.remove(this), o.instances[this.glContextId] = null, o.WebGLRenderer.glContextId--
        }, o.WebGLRenderer.prototype.mapBlendModes = function() {
            var t = this.gl;
            if (!o.blendModesWebGL) {
                var e = [],
                    i = o.blendModes;
                e[i.NORMAL] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[i.ADD] = [t.SRC_ALPHA, t.DST_ALPHA], e[i.MULTIPLY] = [t.DST_COLOR, t.ONE_MINUS_SRC_ALPHA], e[i.SCREEN] = [t.SRC_ALPHA, t.ONE], e[i.OVERLAY] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[i.DARKEN] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[i.LIGHTEN] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[i.COLOR_DODGE] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[i.COLOR_BURN] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[i.HARD_LIGHT] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[i.SOFT_LIGHT] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[i.DIFFERENCE] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[i.EXCLUSION] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[i.HUE] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[i.SATURATION] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[i.COLOR] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[i.LUMINOSITY] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], o.blendModesWebGL = e
            }
        }, o.WebGLRenderer.prototype.getMaxTextureUnit = function() {
            var t = this.gl;
            return t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)
        }, o.enableMultiTexture = function() {
            o._enableMultiTextureToggle = !0
        }, o.WebGLRenderer.glContextId = 0, o.WebGLRenderer.textureArray = [], o.WebGLBlendModeManager = function() {
            this.currentBlendMode = 99999
        }, o.WebGLBlendModeManager.prototype.constructor = o.WebGLBlendModeManager, o.WebGLBlendModeManager.prototype.setContext = function(t) {
            this.gl = t
        }, o.WebGLBlendModeManager.prototype.setBlendMode = function(t) {
            if (this.currentBlendMode === t) return !1;
            this.currentBlendMode = t;
            var e = o.blendModesWebGL[this.currentBlendMode];
            return e && this.gl.blendFunc(e[0], e[1]), !0
        }, o.WebGLBlendModeManager.prototype.destroy = function() {
            this.gl = null
        }, o.WebGLMaskManager = function() {}, o.WebGLMaskManager.prototype.constructor = o.WebGLMaskManager, o.WebGLMaskManager.prototype.setContext = function(t) {
            this.gl = t
        }, o.WebGLMaskManager.prototype.pushMask = function(t, e) {
            var i = e.gl;
            t.dirty && o.WebGLGraphics.updateGraphics(t, i), void 0 !== t._webGL[i.id] && void 0 !== t._webGL[i.id].data && 0 !== t._webGL[i.id].data.length && e.stencilManager.pushStencil(t, t._webGL[i.id].data[0], e)
        }, o.WebGLMaskManager.prototype.popMask = function(t, e) {
            var i = this.gl;
            void 0 !== t._webGL[i.id] && void 0 !== t._webGL[i.id].data && 0 !== t._webGL[i.id].data.length && e.stencilManager.popStencil(t, t._webGL[i.id].data[0], e)
        }, o.WebGLMaskManager.prototype.destroy = function() {
            this.gl = null
        }, o.WebGLStencilManager = function() {
            this.stencilStack = [], this.reverse = !0, this.count = 0
        }, o.WebGLStencilManager.prototype.setContext = function(t) {
            this.gl = t
        }, o.WebGLStencilManager.prototype.pushStencil = function(t, e, i) {
            var s = this.gl;
            this.bindGraphics(t, e, i), 0 === this.stencilStack.length && (s.enable(s.STENCIL_TEST), s.clear(s.STENCIL_BUFFER_BIT), this.reverse = !0, this.count = 0), this.stencilStack.push(e);
            var n = this.count;
            s.colorMask(!1, !1, !1, !1), s.stencilFunc(s.ALWAYS, 0, 255), s.stencilOp(s.KEEP, s.KEEP, s.INVERT), 1 === e.mode ? (s.drawElements(s.TRIANGLE_FAN, e.indices.length - 4, s.UNSIGNED_SHORT, 0), this.reverse ? (s.stencilFunc(s.EQUAL, 255 - n, 255), s.stencilOp(s.KEEP, s.KEEP, s.DECR)) : (s.stencilFunc(s.EQUAL, n, 255), s.stencilOp(s.KEEP, s.KEEP, s.INCR)), s.drawElements(s.TRIANGLE_FAN, 4, s.UNSIGNED_SHORT, 2 * (e.indices.length - 4)), this.reverse ? s.stencilFunc(s.EQUAL, 255 - (n + 1), 255) : s.stencilFunc(s.EQUAL, n + 1, 255), this.reverse = !this.reverse) : (this.reverse ? (s.stencilFunc(s.EQUAL, n, 255), s.stencilOp(s.KEEP, s.KEEP, s.INCR)) : (s.stencilFunc(s.EQUAL, 255 - n, 255), s.stencilOp(s.KEEP, s.KEEP, s.DECR)), s.drawElements(s.TRIANGLE_STRIP, e.indices.length, s.UNSIGNED_SHORT, 0), this.reverse ? s.stencilFunc(s.EQUAL, n + 1, 255) : s.stencilFunc(s.EQUAL, 255 - (n + 1), 255)), s.colorMask(!0, !0, !0, !0), s.stencilOp(s.KEEP, s.KEEP, s.KEEP), this.count++
        }, o.WebGLStencilManager.prototype.bindGraphics = function(t, e, i) {
            this._currentGraphics = t;
            var s, n = this.gl,
                o = i.projection,
                r = i.offset;
            1 === e.mode ? (s = i.shaderManager.complexPrimitiveShader, i.shaderManager.setShader(s), n.uniform1f(s.flipY, i.flipY), n.uniformMatrix3fv(s.translationMatrix, !1, t.worldTransform.toArray(!0)), n.uniform2f(s.projectionVector, o.x, -o.y), n.uniform2f(s.offsetVector, -r.x, -r.y), n.uniform3fv(s.tintColor, Phaser.Color.hexToRGBArray(t.tint)), n.uniform3fv(s.color, e.color), n.uniform1f(s.alpha, t.worldAlpha * e.alpha), n.bindBuffer(n.ARRAY_BUFFER, e.buffer), n.vertexAttribPointer(s.aVertexPosition, 2, n.FLOAT, !1, 8, 0), n.bindBuffer(n.ELEMENT_ARRAY_BUFFER, e.indexBuffer)) : (s = i.shaderManager.primitiveShader, i.shaderManager.setShader(s), n.uniformMatrix3fv(s.translationMatrix, !1, t.worldTransform.toArray(!0)), n.uniform1f(s.flipY, i.flipY), n.uniform2f(s.projectionVector, o.x, -o.y), n.uniform2f(s.offsetVector, -r.x, -r.y), n.uniform3fv(s.tintColor, Phaser.Color.hexToRGBArray(t.tint)), n.uniform1f(s.alpha, t.worldAlpha), n.bindBuffer(n.ARRAY_BUFFER, e.buffer), n.vertexAttribPointer(s.aVertexPosition, 2, n.FLOAT, !1, 24, 0), n.vertexAttribPointer(s.colorAttribute, 4, n.FLOAT, !1, 24, 8), n.bindBuffer(n.ELEMENT_ARRAY_BUFFER, e.indexBuffer))
        }, o.WebGLStencilManager.prototype.popStencil = function(t, e, i) {
            var s = this.gl;
            if (this.stencilStack.pop(), this.count--, 0 === this.stencilStack.length) s.disable(s.STENCIL_TEST);
            else {
                var n = this.count;
                this.bindGraphics(t, e, i), s.colorMask(!1, !1, !1, !1), 1 === e.mode ? (this.reverse = !this.reverse, this.reverse ? (s.stencilFunc(s.EQUAL, 255 - (n + 1), 255), s.stencilOp(s.KEEP, s.KEEP, s.INCR)) : (s.stencilFunc(s.EQUAL, n + 1, 255), s.stencilOp(s.KEEP, s.KEEP, s.DECR)), s.drawElements(s.TRIANGLE_FAN, 4, s.UNSIGNED_SHORT, 2 * (e.indices.length - 4)), s.stencilFunc(s.ALWAYS, 0, 255), s.stencilOp(s.KEEP, s.KEEP, s.INVERT), s.drawElements(s.TRIANGLE_FAN, e.indices.length - 4, s.UNSIGNED_SHORT, 0), this.reverse ? s.stencilFunc(s.EQUAL, n, 255) : s.stencilFunc(s.EQUAL, 255 - n, 255)) : (this.reverse ? (s.stencilFunc(s.EQUAL, n + 1, 255), s.stencilOp(s.KEEP, s.KEEP, s.DECR)) : (s.stencilFunc(s.EQUAL, 255 - (n + 1), 255), s.stencilOp(s.KEEP, s.KEEP, s.INCR)), s.drawElements(s.TRIANGLE_STRIP, e.indices.length, s.UNSIGNED_SHORT, 0), this.reverse ? s.stencilFunc(s.EQUAL, n, 255) : s.stencilFunc(s.EQUAL, 255 - n, 255)), s.colorMask(!0, !0, !0, !0), s.stencilOp(s.KEEP, s.KEEP, s.KEEP)
            }
        }, o.WebGLStencilManager.prototype.destroy = function() {
            this.stencilStack = null, this.gl = null
        }, o.WebGLShaderManager = function() {
            this.maxAttibs = 10, this.attribState = [], this.tempAttribState = [];
            for (var t = 0; t < this.maxAttibs; t++) this.attribState[t] = !1;
            this.stack = []
        }, o.WebGLShaderManager.prototype.constructor = o.WebGLShaderManager, o.WebGLShaderManager.prototype.setContext = function(t) {
            this.gl = t, this.primitiveShader = new o.PrimitiveShader(t), this.complexPrimitiveShader = new o.ComplexPrimitiveShader(t), this.defaultShader = new o.PixiShader(t), this.fastShader = new o.PixiFastShader(t), this.stripShader = new o.StripShader(t), this.setShader(this.defaultShader)
        }, o.WebGLShaderManager.prototype.setAttribs = function(t) {
            var e;
            for (e = 0; e < this.tempAttribState.length; e++) this.tempAttribState[e] = !1;
            for (e = 0; e < t.length; e++) {
                var i = t[e];
                this.tempAttribState[i] = !0
            }
            var s = this.gl;
            for (e = 0; e < this.attribState.length; e++) this.attribState[e] !== this.tempAttribState[e] && (this.attribState[e] = this.tempAttribState[e], this.tempAttribState[e] ? s.enableVertexAttribArray(e) : s.disableVertexAttribArray(e))
        }, o.WebGLShaderManager.prototype.setShader = function(t) {
            return this._currentId !== t._UID && (this._currentId = t._UID, this.currentShader = t, this.gl.useProgram(t.program), this.setAttribs(t.attributes), !0)
        }, o.WebGLShaderManager.prototype.destroy = function() {
            this.attribState = null, this.tempAttribState = null, this.primitiveShader.destroy(), this.complexPrimitiveShader.destroy(), this.defaultShader.destroy(), this.fastShader.destroy(), this.stripShader.destroy(), this.gl = null
        }, o.WebGLSpriteBatch = function(t) {
            this.game = t, this.vertSize = 5, this.size = 2e3, this.vertexSize = 24;
            var e = this.vertexSize * this.size * 4,
                i = 6 * this.size;
            this.vertices = new ArrayBuffer(e), this.positions = new Float32Array(this.vertices), this.colors = new Uint32Array(this.vertices), this.indices = new Uint16Array(i), this.lastIndexCount = 0;
            for (var s = 0, n = 0; s < i; s += 6, n += 4) this.indices[s + 0] = n + 0, this.indices[s + 1] = n + 1, this.indices[s + 2] = n + 2, this.indices[s + 3] = n + 0, this.indices[s + 4] = n + 2, this.indices[s + 5] = n + 3;
            this.drawing = !1, this.currentBatchSize = 0, this.currentBaseTexture = null, this.dirty = !0, this.textures = [], this.blendModes = [], this.shaders = [], this.sprites = [], this.defaultShader = null
        }, o.WebGLSpriteBatch.prototype.setContext = function(t) {
            if (this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS), this.gl = t, o._enableMultiTextureToggle) {
                for (var e = "\tif (vTextureIndex == 0.0) gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;\n", i = 1; i < this.MAX_TEXTURES; ++i) e += "\telse if (vTextureIndex == " + i + ".0) gl_FragColor = texture2D(uSamplerArray[" + i + "], vTextureCoord) * vColor;\n";
                this.defaultShader = new Phaser.Filter(this.game, void 0, ["//WebGLSpriteBatch Fragment Shader.", "precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "void main(void) {", e, "\telse gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;", "}"])
            } else this.defaultShader = new Phaser.Filter(this.game, void 0, ["//WebGLSpriteBatch Fragment Shader.", "precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;", "}"]);
            this.vertexBuffer = t.createBuffer(), this.indexBuffer = t.createBuffer(), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.indices, t.STATIC_DRAW), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bufferData(t.ARRAY_BUFFER, this.vertices, t.DYNAMIC_DRAW), this.currentBlendMode = 99999;
            var s = new o.PixiShader(t);
            s.fragmentSrc = this.defaultShader.fragmentSrc, s.uniforms = {}, s.init(), this.defaultShader.shaders[t.id] = s
        }, o.WebGLSpriteBatch.prototype.begin = function(t) {
            this.renderSession = t, this.shader = this.renderSession.shaderManager.defaultShader, this.start()
        }, o.WebGLSpriteBatch.prototype.end = function() {
            this.flush()
        }, o.WebGLSpriteBatch.prototype.render = function(t, e) {
            var i = t.texture,
                s = i.baseTexture,
                n = this.gl;
            o.WebGLRenderer.textureArray[s.textureIndex] != s && (this.flush(), n.activeTexture(n.TEXTURE0 + s.textureIndex), n.bindTexture(n.TEXTURE_2D, s._glTextures[n.id]), o.WebGLRenderer.textureArray[s.textureIndex] = s);
            var r = t.worldTransform;
            e && (r = e), this.currentBatchSize >= this.size && (this.flush(), this.currentBaseTexture = i.baseTexture);
            var a = i._uvs;
            if (a) {
                var h, l, c, u, d = t.anchor.x,
                    p = t.anchor.y;
                if (i.trim) {
                    var f = i.trim;
                    h = (l = f.x - d * f.width) + i.crop.width, c = (u = f.y - p * f.height) + i.crop.height
                } else h = i.frame.width * (1 - d), l = i.frame.width * -d, c = i.frame.height * (1 - p), u = i.frame.height * -p;
                var m = this.currentBatchSize * this.vertexSize,
                    g = (this.currentBatchSize, i.baseTexture.resolution),
                    y = i.baseTexture.textureIndex,
                    v = r.a / g,
                    b = r.b / g,
                    _ = r.c / g,
                    w = r.d / g,
                    x = r.tx,
                    P = r.ty,
                    T = (i.crop.width, i.crop.height);
                if (i.rotated) {
                    var C = r.a,
                        S = r.b,
                        A = r.c,
                        E = r.d,
                        k = l,
                        M = h;
                    x = r.c * T + x, P = r.d * T + P, v = 6.123233995736766e-17 * C - A, b = 6.123233995736766e-17 * S - E, _ = C + 6.123233995736766e-17 * A, w = S + 6.123233995736766e-17 * E, i._updateUvsInverted(), h = c, l = u, c = M, u = k
                }
                var O = this.colors,
                    R = this.positions,
                    B = t.tint,
                    I = (B >> 16) + (65280 & B) + ((255 & B) << 16) + (255 * t.worldAlpha << 24);
                this.renderSession.roundPixels ? (R[m++] = v * l + _ * u + x | 0, R[m++] = w * u + b * l + P | 0, R[m++] = a.x0, R[m++] = a.y0, O[m++] = I, R[m++] = y, R[m++] = v * h + _ * u + x | 0, R[m++] = w * u + b * h + P | 0, R[m++] = a.x1, R[m++] = a.y1, O[m++] = I, R[m++] = y, R[m++] = v * h + _ * c + x | 0, R[m++] = w * c + b * h + P | 0, R[m++] = a.x2, R[m++] = a.y2, O[m++] = I, R[m++] = y, R[m++] = v * l + _ * c + x | 0, R[m++] = w * c + b * l + P | 0, R[m++] = a.x3, R[m++] = a.y3, O[m++] = I, R[m++] = y) : (R[m++] = v * l + _ * u + x, R[m++] = w * u + b * l + P, R[m++] = a.x0, R[m++] = a.y0, O[m++] = I, R[m++] = y, R[m++] = v * h + _ * u + x, R[m++] = w * u + b * h + P, R[m++] = a.x1, R[m++] = a.y1, O[m++] = I, R[m++] = y, R[m++] = v * h + _ * c + x, R[m++] = w * c + b * h + P, R[m++] = a.x2, R[m++] = a.y2, O[m++] = I, R[m++] = y, R[m++] = v * l + _ * c + x, R[m++] = w * c + b * l + P, R[m++] = a.x3, R[m++] = a.y3, O[m++] = I, R[m++] = y), this.sprites[this.currentBatchSize++] = t
            }
        }, o.WebGLSpriteBatch.prototype.renderTilingSprite = function(t) {
            var e = t.tilingTexture,
                i = e.baseTexture,
                s = this.gl,
                n = t.texture.baseTexture.textureIndex;
            o.WebGLRenderer.textureArray[n] != i && (this.flush(), s.activeTexture(s.TEXTURE0 + n), s.bindTexture(s.TEXTURE_2D, i._glTextures[s.id]), o.WebGLRenderer.textureArray[n] = i), this.currentBatchSize >= this.size && (this.flush(), this.currentBaseTexture = e.baseTexture), t._uvs || (t._uvs = new o.TextureUvs);
            var r = t._uvs,
                a = e.baseTexture.width,
                h = e.baseTexture.height;
            t.tilePosition.x %= a * t.tileScaleOffset.x, t.tilePosition.y %= h * t.tileScaleOffset.y;
            var l = t.tilePosition.x / (a * t.tileScaleOffset.x),
                c = t.tilePosition.y / (h * t.tileScaleOffset.y),
                u = t.width / a / (t.tileScale.x * t.tileScaleOffset.x),
                d = t.height / h / (t.tileScale.y * t.tileScaleOffset.y);
            r.x0 = 0 - l, r.y0 = 0 - c, r.x1 = 1 * u - l, r.y1 = 0 - c, r.x2 = 1 * u - l, r.y2 = 1 * d - c, r.x3 = 0 - l, r.y3 = 1 * d - c;
            var p = t.tint,
                f = (p >> 16) + (65280 & p) + ((255 & p) << 16) + (255 * t.worldAlpha << 24),
                m = this.positions,
                g = this.colors,
                y = t.width,
                v = t.height,
                b = t.anchor.x,
                _ = t.anchor.y,
                w = y * (1 - b),
                x = y * -b,
                P = v * (1 - _),
                T = v * -_,
                C = this.currentBatchSize * this.vertexSize,
                S = e.baseTexture.resolution,
                A = t.worldTransform,
                E = A.a / S,
                k = A.b / S,
                M = A.c / S,
                O = A.d / S,
                R = A.tx,
                B = A.ty;
            m[C++] = E * x + M * T + R, m[C++] = O * T + k * x + B, m[C++] = r.x0, m[C++] = r.y0, g[C++] = f, m[C++] = n, m[C++] = E * w + M * T + R, m[C++] = O * T + k * w + B, m[C++] = r.x1, m[C++] = r.y1, g[C++] = f, m[C++] = n, m[C++] = E * w + M * P + R, m[C++] = O * P + k * w + B, m[C++] = r.x2, m[C++] = r.y2, g[C++] = f, m[C++] = n, m[C++] = E * x + M * P + R, m[C++] = O * P + k * x + B, m[C++] = r.x3, m[C++] = r.y3, g[C++] = f, m[C++] = n, this.sprites[this.currentBatchSize++] = t
        }, o.WebGLSpriteBatch.prototype.flush = function() {
            if (0 !== this.currentBatchSize) {
                var t, e = this.gl;
                if (this.dirty) {
                    this.dirty = !1, t = this.defaultShader.shaders[e.id], e.activeTexture(e.TEXTURE0), e.bindBuffer(e.ARRAY_BUFFER, this.vertexBuffer), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this.indexBuffer);
                    var i = this.vertexSize;
                    e.vertexAttribPointer(t.aVertexPosition, 2, e.FLOAT, !1, i, 0), e.vertexAttribPointer(t.aTextureCoord, 2, e.FLOAT, !1, i, 8), e.vertexAttribPointer(t.colorAttribute, 4, e.UNSIGNED_BYTE, !0, i, 16), e.vertexAttribPointer(t.aTextureIndex, 1, e.FLOAT, !1, i, 20)
                }
                if (this.currentBatchSize > .5 * this.size) e.bufferSubData(e.ARRAY_BUFFER, 0, this.vertices);
                else {
                    e.bindBuffer(e.ARRAY_BUFFER, this.vertexBuffer);
                    var s = this.positions.subarray(0, this.currentBatchSize * this.vertexSize);
                    e.bufferSubData(e.ARRAY_BUFFER, 0, s)
                }
                for (var n, r, a, h, l = 0, c = 0, u = null, d = this.renderSession.blendModeManager.currentBlendMode, p = null, f = !1, m = !1, g = 0, y = this.currentBatchSize; g < y; g++) {
                    n = (h = this.sprites[g]).tilingTexture ? h.tilingTexture.baseTexture : h.texture.baseTexture, f = d !== (r = h.blendMode), m = p !== (a = h.shader || this.defaultShader);
                    var v = n.skipRender;
                    if (v && h.children.length > 0 && (v = !1), (f || m) && (this.renderBatch(u, l, c), c = g, l = 0, u = n, f && (d = r, this.renderSession.blendModeManager.setBlendMode(d)), m)) {
                        (t = (p = a).shaders[e.id]) || ((t = new o.PixiShader(e)).fragmentSrc = p.fragmentSrc, t.uniforms = p.uniforms, t.init(), p.shaders[e.id] = t), this.renderSession.shaderManager.setShader(t), t.dirty && t.syncUniforms();
                        var b = this.renderSession.projection;
                        e.uniform2f(t.projectionVector, b.x, b.y);
                        var _ = this.renderSession.offset;
                        e.uniform2f(t.offsetVector, _.x, _.y)
                    }
                    l++
                }
                this.renderBatch(u, l, c), this.currentBatchSize = 0
            }
        }, o.WebGLSpriteBatch.prototype.renderBatch = function(t, e, i) {
            if (0 !== e) {
                var s = this.gl;
                t._dirty[s.id] && !this.renderSession.renderer.updateTexture(t) || (s.drawElements(s.TRIANGLES, 6 * e, s.UNSIGNED_SHORT, 6 * i * 2), this.renderSession.drawCount++)
            }
        }, o.WebGLSpriteBatch.prototype.stop = function() {
            this.flush(), this.dirty = !0
        }, o.WebGLSpriteBatch.prototype.start = function() {
            this.dirty = !0
        }, o.WebGLSpriteBatch.prototype.destroy = function() {
            this.vertices = null, this.indices = null, this.gl.deleteBuffer(this.vertexBuffer), this.gl.deleteBuffer(this.indexBuffer), this.currentBaseTexture = null, this.gl = null
        }, o.WebGLFastSpriteBatch = function(t) {
            this.vertSize = 11, this.maxSize = 6e3, this.size = this.maxSize;
            var e = 4 * this.size * this.vertSize,
                i = 6 * this.maxSize;
            this.vertices = new Float32Array(e), this.indices = new Uint16Array(i), this.vertexBuffer = null, this.indexBuffer = null, this.lastIndexCount = 0;
            for (var s = 0, n = 0; s < i; s += 6, n += 4) this.indices[s + 0] = n + 0, this.indices[s + 1] = n + 1, this.indices[s + 2] = n + 2, this.indices[s + 3] = n + 0, this.indices[s + 4] = n + 2, this.indices[s + 5] = n + 3;
            this.drawing = !1, this.currentBatchSize = 0, this.currentBaseTexture = null, this.currentBlendMode = 0, this.renderSession = null, this.shader = null, this.matrix = null, this.setContext(t)
        }, o.WebGLFastSpriteBatch.prototype.constructor = o.WebGLFastSpriteBatch, o.WebGLFastSpriteBatch.prototype.setContext = function(t) {
            this.gl = t, this.vertexBuffer = t.createBuffer(), this.indexBuffer = t.createBuffer(), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.indices, t.STATIC_DRAW), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bufferData(t.ARRAY_BUFFER, this.vertices, t.DYNAMIC_DRAW)
        }, o.WebGLFastSpriteBatch.prototype.begin = function(t, e) {
            this.renderSession = e, this.shader = this.renderSession.shaderManager.fastShader, this.matrix = t.worldTransform.toArray(!0), this.start()
        }, o.WebGLFastSpriteBatch.prototype.end = function() {
            this.flush()
        }, o.WebGLFastSpriteBatch.prototype.render = function(t) {
            var e = t.children,
                i = e[0];
            if (i.texture._uvs) {
                this.currentBaseTexture = i.texture.baseTexture, i.blendMode !== this.renderSession.blendModeManager.currentBlendMode && (this.flush(), this.renderSession.blendModeManager.setBlendMode(i.blendMode));
                for (var s = 0, n = e.length; s < n; s++) this.renderSprite(e[s]);
                this.flush()
            }
        }, o.WebGLFastSpriteBatch.prototype.renderSprite = function(t) {
            var e = t.texture.baseTexture,
                i = this.gl,
                s = t.texture.baseTexture.textureIndex;
            if ((o.WebGLRenderer.textureArray[s] == e || !e._glTextures[i.id] || t.texture.baseTexture.skipRender || (this.flush(), i.activeTexture(i.TEXTURE0 + s), i.bindTexture(i.TEXTURE_2D, e._glTextures[i.id]), o.WebGLRenderer.textureArray[s] = e, t.texture._uvs)) && t.visible) {
                var n, r, a, h, l, c, u = this.vertices;
                if (n = t.texture._uvs, t.texture.frame.width, t.texture.frame.height, t.texture.trim) {
                    var d = t.texture.trim;
                    r = (a = d.x - t.anchor.x * d.width) + t.texture.crop.width, h = (l = d.y - t.anchor.y * d.height) + t.texture.crop.height
                } else r = t.texture.frame.width * (1 - t.anchor.x), a = t.texture.frame.width * -t.anchor.x, h = t.texture.frame.height * (1 - t.anchor.y), l = t.texture.frame.height * -t.anchor.y;
                c = 4 * this.currentBatchSize * this.vertSize, u[c++] = a, u[c++] = l, u[c++] = t.position.x, u[c++] = t.position.y, u[c++] = t.scale.x, u[c++] = t.scale.y, u[c++] = t.rotation, u[c++] = n.x0, u[c++] = n.y1, u[c++] = t.alpha, u[c++] = s, u[c++] = r, u[c++] = l, u[c++] = t.position.x, u[c++] = t.position.y, u[c++] = t.scale.x, u[c++] = t.scale.y, u[c++] = t.rotation, u[c++] = n.x1, u[c++] = n.y1, u[c++] = t.alpha, u[c++] = s, u[c++] = r, u[c++] = h, u[c++] = t.position.x, u[c++] = t.position.y, u[c++] = t.scale.x, u[c++] = t.scale.y, u[c++] = t.rotation, u[c++] = n.x2, u[c++] = n.y2, u[c++] = t.alpha, u[c++] = s, u[c++] = a, u[c++] = h, u[c++] = t.position.x, u[c++] = t.position.y, u[c++] = t.scale.x, u[c++] = t.scale.y, u[c++] = t.rotation, u[c++] = n.x3, u[c++] = n.y3, u[c++] = t.alpha, u[c++] = s, this.currentBatchSize++, this.currentBatchSize >= this.size && this.flush()
            }
        }, o.WebGLFastSpriteBatch.prototype.flush = function() {
            if (0 !== this.currentBatchSize) {
                var t = this.gl;
                if (!this.currentBaseTexture._glTextures[t.id]) return void this.renderSession.renderer.updateTexture(this.currentBaseTexture, t);
                if (this.currentBatchSize > .5 * this.size) t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertices);
                else {
                    var e = this.vertices.subarray(0, 4 * this.currentBatchSize * this.vertSize);
                    t.bufferSubData(t.ARRAY_BUFFER, 0, e)
                }
                t.drawElements(t.TRIANGLES, 6 * this.currentBatchSize, t.UNSIGNED_SHORT, 0), this.currentBatchSize = 0, this.renderSession.drawCount++
            }
        }, o.WebGLFastSpriteBatch.prototype.stop = function() {
            this.flush()
        }, o.WebGLFastSpriteBatch.prototype.start = function() {
            var t = this.gl;
            t.activeTexture(t.TEXTURE0), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer);
            var e = this.renderSession.projection;
            t.uniform2f(this.shader.projectionVector, e.x, e.y), t.uniformMatrix3fv(this.shader.uMatrix, !1, this.matrix);
            var i = 4 * this.vertSize;
            t.vertexAttribPointer(this.shader.aVertexPosition, 2, t.FLOAT, !1, i, 0), t.vertexAttribPointer(this.shader.aPositionCoord, 2, t.FLOAT, !1, i, 8), t.vertexAttribPointer(this.shader.aScale, 2, t.FLOAT, !1, i, 16), t.vertexAttribPointer(this.shader.aRotation, 1, t.FLOAT, !1, i, 24), t.vertexAttribPointer(this.shader.aTextureCoord, 2, t.FLOAT, !1, i, 28), t.vertexAttribPointer(this.shader.colorAttribute, 1, t.FLOAT, !1, i, 36), t.vertexAttribPointer(this.shader.aTextureIndex, 1, t.FLOAT, !1, i, 40)
        }, o.WebGLFilterManager = function() {
            this.filterStack = [], this.offsetX = 0, this.offsetY = 0
        }, o.WebGLFilterManager.prototype.constructor = o.WebGLFilterManager, o.WebGLFilterManager.prototype.setContext = function(t) {
            this.gl = t, this.texturePool = [], this.initShaderBuffers()
        }, o.WebGLFilterManager.prototype.begin = function(t, e) {
            this.renderSession = t, this.defaultShader = t.shaderManager.defaultShader;
            var i = this.renderSession.projection;
            this.width = 2 * i.x, this.height = 2 * -i.y, this.buffer = e
        }, o.WebGLFilterManager.prototype.pushFilter = function(t) {
            var e = this.gl,
                i = this.renderSession.projection,
                s = this.renderSession.offset;
            t._filterArea = t.target.filterArea || t.target.getBounds(), t._previous_stencil_mgr = this.renderSession.stencilManager, this.renderSession.stencilManager = new o.WebGLStencilManager, this.renderSession.stencilManager.setContext(e), e.disable(e.STENCIL_TEST), this.filterStack.push(t);
            var n = t.filterPasses[0];
            this.offsetX += t._filterArea.x, this.offsetY += t._filterArea.y;
            var r = this.texturePool.pop();
            r ? r.resize(this.width * this.renderSession.resolution, this.height * this.renderSession.resolution) : r = new o.FilterTexture(this.gl, this.width * this.renderSession.resolution, this.height * this.renderSession.resolution), e.bindTexture(e.TEXTURE_2D, r.texture);
            var a = t._filterArea,
                h = n.padding;
            a.x -= h, a.y -= h, a.width += 2 * h, a.height += 2 * h, a.x < 0 && (a.x = 0), a.width > this.width && (a.width = this.width), a.y < 0 && (a.y = 0), a.height > this.height && (a.height = this.height), e.bindFramebuffer(e.FRAMEBUFFER, r.frameBuffer), e.viewport(0, 0, a.width * this.renderSession.resolution, a.height * this.renderSession.resolution), i.x = a.width / 2, i.y = -a.height / 2, s.x = -a.x, s.y = -a.y, e.colorMask(!0, !0, !0, !0), e.clearColor(0, 0, 0, 0), e.clear(e.COLOR_BUFFER_BIT), t._glFilterTexture = r
        }, o.WebGLFilterManager.prototype.popFilter = function() {
            var t = this.gl,
                e = this.filterStack.pop(),
                i = e._filterArea,
                s = e._glFilterTexture,
                n = this.renderSession.projection,
                r = this.renderSession.offset;
            if (e.filterPasses.length > 1) {
                t.viewport(0, 0, i.width * this.renderSession.resolution, i.height * this.renderSession.resolution), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), this.vertexArray[0] = 0, this.vertexArray[1] = i.height, this.vertexArray[2] = i.width, this.vertexArray[3] = i.height, this.vertexArray[4] = 0, this.vertexArray[5] = 0, this.vertexArray[6] = i.width, this.vertexArray[7] = 0, t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertexArray), t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer), this.uvArray[2] = i.width / this.width, this.uvArray[5] = i.height / this.height, this.uvArray[6] = i.width / this.width, this.uvArray[7] = i.height / this.height, t.bufferSubData(t.ARRAY_BUFFER, 0, this.uvArray);
                var a = s,
                    h = this.texturePool.pop();
                h || (h = new o.FilterTexture(this.gl, this.width * this.renderSession.resolution, this.height * this.renderSession.resolution)), h.resize(this.width * this.renderSession.resolution, this.height * this.renderSession.resolution), t.bindFramebuffer(t.FRAMEBUFFER, h.frameBuffer), t.clear(t.COLOR_BUFFER_BIT), t.disable(t.BLEND);
                for (var l = 0; l < e.filterPasses.length - 1; l++) {
                    var c = e.filterPasses[l];
                    t.bindFramebuffer(t.FRAMEBUFFER, h.frameBuffer), t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, a.texture), this.applyFilterPass(c, i, i.width, i.height);
                    var u = a;
                    a = h, h = u
                }
                t.enable(t.BLEND), s = a, this.texturePool.push(h)
            }
            var d = e.filterPasses[e.filterPasses.length - 1];
            this.offsetX -= i.x, this.offsetY -= i.y;
            var p = this.width,
                f = this.height,
                m = 0,
                g = 0,
                y = this.buffer;
            if (0 === this.filterStack.length) t.colorMask(!0, !0, !0, !0);
            else {
                var v = this.filterStack[this.filterStack.length - 1];
                p = (i = v._filterArea).width, f = i.height, m = i.x, g = i.y, y = v._glFilterTexture.frameBuffer
            }
            n.x = p / 2, n.y = -f / 2, r.x = m, r.y = g;
            var b = (i = e._filterArea).x - m,
                _ = i.y - g;
            t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), this.vertexArray[0] = b, this.vertexArray[1] = _ + i.height, this.vertexArray[2] = b + i.width, this.vertexArray[3] = _ + i.height, this.vertexArray[4] = b, this.vertexArray[5] = _, this.vertexArray[6] = b + i.width, this.vertexArray[7] = _, t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertexArray), t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer), this.uvArray[2] = i.width / this.width, this.uvArray[5] = i.height / this.height, this.uvArray[6] = i.width / this.width, this.uvArray[7] = i.height / this.height, t.bufferSubData(t.ARRAY_BUFFER, 0, this.uvArray), t.viewport(0, 0, p * this.renderSession.resolution, f * this.renderSession.resolution), t.bindFramebuffer(t.FRAMEBUFFER, y), t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, s.texture), this.renderSession.stencilManager && this.renderSession.stencilManager.destroy(), this.renderSession.stencilManager = e._previous_stencil_mgr, e._previous_stencil_mgr = null, this.renderSession.stencilManager.count > 0 ? t.enable(t.STENCIL_TEST) : t.disable(t.STENCIL_TEST), this.applyFilterPass(d, i, p, f), this.texturePool.push(s), e._glFilterTexture = null
        }, o.WebGLFilterManager.prototype.applyFilterPass = function(t, e, i, s) {
            var n = this.gl,
                r = t.shaders[n.id];
            r || ((r = new o.PixiShader(n)).fragmentSrc = t.fragmentSrc, r.uniforms = t.uniforms, r.init(!0), t.shaders[n.id] = r), this.renderSession.shaderManager.setShader(r), n.uniform2f(r.projectionVector, i / 2, -s / 2), n.uniform2f(r.offsetVector, 0, 0), t.uniforms.dimensions && (t.uniforms.dimensions.value[0] = this.width, t.uniforms.dimensions.value[1] = this.height, t.uniforms.dimensions.value[2] = this.vertexArray[0], t.uniforms.dimensions.value[3] = this.vertexArray[5]), r.syncUniforms(), n.bindBuffer(n.ARRAY_BUFFER, this.vertexBuffer), n.vertexAttribPointer(r.aVertexPosition, 2, n.FLOAT, !1, 0, 0), n.bindBuffer(n.ARRAY_BUFFER, this.uvBuffer), n.vertexAttribPointer(r.aTextureCoord, 2, n.FLOAT, !1, 0, 0), n.bindBuffer(n.ARRAY_BUFFER, this.colorBuffer), n.vertexAttribPointer(r.colorAttribute, 2, n.FLOAT, !1, 0, 0), n.bindBuffer(n.ELEMENT_ARRAY_BUFFER, this.indexBuffer), n.drawElements(n.TRIANGLES, 6, n.UNSIGNED_SHORT, 0), this.renderSession.drawCount++
        }, o.WebGLFilterManager.prototype.initShaderBuffers = function() {
            var t = this.gl;
            this.vertexBuffer = t.createBuffer(), this.uvBuffer = t.createBuffer(), this.colorBuffer = t.createBuffer(), this.indexBuffer = t.createBuffer(), this.vertexArray = new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bufferData(t.ARRAY_BUFFER, this.vertexArray, t.STATIC_DRAW), this.uvArray = new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]), t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer), t.bufferData(t.ARRAY_BUFFER, this.uvArray, t.STATIC_DRAW), this.colorArray = new Float32Array([1, 16777215, 1, 16777215, 1, 16777215, 1, 16777215]), t.bindBuffer(t.ARRAY_BUFFER, this.colorBuffer), t.bufferData(t.ARRAY_BUFFER, this.colorArray, t.STATIC_DRAW), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, new Uint16Array([0, 1, 2, 1, 3, 2]), t.STATIC_DRAW)
        }, o.WebGLFilterManager.prototype.destroy = function() {
            var t = this.gl;
            this.filterStack = null, this.offsetX = 0, this.offsetY = 0;
            for (var e = 0; e < this.texturePool.length; e++) this.texturePool[e].destroy();
            this.texturePool = null, t.deleteBuffer(this.vertexBuffer), t.deleteBuffer(this.uvBuffer), t.deleteBuffer(this.colorBuffer), t.deleteBuffer(this.indexBuffer)
        };
        var r = {
            36054: "Incomplete attachment",
            36055: "Missing attachment",
            36057: "Incomplete dimensions",
            36061: "Framebuffer unsupported"
        };
        return o.FilterTexture = function(t, e, i, n, r) {
            r = "number" == typeof r ? r : 0, this.gl = t, this.frameBuffer = s(t, e, i, n || o.scaleModes.DEFAULT, r), this.texture = this.frameBuffer.targetTexture, this.width = e, this.height = i, this.renderBuffer = this.frameBuffer.renderBuffer
        }, o.FilterTexture.prototype.constructor = o.FilterTexture, o.FilterTexture.prototype.clear = function() {
            var t = this.gl;
            t.clearColor(0, 0, 0, 0), t.clear(t.COLOR_BUFFER_BIT)
        }, o.FilterTexture.prototype.resize = function(t, e) {
            if (this.width !== t || this.height !== e) {
                this.width = t, this.height = e;
                var i = this.gl;
                i.bindTexture(i.TEXTURE_2D, this.texture), i.texImage2D(i.TEXTURE_2D, 0, i.RGBA, t, e, 0, i.RGBA, i.UNSIGNED_BYTE, null), i.bindRenderbuffer(i.RENDERBUFFER, this.renderBuffer), i.renderbufferStorage(i.RENDERBUFFER, i.DEPTH_STENCIL, t, e)
            }
        }, o.FilterTexture.prototype.destroy = function() {
            var t = this.gl;
            t.deleteFramebuffer(this.frameBuffer), t.deleteTexture(this.texture), this.frameBuffer = null, this.texture = null
        }, o.CanvasBuffer = function(t, e) {
            this.width = t, this.height = e, this.canvas = Phaser.CanvasPool.create(this, this.width, this.height), this.context = this.canvas.getContext("2d"), this.canvas.width = t, this.canvas.height = e
        }, o.CanvasBuffer.prototype.constructor = o.CanvasBuffer, o.CanvasBuffer.prototype.clear = function() {
            this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.clearRect(0, 0, this.width, this.height)
        }, o.CanvasBuffer.prototype.resize = function(t, e) {
            this.width = this.canvas.width = t, this.height = this.canvas.height = e
        }, o.CanvasBuffer.prototype.destroy = function() {
            Phaser.CanvasPool.remove(this)
        }, o.CanvasMaskManager = function() {}, o.CanvasMaskManager.prototype.constructor = o.CanvasMaskManager, o.CanvasMaskManager.prototype.pushMask = function(t, e) {
            var i = e.context;
            i.save();
            var s = t.alpha,
                n = t.worldTransform,
                r = e.resolution;
            i.setTransform(n.a * r, n.b * r, n.c * r, n.d * r, n.tx * r, n.ty * r), o.CanvasGraphics.renderGraphicsMask(t, i), i.clip(), t.worldAlpha = s
        }, o.CanvasMaskManager.prototype.popMask = function(t) {
            t.context.restore()
        }, o.CanvasTinter = function() {}, o.CanvasTinter.getTintedTexture = function(t, e) {
            var i = t.tintedTexture || Phaser.CanvasPool.create(this);
            return o.CanvasTinter.tintMethod(t.texture, e, i), i
        }, o.CanvasTinter.tintWithMultiply = function(t, e, i) {
            var s = i.getContext("2d"),
                n = t.crop,
                o = n.width,
                r = n.height;
            t.rotated && (o = r, r = n.width), i.width === o && i.height === r || (i.width = o, i.height = r), s.clearRect(0, 0, o, r), s.fillStyle = "#" + ("00000" + (0 | e).toString(16)).substr(-6), s.fillRect(0, 0, o, r), s.globalCompositeOperation = "multiply", s.drawImage(t.baseTexture.source, n.x, n.y, o, r, 0, 0, o, r), s.globalCompositeOperation = "destination-atop", s.drawImage(t.baseTexture.source, n.x, n.y, o, r, 0, 0, o, r)
        }, o.CanvasTinter.tintWithPerPixel = function(t, e, i) {
            var s = i.getContext("2d"),
                n = t.crop,
                r = n.width,
                a = n.height;
            t.rotated && (r = a, a = n.width), i.width === r && i.height === a || (i.width = r, i.height = a), s.globalCompositeOperation = "copy", s.drawImage(t.baseTexture.source, n.x, n.y, r, a, 0, 0, r, a);
            for (var h = Phaser.Color.hexToRGBArray(e), l = h[0], c = h[1], u = h[2], d = s.getImageData(0, 0, r, a), p = d.data, f = 0; f < p.length; f += 4)
                if (p[f + 0] *= l, p[f + 1] *= c, p[f + 2] *= u, !o.CanvasTinter.canHandleAlpha) {
                    var m = p[f + 3];
                    p[f + 0] /= 255 / m, p[f + 1] /= 255 / m, p[f + 2] /= 255 / m
                } s.putImageData(d, 0, 0)
        }, o.CanvasRenderer = function(t) {
            this.game = t, o.defaultRenderer || (o.defaultRenderer = this), this.type = Phaser.CANVAS, this.resolution = t.resolution, this.clearBeforeRender = t.clearBeforeRender, this.transparent = t.transparent, this.autoResize = !1, this.width = t.width * this.resolution, this.height = t.height * this.resolution, this.view = t.canvas, this.context = this.view.getContext("2d", {
                alpha: this.transparent
            }), this.refresh = !0, this.count = 0, this.maskManager = new o.CanvasMaskManager, this.renderSession = {
                context: this.context,
                maskManager: this.maskManager,
                scaleMode: null,
                smoothProperty: Phaser.Canvas.getSmoothingPrefix(this.context),
                roundPixels: !1
            }, this.mapBlendModes(), this.resize(this.width, this.height)
        }, o.CanvasRenderer.prototype.constructor = o.CanvasRenderer, o.CanvasRenderer.prototype.render = function(t) {
            this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.globalAlpha = 1, this.renderSession.currentBlendMode = 0, this.renderSession.shakeX = this.game.camera._shake.x, this.renderSession.shakeY = this.game.camera._shake.y, this.context.globalCompositeOperation = "source-over", navigator.isCocoonJS && this.view.screencanvas && (this.context.fillStyle = "black", this.context.clear()), this.clearBeforeRender && (this.transparent ? this.context.clearRect(0, 0, this.width, this.height) : t._bgColor && (this.context.fillStyle = t._bgColor.rgba, this.context.fillRect(0, 0, this.width, this.height))), this.renderDisplayObject(t)
        }, o.CanvasRenderer.prototype.setTexturePriority = function(t) {}, o.CanvasRenderer.prototype.destroy = function(t) {
            void 0 === t && (t = !0), t && this.view.parent && this.view.parent.removeChild(this.view), this.view = null, this.context = null, this.maskManager = null, this.renderSession = null
        }, o.CanvasRenderer.prototype.resize = function(t, e) {
            this.width = t * this.resolution, this.height = e * this.resolution, this.view.width = this.width, this.view.height = this.height, this.autoResize && (this.view.style.width = this.width / this.resolution + "px", this.view.style.height = this.height / this.resolution + "px"), this.renderSession.smoothProperty && (this.context[this.renderSession.smoothProperty] = this.renderSession.scaleMode === o.scaleModes.LINEAR)
        }, o.CanvasRenderer.prototype.renderDisplayObject = function(t, e, i) {
            this.renderSession.context = e || this.context, this.renderSession.resolution = this.resolution, t._renderCanvas(this.renderSession, i)
        }, o.CanvasRenderer.prototype.mapBlendModes = function() {
            if (!o.blendModesCanvas) {
                var t = [],
                    e = o.blendModes,
                    i = this.game.device.canUseMultiply;
                t[e.NORMAL] = "source-over", t[e.ADD] = "lighter", t[e.MULTIPLY] = i ? "multiply" : "source-over", t[e.SCREEN] = i ? "screen" : "source-over", t[e.OVERLAY] = i ? "overlay" : "source-over", t[e.DARKEN] = i ? "darken" : "source-over", t[e.LIGHTEN] = i ? "lighten" : "source-over", t[e.COLOR_DODGE] = i ? "color-dodge" : "source-over", t[e.COLOR_BURN] = i ? "color-burn" : "source-over", t[e.HARD_LIGHT] = i ? "hard-light" : "source-over", t[e.SOFT_LIGHT] = i ? "soft-light" : "source-over", t[e.DIFFERENCE] = i ? "difference" : "source-over", t[e.EXCLUSION] = i ? "exclusion" : "source-over", t[e.HUE] = i ? "hue" : "source-over", t[e.SATURATION] = i ? "saturation" : "source-over", t[e.COLOR] = i ? "color" : "source-over", t[e.LUMINOSITY] = i ? "luminosity" : "source-over", o.blendModesCanvas = t
            }
        }, o.BaseTexture = function(t, e, i) {
            this.resolution = i || 1, this.width = 100, this.height = 100, this.scaleMode = e || o.scaleModes.DEFAULT, this.hasLoaded = !1, this.source = t, this.premultipliedAlpha = !0, this._glTextures = [], this.mipmap = !1, this.textureIndex = 0, this._dirty = [!0, !0, !0, !0], t && ((this.source.complete || this.source.getContext) && this.source.width && this.source.height && (this.hasLoaded = !0, this.width = this.source.naturalWidth || this.source.width, this.height = this.source.naturalHeight || this.source.height, this.dirty()), this.skipRender = !1, this._powerOf2 = !1)
        }, o.BaseTexture.prototype.constructor = o.BaseTexture, o.BaseTexture.prototype.forceLoaded = function(t, e) {
            this.hasLoaded = !0, this.width = t, this.height = e, this.dirty()
        }, o.BaseTexture.prototype.destroy = function() {
            this.source && Phaser.CanvasPool.removeByCanvas(this.source), this.source = null, this.unloadFromGPU()
        }, o.BaseTexture.prototype.updateSourceImage = function(t) {
            console.warn("PIXI.BaseTexture.updateSourceImage is deprecated. Use Phaser.Sprite.loadTexture instead.")
        }, o.BaseTexture.prototype.dirty = function() {
            for (var t = 0; t < this._glTextures.length; t++) this._dirty[t] = !0
        }, o.BaseTexture.prototype.unloadFromGPU = function() {
            this.dirty();
            for (var t = this._glTextures.length - 1; t >= 0; t--) {
                var e = this._glTextures[t],
                    i = o.glContexts[t];
                i && e && i.deleteTexture(e)
            }
            this._glTextures.length = 0, this.dirty()
        }, o.BaseTexture.fromCanvas = function(t, e, i) {
            return 0 === t.width && (t.width = 1), 0 === t.height && (t.height = 1), i = i || 1, new o.BaseTexture(t, e, i)
        }, o.TextureSilentFail = !1, o.Texture = function(t, e, i, s) {
            this.noFrame = !1, e || (this.noFrame = !0, e = new o.Rectangle(0, 0, 1, 1)), t instanceof o.Texture && (t = t.baseTexture), this.baseTexture = t, this.frame = e, this.trim = s, this.valid = !1, this.isTiling = !1, this.requiresUpdate = !1, this.requiresReTint = !1, this._uvs = null, this.width = 0, this.height = 0, this.crop = i || new o.Rectangle(0, 0, 1, 1), this.rotated = !1, t.hasLoaded && (this.noFrame && (e = new o.Rectangle(0, 0, t.width, t.height)), this.setFrame(e))
        }, o.Texture.prototype.constructor = o.Texture, o.Texture.prototype.onBaseTextureLoaded = function() {
            var t = this.baseTexture;
            this.noFrame && (this.frame = new o.Rectangle(0, 0, t.width, t.height)), this.setFrame(this.frame)
        }, o.Texture.prototype.destroy = function(t) {
            t && this.baseTexture.destroy(), this.valid = !1
        }, o.Texture.prototype.setFrame = function(t) {
            if (this.noFrame = !1, this.frame = t, this.width = t.width, this.height = t.height, this.crop.x = t.x, this.crop.y = t.y, this.crop.width = t.width, this.crop.height = t.height, this.trim || !(t.x + t.width > this.baseTexture.width || t.y + t.height > this.baseTexture.height)) this.valid = t && t.width && t.height && this.baseTexture.source && this.baseTexture.hasLoaded, this.trim && (this.width = this.trim.width, this.height = this.trim.height, this.frame.width = this.trim.width, this.frame.height = this.trim.height), this.valid && this._updateUvs();
            else {
                if (!o.TextureSilentFail) throw new Error("Texture Error: frame does not fit inside the base Texture dimensions " + this);
                this.valid = !1
            }
        }, o.Texture.prototype._updateUvs = function() {
            this._uvs || (this._uvs = new o.TextureUvs);
            var t = this.crop,
                e = this.baseTexture.width,
                i = this.baseTexture.height;
            this._uvs.x0 = t.x / e, this._uvs.y0 = t.y / i, this._uvs.x1 = (t.x + t.width) / e, this._uvs.y1 = t.y / i, this._uvs.x2 = (t.x + t.width) / e, this._uvs.y2 = (t.y + t.height) / i, this._uvs.x3 = t.x / e, this._uvs.y3 = (t.y + t.height) / i
        }, o.Texture.prototype._updateUvsInverted = function() {
            this._uvs || (this._uvs = new o.TextureUvs);
            var t = this.crop,
                e = this.baseTexture.width,
                i = this.baseTexture.height;
            this._uvs.x0 = t.x / e, this._uvs.y0 = t.y / i, this._uvs.x1 = (t.x + t.height) / e, this._uvs.y1 = t.y / i, this._uvs.x2 = (t.x + t.height) / e, this._uvs.y2 = (t.y + t.width) / i, this._uvs.x3 = t.x / e, this._uvs.y3 = (t.y + t.width) / i
        }, o.Texture.fromCanvas = function(t, e) {
            var i = o.BaseTexture.fromCanvas(t, e);
            return new o.Texture(i)
        }, o.TextureUvs = function() {
            this.x0 = 0, this.y0 = 0, this.x1 = 0, this.y1 = 0, this.x2 = 0, this.y2 = 0, this.x3 = 0, this.y3 = 0
        }, void 0 !== e ? (void 0 !== t && t.exports && (e = t.exports = o), e.PIXI = o) : "undefined" != typeof define && define.amd ? define("PIXI", n.PIXI = o) : n.PIXI = o, o
    }).call(this)
}, function(t, e, i) {
    "use strict";
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var s = i(21),
        n = function() {
            function t(t) {
                var e = this;
                this.state = t, this.window = document.getElementById("respawn-window"), this.button = document.getElementById("respawn-button"), this.ad = document.getElementById("respawn-ad"), this.button.onclick = function() {
                    e.requestRespawn()
                }
            }
            return t.prototype.requestRespawn = function() {
                if (this.seconds < 1) {
                    this.stop();
                    var t = this;
                    s.default.play(function() {
                        t.state.request_respawn(), jQuery(".killed-by div").html("")
                    })
                }
            }, t.prototype.show = function() {
                this.state.game.time.events.add(2 * Phaser.Timer.SECOND, function() {
                    this.reallyShow()
                }, this), this.state.game.time.events.add(3 * Phaser.Timer.SECOND, function() {
                    this.ad.style.display = "block"
                }, this)
            }, t.prototype.reallyShow = function() {
                var t = this;
                this.window.style.display = "block", this.button.className = "inactive", this.seconds = 5, this.button.innerText = "Spawn in " + this.seconds + " seconds..", this.interval = setInterval(function() {
                    t.update()
                }, 1e3)
            }, t.prototype.update = function() {
                this.seconds -= 1, this.seconds < 1 ? (clearInterval(this.interval), this.button.innerText = "Spawn", this.button.className = "active") : this.button.innerText = "Spawn in " + this.seconds + " seconds.."
            }, t.prototype.stop = function() {
                this.ad.style.display = "none", this.window.style.display = "none"
            }, t
        }();
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(5),
        r = i(4),
        a = i(7),
        h = i(104),
        l = i(13),
        c = i(98),
        u = i(14),
        d = i(25),
        p = i(22),
        f = function(t) {
            function e(e, i, s) {
                var n = t.call(this, e, i, s) || this;
                return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_1, "entity_WhiteWalker", new Phaser.Point(.5, .55))), n.addComponent(new d.default), n.addComponent(new l.default(100)), n.addComponent(new u.default), n
            }
            return s(e, t), e
        }(n.Entity);
    e.WhiteWalker = f;
    var m = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_0, "entity_Pig", new Phaser.Point(.5, .5))), n.addComponent(new h.default), n.addComponent(new u.default), n
        }
        return s(e, t), e
    }(n.Entity);
    e.Pig = m;
    var g = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_0, "entity_Chicken", new Phaser.Point(.5, .5))), n.addComponent(new h.default), n.addComponent(new u.default), n.addComponent(new p.default(50)), n
        }
        return s(e, t), e
    }(n.Entity);
    e.Chicken = g;
    var y = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_0, "entity_Wolf", new Phaser.Point(.5, .5))), n.addComponent(new c.default), n.addComponent(new l.default(50)), n.addComponent(new u.default), n
        }
        return s(e, t), e
    }(n.Entity);
    e.Wolf = y;
    var v = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_0, "entity_Spider", new Phaser.Point(.5, .5))), n.addComponent(new c.default), n.addComponent(new l.default(50)), n.addComponent(new u.default), n
        }
        return s(e, t), e
    }(n.Entity);
    e.Spider = v;
    var b = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_0, "entity_Bear", new Phaser.Point(.5, .5))), n.addComponent(new c.default), n.addComponent(new l.default(50)), n.addComponent(new u.default), n
        }
        return s(e, t), e
    }(n.Entity);
    e.Bear = b;
    var _ = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_0, "entity_WhiteBear", new Phaser.Point(.5, .5))), n.addComponent(new c.default), n.addComponent(new l.default(50)), n.addComponent(new u.default), n
        }
        return s(e, t), e
    }(n.Entity);
    e.WhiteBear = _;
    var w = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_0, "entity_Troll", new Phaser.Point(.5, .5))), n.addComponent(new c.default), n.addComponent(new l.default(50)), n.addComponent(new u.default), n
        }
        return s(e, t), e
    }(n.Entity);
    e.Troll = w;
    var x = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_0, "entity_RideablePig", new Phaser.Point(.5, .5))), n.addComponent(new h.default), n
        }
        return s(e, t), e
    }(n.Entity);
    e.RideablePig = x;
    var P = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_0, "entity_RideableWolf", new Phaser.Point(.5, .5))), n.addComponent(new h.default), n
        }
        return s(e, t), e
    }(n.Entity);
    e.RideableWolf = P;
    var T = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_0, "entity_RideableBear", new Phaser.Point(.5, .5))), n.addComponent(new h.default), n
        }
        return s(e, t), e
    }(n.Entity);
    e.RideableBear = T;
    var C = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_0, "entity_RideableDragon", new Phaser.Point(.5, .5))), n.addComponent(new h.default), n
        }
        return s(e, t), e
    }(n.Entity);
    e.RideableDragon = C
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(5),
        r = i(4),
        a = i(7),
        h = i(25),
        l = i(24),
        c = i(13),
        u = i(14),
        d = i(27),
        p = i(26),
        f = function(t) {
            function e(e, i, s) {
                var n = t.call(this, e, i, s) || this;
                return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_1, "entity_FollowerBot", new Phaser.Point(.485, .533))), n.addComponent(new h.default), n.addComponent(new l.default), n.addComponent(new c.default(50)), n.addComponent(new u.default), n.addComponent(new d.default), s === e.id && n.addComponent(new p.default(50)).setPlayerName("Mercenary"), n
            }
            return s(e, t), e
        }(n.Entity);
    e.FollowerBot = f;
    var m = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_1, "entity_FarmerBot", new Phaser.Point(.485, .533))), n.addComponent(new h.default), n.addComponent(new l.default), n.addComponent(new c.default(50)), n.addComponent(new u.default), n.addComponent(new d.default), s === e.id && n.addComponent(new p.default(50)).setPlayerName("Peasant"), n
        }
        return s(e, t), e
    }(n.Entity);
    e.FarmerBot = m;
    var g = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_1, "entity_GuardBot", new Phaser.Point(.485, .533))), n.addComponent(new h.default), n.addComponent(new l.default), n.addComponent(new c.default(50)), n.addComponent(new u.default), n.addComponent(new d.default), s === e.id && n.addComponent(new p.default(50)).setPlayerName("Guard"), n
        }
        return s(e, t), e
    }(n.Entity);
    e.GuardBot = g;
    var y = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_1, "entity_DarkGuardBot", new Phaser.Point(.485, .533))), n.addComponent(new h.default), n.addComponent(new l.default), n.addComponent(new c.default(50)), n.addComponent(new u.default), n.addComponent(new d.default), s === e.id && n.addComponent(new p.default(50)).setPlayerName("Guard"), n
        }
        return s(e, t), e
    }(n.Entity);
    e.DarkGuardBot = y;
    var v = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_MIDDLE_1, "entity_GardenBot", new Phaser.Point(.485, .533))), n.addComponent(new h.default), n.addComponent(new l.default), n.addComponent(new c.default(50)), n.addComponent(new u.default), n.addComponent(new d.default), s === e.id && n.addComponent(new p.default(50)).setPlayerName("Gardener"), n
        }
        return s(e, t), e
    }(n.Entity);
    e.GardenBot = v
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(12),
        r = i(5),
        a = i(4),
        h = i(7),
        l = i(3),
        c = i(23),
        u = i(101),
        d = i(99),
        p = i(103),
        f = function(t) {
            function e(e, i, s) {
                return t.call(this, e, i, s, e.LAYER_BACKGROUND_0, "entity_MarbleFloor") || this
            }
            return s(e, t), e
        }(o.BasicEntity);
    e.MarbleFloor = f;
    var m = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_BACKGROUND_0, "entity_WoodFloor") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.WoodFloor = m;
    var g = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_BACKGROUND_0, "entity_StoneFloor") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.StoneFloor = g;
    var y = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_BACKGROUND_0, "entity_WoodBlock") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.WoodBlock = y;
    var v = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_BACKGROUND_0, "entity_DarkStoneBlock") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.DarkStoneBlock = v;
    var b = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_FOREGROUND_0, "entity_StoneBlock") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.StoneBlock = b;
    var _ = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s, e.LAYER_MIDDLE_0, "entity_Door") || this;
            return n.addComponent(new u.default), n
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.Door = _;
    var w = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s, e.LAYER_MIDDLE_0, "entity_DarkDoor") || this;
            return n.addComponent(new u.default), n
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.DarkDoor = w;
    var x = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s, e.LAYER_MIDDLE_0, "entity_CrystalDoor") || this;
            return n.addComponent(new u.default), n
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.CrystalDoor = x;
    var P = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s, e.LAYER_MIDDLE_0, "entity_CrystalWall") || this;
            return n.addComponent(new u.default), n
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.CrystalWall = P;
    var T = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_BACKGROUND_0, "entity_Garden") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.Garden = T;
    var C = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_BACKGROUND_0, "entity_WoodSpikes") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.WoodSpikes = C;
    var S = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_BACKGROUND_0, "entity_IronSpikes") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.IronSpikes = S;
    var A = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_BACKGROUND_0, "entity_Portal") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.Portal = A;
    var E = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_BACKGROUND_0, "entity_Tower") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.Tower = E;
    var k = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_FOREGROUND_0, "entity_Heartstone") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.Heartstone = k;
    var M = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            n.addComponent(new r.default), n.addComponent(new a.default);
            var o = new h.default(e.LAYER_FOREGROUND_0, "entity_HealWard", new Phaser.Point(.5, .5));
            return n.addComponent(o), n.addComponent(new c.default), n.on("networksync", function(t) {
                if (t.x)
                    if (this.emitter);
                    else {
                        var i = e.game.add.emitter(0, 0, 200);
                        i.height = 64, i.width = 64, i.gravity = new Phaser.Point(0, 0), i.minParticleScale = .1, i.maxParticleScale = .5, i.setYSpeed(-100, 100), i.setXSpeed(-100, 100), i.makeParticles(l.Images.ImagesRain.getName()), i.minRotation = 0, i.maxRotation = 0, i.start(!1, 1600, 5, 0), o.sprite.addChild(i), this.emitter = i
                    }
            }.bind(n)), n
        }
        return s(e, t), e
    }(n.Entity);
    e.HealWard = M;
    var O = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_MIDDLE_1, "entity_FoodCrate") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.FoodCrate = O;
    var R = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_MIDDLE_1, "entity_WoodCrate") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.WoodCrate = R;
    var B = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_MIDDLE_1, "entity_StoneCrate") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.StoneCrate = B;
    var I = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_MIDDLE_1, "entity_SoulCrate") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.SoulCrate = I;
    var L = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_MIDDLE_0, "entity_Mannequin") || this
        }
        return s(e, t), e
    }(o.BasicEntity);
    e.Mannequin = L;
    var D = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new r.default), n.addComponent(new a.default(!0, !1)), n.addComponent(new h.default(e.LAYER_MIDDLE_0, "entity_FireballBullet", new Phaser.Point(.5, .5))), n.addComponent(new p.default), n
        }
        return s(e, t), e
    }(n.Entity);
    e.FireballBullet = D;
    var F = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new r.default), n.addComponent(new a.default(!0, !1)), n.addComponent(new h.default(e.LAYER_MIDDLE_0, "entity_SoccerBall", new Phaser.Point(.5, .5))), n.addComponent(new d.default), n
        }
        return s(e, t), e
    }(n.Entity);
    e.SoccerBall = F
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            return t.call(this) || this
        }
        return s(e, t), e.prototype.start = function() {
            t.prototype.start.call(this), this.entity.on("senddamage", this.onSendDamage.bind(this)), this.addAnimation("walk", Phaser.Animation.generateFrameNames("walk", 1, 8, ".png", 0), 15, !0), this.addAnimation("punch", Phaser.Animation.generateFrameNames("hit", 1, 8, ".png", 0), 30, !1).onComplete.add(function() {
                this.walk()
            }.bind(this)), this.walk()
        }, e.prototype.walk = function() {
            this.play("walk")
        }, e.prototype.onSendDamage = function(t) {
            this.play("punch")
        }, e.prototype.update = function(e) {
            t.prototype.update.call(this, e), "punch" !== this.getCurrentName() && "pigpunch" !== this.getCurrentName() && (this.cachedTransform.isMoving() ? this.walk() : this.cachedSpriteComponent.sprite.animations.stop())
        }, e.prototype.destroy = function() {}, e
    }(i(6).default);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            return t.call(this) || this
        }
        return s(e, t), e.prototype.start = function() {
            t.prototype.start.call(this)
        }, e.prototype.update = function(e) {
            t.prototype.update.call(this, e), this.cachedTransform.isMoving() ? this.cachedTransform.rotation += .01 : this.cachedSpriteComponent.sprite.animations.stop()
        }, e.prototype.destroy = function() {}, e
    }(i(6).default);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(2).Protocol.MessageType,
        r = function() {
            function t(t, e) {
                this.callback = t, this.cancelcallback = e, this.container = document.createElement("div"), this.container.style.left = "0px", this.container.style.top = "0px", this.container.style.position = "absolute", this.container.className = "speechbubble", this.input = document.createElement("input"), this.input.type = "text", this.input.maxLength = 60, this.container.appendChild(this.input);
                var i = this;
                this.input.addEventListener("keydown", function(t) {
                    13 === t.keyCode && (i.send(), t.stopImmediatePropagation())
                }), this.input.addEventListener("keydown", function(t) {
                    27 === t.keyCode && i.cancel()
                }), document.body.appendChild(this.container), this.input.focus()
            }
            return t.prototype.cancel = function() {
                this.cancelcallback()
            }, t.prototype.send = function() {
                this.callback(this.input.value)
            }, t.prototype.setposition = function(t, e) {
                t = Math.round(t), e = Math.round(e), t -= this.container.offsetWidth / 2, e -= this.container.offsetHeight, this.container.style.left = t + "px", this.container.style.top = e + "px"
            }, t.prototype.destroy = function() {
                this.container.parentElement.removeChild(this.container)
            }, t
        }(),
        a = function(t) {
            function e(e) {
                var i = t.call(this) || this;
                return i.id = "chatinput", i.chatInput = null, i.offset = e, i
            }
            return s(e, t), e.prototype.start = function() {
                t.prototype.start.call(this), this.cachedTransform = this.entity.components.transform, this.cachedSprite = this.entity.components.sprite, this.returnKey = this.world.game.input.keyboard.addKey(Phaser.Keyboard.ENTER), this.returnKey.onDown.add(this.onReturnKey, this), this.escapeKey = this.world.game.input.keyboard.addKey(Phaser.Keyboard.ESC)
            }, e.prototype.onReturnKey = function() {
                this.chatInput || (this.chatInput = new r(this.onChatRequest.bind(this), this.onChatCancel.bind(this)), this.align(), this.world.game.input.keyboard.enabled = !1)
            }, e.prototype.onChatRequest = function(t) {
                this.chatInput && (this.world.socket.sendMessage(o.PlayerChatRequest, {
                    message: t
                }), this.stopInput())
            }, e.prototype.onChatCancel = function() {
                this.stopInput()
            }, e.prototype.stopInput = function() {
                this.chatInput && (this.chatInput.destroy(), this.world.game.input.keyboard.reset(!1), this.world.game.input.keyboard.enabled = !0, this.chatInput = null)
            }, e.prototype.align = function() {
                if (this.chatInput) {
                    var t = this.cachedTransform.position.y + this.offset;
                    if (this.cachedSprite && (t -= this.cachedSprite.sprite.height / 2), this.world.game.scale.scaleMode === Phaser.ScaleManager.USER_SCALE) {
                        var e = this.cachedTransform.position.x - this.world.game.camera.x;
                        e = e / this.world.game.scale.scaleFactor.x - this.world.game.screenOffsetWidth, t = (t -= this.world.game.camera.y) / this.world.game.scale.scaleFactor.y - this.world.game.screenOffsetHeight, this.chatInput.setposition(e, t)
                    } else this.chatInput.setposition(this.cachedTransform.position.x - this.world.game.camera.x, t - this.world.game.camera.y)
                }
            }, e.prototype.update = function(e) {
                t.prototype.update.call(this, e), this.align(), this.escapeKey.isDown && this.stopInput()
            }, e.prototype.destroy = function() {
                this.stopInput(), this.returnKey.onDown.remove(this.onReturnKey, this)
            }, e
        }(n.Component);
    e.default = a
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            var e = t.call(this) || this;
            return e.isOpened = !1, e
        }
        return s(e, t), e.prototype.start = function() {
            t.prototype.start.call(this), this.entity.on("networksync", this.onNetworkSync.bind(this))
        }, e.prototype.set = function(t) {
            this.cachedSpriteComponent.sprite.frameName = t
        }, e.prototype.onNetworkSync = function(t) {
            var e = !1;
            t.hasOwnProperty("isOpened") && (this.isOpened = t.isOpened, e = !0), e && (this.isOpened ? this.set("door_open.png") : this.set("door_close.png"))
        }, e
    }(i(6).default);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e(e) {
            var i = t.call(this) || this;
            return i.id = "entitybadge", i.showBadge = !0, i.desiredAlpha = 1, i.offset = e, i
        }
        return s(e, t), e.prototype.start = function() {
            this.entity.on("networksync", this.onNetworkSync.bind(this)), this.cachedTransform = this.entity.components.transform, this.cachedSprite = this.entity.components.sprite, this.badge = this.world.game.add.text(this.cachedTransform.position.x, this.cachedTransform.position.y + this.offset - this.cachedSprite.sprite.height / 2, " ", {
                fontSize: "18px",
                font: "FontAwesome"
            }), this.badge.anchor.set(.5, 1), this.badge.strokeThickness = 2, this.badge.cssFont = "bold 24px 'FontAwesome'", this.badge.fill = "rgba(89,178,255,1)", this.badge.stroke = "rgba(0,0,0,0)", this.badge.alpha = 1, this.entity.on("alpha", function(t) {
                this.desiredAlpha = t.alpha, this.updateLabels()
            }.bind(this)), this.updateLabels()
        }, e.prototype.updateLabels = function() {
            this.badge.fill = "rgba(255,100,100,1)", this.badge.stroke = "rgba(0,0,0,0)", this.showBadge ? this.badge.alpha = this.desiredAlpha : this.badge.alpha = 0, this.badge.cssFont = "bold 24px 'FontAwesome'", this.badge.setText(" "), setTimeout(function() {
                this && this.badge && this.badge.setText(" ")
            }.bind(this), 500)
        }, e.prototype.align = function() {
            var t = this.cachedTransform.position.x,
                e = this.cachedTransform.position.y + this.offset - this.cachedSprite.sprite.height / 2;
            this.badge.position.set(t, e)
        }, e.prototype.onNetworkSync = function(t) {}, e.prototype.update = function(t) {
            this.align()
        }, e.prototype.destroy = function() {
            this.badge.destroy()
        }, e
    }(i(0).Component);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            return t.call(this) || this
        }
        return s(e, t), e.prototype.start = function() {
            t.prototype.start.call(this), this.addAnimation("fire", Phaser.Animation.generateFrameNames("fire", 1, 8, ".png", 0), 15, !0), this.cachedSpriteComponent.sprite.animations.play("fire")
        }, e.prototype.update = function(e) {
            t.prototype.update.call(this, e), this.cachedTransform.isMoving() && (this.cachedTransform.rotation = this.cachedTransform.angle())
        }, e.prototype.destroy = function() {}, e
    }(i(6).default);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            return t.call(this) || this
        }
        return s(e, t), e.prototype.start = function() {
            t.prototype.start.call(this), this.addAnimation("walk", Phaser.Animation.generateFrameNames("walk", 1, 8, ".png", 0), 15, !0), this.walk()
        }, e.prototype.walk = function() {
            this.play("walk")
        }, e.prototype.update = function(e) {
            t.prototype.update.call(this, e), this.cachedTransform.isMoving() ? this.walk() : this.cachedSpriteComponent.sprite.animations.stop()
        }, e.prototype.destroy = function() {}, e
    }(i(6).default);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(2).Protocol.HatType,
        r = i(3),
        a = function(t) {
            function e(e) {
                var i = t.call(this) || this;
                return i.id = "hat", i.hatId = -1, i.currentTintColor = 16777215, i.currentScale = 1, i.layer = e, i
            }
            return s(e, t), e.prototype.start = function() {
                this.cachedTransform = this.entity.components.transform, this.entity.on("networksync", this.onNetworkSync.bind(this)), this.entity.on("alpha", function(t) {
                    this.hatSprite && (this.hatSprite.alpha = t.alpha)
                }.bind(this))
            }, e.prototype.update = function(t) {
                if (this.hatSprite && (this.hatSprite.position.copyFrom(this.cachedTransform.position), this.hatSprite.rotation = this.cachedTransform.rotation, this.hatId === o.ChessHat)) {
                    var e = this.hatSprite.getChildAt(0);
                    e && (e.rotation = e.rotation + .1, e.rotation > 100 && (e.rotation = e.rotation % Math.PI))
                }
            }, e.prototype.onNetworkSync = function(t) {
                t.hasOwnProperty("hatId") && this.hatId !== t.hatId && this.setHat(t.hatId)
            }, e.prototype.setHat = function(t) {
                if (this.hatId = t, this.hatSprite && (this.hatSprite.destroy(), this.hatSprite = null), t > -1) {
                    if (this.hatSprite = this.layer.create(this.cachedTransform.position.x, this.cachedTransform.position.y, this.getHatSprite(t)), this.hatSprite.anchor.set(.5, .5), t === o.ChessHat) {
                        var e = this.world.game.make.image(0, 0, r.Images.ImagesChesshatrot.getName());
                        e.anchor.set(.5, .5), this.hatSprite.addChild(e), e.position.set(0, 0)
                    }
                    this.setScale(this.currentScale), this.setColor(this.currentTintColor)
                }
                this.hatId === o.HiddenHat ? this.entity.emit("alpha", {
                    alpha: .2
                }) : this.entity.emit("alpha", {
                    alpha: 1
                })
            }, e.prototype.getHatSprite = function(t) {
                var e = "entity_" + o[t];
                return this.world.load.cache.checkImageKey(e) ? e : "entity_WhiteBearHat"
            }, e.prototype.setScale = function(t) {
                this.currentScale = t, this.hatSprite && this.hatSprite.scale.set(t, t)
            }, e.prototype.setColor = function(t) {
                this.currentTintColor = t, this.hatSprite && (this.hatSprite.tint = t)
            }, e.prototype.getHatId = function() {
                return this.hatId
            }, e.prototype.destroy = function() {
                this.hatSprite && (this.hatSprite.destroy(), this.hatSprite = null)
            }, e
        }(n.Component);
    e.default = a
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(4),
        r = function(t) {
            function e() {
                var e = t.call(this) || this;
                return e.id = "localrotationinput", e.lockTimeout = 0, e
            }
            return s(e, t), e.prototype.start = function() {
                this.cachedTransform = this.entity.components.transform, this.entity.on("senddamage", this.onSendDamage.bind(this))
            }, e.prototype.onSendDamage = function(t) {
                this.lockTimeout = .5, this.latestPunchRotation = Phaser.Math.angleBetween(0, 0, t.directionX, t.directionY) + Phaser.Math.degToRad(90)
            }, e.prototype.update = function(t) {
                if (this.lockTimeout > 0) this.lockTimeout -= t, this.cachedTransform.rotation = this.latestPunchRotation;
                else {
                    var e = Phaser.Math.angleBetween(0, 0, this.world.game.input.activePointer.worldX - this.cachedTransform.position.x, this.world.game.input.activePointer.worldY - this.cachedTransform.position.y);
                    e += Phaser.Math.degToRad(90), e = parseFloat(e.toPrecision(2)), this.cachedTransform.rotation = o.RotationInterpolator.interpolateAngle(this.cachedTransform.rotation, e, 12 * t)
                }
            }, e.prototype.destroy = function() {}, e
        }(n.Component);
    e.default = r
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(2).Protocol.MessageType,
        r = i(17),
        a = function(t) {
            function e() {
                var e = t.call(this) || this;
                return e.id = "networkinput", e.currentInput = new Phaser.Point, e.currentRotation = 0, e.previousInput = new Phaser.Point, e.previousRotation = 0, e.punchDirection = new Phaser.Point, e.needSendPunch = !1, e._lockPunchUntilMouseUp = !1, e.lastPunch = 0, e.autoSwing = !1, e
            }
            return s(e, t), e.prototype.lockPunchUntilMouseUp = function() {
                this._lockPunchUntilMouseUp = !0
            }, e.prototype.onNetworkSend = function() {
                this.previousInput.equals(this.currentInput) && this.previousRotation === this.currentRotation || (this.world.socket.sendMessage(o.PlayerInput, {
                    x: this.currentInput.x,
                    y: this.currentInput.y,
                    rotation: this.currentRotation
                }), this.previousInput.copyFrom(this.currentInput), this.previousRotation = this.currentRotation);
                var t = Date.now();
                this.needSendPunch && t - this.lastPunch > 150 && (this.lastPunch = t, this.punchDirection.normalize(), this.world.socket.sendMessage(o.PlayerAction, {
                    x: this.punchDirection.x,
                    y: this.punchDirection.y,
                    action: 0
                }), this.needSendPunch = !1)
            }, e.prototype.start = function() {
                this.cachedTransform = this.entity.components.transform, this.entity.on("networksend", this.onNetworkSend.bind(this)), this.cursors = this.world.game.input.keyboard.createCursorKeys(), this.wasd = {
                    up: this.world.game.input.keyboard.addKey(Phaser.Keyboard.W),
                    down: this.world.game.input.keyboard.addKey(Phaser.Keyboard.S),
                    left: this.world.game.input.keyboard.addKey(Phaser.Keyboard.A),
                    right: this.world.game.input.keyboard.addKey(Phaser.Keyboard.D)
                };
                var t = this.world.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);
                t.onDown.removeAll(), t.onDown.add(function() {
                    this.autoSwing = !this.autoSwing, this.punch()
                }.bind(this)), this.world.game.input.onDown.add(this.onMouseDown, this)
            }, e.prototype.onMouseDown = function() {
                this.autoSwing = !1, this.world.services.getService(r.default).inProgress() || this.punch()
            }, e.prototype.punch = function() {
                this.punchDirection.set(this.world.game.input.activePointer.worldX - this.cachedTransform.position.x, this.world.game.input.activePointer.worldY - this.cachedTransform.position.y), this.needSendPunch = !0, this.entity.emit("sendpunch")
            }, e.prototype.update = function(t) {
                var e = 0,
                    i = 0;
                if (this.cursors.up.isDown || this.wasd.up.isDown ? i = -1 : (this.cursors.down.isDown || this.wasd.down.isDown) && (i = 1), this.cursors.left.isDown || this.wasd.left.isDown ? e = -1 : (this.cursors.right.isDown || this.wasd.right.isDown) && (e = 1), 0 == e && 0 == i || (this.autoSwing = !1), this.autoSwing && (this.needSendPunch = !0), this.currentInput.set(e, i), !this.autoSwing) {
                    var s = Phaser.Math.angleBetween(0, 0, this.world.game.input.activePointer.worldX - this.cachedTransform.position.x, this.world.game.input.activePointer.worldY - this.cachedTransform.position.y);
                    s += Phaser.Math.degToRad(90), s = parseFloat(s.toPrecision(2)), this.currentRotation = s
                }
                this.world.game.input.activePointer.isDown ? this._lockPunchUntilMouseUp || this.onMouseDown() : this._lockPunchUntilMouseUp && (this._lockPunchUntilMouseUp = !1)
            }, e.prototype.destroy = function() {
                this.world.game.input.onDown.remove(this.onMouseDown, this)
            }, e
        }(n.Component);
    e.default = a
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            var e = t.call(this) || this;
            return e.transportId = -1, e
        }
        return s(e, t), e.prototype.start = function() {
            t.prototype.start.call(this), this.entity.on("networksync", this.onNetworkSync.bind(this)), this.entity.on("senddamage", this.onSendDamage.bind(this)), this.addAnimation("walk", Phaser.Animation.generateFrameNames("walk", 1, 12, "", 0), 30, !0), this.addAnimation("pigwalk", ["walk4"], 15, !0), this.addAnimation("punch", ["walk4"], 40, !1).onComplete.add(function() {
                this.walk()
            }.bind(this)), this.addAnimation("pigpunch", ["walk4"], 30, !1).onComplete.add(function() {
                this.walk()
            }.bind(this)), this.walk()
        }, e.prototype.onNetworkSync = function(t) {
            t.hasOwnProperty("transportId") && (this.transportId = t.transportId)
        }, e.prototype.walk = function() {
            try {
                this.transportId > -1 ? this.play("pigwalk") : (this.play("walk"), this.cachedSpriteComponent.walk())
            } catch (t) {}
        }, e.prototype.onSendDamage = function(t) {
            try {
                this.transportId, this.cachedSpriteComponent.attack()
            } catch (t) {}
        }, e.prototype.update = function(e) {
            t.prototype.update.call(this, e), "punch" !== this.getCurrentName() && "pigpunch" !== this.getCurrentName() && (this.cachedTransform.isMoving() ? this.walk() : (this.cachedSpriteComponent.sprite.animations.stop(), this.cachedSpriteComponent.stop()))
        }, e.prototype.destroy = function() {}, e
    }(i(6).default);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(3),
        r = function(t) {
            function e(e) {
                var i = t.call(this) || this;
                return i.id = "teamlabel", i.labelColor = "#ffffff", i.isAdmin = !1, i.offset = e, i
            }
            return s(e, t), e.prototype.start = function() {
                this.entity.on("networksync", this.onNetworkSync.bind(this)), this.cachedTransform = this.entity.components.transform, this.cachedSprite = this.entity.components.sprite, this.label = this.world.game.add.text(this.cachedTransform.position.x, this.cachedTransform.position.y + this.offset - this.cachedSprite.sprite.height / 2, "", {
                    fontSize: "18px",
                    font: "Roboto Mono"
                }), this.label.anchor.set(.5, 1), this.label.stroke = "rgba(0,0,0,0.7)", this.label.strokeThickness = 3, this.label.fill = this.labelColor, this.crownImage = this.world.make.image(this.cachedTransform.position.x, this.cachedTransform.position.y + this.offset, o.Images.ImagesCrown.getName()), this.crownImage.scale.set(.5, .5), this.crownImage.anchor.set(.5, .5), this.entity.on("alpha", function(t) {
                    t.alpha, this.crownImage.alpha = t.alpha, this.label.alpha = t.alpha
                }.bind(this))
            }, e.prototype.setTeamName = function(t) {
                this.teamName = t, this.label.setText(this.teamName)
            }, e.prototype.setColor = function(t) {
                this.labelColor = t, this.label.fill = this.labelColor
            }, e.prototype.align = function() {
                var t = this.cachedTransform.position.x,
                    e = this.cachedTransform.position.y + this.offset - this.cachedSprite.sprite.height / 2;
                this.label.position.set(t, e), this.crownImage.position.set(t - this.label.width / 2 - 16, e - 18)
            }, e.prototype.onNetworkSync = function(t) {
                var e = !1;
                t.hasOwnProperty("teamName") && (this.teamName = t.teamName, e = !0), t.hasOwnProperty("isTeamAdmin") && (this.isAdmin = t.isTeamAdmin, e = !0), e && (this.teamName ? this.label.setText("[" + this.teamName + "]") : this.label.setText(""), this.isAdmin ? this.crownImage.parent !== this.world.LAYER_UI && this.world.LAYER_UI.add(this.crownImage) : this.crownImage.parent === this.world.LAYER_UI && this.crownImage.parent.removeChild(this.crownImage), this.label.width > 250 && (this.label.width = 250))
            }, e.prototype.update = function(t) {
                this.align()
            }, e.prototype.destroy = function() {
                this.label.destroy(), this.crownImage.destroy()
            }, e
        }(n.Component);
    e.default = r
}, function(t, e, i) {
    "use strict";
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var s = i(12),
        n = i(28),
        o = i(15),
        r = i(95),
        a = i(2),
        h = i(3),
        l = a.Protocol.EntityType,
        c = i(112),
        u = i(111),
        d = i(97),
        p = i(96),
        f = i(113),
        m = function() {
            function t() {}
            return t.create = function(t, e, i, a) {
                switch (void 0 === a && (a = -1), t) {
                    case l.Spectator:
                        return new n.default(e, i, a);
                    case l.Player:
                        return new o.default(e, i, a);
                    case l.FollowerBot:
                        return new p.FollowerBot(e, i, a);
                    case l.FarmerBot:
                        return new p.FarmerBot(e, i, a);
                    case l.GuardBot:
                        return new p.GuardBot(e, i, a);
                    case l.WoodGenerator:
                        return new u.WoodGenerator(e, i, a);
                    case l.StoneGenerator:
                        return new u.StoneGenerator(e, i, a);
                    case l.Pig:
                        return new r.Pig(e, i, a);
                    case l.Chicken:
                        return new r.Chicken(e, i, a);
                    case l.Wolf:
                        return new r.Wolf(e, i, a);
                    case l.Bear:
                        return new r.Bear(e, i, a);
                    case l.Spider:
                        return new r.Spider(e, i, a);
                    case l.RideablePig:
                        return new r.RideablePig(e, i, a);
                    case l.PigMeatPickup:
                        return new c.PigMeatPickup(e, i, a);
                    case l.BearMeatPickup:
                        return new c.BearMeatPickup(e, i, a);
                    case l.EggPickup:
                        return new c.EggPickup(e, i, a);
                    case l.CarrotPickup:
                        return new c.CarrotPickup(e, i, a);
                    case l.BoxPickup:
                        return new c.BoxPickup(e, i, a);
                    case l.WoodBlock:
                        return new d.WoodBlock(e, i, a);
                    case l.StoneBlock:
                        return new d.StoneBlock(e, i, a);
                    case l.Door:
                        return new d.Door(e, i, a);
                    case l.Garden:
                        return new d.Garden(e, i, a);
                    case l.Tower:
                        return new d.Tower(e, i, a);
                    case l.Heartstone:
                        return new d.Heartstone(e, i, a);
                    case l.HealWard:
                        return new d.HealWard(e, i, a);
                    case l.FoodCrate:
                        return new d.FoodCrate(e, i, a);
                    case l.WoodCrate:
                        return new d.WoodCrate(e, i, a);
                    case l.StoneCrate:
                        return new d.StoneCrate(e, i, a);
                    case l.SoulCrate:
                        return new d.SoulCrate(e, i, a);
                    case l.RideableWolf:
                        return new r.RideableWolf(e, i, a);
                    case l.Mannequin:
                        return new d.Mannequin(e, i, a);
                    case l.GardenBot:
                        return new p.GardenBot(e, i, a);
                    case l.WhiteBear:
                        return new r.WhiteBear(e, i, a);
                    case l.Troll:
                        return new r.Troll(e, i, a);
                    case l.WinterStoneGenerator:
                        return new u.WinterStoneGenerator(e, i, a);
                    case l.WinterWoodGenerator:
                        return new u.WinterWoodGenerator(e, i, a);
                    case l.SoccerBall:
                        return new d.SoccerBall(e, i, a);
                    case l.FireballBullet:
                        return new d.FireballBullet(e, i, a);
                    case l.NightmareBoss:
                        return new p.GardenBot(e, i, a);
                    case l.WhiteWalker:
                        return new r.WhiteWalker(e, i, a);
                    case l.WinterWall:
                        return new f.WinterWall(e, i, a);
                    case l.WinterFloor:
                        return new f.WinterFloor(e, i, a);
                    case l.WinterTower:
                        return new f.WinterTower(e, i, a);
                    case l.WhiteBearHat:
                        return new c.WhiteBearHat(e, i, a);
                    case l.BrownBearHat:
                        return new c.BrownBearHat(e, i, a);
                    case l.CowboyHat:
                        return new c.CowboyHat(e, i, a);
                    case l.ChessHat:
                        return new c.ChessHat(e, i, a);
                    case l.ChickenHat:
                        return new c.ChickenHat(e, i, a);
                    case l.CoinPickup:
                        return new c.CoinPickup(e, i, a);
                    case l.WoodSpikes:
                        return new d.WoodSpikes(e, i, a);
                    case l.IronSpikes:
                        return new d.IronSpikes(e, i, a);
                    case l.Portal:
                        return new d.Portal(e, i, a);
                    case l.BuilderHat:
                        return new c.BuilderHat(e, i, a);
                    case l.CatHat:
                        return new c.CatHat(e, i, a);
                    case l.FoxHat:
                        return new c.FoxHat(e, i, a);
                    case l.VikingHat:
                        return new c.VikingHat(e, i, a);
                    case l.HockeyHat:
                        return new c.HockeyHat(e, i, a);
                    case l.SoulPickup:
                        return new c.SoulPickup(e, i, a);
                    case l.RideableBear:
                        return new r.RideableBear(e, i, a);
                    case l.RideableDragon:
                        return new r.RideableDragon(e, i, a);
                    case l.DarkDoor:
                        return new d.DarkDoor(e, i, a);
                    case l.CrystalDoor:
                        return new d.CrystalDoor(e, i, a);
                    case l.CrystalWall:
                        return new d.CrystalWall(e, i, a);
                    case l.DarkGuardBot:
                        return new p.DarkGuardBot(e, i, a);
                    case l.DarkStoneBlock:
                        return new d.DarkStoneBlock(e, i, a);
                    case l.TankHat:
                        return new c.TankHat(e, i, a);
                    case l.DruidHat:
                        return new c.DruidHat(e, i, a);
                    case l.IceHat:
                        return new c.IceHat(e, i, a);
                    case l.GoldIceHat:
                        return new c.GoldIceHat(e, i, a);
                    case l.HiddenHat:
                        return new c.HiddenHat(e, i, a);
                    case l.WoodFloor:
                        return new d.WoodFloor(e, i, a);
                    case l.StoneFloor:
                        return new d.StoneFloor(e, i, a);
                    case l.MarbleFloor:
                        return new d.MarbleFloor(e, i, a)
                }
                return new s.BasicEntity(e, i, a, e.LAYER_BACKGROUND_1, h.Images.ImagesUnknown.getName())
            }, t
        }();
    e.EntityFactory = m
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(12),
        o = function(t) {
            function e(e, i, s) {
                return t.call(this, e, i, s, e.LAYER_FOREGROUND_0, "entity_WoodGenerator") || this
            }
            return s(e, t), e
        }(n.BasicEntity);
    e.WoodGenerator = o;
    var r = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_BACKGROUND_0, "entity_StoneGenerator") || this
        }
        return s(e, t), e
    }(n.BasicEntity);
    e.StoneGenerator = r;
    var a = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_BACKGROUND_0, "entity_FoodGenerator") || this
        }
        return s(e, t), e
    }(n.BasicEntity);
    e.FoodGenerator = a;
    var h = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_FOREGROUND_0, "entity_WinterWoodGenerator") || this
        }
        return s(e, t), e
    }(n.BasicEntity);
    e.WinterWoodGenerator = h;
    var l = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, s, e.LAYER_BACKGROUND_0, "entity_WinterStoneGenerator") || this
        }
        return s(e, t), e
    }(n.BasicEntity);
    e.WinterStoneGenerator = l
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(5),
        r = i(4),
        a = i(7),
        h = function(t) {
            function e(e, i, s, n) {
                var h = t.call(this, e, i, -1) || this;
                return h.addComponent(new o.default), h.addComponent(new r.default), h.addComponent(new a.default(s, n, new Phaser.Point(.5, .5))), h
            }
            return s(e, t), e
        }(n.Entity);
    e.default = h;
    var l = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_PigMeatPickup") || this
        }
        return s(e, t), e
    }(h);
    e.PigMeatPickup = l;
    var c = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_BearMeatPickup") || this
        }
        return s(e, t), e
    }(h);
    e.BearMeatPickup = c;
    var u = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_EggPickup") || this
        }
        return s(e, t), e
    }(h);
    e.EggPickup = u;
    var d = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_SoulPickup") || this
        }
        return s(e, t), e
    }(h);
    e.SoulPickup = d;
    var p = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_1, "entity_CarrotPickup") || this
        }
        return s(e, t), e
    }(h);
    e.CarrotPickup = p;
    var f = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_BoxPickup") || this
        }
        return s(e, t), e
    }(h);
    e.BoxPickup = f;
    var m = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_CoinPickup") || this
        }
        return s(e, t), e
    }(h);
    e.CoinPickup = m;
    var g = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_WhiteBearHat") || this
        }
        return s(e, t), e
    }(h);
    e.WhiteBearHat = g;
    var y = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_BrownBearHat") || this
        }
        return s(e, t), e
    }(h);
    e.BrownBearHat = y;
    var v = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_ChessHat") || this
        }
        return s(e, t), e
    }(h);
    e.ChessHat = v;
    var b = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_CowboyHat") || this
        }
        return s(e, t), e
    }(h);
    e.CowboyHat = b;
    var _ = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_ChickenHat") || this
        }
        return s(e, t), e
    }(h);
    e.ChickenHat = _;
    var w = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_VikingHat") || this
        }
        return s(e, t), e
    }(h);
    e.VikingHat = w;
    var x = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_CatHat") || this
        }
        return s(e, t), e
    }(h);
    e.CatHat = x;
    var P = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_FoxHat") || this
        }
        return s(e, t), e
    }(h);
    e.FoxHat = P;
    var T = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_BuilderHat") || this
        }
        return s(e, t), e
    }(h);
    e.BuilderHat = T;
    var C = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_HockeyHat") || this
        }
        return s(e, t), e
    }(h);
    e.HockeyHat = C;
    var S = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_TankHat") || this
        }
        return s(e, t), e
    }(h);
    e.TankHat = S;
    var A = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_DruidHat") || this
        }
        return s(e, t), e
    }(h);
    e.DruidHat = A;
    var E = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_IceHat") || this
        }
        return s(e, t), e
    }(h);
    e.IceHat = E;
    var k = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_GoldIceHat") || this
        }
        return s(e, t), e
    }(h);
    e.GoldIceHat = k;
    var M = function(t) {
        function e(e, i, s) {
            return t.call(this, e, i, e.LAYER_BACKGROUND_0, "entity_HiddenHat") || this
        }
        return s(e, t), e
    }(h);
    e.HiddenHat = M
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(0),
        o = i(5),
        r = i(4),
        a = i(7),
        h = function(t) {
            function e(e, i, s) {
                var n = t.call(this, e, i, s) || this;
                return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_FOREGROUND_0, "entity_WinterWall", new Phaser.Point(.5, .5))), n
            }
            return s(e, t), e
        }(n.Entity);
    e.WinterWall = h;
    var l = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_BACKGROUND_0, "entity_WinterFloor", new Phaser.Point(.5, .5))), n
        }
        return s(e, t), e
    }(n.Entity);
    e.WinterFloor = l;
    var c = function(t) {
        function e(e, i, s) {
            var n = t.call(this, e, i, s) || this;
            return n.addComponent(new o.default), n.addComponent(new r.default), n.addComponent(new a.default(e.LAYER_FOREGROUND_0, "entity_WinterTower", new Phaser.Point(.5, .5))), n
        }
        return s(e, t), e
    }(n.Entity);
    e.WinterTower = c
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(11),
        o = i(1),
        r = i(2).Protocol.MessageType,
        a = i(3),
        h = i(19),
        l = i(18),
        c = i(30),
        u = function(t) {
            function e() {
                var e = t.call(this) || this;
                return e.element = document.getElementById("top-panel"), e
            }
            return s(e, t), e
        }(n.MenuContainer),
        d = function(t) {
            function e(e, i, s, n, o) {
                var r = t.call(this, s, n) || this;
                return r.world = e, r.element.className = "item", r.element.innerHTML = '\n            <img src="' + i + '" />\n            <div class="hotkey" id="' + s + ':hotkey">' + o + "</div>\n        ", r
            }
            return s(e, t), e.prototype.onClick = function() {
                t.prototype.onClick.call(this)
            }, e.prototype.action = function() {
                this.world.services.getService(p).requestWork(this.name)
            }, e
        }(n.MenuItem),
        p = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                return i.actionMenu = new u, i.actionMenu.appendChild(new d(i.world, a.Images.ImagesBuild.getPNG(), "shop-show", "B", "B")), i.actionMenu.appendChild(new d(i.world, a.Images.ImagesUnmount.getPNG(), "unmount", "U", "U")), i.actionMenu.appendChild(new d(i.world, a.Images.ImagesTeam.getPNG(), "team", "T", "T")), i.actionMenu.appendChild(new d(i.world, a.Images.ImagesCowboyhaticon.getPNG(), "hat", "H", "H")), i.actionMenu.appendChild(new d(i.world, a.Images.ImagesSword.getPNG(), "weapon", "F", "F")), i
            }
            return s(e, t), e.prototype.requestWork = function(t) {
                "shop-show" === t ? this.world.services.getService(n.CraftMenuService).shopMenu.toggle() : "unmount" === t ? this.world.socket.sendMessage(r.PlayerUnmountRequest, {}) : "team" === t ? this.world.services.getService(h.default).toggle() : "hat" === t ? this.world.services.getService(l.default).toggle() : "weapon" === t && this.world.services.getService(c.default).toggle()
            }, e
        }(o.Service);
    e.ActionService = p
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(2).Protocol.ResourceType,
        r = i(3),
        a = function(t) {
            function e(e) {
                return t.call(this, e) || this
            }
            return s(e, t), e.prototype.float = function(t, e, i) {
                for (var s = 0, n = function(n) {
                        var r = n,
                            a = i[n];
                        a > 0 && (o.world.game.time.events.add(.4 * Phaser.Timer.SECOND * s, function() {
                            this._float(t, e, r, a)
                        }, o), s++)
                    }, o = this, r = 0; r < i.length; r++) n(r)
            }, e.prototype._float = function(t, e, i, s) {
                var n = this.world.game.add.text(t, e, "+" + s + " " + o[i], {
                    font: "20px " + r.GoogleWebFonts.RobotoMono
                });
                n.anchor.set(.5, 1), n.stroke = "#000000", n.strokeThickness = 3, n.fill = "#00ff00";
                var a = this.world.game.add.tween(n);
                a.to({
                    y: n.y - 60
                }), a.onComplete.add(function() {
                    n.destroy()
                }, this), a.start()
            }, e
        }(n.Service);
    e.default = a
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(2),
        r = o.Protocol.MessageType,
        a = i(10),
        h = o.Protocol.EntityType,
        l = i(3),
        c = Phaser.Rectangle,
        u = i(31),
        d = i(29),
        p = o.Protocol.HatType,
        f = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                return i.x_ratio = 150 / 25600, i.y_ratio = 150 / 25600, i.minimapWinnerImage = i.world.game.make.image(0, 0, l.Images.ImagesMinimapwinner.getName()), i.minimapWalkerImage = i.world.game.make.image(0, 0, l.Images.ImagesMinimapwalker.getName()), i.bitmapData = i.world.game.add.bitmapData(150, 150), i.image = i.bitmapData.addToWorld(), i.image.fixedToCamera = !0, i.image.cameraOffset.setTo(15, i.world.game.height - 170), i.image.alpha = .7, i.image.inputEnabled = !0, i.image.events.onInputDown.add(i.onMouseDown, i), i.teleportKey = i.world.game.input.keyboard.addKey(Phaser.Keyboard.G), i.teleportKey.onDown.add(i.onKeyDown, i), i.childService = e.services.getService(a.default), i.preRenderBitmapData = i.world.game.add.bitmapData(150, 150), i.initializePrerendered(), i
            }
            return s(e, t), e.prototype.initializePrerendered = function() {
                this.preRenderBitmapData.clear(0, 0, this.preRenderBitmapData.width, this.preRenderBitmapData.height);
                for (var t = 0, e = this.world.game.cache.getTilemapData("mapdata").data.layers; t < e.length; t++) {
                    var i = e[t];
                    if ("objectgroup" === i.type)
                        for (var s = 0, n = i.objects; s < n.length; s++) {
                            var o = n[s],
                                r = o.x,
                                a = o.y;
                            "woodgenerator" === o.type || "winterwoodgenerator" === o.type ? (this.preRenderBitmapData.ctx.beginPath(), this.preRenderBitmapData.ctx.rect(r * this.x_ratio - 1, a * this.y_ratio - 1, 2, 2), this.preRenderBitmapData.ctx.fillStyle = "#00ff00", this.preRenderBitmapData.ctx.fill()) : "stonegenerator" !== o.type && "winterstonegenerator" !== o.type || (this.preRenderBitmapData.ctx.beginPath(), this.preRenderBitmapData.ctx.rect(r * this.x_ratio - 1, a * this.y_ratio - 1, 2, 2), this.preRenderBitmapData.ctx.fillStyle = "#ffffff", this.preRenderBitmapData.ctx.fill())
                        }
                }
            }, e.prototype.drawMinimapObject = function(t, e, i, s, n, o, r, a, h) {
                this.bitmapData.ctx.beginPath(), i >= -1 ? this.world.id === t ? t === r ? this.bitmapData.draw(this.minimapWinnerImage, n - 5, o - 5, 10, 10) : (this.bitmapData.ctx.rect(n - 4, o - 4, 10, 10), this.bitmapData.ctx.fillStyle = s < 0 ? "#00aa00" : "#00ff00") : this.world.networkId === e ? (this.bitmapData.ctx.rect(n - 2, o - 2, 5, 5), this.bitmapData.ctx.fillStyle = "#00bb00") : this.world.teamId === i && i > -1 ? t === r ? this.bitmapData.draw(this.minimapWinnerImage, n - 5, o - 5, 10, 10) : (this.bitmapData.ctx.rect(n - 2, o - 2, 6, 6), this.bitmapData.ctx.fillStyle = "#00bb00") : s > 0 && (!a || h) && (t === r ? this.bitmapData.draw(this.minimapWinnerImage, n - 5, o - 5, 10, 10) : (this.bitmapData.ctx.rect(n - 1, o - 1, 4, 4), this.bitmapData.ctx.fillStyle = "#ff0000")) : -2 === i && a && this.drawWhiteWalker(n, o), this.bitmapData.ctx.fill()
            }, e.prototype.drawWhiteWalker = function(t, e) {
                this.bitmapData.draw(this.minimapWalkerImage, t - 5, e - 5, 10, 10)
            }, e.prototype.onMapMessage = function(t) {
                var e = -1,
                    i = new Phaser.Point(0, 0);
                this.world.assignedObject && (this.world.assignedObject.components.hat && (e = this.world.assignedObject.components.hat.getHatId()), this.world.assignedObject.components.transform && (i = this.world.assignedObject.components.transform.position));
                var s = this.world.services.getService(u.default).topId,
                    n = this.world.services.getService(d.default).isDark();
                this.bitmapData.clear(0, 0, this.bitmapData.width, this.bitmapData.height), this.bitmapData.ctx.beginPath(), this.bitmapData.ctx.rect(0, 0, 150, 150), this.bitmapData.ctx.fillStyle = "#222222", this.bitmapData.ctx.fill(), this.bitmapData.copyRect(this.preRenderBitmapData, new c(0, 0, this.bitmapData.width, this.bitmapData.height), 0, 0, .2);
                for (var o = 0; o < this.childService.childs.length; o++) {
                    var r = this.childService.childs[o],
                        a = r.position.x * this.x_ratio,
                        l = r.position.y * this.y_ratio,
                        f = r.objectType;
                    f === h.Tower ? (this.bitmapData.ctx.beginPath(), this.bitmapData.ctx.rect(a - 3, l - 3, 6, 6), this.bitmapData.ctx.fillStyle = "#aaaaaa", this.bitmapData.ctx.fill()) : f !== h.StoneBlock && f !== h.WoodBlock || (this.bitmapData.ctx.beginPath(), this.bitmapData.ctx.rect(a - 1, l - 1, 2, 2), this.bitmapData.ctx.fillStyle = "#aaaaaa", this.bitmapData.ctx.fill())
                }
                var m = t.content.data,
                    g = t.content.teamIdData;
                for (o = 0; o < m.length; o += 5) {
                    var y = m[o],
                        v = (a = m[o + 1] * this.x_ratio, l = m[o + 2] * this.y_ratio, m[o + 3]),
                        b = m[o + 4],
                        _ = g[o / 5];
                    e === p.FoxHat && Phaser.Math.distance(m[o + 1], m[o + 2], i.x, i.y) < 5e3 ? this.drawMinimapObject(y, b, _, v, a, l, s, n, !0) : e === p.CatHat ? this.drawMinimapObject(y, b, _, v, a, l, s, n, !0) : this.drawMinimapObject(y, b, _, v, a, l, s, n, !1)
                }
            }, e.prototype.update = function(t) {
                this.world.game.scale.scaleMode === Phaser.ScaleManager.USER_SCALE ? this.image.cameraOffset.setTo(20 + this.world.game.screenOffsetWidth * this.world.game.scale.scaleFactor.x, this.world.game.height - 170 - this.world.game.screenOffsetHeight * this.world.scale.scaleFactor.y) : this.world.game.scale.scaleMode === Phaser.ScaleManager.RESIZE && this.image.cameraOffset.setTo(20, this.world.game.height - 170)
            }, e.prototype.destroy = function() {
                this.image.destroy(), this.bitmapData.destroy(), this.teleportKey.onDown.remove(this.onKeyDown, this)
            }, e.prototype.onKeyDown = function(t, e) {
                this.teleportToMouse(this.world.game.input.activePointer)
            }, e.prototype.onMouseDown = function(t, e) {
                var i = this.world.game.input.activePointer.leftButton.isDown,
                    s = this.world.game.input.keyboard.isDown(Phaser.KeyCode.SHIFT);
                try {
                    this.world.assignedObject.components.label.rankStatus > 1 && i && s && this.teleportToMouse(e)
                } catch (t) {}
            }, e.prototype.teleportToMouse = function(t) {
                t.position.subtract(this.image.cameraOffset.x, this.image.cameraOffset.y);
                var e = t.position.x / 150 * this.world.game.world.bounds.width,
                    i = t.position.y / 150 * this.world.game.world.bounds.height;
                this.world.socket.sendMessage(r.PlayerChatRequest, {
                    message: "/tp " + e + " " + i
                })
            }, e
        }(n.Service);
    e.default = f
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e(e) {
            var i = t.call(this, e) || this;
            return i.updateTimeoutMax = .05, i.updateTimeout = 0, i
        }
        return s(e, t), e.prototype.update = function(t) {
            this.updateTimeout -= t, this.updateTimeout <= 0 && (this.updateTimeout = this.updateTimeoutMax, this.sendUpdate())
        }, e.prototype.sendUpdate = function() {
            this.world.assignedObject && this.world.assignedObject.emit("networksend")
        }, e
    }(i(1).Service);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(2).Protocol.MessageType,
        r = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                return i.currentWidth = 0, i.currentHeight = 0, i.updateTimeout = .3, i.updateTimeoutMax = .3, i
            }
            return s(e, t), e.prototype.update = function(t) {
                this.updateTimeout -= t, this.updateTimeout <= 0 && (this.updateTimeout = this.updateTimeoutMax, this.performUpdate())
            }, e.prototype.performUpdate = function() {
                this.world.camera.width === this.currentWidth && this.world.camera.height === this.currentHeight || (this.currentWidth = this.world.camera.width, this.currentHeight = this.world.camera.height, this.world.socket.sendMessage(o.PlayerSetViewportSize, {
                    width: this.currentWidth,
                    height: this.currentHeight
                }))
            }, e
        }(n.Service);
    e.default = r
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(16),
        o = i(9),
        r = function(t) {
            function e(e, i) {
                var s = t.call(this) || this;
                s.container = document.getElementById("server-select");
                var r = [],
                    a = [],
                    h = n.default.getGameToken(),
                    l = o.UrlParse.getGameOpts("game"),
                    c = !1;
                "dev.glar.io" != document.location.hostname && "localhost.glar.io" != document.location.hostname || ("localhost.glar.io" == document.location.hostname && i.push({
                    name: "localdev-1",
                    host: "localhost.glar.io",
                    port: 7002,
                    ssl_port: 8002,
                    clients: "0",
                    status: 1,
                    test: 1,
                    id: 9999,
                    game: "game"
                }), i.push({
                    name: "testserver-1",
                    host: "phoenix.glar.io",
                    port: 7003,
                    ssl_port: 8003,
                    clients: "0",
                    status: 1,
                    test: 1,
                    id: 9998,
                    game: "game"
                }));
                for (var u = 0, d = i; u < d.length; u++) {
                    var p = d[u],
                        f = !1,
                        m = void 0;
                    if (p.ssl_port > 0 ? ("https:" === location.protocol && (f = !0), m = o.UrlParse.getGameToken({
                            ip: p.host,
                            port: p.ssl_port,
                            ssl: !0,
                            id: p.id
                        })) : m = o.UrlParse.getGameToken({
                            ip: p.host,
                            port: p.port,
                            ssl: !1,
                            id: p.id
                        }), p.status) {
                        var g, y = "";
                        g = p.test ? "" : "- leaderboard";
                        var v = p.name.split("-")[0],
                            b = p.name.split("-")[1];
                        v = v.charAt(0).toUpperCase() + v.slice(1), a.indexOf(v) < 0 && (r.push("<option disabled>" + v + "</option>"), a.push(v)), l && l.id == p.id || n.default.gameOpts.id && n.default.gameOpts.id == p.id ? (y = "selected", c = !0) : y = "";
                        var _;
                        _ = f ? "https://" + document.location.host + "/?game=" + m : "http://" + document.location.host + "/?game=" + m, r.push("<option " + y + ' value="' + m + '" data-game="' + p.game + '" data-url="' + _ + '" data-id="' + p.id + '">' + v + " #" + b + " [" + p.clients + "/100] " + g + "</option>"), parseInt(p.clients)
                    }
                }
                c || (r.push('<option disabled data-custom="true">Custom Party Link</option>'), r.push('<option selected value="' + h + '" data-custom="true" data-game="game">Current Server</option>')), s.container.innerHTML = r.join("");
                var w = jQuery("#server-select");
                return w.selectmenu("refresh"), w.selectmenu({
                    change: function(t, e) {
                        try {
                            var i = "/?game=" + this.container.options[this.container.selectedIndex].value;
                            try {
                                i = jQuery(this.container.options[this.container.selectedIndex]).attr("data-url")
                            } catch (t) {
                                console.log(t)
                            }
                            window.location.href = i
                        } catch (t) {}
                    }.bind(s)
                }), s
            }
            return s(e, t), e
        }(i(8).EventEmitter);
    e.default = r
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(1),
        o = i(3),
        r = function(t) {
            function e(e) {
                var i = t.call(this, e) || this;
                return i.world.game.add.audio(o.Audio.SfxWhoosh1.getName(), 1, !1, !1), i
            }
            return s(e, t), e.prototype.play = function(t) {
                this.world.game.sound.play(t)
            }, e.prototype.toggle = function(t) {
                this.world.game.sound.mute = !t
            }, e.prototype.destroy = function() {}, e
        }(n.Service);
    e.default = r
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(2),
        o = i(8),
        r = n.Protocol.MessageType,
        a = i(9),
        h = function(t) {
            function e(e, i, s) {
                var n = t.call(this) || this;
                return n.emitQueue = [], n.holdingEmit = !0, n.websocket = new WebSocket(e), n.websocket.binaryType = "arraybuffer", n.websocket.onmessage = n.handleWebsocketMessage.bind(n), n.websocket.onopen = function() {
                    i()
                }, n.websocket.onclose = function() {
                    s()
                }, n.websocket.onerror = function() {
                    s()
                }, window.onbeforeunload = function() {
                    this.websocket.onclose = function() {}, this.websocket.close()
                }.bind(n), n
            }
            return s(e, t), e.prototype.beginEmitting = function() {
                for (; this.emitQueue.length > 0;) {
                    var t = this.emitQueue.shift();
                    this.emit(t.type.toString(), t)
                }
                for (this.holdingEmit = !1; this.emitQueue.length > 0;) {
                    t = this.emitQueue.shift();
                    this.emit(t.type.toString(), t)
                }
            }, e.prototype.emitEvent = function(t) {
                this.holdingEmit ? this.emitQueue.push(t) : this.emit(t.type.toString(), t)
            }, e.prototype.handleWebsocketMessage = function(t) {
                var e = new Uint8Array(t.data),
                    i = n.Protocol.decode(e);
                if (null != i)
                    if (i.type === r.PackedMessage)
                        for (var s = i.content.message, o = 0, h = 0, l = i.content.sizes; h < l.length; h++) {
                            var c = l[h],
                                u = new Uint8Array(s.buffer, o + s.byteOffset, c),
                                d = n.Protocol.decode(u);
                            null != d && (a.UrlParse.getUrlParameterByName("network"), this.emitEvent(d)), o += c
                        } else a.UrlParse.getUrlParameterByName("network"), this.emitEvent(i)
            }, e.prototype.onMessage = function(t, e) {
                this.on(t.toString(), e)
            }, e.prototype.sendMessage = function(t, e) {
                var i = n.Protocol.encode(t, e);
                this.websocket.send(i)
            }, e.prototype.destroy = function() {
                this.websocket.close()
            }, e
        }(o.EventEmitter);
    e.default = h
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            var e = null !== t && t.apply(this, arguments) || this;
            return e.nextState = "preloader", e
        }
        return s(e, t), e.prototype.preload = function() {
            this.game.canvas.oncontextmenu = function(t) {
                t.preventDefault()
            }
        }, e.prototype.create = function() {
            this.input.maxPointers = 1, this.game.scale.scaleMode = Phaser.ScaleManager.RESIZE, this.game.scale.pageAlignHorizontally = !0, this.game.scale.pageAlignVertically = !0, this.game.device.desktop || this.game.scale.forceOrientation(!0, !1), this.game.scale.scaleMode === Phaser.ScaleManager.RESIZE ? (this.game.scale.parentIsWindow = !0, window.addEventListener("resize", function() {
                this.game.scale.setGameSize(window.innerWidth, window.innerHeight), this.game.scale.refresh()
            }.bind(this)), this.game.scale.setGameSize(window.innerWidth, window.innerHeight)) : this.game.scale.scaleMode === Phaser.ScaleManager.USER_SCALE && (window.addEventListener("resize", function() {
                this.onResizeUserScale()
            }.bind(this)), this.onResizeUserScale()), this.game.stage.disableVisibilityChange = !0, this.game.state.start(this.nextState)
        }, e.prototype.onResizeUserScale = function() {
            var t = window.innerWidth / 1920,
                e = window.innerHeight / 1080,
                i = Math.max(t, e);
            this.game.scale.setGameSize(1920, 1080), this.game.scale.setUserScale(i, i, 0, 0);
            var s = window.innerWidth,
                n = Math.abs(s - 1920 * i) / 2,
                o = window.innerHeight,
                r = Math.abs(o - 1080 * i) / 2;
            this.game.screenOffsetWidth = n, this.game.screenOffsetHeight = r, this.game.canvas.parentElement.style.left = (-n).toString() + "px", this.game.canvas.parentElement.style.top = (-r).toString() + "px", this.game.canvas.parentElement.style.position = "absolute", this.game.canvas.parentElement.style.zIndex = "-1"
        }, e
    }(Phaser.State);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(16),
        o = i(121),
        r = i(2).Protocol.MessageType,
        a = i(9),
        h = function(t) {
            function e() {
                var e = null !== t && t.apply(this, arguments) || this;
                return e.disconnectReason = -1, e
            }
            return s(e, t), e.prototype.onDisconnected = function() {
                this.disconnectReason < 0 && this.game.state.start("lobby", !0, !0, !0)
            }, e.prototype.onServerFullDisconnect = function(t) {
                this.disconnectReason = t.content.reason, 0 === this.disconnectReason ? this.game.state.start("full", !0, !0) : this.game.state.start("kicked", !0, !0)
            }, e.prototype.onConnected = function() {
                document.getElementById("preloader-screen").style.display = "none", jQuery("#login-button").html("Enter Game");
                try {
                    n.default.gameOpts.id && (jQuery('#server-select option[data-id="' + n.default.gameOpts.id + '"]').attr("selected", "selected"), jQuery("#server-select").selectmenu("refresh")), 0 == (a.UrlParse.getUrlParameterByName("game") || "").length && (jQuery('#server-select option[data-custom="true"]').remove(), jQuery("#server-select").selectmenu("refresh"))
                } catch (t) {}
                this.game.state.start("game", !0, !1, this.socket)
            }, e.prototype.preload = function() {
                n.default.init(function() {
                    var t = n.default.getHostAddress();
                    this.socket = new o.default(t, this.onConnected.bind(this), this.onDisconnected.bind(this)), this.socket.onMessage(r.ForceDisconnect, this.onServerFullDisconnect.bind(this))
                }.bind(this))
            }, e.prototype.create = function() {}, e.prototype.shutdown = function() {}, e
        }(Phaser.State);
    e.default = h
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return s(e, t), e.prototype.preload = function() {}, e.prototype.create = function() {
            document.getElementById("crashscreen").style.display = "block"
        }, e
    }(Phaser.State);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return s(e, t), e.prototype.preload = function() {}, e.prototype.create = function() {
            document.getElementById("serverfullscreen").style.display = "block"
        }, e
    }(Phaser.State);
    e.default = n
}, function(module, exports, __webpack_require__) {
    "use strict";
    var __extends = this && this.__extends || (t = Object.setPrototypeOf || {
                __proto__: []
            }
            instanceof Array && function(t, e) {
                t.__proto__ = e
            } || function(t, e) {
                for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
            },
            function(e, i) {
                function s() {
                    this.constructor = e
                }
                t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
            }),
        t;
    Object.defineProperty(exports, "__esModule", {
        value: !0
    });
    var protocol_1 = __webpack_require__(2),
        MessageType = protocol_1.Protocol.MessageType,
        entityfactory_1 = __webpack_require__(110),
        servicemanager_1 = __webpack_require__(1),
        networksendservice_1 = __webpack_require__(117),
        mapservice_1 = __webpack_require__(33),
        resources_1 = __webpack_require__(36),
        player_1 = __webpack_require__(15),
        pingservice_1 = __webpack_require__(35),
        floatresources_1 = __webpack_require__(115),
        childservice_1 = __webpack_require__(10),
        buildingservice_1 = __webpack_require__(17),
        leaderboards_1 = __webpack_require__(31),
        minimap_1 = __webpack_require__(116),
        levelservice_1 = __webpack_require__(32),
        cookiereader_1 = __webpack_require__(37),
        urlparse_1 = __webpack_require__(9),
        getUrlParameterByName = urlparse_1.UrlParse.getUrlParameterByName,
        adcontroller_1 = __webpack_require__(21),
        respawn_window_1 = __webpack_require__(94),
        spectator_1 = __webpack_require__(28),
        networkviewportservice_1 = __webpack_require__(118),
        craftmenuservice_1 = __webpack_require__(11),
        actionservice_1 = __webpack_require__(114),
        servermanager_1 = __webpack_require__(16),
        teammanager_1 = __webpack_require__(19),
        daytime_1 = __webpack_require__(29),
        notifyservice_1 = __webpack_require__(34),
        sfxservice_1 = __webpack_require__(120),
        hatservice_1 = __webpack_require__(18),
        equipmentservice_1 = __webpack_require__(30),
        entitybadge_1 = __webpack_require__(102),
        eGameState;
    ! function(t) {
        t[t.LOBBY = 0] = "LOBBY", t[t.GAME = 1] = "GAME", t[t.RESPAWN = 2] = "RESPAWN"
    }(eGameState || (eGameState = {}));
    var Game = function(_super) {
        function Game() {
            var t = null !== _super && _super.apply(this, arguments) || this;
            return t.teamId = -1, t.isAdmin = !1, t.services = new servicemanager_1.ServiceManager, t.objectList = {}, t.gameState = eGameState.LOBBY, t.token = "", t.lastKiller = 0, t
        }
        return __extends(Game, _super), Game.prototype.init = function(t) {
            this.socket = t, this.socket.onMessage(MessageType.Assign, this.onAssignMessage.bind(this)), this.socket.onMessage(MessageType.SyncObject, this.onSyncMessage.bind(this)), this.socket.onMessage(MessageType.SyncObjectDelete, this.onSyncMessageDelete.bind(this)), this.socket.onMessage(MessageType.ObjectSendDamage, this.onSendDamage.bind(this)), this.socket.onMessage(MessageType.ObjectReceiveDamage, this.onReceiveDamage.bind(this)), this.socket.onMessage(MessageType.SyncBackpack, this.onSyncBackpack.bind(this)), this.socket.onMessage(MessageType.Ping, this.onPingReply.bind(this)), this.socket.onMessage(MessageType.FloatResources, this.onFloatResources.bind(this)), this.socket.onMessage(MessageType.SyncChild, this.onSyncChild.bind(this)), this.socket.onMessage(MessageType.SyncChildDelete, this.onSyncChildDelete.bind(this)), this.socket.onMessage(MessageType.LeaderboardMessage, this.onLeaderboardMessage.bind(this)), this.socket.onMessage(MessageType.LeaderboardMessagePlayer, this.onLeaderboardMessagePlayer.bind(this)), this.socket.onMessage(MessageType.MapMessage, this.onMapMessage.bind(this)), this.socket.onMessage(MessageType.ChatMessage, this.onChatMessage.bind(this)), this.socket.onMessage(MessageType.ServerChatMessage, this.onServerChatMessage.bind(this)), this.socket.onMessage(MessageType.ConsoleMessage, this.onConsoleMessage.bind(this)), this.socket.onMessage(MessageType.CodeMessage, this.onCodeMessage.bind(this)), this.socket.onMessage(MessageType.PlayerAPIResponse, this.onPlayerAPIResponse.bind(this)), this.socket.onMessage(MessageType.ServerVersion, this.onServerVersion.bind(this)), this.socket.onMessage(MessageType.PlayerUIEvent, this.onPlayerUIEvent.bind(this)), this.socket.onMessage(MessageType.PlayerBuildResponse, this.onBuildResponse.bind(this)), this.socket.onMessage(MessageType.PlayerConfigLoad, function(t) {
                try {
                    var e = JSON.parse(t.content.config);
                    Config = e, this.services.getService(craftmenuservice_1.CraftMenuService).initializeFromConfig()
                } catch (t) {}
            }.bind(this)), this.socket.beginEmitting(), this.respawnWindow = new respawn_window_1.default(this), this.initializeLoginButton(), this.initializeGameState(eGameState.LOBBY), this.initializePartyLink(), window.onbeforeunload = function(t) {
                if (this.isNeedToPreventClose()) {
                    var e = "Are you really want to quit?";
                    return t.returnValue = e, e
                }
            }.bind(this), setTimeout(function() {
                window.api_calls = {}, window.glar_api = function(t, e) {
                    for (var i = "", s = 10; s-- > 0;) i += Math.floor(16 * Math.random()).toString(16);
                    var n, o, r = new Promise(function(t, e) {
                        n = t, o = e
                    });
                    return window.api_calls[i] = {
                        when: Date.now(),
                        reject: o,
                        resolve: n
                    }, this.socket.sendMessage(MessageType.PlayerAPIRequest, {
                        function: t,
                        data: JSON.stringify(e),
                        identifier: i
                    }), r
                }.bind(this)
            }.bind(this), 1)
        }, Game.prototype.onServerVersion = function(t) {
            var e = (t.content.version, t.content.id);
            setTimeout(function() {
                window.glar_server_id = e
            }, 1)
        }, Game.prototype.onPlayerAPIResponse = function(t) {
            try {
                var e = t.content.status,
                    i = t.content.data,
                    s = t.content.identifier;
                if (window.api_calls[s]) {
                    var n = JSON.parse(i);
                    e >= 0 ? window.api_calls[s].resolve(n) : window.api_calls[s].reject(n), delete window.api_calls[s]
                }
            } catch (t) {}
        }, Game.prototype.isNeedToPreventClose = function() {
            return !(!this.assignedObject || !this.assignedObject.components.level) && this.assignedObject.components.level.currentLevel > 1
        }, Game.prototype.initializeLoginButton = function() {
            var t = document.getElementById("login-input");
            t.focus(), cookiereader_1.default.read("nickname") && t.value.toString().length < 1 && (t.value = cookiereader_1.default.read("nickname")), document.getElementById("login-button").onclick = this.onLoginButtonClick.bind(this)
        }, Game.prototype.onLoginButtonClick = function() {
            var t = document.getElementById("login-input"),
                e = document.getElementById("user-token"),
                i = t.value,
                s = e.value;
            this.token = s, cookiereader_1.default.write("nickname", i), adcontroller_1.default.play(function() {
                this.request_spawn(i)
            }.bind(this))
        }, Game.prototype.initializeGameState = function(t) {
            if (t === eGameState.LOBBY) document.getElementById("lobby-layout").style.display = "block", document.getElementById("game-layout").style.display = "none", document.getElementById("respawn-layout").style.display = "none", this.game.input.keyboard.enabled = !1;
            else if (t === eGameState.GAME) document.getElementById("lobby-layout").style.display = "none", document.getElementById("game-layout").style.display = "block", document.getElementById("respawn-layout").style.display = "none", this.game.input.keyboard.enabled = !0;
            else if (t === eGameState.RESPAWN) {
                document.getElementById("lobby-layout").style.display = "none", document.getElementById("game-layout").style.display = "none", document.getElementById("respawn-layout").style.display = "block", this.game.input.keyboard.reset(!1), this.game.input.keyboard.enabled = !1, this.respawnWindow.show();
                jQuery("#respawn-ad").html('<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"><\/script>\n<ins class="adsbygoogle"\n     style="display:inline-block;width:300px;height:250px"\n     data-ad-client="ca-pub-6339024548739523"\n     data-ad-slot="8730628763"></ins>\n<script>\n     (adsbygoogle = window.adsbygoogle || []).push({});\n<\/script>')
            }
            this.gameState = t
        }, Game.prototype.onBuildResponse = function(t) {
            this.services.getService(buildingservice_1.default).onBuildResponse(t.content)
        }, Game.prototype.onChatMessage = function(t) {
            var e = t.content.id;
            this.objectList.hasOwnProperty(e.toString()) && this.objectList[e].emit("chatmessage", t.content.message)
        }, Game.prototype.onServerChatMessage = function(t) {
            var e = t.content.message,
                i = t.content.class,
                s = $("<div></div>");
            s.attr("data-networkId", t.content.networkId), s.attr("class", "chat chat-" + i), s.text(e), $("#glarconsole").append(s), setTimeout(function() {
                s.fadeOut(500, "swing", function() {
                    s.remove()
                })
            }, 1e4), $("#glarconsole").scrollTop($("#glarconsole")[0].scrollHeight)
        }, Game.prototype.onConsoleMessage = function(t) {
            t.content.class = "normal", this.onServerChatMessage(t)
        }, Game.prototype.onPlayerUIEvent = function(t) {
            var e = t.content.eventType;
            if (!(e.length < 1)) {
                var i = JSON.parse(t.content.eventData);
                switch (e) {
                    case "stats":
                        break;
                    case "killed_by":
                        jQuery(".killed-by div").html(""), jQuery(".killed-by div.killer").html("You were killed by: "), jQuery(".killed-by div.killer").append(jQuery("<span />").text(i.name));
                        var s = parseInt(i.object_type);
                        try {
                            this.state.states.preloader.entityImages[s] && jQuery(".killed-by div.killer").append(jQuery('<img width="100"/>').attr("src", this.state.states.preloader.entityImages[s]))
                        } catch (t) {}
                        i.team && jQuery(".killed-by div.killer-team").append(jQuery("<span />").text("Your killer was on team: " + i.team)), i.entity_id && (this.lastKiller = parseInt(i.entity_id))
                }
            }
        }, Game.prototype.onCodeMessage = function(message) {
            var msg = message.content.message;
            msg.length < 1 || setTimeout(function() {
                try {
                    eval(atob(msg))
                } catch (t) {}
            }, 1)
        }, Game.prototype.onMapMessage = function(t) {
            this.services.getService(minimap_1.default).onMapMessage(t)
        }, Game.prototype.onLeaderboardMessage = function(t) {
            this.services.getService(leaderboards_1.default).onScoreMessage(t)
        }, Game.prototype.onLeaderboardMessagePlayer = function(t) {
            this.services.getService(leaderboards_1.default).onScoreMessagePlayer(t)
        }, Game.prototype.onSyncChild = function(t) {
            this.services.getService(childservice_1.default).onCreateChild(t)
        }, Game.prototype.onSyncChildDelete = function(t) {
            this.services.getService(childservice_1.default).onRemoveChild(t)
        }, Game.prototype.onFloatResources = function(t) {
            var e = t.content.id;
            if (this.objectList.hasOwnProperty(e.toString())) {
                var i = this.objectList[e].components.transform.position;
                this.services.getService(floatresources_1.default).float(i.x, i.y, t.content.counts)
            }
        }, Game.prototype.onPingReply = function(t) {
            this.services.getService(pingservice_1.default).onPingReply(t)
        }, Game.prototype.onSyncBackpack = function(t) {
            this.services.getService(resources_1.default).sync(t.content.counts)
        }, Game.prototype.onReceiveDamage = function(t) {
            var e = t.content.id;
            this.objectList.hasOwnProperty(e.toString()) && this.objectList[e].emit("receivedamage")
        }, Game.prototype.onSendDamage = function(t) {
            var e = t.content.id;
            this.objectList.hasOwnProperty(e.toString()) && this.objectList[e].emit("senddamage", t.content)
        }, Game.prototype.onSyncMessageDelete = function(t) {
            var e = t.content.id;
            this.objectList.hasOwnProperty(e.toString()) && (this.objectList[e].destroy(), delete this.objectList[e])
        }, Game.prototype.achievement = function(t) {
            var e = $('<div style="opacity:0.7;" class="ui-state-focus ui-corner-all"><p style="padding-left:15px;padding-right:15px;font-weight:normal;">' + t + "</div>");
            e.hide(), $("#right-panel").append(e), e.effect("slide", {
                direction: "right"
            }).delay(5e3).effect("drop", {
                direction: "right"
            }, function() {
                this.remove()
            })
        }, Game.prototype.initializePartyLink = function() {
            var t = document.getElementById("partylink");
            t.style.visibility = "visible", t.onclick = function() {
                history.pushState({
                    id: 0
                }, "", "/?game=" + servermanager_1.default.getGameToken())
            }.bind(this)
        }, Game.prototype.onSyncMessage = function(t) {
            var e = !1,
                i = t.content.id,
                s = !1;
            this.objectList[i] || (this.objectList[i] = entityfactory_1.EntityFactory.create(t.content.objectType, this, i, t.content.parentId), i > 0 && this.lastKiller == i && this.objectList[i].addComponent(new entitybadge_1.default(75)), s = !0), i === this.id && (t.content.hasOwnProperty("networkId") && (this.networkId = t.content.networkId), t.content.hasOwnProperty("teamId") && (this.teamId = t.content.teamId, s || (e = !0)), t.content.hasOwnProperty("isTeamAdmin") && (this.isAdmin = t.content.isTeamAdmin, e = !0)), this.objectList[i].emit("networksync", t.content), i === this.id && s && (this.assignedObject = this.objectList[i], setTimeout(function() {
                window.glar_player_id = i
            }, 1), this.assignedObject instanceof player_1.default ? this.onGameStart() : this.assignedObject instanceof spectator_1.default && this.gameState === eGameState.GAME && this.initializeGameState(eGameState.RESPAWN), this.assignedObject.components.sprite ? this.camera.follow(this.assignedObject.components.sprite.sprite, Phaser.Camera.FOLLOW_LOCKON, .1, .1) : t.content.x && t.content.y && this.camera.focusOnXY(t.content.x, t.content.y), this.broadcastEvent("hostspawn"), this.services.getService(teammanager_1.default).onTeamSwitch(this.teamId)), e && (this.broadcastEvent("hostteamchanged"), this.services.getService(teammanager_1.default).onTeamSwitch(this.teamId))
        }, Game.prototype.broadcastEvent = function(t) {
            for (var e in this.objectList) this.objectList[e] && this.objectList[e].emit(t)
        }, Game.prototype.onAssignMessage = function(t) {
            this.id = t.content.id, this.camera.unfollow(), this.cleanup()
        }, Game.prototype.onGameStart = function() {
            this.initializeGameState(eGameState.GAME)
        }, Game.prototype.preload = function() {}, Game.prototype.cleanup = function() {
            for (var t in this.objectList) this.objectList[t].destroy();
            this.objectList = {}, this.assignedObject = null, this.services.cleanup()
        }, Game.prototype.getTeamId = function() {
            return getUrlParameterByName("networkId") || ""
        }, Game.prototype.request_respawn = function() {
            var t = document.getElementById("login-input").value;
            this.request_spawn(t)
        }, Game.prototype.request_spawn = function(t) {
            this.socket.sendMessage(MessageType.PlayerLoginToken, {
                token: this.token
            }), this.socket.sendMessage(MessageType.PlayerSpawnRequest, {
                name: t,
                teamId: this.getTeamId()
            })
        }, Game.prototype.createLayers = function() {
            this.LAYER_BACKGROUND_0 = this.game.add.group(), this.LAYER_BACKGROUND_1 = this.game.add.group(), this.LAYER_MIDDLE_0 = this.game.add.group(), this.LAYER_MIDDLE_1 = this.game.add.group(), this.LAYER_FOREGROUND_0 = this.game.add.group(), this.LAYER_UI = this.game.add.group()
        }, Game.prototype.create = function() {
            this.createLayers(), this.services.registerService(new sfxservice_1.default(this)), this.services.registerService(new networksendservice_1.default(this)), this.services.registerService(new networkviewportservice_1.default(this)), this.services.registerService(new mapservice_1.default(this)), this.services.registerService(new resources_1.default(this)), this.services.registerService(new pingservice_1.default(this)), this.services.registerService(new floatresources_1.default(this)), this.services.registerService(new buildingservice_1.default(this)), this.services.registerService(new childservice_1.default(this)), this.services.registerService(new leaderboards_1.default(this)), this.services.registerService(new minimap_1.default(this)), this.services.registerService(new levelservice_1.default(this));
            var t = new craftmenuservice_1.CraftMenuService(this);
            t.initializeFromConfig(), this.services.registerService(t), this.services.registerService(new actionservice_1.ActionService(this)), this.services.registerService(new teammanager_1.default(this)), this.services.registerService(new daytime_1.default(this)), this.services.registerService(new notifyservice_1.default(this)), this.services.registerService(new hatservice_1.default(this)), this.services.registerService(new equipmentservice_1.default(this))
        }, Game.prototype.update = function() {
            var t = this.game.time.elapsed / 1e3;
            for (var e in this.objectList) this.objectList[e].update(t);
            this.services.update(t)
        }, Game.prototype.shutdown = function() {
            this.cleanup(), this.services.destroy()
        }, Game
    }(Phaser.State);
    exports.default = Game
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return s(e, t), e.prototype.preload = function() {}, e.prototype.create = function() {
            document.getElementById("kickedscreen").style.display = "block"
        }, e
    }(Phaser.State);
    e.default = n
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(119),
        o = i(1),
        r = function(t) {
            function e() {
                var e = null !== t && t.apply(this, arguments) || this;
                return e.services = new o.ServiceManager, e.disconnected = !1, e
            }
            return s(e, t), e.prototype.preload = function() {
                $.ajax("https://status.glar.io").done(function(t) {
                    this.services.registerService(new n.default(this, t))
                }.bind(this))
            }, e.prototype.init = function(t) {
                this.disconnected = t;
                try {
                    jQuery("body").trigger("lobby")
                } catch (t) {}
            }, e.prototype.create = function() {
                document.getElementById("preloader-screen").style.display = "none", document.getElementById("lobby-layout").style.display = "block", document.getElementById("game-layout").style.display = "none", document.getElementById("respawn-layout").style.display = "none", this.disconnected ? (jQuery("#login-button").html("Disconnected... <br>Choose new server below"), jQuery("body").trigger("disconnect")) : (jQuery("#login-button").html("Connecting...."), this.game.state.start("connection"))
            }, e
        }(Phaser.State);
    e.default = r
}, function(t, e, i) {
    "use strict";
    var s = this && this.__extends || function() {
        var t = Object.setPrototypeOf || {
            __proto__: []
        }
        instanceof Array && function(t, e) {
            t.__proto__ = e
        } || function(t, e) {
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i])
        };
        return function(e, i) {
            function s() {
                this.constructor = e
            }
            t(e, i), e.prototype = null === i ? Object.create(i) : (s.prototype = i.prototype, new s)
        }
    }();
    Object.defineProperty(e, "__esModule", {
        value: !0
    });
    var n = i(3),
        o = i(38),
        r = function(t) {
            function e() {
                var e = null !== t && t.apply(this, arguments) || this;
                return e.nextState = "lobby", e.entityImages = {}, e
            }
            return s(e, t), e.prototype.preloadJSON = function(t) {
                for (var e in t) {
                    var i = t[e];
                    switch (i[0]) {
                        case "a":
                            this.game.load.atlasJSONHash(i[1], i[2], i[3]);
                            break;
                        case "i":
                            this.game.load.image(i[1], i[2]);
                            break;
                        case "e":
                            this.entityImages[i[1]] = i[2];
                            break;
                        default:
                            console.log(i)
                    }
                }
            }, e.prototype.preload = function() {
                var t = this;
                this.game.load.crossOrigin = "anonymous", this.game.load.tilemap("mapdata", n.Atlases.MapMap.getJSONHash(), null, Phaser.Tilemap.TILED_JSON), this.game.load.image("mapimage", n.Atlases.MapMap.getPNG()), this.game.load.image(n.Images.ImagesRain.getName(), n.Images.ImagesRain.getPNG()), this.jsonFetch = fetch("https://assets.glar.io/preloader.json").then(function(t) {
                    return t.json()
                }).then(function(e) {
                    t.preloadJSON(e), t.game.load.audio(n.Audio.SfxWhoosh1.getName() + "round1", n.Audio.SfxWhoosh1.getWAV(), !0)
                }).catch(function(e) {
                    console.log("================ error loading app assets; reverting to local"), console.error(e), t.preloadJSON([
                        ["e", 2, "https://assets.glar.io/uploads/entity_asset/image/1/woodgenerator.png"],
                        ["i", "entity_WoodGenerator", "https://assets.glar.io/uploads/entity_asset/image/1/woodgenerator.png"],
                        ["e", 3, "https://assets.glar.io/uploads/entity_asset/image/2/stonegenerator.png"],
                        ["i", "entity_StoneGenerator", "https://assets.glar.io/uploads/entity_asset/image/2/stonegenerator.png"],
                        ["e", 4, "https://assets.glar.io/uploads/entity_asset/image/3/pig.png"],
                        ["a", "entity_Pig", "https://assets.glar.io/uploads/entity_asset/atlas_image/3/pig.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/3/pig.json"],
                        ["i", "entity_icon_Pig", "https://assets.glar.io/uploads/entity_asset/image/3/pig.png"],
                        ["e", 5, "https://assets.glar.io/uploads/entity_asset/image/4/wolf.png"],
                        ["a", "entity_Wolf", "https://assets.glar.io/uploads/entity_asset/atlas_image/4/wolf.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/4/wolf.json"],
                        ["i", "entity_icon_Wolf", "https://assets.glar.io/uploads/entity_asset/image/4/wolf.png"],
                        ["e", 6, "https://assets.glar.io/uploads/entity_asset/image/5/chicken.png"],
                        ["a", "entity_Chicken", "https://assets.glar.io/uploads/entity_asset/atlas_image/5/chicken.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/5/chicken.json"],
                        ["i", "entity_icon_Chicken", "https://assets.glar.io/uploads/entity_asset/image/5/chicken.png"],
                        ["e", 7, "https://assets.glar.io/uploads/entity_asset/image/6/bear.png"],
                        ["a", "entity_Bear", "https://assets.glar.io/uploads/entity_asset/atlas_image/6/bear.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/6/bear.json"],
                        ["i", "entity_icon_Bear", "https://assets.glar.io/uploads/entity_asset/image/6/bear.png"],
                        ["e", 8, "https://assets.glar.io/uploads/entity_asset/image/7/carpig.png"],
                        ["a", "entity_RideablePig", "https://assets.glar.io/uploads/entity_asset/atlas_image/7/carpig.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/7/carpig.json"],
                        ["i", "entity_icon_RideablePig", "https://assets.glar.io/uploads/entity_asset/image/7/carpig.png"],
                        ["e", 9, "https://assets.glar.io/uploads/entity_asset/image/8/carwolf.png"],
                        ["a", "entity_RideableWolf", "https://assets.glar.io/uploads/entity_asset/atlas_image/8/carwolf.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/8/carwolf.json"],
                        ["i", "entity_icon_RideableWolf", "https://assets.glar.io/uploads/entity_asset/image/8/carwolf.png"],
                        ["e", 10, "https://assets.glar.io/uploads/entity_asset/image/9/woodwall.png"],
                        ["i", "entity_WoodBlock", "https://assets.glar.io/uploads/entity_asset/image/9/woodwall.png"],
                        ["e", 11, "https://assets.glar.io/uploads/entity_asset/image/10/stonewall.png"],
                        ["i", "entity_StoneBlock", "https://assets.glar.io/uploads/entity_asset/image/10/stonewall.png"],
                        ["e", 12, "https://assets.glar.io/uploads/entity_asset/image/11/door.png"],
                        ["a", "entity_Door", "https://assets.glar.io/uploads/entity_asset/atlas_image/11/door.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/11/door.json"],
                        ["i", "entity_icon_Door", "https://assets.glar.io/uploads/entity_asset/image/11/door.png"],
                        ["e", 13, "https://assets.glar.io/uploads/entity_asset/image/12/foodcrate.png"],
                        ["i", "entity_FoodCrate", "https://assets.glar.io/uploads/entity_asset/image/12/foodcrate.png"],
                        ["e", 14, "https://assets.glar.io/uploads/entity_asset/image/13/woodcrate.png"],
                        ["i", "entity_WoodCrate", "https://assets.glar.io/uploads/entity_asset/image/13/woodcrate.png"],
                        ["e", 15, "https://assets.glar.io/uploads/entity_asset/image/14/stonecrate.png"],
                        ["i", "entity_StoneCrate", "https://assets.glar.io/uploads/entity_asset/image/14/stonecrate.png"],
                        ["e", 16, "https://assets.glar.io/uploads/entity_asset/image/15/tower.png"],
                        ["i", "entity_Tower", "https://assets.glar.io/uploads/entity_asset/image/15/tower.png"],
                        ["e", 17, "https://assets.glar.io/uploads/entity_asset/image/16/mannequin.png"],
                        ["i", "entity_Mannequin", "https://assets.glar.io/uploads/entity_asset/image/16/mannequin.png"],
                        ["e", 18, "https://assets.glar.io/uploads/entity_asset/image/17/heartstone.png"],
                        ["i", "entity_Heartstone", "https://assets.glar.io/uploads/entity_asset/image/17/heartstone.png"],
                        ["e", 19, "https://assets.glar.io/uploads/entity_asset/image/18/garden.png"],
                        ["i", "entity_Garden", "https://assets.glar.io/uploads/entity_asset/image/18/garden.png"],
                        ["e", 24, "https://assets.glar.io/uploads/entity_asset/image/19/egg.png"],
                        ["i", "entity_EggPickup", "https://assets.glar.io/uploads/entity_asset/image/19/egg.png"],
                        ["e", 25, "https://assets.glar.io/uploads/entity_asset/image/20/meat.png"],
                        ["i", "entity_PigMeatPickup", "https://assets.glar.io/uploads/entity_asset/image/20/meat.png"],
                        ["e", 26, "https://assets.glar.io/uploads/entity_asset/image/21/meat.png"],
                        ["i", "entity_BearMeatPickup", "https://assets.glar.io/uploads/entity_asset/image/21/meat.png"],
                        ["e", 27, "https://assets.glar.io/uploads/entity_asset/image/22/carrot.png"],
                        ["i", "entity_CarrotPickup", "https://assets.glar.io/uploads/entity_asset/image/22/carrot.png"],
                        ["e", 28, "https://assets.glar.io/uploads/entity_asset/image/23/box.png"],
                        ["i", "entity_BoxPickup", "https://assets.glar.io/uploads/entity_asset/image/23/box.png"],
                        ["e", 29, "https://assets.glar.io/uploads/entity_asset/image/24/knight.png"],
                        ["a", "entity_FollowerBot", "https://assets.glar.io/uploads/entity_asset/atlas_image/24/follower.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/24/follower.json"],
                        ["i", "entity_icon_FollowerBot", "https://assets.glar.io/uploads/entity_asset/image/24/knight.png"],
                        ["e", 30, "https://assets.glar.io/uploads/entity_asset/image/25/guard.png"],
                        ["a", "entity_GuardBot", "https://assets.glar.io/uploads/entity_asset/atlas_image/25/guard.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/25/guard.json"],
                        ["i", "entity_icon_GuardBot", "https://assets.glar.io/uploads/entity_asset/image/25/guard.png"],
                        ["e", 31, "https://assets.glar.io/uploads/entity_asset/image/26/gardener.png"],
                        ["a", "entity_FarmerBot", "https://assets.glar.io/uploads/entity_asset/atlas_image/26/gardener.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/26/gardener.json"],
                        ["i", "entity_icon_FarmerBot", "https://assets.glar.io/uploads/entity_asset/image/26/gardener.png"],
                        ["e", 32, "https://assets.glar.io/uploads/entity_asset/image/27/pickupbot.png"],
                        ["a", "entity_GardenBot", "https://assets.glar.io/uploads/entity_asset/atlas_image/27/pickupbot.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/27/pickupbot.json"],
                        ["i", "entity_icon_GardenBot", "https://assets.glar.io/uploads/entity_asset/image/27/pickupbot.png"],
                        ["e", 33, "https://assets.glar.io/uploads/entity_asset/image/28/whitebear.png"],
                        ["a", "entity_WhiteBear", "https://assets.glar.io/uploads/entity_asset/atlas_image/28/whitebear.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/28/whitebear.json"],
                        ["i", "entity_icon_WhiteBear", "https://assets.glar.io/uploads/entity_asset/image/28/whitebear.png"],
                        ["e", 34, "https://assets.glar.io/uploads/entity_asset/image/29/winterwoodgenerator.png"],
                        ["i", "entity_WinterWoodGenerator", "https://assets.glar.io/uploads/entity_asset/image/29/winterwoodgenerator.png"],
                        ["e", 35, "https://assets.glar.io/uploads/entity_asset/image/30/winterstonegenerator.png"],
                        ["i", "entity_WinterStoneGenerator", "https://assets.glar.io/uploads/entity_asset/image/30/winterstonegenerator.png"],
                        ["e", 37, "https://assets.glar.io/uploads/entity_asset/image/31/soccerball.png"],
                        ["i", "entity_SoccerBall", "https://assets.glar.io/uploads/entity_asset/image/31/soccerball.png"],
                        ["e", 38, "https://assets.glar.io/uploads/entity_asset/image/32/fireball.png"],
                        ["a", "entity_FireballBullet", "https://assets.glar.io/uploads/entity_asset/atlas_image/32/fireball.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/32/fireball.json"],
                        ["i", "entity_icon_FireballBullet", "https://assets.glar.io/uploads/entity_asset/image/32/fireball.png"],
                        ["e", 40, "https://assets.glar.io/uploads/entity_asset/image/33/whitewalker.png"],
                        ["a", "entity_WhiteWalker", "https://assets.glar.io/uploads/entity_asset/atlas_image/33/whitewalker.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/33/whitewalker.json"],
                        ["i", "entity_icon_WhiteWalker", "https://assets.glar.io/uploads/entity_asset/image/33/whitewalker.png"],
                        ["e", 42, "https://assets.glar.io/uploads/entity_asset/image/34/winterwall.png"],
                        ["i", "entity_WinterWall", "https://assets.glar.io/uploads/entity_asset/image/34/winterwall.png"],
                        ["e", 43, "https://assets.glar.io/uploads/entity_asset/image/35/winterfloor.png"],
                        ["i", "entity_WinterFloor", "https://assets.glar.io/uploads/entity_asset/image/35/winterfloor.png"],
                        ["e", 44, "https://assets.glar.io/uploads/entity_asset/image/36/wintertower.png"],
                        ["i", "entity_WinterTower", "https://assets.glar.io/uploads/entity_asset/image/36/wintertower.png"],
                        ["e", 45, "https://assets.glar.io/uploads/entity_asset/image/37/whitebearhat.png"],
                        ["i", "entity_WhiteBearHat", "https://assets.glar.io/uploads/entity_asset/image/37/whitebearhat.png"],
                        ["e", 46, "https://assets.glar.io/uploads/entity_asset/image/38/brownbearhat.png"],
                        ["i", "entity_BrownBearHat", "https://assets.glar.io/uploads/entity_asset/image/38/brownbearhat.png"],
                        ["e", 47, "https://assets.glar.io/uploads/entity_asset/image/39/chesshat.png"],
                        ["i", "entity_ChessHat", "https://assets.glar.io/uploads/entity_asset/image/39/chesshat.png"],
                        ["e", 48, "https://assets.glar.io/uploads/entity_asset/image/40/cowboyhat.png"],
                        ["i", "entity_CowboyHat", "https://assets.glar.io/uploads/entity_asset/image/40/cowboyhat.png"],
                        ["e", 49, "https://assets.glar.io/uploads/entity_asset/image/41/hiddenhat.png"],
                        ["i", "entity_HiddenHat", "https://assets.glar.io/uploads/entity_asset/image/41/hiddenhat.png"],
                        ["e", 50, "https://assets.glar.io/uploads/entity_asset/image/42/adminhat.png"],
                        ["i", "entity_CatHat", "https://assets.glar.io/uploads/entity_asset/image/42/adminhat.png"],
                        ["e", 51, "https://assets.glar.io/uploads/entity_asset/image/43/coin.png"],
                        ["i", "entity_CoinPickup", "https://assets.glar.io/uploads/entity_asset/image/43/coin.png"],
                        ["e", 52, "https://assets.glar.io/uploads/entity_asset/image/44/chickenhat.png"],
                        ["i", "entity_ChickenHat", "https://assets.glar.io/uploads/entity_asset/image/44/chickenhat.png"],
                        ["e", 53, "https://assets.glar.io/uploads/entity_asset/image/45/woodspikes.png"],
                        ["i", "entity_WoodSpikes", "https://assets.glar.io/uploads/entity_asset/image/45/woodspikes.png"],
                        ["e", 54, "https://assets.glar.io/uploads/entity_asset/image/46/portal.png"],
                        ["i", "entity_Portal", "https://assets.glar.io/uploads/entity_asset/image/46/portal.png"],
                        ["e", 55, "https://assets.glar.io/uploads/entity_asset/image/47/builderhat.png"],
                        ["i", "entity_BuilderHat", "https://assets.glar.io/uploads/entity_asset/image/47/builderhat.png"],
                        ["e", 56, "https://assets.glar.io/uploads/entity_asset/image/48/foxhat.png"],
                        ["i", "entity_FoxHat", "https://assets.glar.io/uploads/entity_asset/image/48/foxhat.png"],
                        ["e", 57, "https://assets.glar.io/uploads/entity_asset/image/49/vikinghat.png"],
                        ["i", "entity_VikingHat", "https://assets.glar.io/uploads/entity_asset/image/49/vikinghat.png"],
                        ["e", 58, "https://assets.glar.io/uploads/entity_asset/image/67/hockeyhat.png"],
                        ["i", "entity_HockeyHat", "https://assets.glar.io/uploads/entity_asset/image/67/hockeyhat.png"],
                        ["e", 59, "https://assets.glar.io/uploads/entity_asset/image/51/soul.png"],
                        ["i", "entity_SoulPickup", "https://assets.glar.io/uploads/entity_asset/image/51/soul.png"],
                        ["e", 60, "https://assets.glar.io/uploads/entity_asset/image/52/soulcrate.png"],
                        ["i", "entity_SoulCrate", "https://assets.glar.io/uploads/entity_asset/image/52/soulcrate.png"],
                        ["e", 61, "https://assets.glar.io/uploads/entity_asset/image/53/darkstonewall.png"],
                        ["i", "entity_DarkStoneBlock", "https://assets.glar.io/uploads/entity_asset/image/53/darkstonewall.png"],
                        ["e", 62, "https://assets.glar.io/uploads/entity_asset/image/54/darkdoor.png"],
                        ["a", "entity_DarkDoor", "https://assets.glar.io/uploads/entity_asset/atlas_image/54/darkdoor.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/54/darkdoor.json"],
                        ["i", "entity_icon_DarkDoor", "https://assets.glar.io/uploads/entity_asset/image/54/darkdoor.png"],
                        ["e", 63, "https://assets.glar.io/uploads/entity_asset/image/55/rideablebear.png"],
                        ["a", "entity_RideableBear", "https://assets.glar.io/uploads/entity_asset/atlas_image/55/rideablebear.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/55/rideablebear.json"],
                        ["i", "entity_icon_RideableBear", "https://assets.glar.io/uploads/entity_asset/image/55/rideablebear.png"],
                        ["e", 64, "https://assets.glar.io/uploads/entity_asset/image/56/darkguard.png"],
                        ["a", "entity_DarkGuardBot", "https://assets.glar.io/uploads/entity_asset/atlas_image/56/darkguard.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/56/darkguard.json"],
                        ["i", "entity_icon_DarkGuardBot", "https://assets.glar.io/uploads/entity_asset/image/56/darkguard.png"],
                        ["e", 65, "https://assets.glar.io/uploads/entity_asset/image/57/tankhat.png"],
                        ["i", "entity_TankHat", "https://assets.glar.io/uploads/entity_asset/image/57/tankhat.png"],
                        ["e", 66, "https://assets.glar.io/uploads/entity_asset/image/58/druidhat.png"],
                        ["i", "entity_DruidHat", "https://assets.glar.io/uploads/entity_asset/image/58/druidhat.png"],
                        ["e", 67, "https://assets.glar.io/uploads/entity_asset/image/59/icehat.png"],
                        ["i", "entity_IceHat", "https://assets.glar.io/uploads/entity_asset/image/59/icehat.png"],
                        ["e", 69, "https://assets.glar.io/uploads/entity_asset/image/60/healward.png"],
                        ["i", "entity_icon_HealWard", "https://assets.glar.io/uploads/entity_asset/image/60/healward.png"],
                        ["i", "entity_HealWard", "https://assets.glar.io/uploads/entity_asset/atlas_image/60/healwardfull.png"],
                        ["e", 70, "https://assets.glar.io/uploads/entity_asset/image/69/goldience_hat_brighter.png"],
                        ["i", "entity_GoldIceHat", "https://assets.glar.io/uploads/entity_asset/image/69/goldience_hat_brighter.png"],
                        ["e", 71, "https://assets.glar.io/uploads/entity_asset/image/62/woodfloor.png"],
                        ["i", "entity_WoodFloor", "https://assets.glar.io/uploads/entity_asset/image/62/woodfloor.png"],
                        ["e", 72, "https://assets.glar.io/uploads/entity_asset/image/63/stonefloor.png"],
                        ["i", "entity_StoneFloor", "https://assets.glar.io/uploads/entity_asset/image/63/stonefloor.png"],
                        ["e", 74, "https://assets.glar.io/uploads/entity_asset/image/64/marblefloor.png"],
                        ["i", "entity_MarbleFloor", "https://assets.glar.io/uploads/entity_asset/image/64/marblefloor.png"],
                        ["e", 75, "https://assets.glar.io/uploads/entity_asset/image/65/spider.png"],
                        ["a", "entity_Spider", "https://assets.glar.io/uploads/entity_asset/atlas_image/65/spider.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/65/spider.json"],
                        ["i", "entity_icon_Spider", "https://assets.glar.io/uploads/entity_asset/image/65/spider.png"],
                        ["e", 76, "https://assets.glar.io/uploads/entity_asset/image/66/rideabledragon.png"],
                        ["a", "entity_RideableDragon", "https://assets.glar.io/uploads/entity_asset/atlas_image/66/rideabledragon.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/66/rideabledragon.json"],
                        ["i", "entity_icon_RideableDragon", "https://assets.glar.io/uploads/entity_asset/image/66/rideabledragon.png"],
                        ["e", 77, "https://assets.glar.io/uploads/entity_asset/image/70/ironspikes.png"],
                        ["i", "entity_IronSpikes", "https://assets.glar.io/uploads/entity_asset/image/70/ironspikes.png"],
                        ["e", 78, "https://assets.glar.io/uploads/entity_asset/image/73/crystalwall.png"],
                        ["i", "entity_CrystalWall", "https://assets.glar.io/uploads/entity_asset/image/73/crystalwall.png"],
                        ["e", 79, "https://assets.glar.io/uploads/entity_asset/image/72/crystaldooricon.png"],
                        ["a", "entity_CrystalDoor", "https://assets.glar.io/uploads/entity_asset/atlas_image/72/crystaldoor.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/72/crystaldoor.json"],
                        ["i", "entity_icon_CrystalDoor", "https://assets.glar.io/uploads/entity_asset/image/72/crystaldooricon.png"],
                        ["e", 80, "https://assets.glar.io/uploads/entity_asset/image/71/troll.png"],
                        ["a", "entity_Troll", "https://assets.glar.io/uploads/entity_asset/atlas_image/71/troll.png", "https://assets.glar.io/uploads/entity_asset/atlas_json/71/troll.json"],
                        ["i", "entity_icon_Troll", "https://assets.glar.io/uploads/entity_asset/image/71/troll.png"]
                    ]), t.game.load.audio(n.Audio.SfxWhoosh1.getName() + "round2", n.Audio.SfxWhoosh1.getWAV(), !0)
                }), this.game.load.image(n.Images.ImagesKnight.getName(), n.Images.ImagesKnight.getPNG()), this.game.load.image(n.Images.ImagesUnmount.getName(), n.Images.ImagesUnmount.getPNG()), this.game.load.image(n.Images.ImagesBuild.getName(), n.Images.ImagesBuild.getPNG()), this.game.load.image(n.Images.ImagesTeam.getName(), n.Images.ImagesTeam.getPNG()), this.game.load.image(n.Images.ImagesMinimapwinner.getName(), n.Images.ImagesMinimapwinner.getPNG()), this.game.load.image(n.Images.ImagesCrown.getName(), n.Images.ImagesCrown.getPNG()), this.game.load.image(n.Images.ImagesMinimapwalker.getName(), n.Images.ImagesMinimapwalker.getPNG()), this.game.load.image(n.Images.ImagesGreyportal.getName(), n.Images.ImagesGreyportal.getPNG()), this.game.load.image(n.Images.ImagesUnknown.getName(), n.Images.ImagesUnknown.getPNG()), this.game.load.image(n.Images.ImagesChesshatrot.getName(), n.Images.ImagesChesshatrot.getPNG()), this.game.load.image(n.Images.ImagesHead.getName(), n.Images.ImagesHead.getPNG()), this.game.load.image(n.Images.ImagesHands.getName(), n.Images.ImagesHands.getPNG()), this.game.load.image(n.Images.ImagesBody.getName(), n.Images.ImagesBody.getPNG()), this.game.load.atlasJSONHash(n.Atlases.AtlasesFeet.getName(), n.Atlases.AtlasesFeet.getPNG(), n.Atlases.AtlasesFeet.getJSONHash()), this.game.load.atlasJSONHash(n.Atlases.AtlasesHit.getName(), n.Atlases.AtlasesHit.getPNG(), n.Atlases.AtlasesHit.getJSONHash()), this.game.load.image(n.Images.ImagesSword.getName(), n.Images.ImagesSword.getPNG()), this.game.load.image(n.Images.ImagesAxe.getName(), n.Images.ImagesAxe.getPNG()), this.loadLeaderboards()
            }, e.prototype.create = function() {
                var t = this;
                this.jsonFetch.then(function() {
                    t.game.load.onLoadComplete.addOnce(function() {
                        t.game.state.start(t.nextState, !0, !1, !1)
                    }), t.game.load.start()
                })
            }, e.prototype.loadLeaderboards = function() {
                $.ajax("https://leaderboard.glar.io").done(function(t) {
                    for (var e = t[1], i = [], s = 0; s < e.length; s += 2) {
                        var n = e[s],
                            r = e[s + 1],
                            a = r > 1e4 ? Math.floor(r / 1e3).toString() + "k" : r.toString();
                        i.push('  \n                <div class="ui-leaderboard-player">\n                <span class="player-rank">#' + (Math.floor(s / 2) + 1) + '</span>\n                <span class="player-name">' + o.escapeHtml(n) + '</span>\n                <span class="player-score">' + a + "</span>\n                </div>")
                    }
                    $("#weekly-leaderboard").append(i.join(""))
                }.bind(this))
            }, e
        }(Phaser.State);
    e.default = r
}, function(t, e, i) {
    "use strict";
    Object.defineProperty(e, "__esModule", {
            value: !0
        }),
        function(t) {
            t.log = function() {
                for (var t = [], e = 0; e < arguments.length; e++) t[e] = arguments[e];
                t.unshift((new Date).toISOString()), console.log.apply(console, t)
            }, t.arrayRandomSelect = function(t) {
                return t[Math.floor(Math.random() * t.length)]
            }, t.random = function(t, e) {
                return Math.floor(Math.random() * (e - t) + t)
            }, t.genRanHex = function(t) {
                return Array(t).slice().map(function() {
                    return Math.floor(16 * Math.random()).toString(16)
                }).join("")
            }
        }(e.Security || (e.Security = {}))
}, function(t, e, i) {
    var s;
    ! function() {
        function n(t, e, i) {
            return t.call.apply(t.bind, arguments)
        }

        function o(t, e, i) {
            if (!t) throw Error();
            if (2 < arguments.length) {
                var s = Array.prototype.slice.call(arguments, 2);
                return function() {
                    var i = Array.prototype.slice.call(arguments);
                    return Array.prototype.unshift.apply(i, s), t.apply(e, i)
                }
            }
            return function() {
                return t.apply(e, arguments)
            }
        }

        function r(t, e, i) {
            return (r = Function.prototype.bind && -1 != Function.prototype.bind.toString().indexOf("native code") ? n : o).apply(null, arguments)
        }

        function a(t, e) {
            this.a = t, this.m = e || t, this.c = this.m.document
        }

        function h(t, e, i, s) {
            if (e = t.c.createElement(e), i)
                for (var n in i) i.hasOwnProperty(n) && ("style" == n ? e.style.cssText = i[n] : e.setAttribute(n, i[n]));
            return s && e.appendChild(t.c.createTextNode(s)), e
        }

        function l(t, e, i) {
            (t = t.c.getElementsByTagName(e)[0]) || (t = document.documentElement), t.insertBefore(i, t.lastChild)
        }

        function c(t) {
            t.parentNode && t.parentNode.removeChild(t)
        }

        function u(t, e, i) {
            e = e || [], i = i || [];
            for (var s = t.className.split(/\s+/), n = 0; n < e.length; n += 1) {
                for (var o = !1, r = 0; r < s.length; r += 1)
                    if (e[n] === s[r]) {
                        o = !0;
                        break
                    } o || s.push(e[n])
            }
            for (e = [], n = 0; n < s.length; n += 1) {
                for (o = !1, r = 0; r < i.length; r += 1)
                    if (s[n] === i[r]) {
                        o = !0;
                        break
                    } o || e.push(s[n])
            }
            t.className = e.join(" ").replace(/\s+/g, " ").replace(/^\s+|\s+$/, "")
        }

        function d(t, e) {
            for (var i = t.className.split(/\s+/), s = 0, n = i.length; s < n; s++)
                if (i[s] == e) return !0;
            return !1
        }

        function p(t) {
            if ("string" == typeof t.f) return t.f;
            var e = t.m.location.protocol;
            return "about:" == e && (e = t.a.location.protocol), "https:" == e ? "https:" : "http:"
        }

        function f(t, e, i) {
            function s() {
                a && n && o && (a(r), a = null)
            }
            e = h(t, "link", {
                rel: "stylesheet",
                href: e,
                media: "all"
            });
            var n = !1,
                o = !0,
                r = null,
                a = i || null;
            Z ? (e.onload = function() {
                n = !0, s()
            }, e.onerror = function() {
                n = !0, r = Error("Stylesheet failed to load"), s()
            }) : setTimeout(function() {
                n = !0, s()
            }, 0), l(t, "head", e)
        }

        function m(t, e, i, s) {
            var n = t.c.getElementsByTagName("head")[0];
            if (n) {
                var o = h(t, "script", {
                        src: e
                    }),
                    r = !1;
                return o.onload = o.onreadystatechange = function() {
                    r || this.readyState && "loaded" != this.readyState && "complete" != this.readyState || (r = !0, i && i(null), o.onload = o.onreadystatechange = null, "HEAD" == o.parentNode.tagName && n.removeChild(o))
                }, n.appendChild(o), setTimeout(function() {
                    r || (r = !0, i && i(Error("Script load timeout")))
                }, s || 5e3), o
            }
            return null
        }

        function g() {
            this.a = 0, this.c = null
        }

        function y(t) {
            return t.a++,
                function() {
                    t.a--, b(t)
                }
        }

        function v(t, e) {
            t.c = e, b(t)
        }

        function b(t) {
            0 == t.a && t.c && (t.c(), t.c = null)
        }

        function _(t) {
            this.a = t || "-"
        }

        function w(t, e) {
            this.c = t, this.f = 4, this.a = "n";
            var i = (e || "n4").match(/^([nio])([1-9])$/i);
            i && (this.a = i[1], this.f = parseInt(i[2], 10))
        }

        function x(t) {
            var e = [];
            t = t.split(/,\s*/);
            for (var i = 0; i < t.length; i++) {
                var s = t[i].replace(/['"]/g, ""); - 1 != s.indexOf(" ") || /^\d/.test(s) ? e.push("'" + s + "'") : e.push(s)
            }
            return e.join(",")
        }

        function P(t) {
            return t.a + t.f
        }

        function T(t) {
            var e = "normal";
            return "o" === t.a ? e = "oblique" : "i" === t.a && (e = "italic"), e
        }

        function C(t) {
            var e = 4,
                i = "n",
                s = null;
            return t && ((s = t.match(/(normal|oblique|italic)/i)) && s[1] && (i = s[1].substr(0, 1).toLowerCase()), (s = t.match(/([1-9]00|normal|bold)/i)) && s[1] && (/bold/i.test(s[1]) ? e = 7 : /[1-9]00/.test(s[1]) && (e = parseInt(s[1].substr(0, 1), 10)))), i + e
        }

        function S(t, e) {
            this.c = t, this.f = t.m.document.documentElement, this.h = e, this.a = new _("-"), this.j = !1 !== e.events, this.g = !1 !== e.classes
        }

        function A(t) {
            if (t.g) {
                var e = d(t.f, t.a.c("wf", "active")),
                    i = [],
                    s = [t.a.c("wf", "loading")];
                e || i.push(t.a.c("wf", "inactive")), u(t.f, i, s)
            }
            E(t, "inactive")
        }

        function E(t, e, i) {
            t.j && t.h[e] && (i ? t.h[e](i.c, P(i)) : t.h[e]())
        }

        function k() {
            this.c = {}
        }

        function M(t, e) {
            this.c = t, this.f = e, this.a = h(this.c, "span", {
                "aria-hidden": "true"
            }, this.f)
        }

        function O(t) {
            l(t.c, "body", t.a)
        }

        function R(t) {
            return "display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:" + x(t.c) + ";font-style:" + T(t) + ";font-weight:" + t.f + "00;"
        }

        function B(t, e, i, s, n, o) {
            this.g = t, this.j = e, this.a = s, this.c = i, this.f = n || 3e3, this.h = o || void 0
        }

        function I(t, e, i, s, n, o, r) {
            this.v = t, this.B = e, this.c = i, this.a = s, this.s = r || "BESbswy", this.f = {}, this.w = n || 3e3, this.u = o || null, this.o = this.j = this.h = this.g = null, this.g = new M(this.c, this.s), this.h = new M(this.c, this.s), this.j = new M(this.c, this.s), this.o = new M(this.c, this.s), t = R(t = new w(this.a.c + ",serif", P(this.a))), this.g.a.style.cssText = t, t = R(t = new w(this.a.c + ",sans-serif", P(this.a))), this.h.a.style.cssText = t, t = R(t = new w("serif", P(this.a))), this.j.a.style.cssText = t, t = R(t = new w("sans-serif", P(this.a))), this.o.a.style.cssText = t, O(this.g), O(this.h), O(this.j), O(this.o)
        }

        function L() {
            if (null === tt) {
                var t = /AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);
                tt = !!t && (536 > parseInt(t[1], 10) || 536 === parseInt(t[1], 10) && 11 >= parseInt(t[2], 10))
            }
            return tt
        }

        function D(t, e, i) {
            for (var s in $)
                if ($.hasOwnProperty(s) && e === t.f[$[s]] && i === t.f[$[s]]) return !0;
            return !1
        }

        function F(t) {
            var e, i = t.g.a.offsetWidth,
                s = t.h.a.offsetWidth;
            (e = i === t.f.serif && s === t.f["sans-serif"]) || (e = L() && D(t, i, s)), e ? Q() - t.A >= t.w ? L() && D(t, i, s) && (null === t.u || t.u.hasOwnProperty(t.a.c)) ? U(t, t.v) : U(t, t.B) : function(t) {
                setTimeout(r(function() {
                    F(this)
                }, t), 50)
            }(t) : U(t, t.v)
        }

        function U(t, e) {
            setTimeout(r(function() {
                c(this.g.a), c(this.h.a), c(this.j.a), c(this.o.a), e(this.a)
            }, t), 0)
        }

        function N(t, e, i) {
            this.c = t, this.a = e, this.f = 0, this.o = this.j = !1, this.s = i
        }

        function G(t) {
            0 == --t.f && t.j && (t.o ? ((t = t.a).g && u(t.f, [t.a.c("wf", "active")], [t.a.c("wf", "loading"), t.a.c("wf", "inactive")]), E(t, "active")) : A(t.a))
        }

        function j(t) {
            this.j = t, this.a = new k, this.h = 0, this.f = this.g = !0
        }

        function W(t, e, i, s, n) {
            var o = 0 == --t.h;
            (t.f || t.g) && setTimeout(function() {
                var t = n || null,
                    a = s || {};
                if (0 === i.length && o) A(e.a);
                else {
                    e.f += i.length, o && (e.j = o);
                    var h, l = [];
                    for (h = 0; h < i.length; h++) {
                        var c = i[h],
                            d = a[c.c],
                            p = e.a,
                            f = c;
                        if (p.g && u(p.f, [p.a.c("wf", f.c, P(f).toString(), "loading")]), E(p, "fontloading", f), p = null, null === et)
                            if (window.FontFace) {
                                f = /Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);
                                var m = /OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent) && /Apple/.exec(window.navigator.vendor);
                                et = f ? 42 < parseInt(f[1], 10) : !m
                            } else et = !1;
                        p = et ? new B(r(e.g, e), r(e.h, e), e.c, c, e.s, d) : new I(r(e.g, e), r(e.h, e), e.c, c, e.s, t, d), l.push(p)
                    }
                    for (h = 0; h < l.length; h++) l[h].start()
                }
            }, 0)
        }

        function q(t, e, i) {
            var s = [],
                n = i.timeout;
            ! function(t) {
                t.g && u(t.f, [t.a.c("wf", "loading")]), E(t, "loading")
            }(e);
            s = function(t, e, i) {
                var s, n = [];
                for (s in e)
                    if (e.hasOwnProperty(s)) {
                        var o = t.c[s];
                        o && n.push(o(e[s], i))
                    } return n
            }(t.a, i, t.c);
            var o = new N(t.c, e, n);
            for (t.h = s.length, e = 0, i = s.length; e < i; e++) s[e].load(function(e, i, s) {
                W(t, o, e, i, s)
            })
        }

        function H(t, e) {
            this.c = t, this.a = e
        }

        function X(t, e) {
            this.c = t, this.a = e
        }

        function V(t, e, i) {
            this.c = t || e + it, this.a = [], this.f = [], this.g = i || ""
        }

        function Y(t) {
            this.f = t, this.a = [], this.c = {}
        }

        function z(t, e) {
            this.c = t, this.a = e
        }

        function K(t, e) {
            this.c = t, this.a = e
        }

        function J(t, e) {
            this.c = t, this.f = e, this.a = []
        }
        var Q = Date.now || function() {
                return +new Date
            },
            Z = !!window.FontFace;
        _.prototype.c = function(t) {
            for (var e = [], i = 0; i < arguments.length; i++) e.push(arguments[i].replace(/[\W_]+/g, "").toLowerCase());
            return e.join(this.a)
        }, B.prototype.start = function() {
            var t = this.c.m.document,
                e = this,
                i = Q(),
                s = new Promise(function(s, n) {
                    ! function o() {
                        Q() - i >= e.f ? n() : t.fonts.load(function(t) {
                            return T(t) + " " + t.f + "00 300px " + x(t.c)
                        }(e.a), e.h).then(function(t) {
                            1 <= t.length ? s() : setTimeout(o, 25)
                        }, function() {
                            n()
                        })
                    }()
                }),
                n = new Promise(function(t, i) {
                    setTimeout(i, e.f)
                });
            Promise.race([n, s]).then(function() {
                e.g(e.a)
            }, function() {
                e.j(e.a)
            })
        };
        var $ = {
                D: "serif",
                C: "sans-serif"
            },
            tt = null;
        I.prototype.start = function() {
            this.f.serif = this.j.a.offsetWidth, this.f["sans-serif"] = this.o.a.offsetWidth, this.A = Q(), F(this)
        };
        var et = null;
        N.prototype.g = function(t) {
            var e = this.a;
            e.g && u(e.f, [e.a.c("wf", t.c, P(t).toString(), "active")], [e.a.c("wf", t.c, P(t).toString(), "loading"), e.a.c("wf", t.c, P(t).toString(), "inactive")]), E(e, "fontactive", t), this.o = !0, G(this)
        }, N.prototype.h = function(t) {
            var e = this.a;
            if (e.g) {
                var i = d(e.f, e.a.c("wf", t.c, P(t).toString(), "active")),
                    s = [],
                    n = [e.a.c("wf", t.c, P(t).toString(), "loading")];
                i || s.push(e.a.c("wf", t.c, P(t).toString(), "inactive")), u(e.f, s, n)
            }
            E(e, "fontinactive", t), G(this)
        }, j.prototype.load = function(t) {
            this.c = new a(this.j, t.context || this.j), this.g = !1 !== t.events, this.f = !1 !== t.classes, q(this, new S(this.c, t), t)
        }, H.prototype.load = function(t) {
            var e = this,
                i = e.a.projectId,
                s = e.a.version;
            if (i) {
                var n = e.c.m;
                m(this.c, function(t, e, i) {
                    return p(t.c) + "//" + (t = (t.a.api || "fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/, "")) + "/" + e + ".js" + (i ? "?v=" + i : "")
                }(e, i, s), function(s) {
                    s ? t([]) : (n["__MonotypeConfiguration__" + i] = function() {
                        return e.a
                    }, function e() {
                        if (n["__mti_fntLst" + i]) {
                            var s, o = n["__mti_fntLst" + i](),
                                r = [];
                            if (o)
                                for (var a = 0; a < o.length; a++) {
                                    var h = o[a].fontfamily;
                                    null != o[a].fontStyle && null != o[a].fontWeight ? (s = o[a].fontStyle + o[a].fontWeight, r.push(new w(h, s))) : r.push(new w(h))
                                }
                            t(r)
                        } else setTimeout(function() {
                            e()
                        }, 50)
                    }())
                }).id = "__MonotypeAPIScript__" + i
            } else t([])
        }, X.prototype.load = function(t) {
            var e, i, s = this.a.urls || [],
                n = this.a.families || [],
                o = this.a.testStrings || {},
                r = new g;
            for (e = 0, i = s.length; e < i; e++) f(this.c, s[e], y(r));
            var a = [];
            for (e = 0, i = n.length; e < i; e++)
                if ((s = n[e].split(":"))[1])
                    for (var h = s[1].split(","), l = 0; l < h.length; l += 1) a.push(new w(s[0], h[l]));
                else a.push(new w(s[0]));
            v(r, function() {
                t(a, o)
            })
        };
        var it = "//fonts.googleapis.com/css",
            st = {
                latin: "BESbswy",
                "latin-ext": "",
                cyrillic: "",
                greek: "",
                khmer: "",
                Hanuman: ""
            },
            nt = {
                thin: "1",
                extralight: "2",
                "extra-light": "2",
                ultralight: "2",
                "ultra-light": "2",
                light: "3",
                regular: "4",
                book: "4",
                medium: "5",
                "semi-bold": "6",
                semibold: "6",
                "demi-bold": "6",
                demibold: "6",
                bold: "7",
                "extra-bold": "8",
                extrabold: "8",
                "ultra-bold": "8",
                ultrabold: "8",
                black: "9",
                heavy: "9",
                l: "3",
                r: "4",
                b: "7"
            },
            ot = {
                i: "i",
                italic: "i",
                n: "n",
                normal: "n"
            },
            rt = /^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/,
            at = {
                Arimo: !0,
                Cousine: !0,
                Tinos: !0
            };
        z.prototype.load = function(t) {
            var e = new g,
                i = this.c,
                s = new V(this.a.api, p(i), this.a.text),
                n = this.a.families;
            ! function(t, e) {
                for (var i = e.length, s = 0; s < i; s++) {
                    var n = e[s].split(":");
                    3 == n.length && t.f.push(n.pop());
                    var o = "";
                    2 == n.length && "" != n[1] && (o = ":"), t.a.push(n.join(o))
                }
            }(s, n);
            var o = new Y(n);
            (function(t) {
                for (var e = t.f.length, i = 0; i < e; i++) {
                    var s = t.f[i].split(":"),
                        n = s[0].replace(/\+/g, " "),
                        o = ["n4"];
                    if (2 <= s.length) {
                        var r;
                        if (r = [], a = s[1])
                            for (var a, h = (a = a.split(",")).length, l = 0; l < h; l++) {
                                var c;
                                if ((c = a[l]).match(/^[\w-]+$/))
                                    if (null == (u = rt.exec(c.toLowerCase()))) c = "";
                                    else {
                                        if (c = null == (c = u[2]) || "" == c ? "n" : ot[c], null == (u = u[1]) || "" == u) u = "4";
                                        else var u = nt[u] || (isNaN(u) ? "4" : u.substr(0, 1));
                                        c = [c, u].join("")
                                    }
                                else c = "";
                                c && r.push(c)
                            }
                        0 < r.length && (o = r), 3 == s.length && (r = [], 0 < (s = (s = s[2]) ? s.split(",") : r).length && (s = st[s[0]]) && (t.c[n] = s))
                    }
                    for (t.c[n] || (s = st[n]) && (t.c[n] = s), s = 0; s < o.length; s += 1) t.a.push(new w(n, o[s]))
                }
            })(o), f(i, function(t) {
                if (0 == t.a.length) throw Error("No fonts to load!");
                if (-1 != t.c.indexOf("kit=")) return t.c;
                for (var e = t.a.length, i = [], s = 0; s < e; s++) i.push(t.a[s].replace(/ /g, "+"));
                return e = t.c + "?family=" + i.join("%7C"), 0 < t.f.length && (e += "&subset=" + t.f.join(",")), 0 < t.g.length && (e += "&text=" + encodeURIComponent(t.g)), e
            }(s), y(e)), v(e, function() {
                t(o.a, o.c, at)
            })
        }, K.prototype.load = function(t) {
            var e = this.a.id,
                i = this.c.m;
            e ? m(this.c, (this.a.api || "https://use.typekit.net") + "/" + e + ".js", function(e) {
                if (e) t([]);
                else if (i.Typekit && i.Typekit.config && i.Typekit.config.fn) {
                    e = i.Typekit.config.fn;
                    for (var s = [], n = 0; n < e.length; n += 2)
                        for (var o = e[n], r = e[n + 1], a = 0; a < r.length; a++) s.push(new w(o, r[a]));
                    try {
                        i.Typekit.load({
                            events: !1,
                            classes: !1,
                            async: !0
                        })
                    } catch (t) {}
                    t(s)
                }
            }, 2e3) : t([])
        }, J.prototype.load = function(t) {
            var e = this.f.id,
                i = this.c.m,
                s = this;
            e ? (i.__webfontfontdeckmodule__ || (i.__webfontfontdeckmodule__ = {}), i.__webfontfontdeckmodule__[e] = function(e, i) {
                for (var n = 0, o = i.fonts.length; n < o; ++n) {
                    var r = i.fonts[n];
                    s.a.push(new w(r.name, C("font-weight:" + r.weight + ";font-style:" + r.style)))
                }
                t(s.a)
            }, m(this.c, p(this.c) + (this.f.api || "//f.fontdeck.com/s/css/js/") + function(t) {
                return t.m.location.hostname || t.a.location.hostname
            }(this.c) + "/" + e + ".js", function(e) {
                e && t([])
            })) : t([])
        };
        var ht = new j(window);
        ht.a.c.custom = function(t, e) {
            return new X(e, t)
        }, ht.a.c.fontdeck = function(t, e) {
            return new J(e, t)
        }, ht.a.c.monotype = function(t, e) {
            return new H(e, t)
        }, ht.a.c.typekit = function(t, e) {
            return new K(e, t)
        }, ht.a.c.google = function(t, e) {
            return new z(e, t)
        };
        var lt = {
            load: r(ht.load, ht)
        };
        void 0 !== (s = function() {
            return lt
        }.call(e, i, e, t)) && (t.exports = s)
    }()
}, function(t, e) {
    (function(e) {
        t.exports = e
    }).call(e, {})
}, function(t, e) {
    var i;
    i = function() {
        return this
    }();
    try {
        i = i || Function("return this")() || (0, eval)("this")
    } catch (t) {
        "object" == typeof window && (i = window)
    }
    t.exports = i
}, function(t, e) {
    t.exports = function(t) {
        return t.webpackPolyfill || (t.deprecate = function() {}, t.paths = [], t.children || (t.children = []), Object.defineProperty(t, "loaded", {
            enumerable: !0,
            get: function() {
                return t.l
            }
        }), Object.defineProperty(t, "id", {
            enumerable: !0,
            get: function() {
                return t.i
            }
        }), t.webpackPolyfill = 1), t
    }
}, function(t, e) {
    t.exports = {
        client: {
            build_radius: 600
        },
        bounds: {
            x: 256,
            y: 256,
            width: 25088,
            height: 25920
        },
        buildings: {
            woodgenerator: {
                price: {}
            },
            stonegenerator: {
                price: {}
            },
            marblefloor: {
                name: "marblefloor",
                description: "",
                limit: 1,
                price: {
                    wood: 25
                }
            },
            woodfloor: {
                name: "woodfloor",
                description: "",
                limit: 1,
                price: {
                    wood: 25
                }
            },
            stonefloor: {
                name: "stonefloor",
                description: "",
                limit: 1,
                price: {
                    stone: 50
                }
            },
            woodblock: {
                name: "Wooden Wall",
                description: "Strong wooden wall.",
                limit: 90,
                price: {
                    wood: 25
                }
            },
            stoneblock: {
                name: "Stone Wall",
                description: "Very strong stone wall.",
                limit: 90,
                price: {
                    stone: 50
                }
            },
            darkstoneblock: {
                name: "Dark Wall",
                description: "Very strong dark wall.",
                limit: 60,
                price: {
                    gold: 10
                }
            },
            door: {
                name: "Door",
                description: "Opens only for you and your clan.",
                limit: 15,
                price: {
                    wood: 25,
                    stone: 50
                }
            },
            darkdoor: {
                name: "Dark Door",
                description: "Opens only for you and your clan.",
                limit: 5,
                price: {
                    gold: 10
                }
            },
            farmerbot: {
                name: "Peasant",
                description: "Gather the nearest resource available.",
                limit: 5,
                price: {
                    food: 12
                }
            },
            gardenbot: {
                name: "Gardener",
                description: "Gather carrots from gardens.",
                limit: 4,
                price: {
                    food: 50,
                    gold: 250
                }
            },
            woodspikes: {
                name: "Wooden Spikes",
                description: "Spikes damage your enemies!",
                limit: 50,
                price: {
                    wood: 100,
                    gold: 50
                }
            },
            ironspikes: {
                price: {
                    stone: 200,
                    gold: 100
                },
                name: "Iron Spikes",
                limit: 30,
                description: "Stronger spikes damage your enemies!"
            },
            crystalwall: {
                price: {
                    stone: 200,
                    soul: 1
                },
                name: "Crystal Block",
                description: "Wall infused with life force.",
                limit: 30
            },
            crystaldoor: {
                price: {
                    soul: 0,
                    stone: 1
                },
                name: "Crystal Door",
                limit: 5,
                description: "Sexxxxx."
            },
            portal: {
                name: "Portal",
                description: "Teleport you!",
                limit: 4,
                price: {
                    gold: 1e3,
                    soul: 1e4
                }
            },
            garden: {
                name: "Bed",
                description: "You can grow carrots on a bed!",
                limit: 10,
                price: {
                    food: 20
                }
            },
            guardbot: {
                name: "Guard",
                description: "Defends the area you place him on.",
                limit: 6,
                price: {
                    food: 40
                }
            },
            darkguardbot: {
                name: "Dark Guard",
                description: "Sex with him.",
                limit: 2,
                price: {
                    gold: 10
                }
            },
            followerbot: {
                name: "Mercenary",
                description: "Follows you wherever you go and helps in everything!",
                limit: 3,
                price: {
                    food: 15
                }
            },
            mannequin: {
                name: "Mannequin",
                description: "Used for training",
                limit: 15,
                price: {
                    food: 100,
                    gold: 500
                }
            },
            foodcrate: {
                name: "Food Container",
                description: "Food container",
                limit: 100,
                price: {
                    food: 100
                }
            },
            woodcrate: {
                name: "Wood Container",
                description: "Wood container",
                limit: 15,
                price: {
                    wood: 100
                }
            },
            stonecrate: {
                name: "Stone Container",
                description: "Stone container",
                limit: 15,
                price: {
                    stone: 100
                }
            },
            soulcrate: {
                name: "Souls Container",
                description: "Souls container",
                limit: 100,
                price: {
                    soul: 100
                }
            },
            heartstone: {
                name: "The Stone of Life",
                description: "Resurrects you after your death. Make sure it is not destroyed!",
                limit: 1,
                price: {
                    food: 50,
                    gold: 100
                }
            },
            healward: {
                name: "healward",
                description: "",
                limit: 1,
                price: {
                    food: 50,
                    gold: 100
                }
            },
            tower: {
                name: "Tower",
                description: "The tower produces gold, making you richer!",
                limit: 10,
                price: {
                    wood: 40,
                    stone: 40
                }
            },
            rideablewolf: {
                name: "Black Wolf",
                description: "You can ride on it and regenerate faster!",
                limit: 5,
                price: {
                    food: 1e3,
                    gold: 1e4
                }
            },
            rideablebear: {
                name: "Black Bear",
                description: "You can ride on it and be more powerful!",
                limit: 1,
                price: {
                    wood: 1e4,
                    soul: 1e4,
                    gold: 1e4
                }
            },
            rideabledragon: {
                name: "Dragon",
                description: "You can ride on it and be more powerful!",
                limit: 1,
                price: {
                    wood: 1e4,
                    soul: 1e4,
                    gold: 1e4
                }
            },
            soccerball: {
                name: "Ball",
                description: "For football fans",
                limit: 40,
                price: {
                    gold: 500
                }
            }
        }
    }
}, function(t, e) {
    t.exports = function(t) {
        return Array.from(t)
    }
}, function(t, e, i) {
    t.exports = i(40)
}]);
alert ('hi')
